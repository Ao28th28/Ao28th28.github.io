var sw=sw||{},SW=SW||{};SW.AppRouter=Backbone.Router.extend({routes:{"":"setDashboardPage",classes:"setClassesPage","my-kids":"setClassesPage",students:"setStudentsPage",memberships:"setMembershipsPage",planner:"setPlannerPage",influencer:"setInfluencerPage","reports/topic-report(/:curriculumID)(/:topicName)(/)":"setTopicReportPage","reports/curriculum-report":"setCurriculumReportPage","reports/activity-report":"setActivityReportPage","reports/student-usage-report":"setStudentUsageReportPage","reports/admin-report":"setAdminReportPage",reports:"setReportsPage","start-now":"forceLogout",account:"setAccountsPage",profile:"setStudentProfilePage"},initialize:function(){this.initializeErrorHandlers(),sw.overlayManager=new SW.OverlayManagerView({el:"#overlay-mask"}),sw.toastManager=new SW.ToastManager,sw.dialogManager=new SW.DialogManager,sw.config=new SW.Config,sw.user=new SW.User,sw.user.students.load(),sw.user.classes.load(),sw.user.memberships.load(),sw.splitTest=new SW.SplitTest,sw.track=new SW.Track,sw.support={chat:new SW.SupportChat},sw.pageManager=new SW.PageManager,this.trackFirstLogin(),this.initializeAppRootRegion(),sw.dispatcher.trigger("tutorials:load"),this.initializeSubRouters(),sw.user.parentApp()&&this.route("","setClassesPage"),this.listenTo(sw.dispatcher,"class:change",this.refresh),this.listenTo(sw.dispatcher,"navigate",this.onNavigateRequest)},initializeAppRootRegion:function(){sw.appRootRegion=sw.appRootRegion||new SW.AppRootRegionView({el:"#main-app-page",model:new SW.AppRootRegion}),sw.appRootRegion.render()},initializeErrorHandlers:function(){$(document).ajaxError(function(e,t){409===t.status&&sw.dispatcher.trigger("error:conflict")})},initializeSubRouters:function(){sw.tutorialRouter=sw.tutorialRouter||new SW.TutorialRouter},start:function(){Backbone.history.start(),this.directToStartingPage()},directToStartingPage:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.tutorials],success:this.loadTutorialsSuccess.bind(this),fail:this.loadTutorialsFail.bind(this)})},loadTutorialsSuccess:function(){sw.user.hasIncompleteCriticalTutorials()?sw.app.navigate("#tutorial",{trigger:!0}):sw.user.tutorials.isCompleted(SW.Tutorials.EXISTING_USER_MODAL_TUTORIAL)||sw.user.parentApp()?!sw.user.parentApp()||sw.user.wasInParentAppDuringExperiment()||sw.user.tutorials.isCompleted(SW.Tutorials.PARENT_APP_MIGRATION)||sw.dialogManager.open({className:"dialog dialog--basic dialog--tall",type:"custom",size:"medium",children:[{view:SW.MigrationDialogView,model:SW.MigrationDialog}]}):_.delay(function(){this.createExistingUserModalTutorial()}.bind(this),750)},loadTutorialsFail:function(){console.error("(AppRouter) There was a problem loading tutorials.")},createExistingUserModalTutorial:function(){this._existingUserModalTutorialView||(this._existingUserModalTutorialView=new SW.ExistingUserModalTutorialView({model:new SW.ExistingUserModalTutorial}),this.listenToOnce(this._existingUserModalTutorialView,"complete",function(){sw.user.tutorials.save(SW.Tutorials.EXISTING_USER_MODAL_TUTORIAL),this._existingUserModalTutorialView=null}.bind(this)))},refresh:function(){Backbone.history.loadUrl(Backbone.history.fragment)},forceLogout:function(){sw.user.logout()},updateSession:function(){SW.Cookie.sessionTokenMatches(sw.user.get("authKey"))||this.trackSession(),SW.Cookie.setSessionToken(sw.user.get("authKey"))},beforeSetPage:function(e,t){var i,s=SW.Utility.getUrlVar("classID"),n=SW.Utility.getUrlVar("activate");sw.track.pageView(e),SW.Logger.pageView(e),this.updateSession(),s&&SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){return sw.user.classes.get(s)?(sw.user.classes.changeCurrentClass(s,!0),void this.navigate(SW.Utility.removeUrlVarFromFragment(encodeURI(Backbone.history.fragment),"classID"),{replace:!0})):(sw.toastManager.create({id:"class-not-found",type:"error",content:"The class you're looking for could not be found."}),void this.navigate(SW.Utility.removeUrlVarFromFragment("classes","classID"),{trigger:!0}))}.bind(this)}),n&&sw.user.isParent()&&(SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){sw.user.classes.each(function(e){e.students.get(n)&&(i=e.students.get(n))}),i&&sw.dialogManager.open({type:"card",title:"How to play Prodigy at home",buttons:[{text:"Got it!",className:"btn btn--blue"}],children:[{view:SW.ActivateChildView,model:i}]})}}),this.navigate(SW.Utility.removeUrlVarFromFragment(encodeURI(Backbone.history.fragment),"activate"),{replace:!0})),t&&t()},setDashboardPage:function(){var e="dashboard",t={settings:this.getPageSettings(e)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.DashboardView({model:new SW.Dashboard(t)}))},setStudentsPage:function(){var e="students",t={settings:this.getPageSettings(e)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.StudentsPageView({model:new SW.StudentsPage(t)}))},setPlannerPage:function(){var e="planner",t={settings:this.getPageSettings(e)},i=SW.Utility.getUrlVar("startCreation");i&&(t.startCreation=i,this.navigate(SW.Utility.removeUrlVarsFromFragment(Backbone.history.fragment,["startCreation"]),{replace:!0})),this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.PlannerView({model:new SW.Planner(t)}))},setInfluencerPage:function(){var e="influencer",t={settings:this.getPageSettings(e,!1)};this.beforeSetPage(e),sw.track.milestone("Share - Page View"),sw.appRootRegion.setAppPage(new SW.InfluencerView({model:new SW.Influencer(t)}))},setTopicReportPage:function(e,t){var i="topicReport",s={settings:this.getPageSettings(i,!1)},n=SW.Utility.getUrlVar("referrer");this.beforeSetPage(i),sw.track.user("increment",{"Viewed Topic Report":1}),sw.track.user("set",{"Last Report Viewed":new Date}),_.extend(s,{curriculumID:e?parseInt(e,10):e,topicName:t?decodeURIComponent(t):t,referrer:n||null}),sw.appRootRegion.setAppPage(new SW.TopicReportPageView({model:new SW.TopicReportPage(s)}))},setCurriculumReportPage:function(){var e="curriculumReport",t={settings:this.getPageSettings(e,!1)};this.beforeSetPage(e),sw.track.user("increment",{"Viewed Curriculum Report":1}),sw.track.user("set",{"Last Report Viewed":new Date}),sw.appRootRegion.setAppPage(new SW.CurriculumReportPageView({model:new SW.CurriculumReportPage(t)}))},setStudentUsageReportPage:function(){var e="studentUsageReport",t={settings:this.getPageSettings(e,!1)},i=SW.Utility.getUrlVar("startTime"),s=SW.Utility.getUrlVar("endTime");i&&s&&(t.startTime=parseInt(i,10),t.endTime=parseInt(s,10),this.navigate(SW.Utility.removeUrlVarsFromFragment(Backbone.history.fragment,["startTime","endTime"]),{replace:!0})),this.beforeSetPage(e),sw.track.user("increment",{"Viewed Student Usage Report":1}),sw.track.user("set",{"Last Report Viewed":new Date}),sw.appRootRegion.setAppPage(new SW.StudentUsageReportPageView({model:new SW.StudentUsageReportPage(t)}))},setAdminReportPage:function(){var e="adminReport",t={settings:this.getPageSettings(e,!1)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.AdminReportPageView({model:new SW.AdminReportPage(t)}))},setActivityReportPage:function(){var e="activityReport",t={settings:this.getPageSettings(e,!1)},i=SW.Utility.getUrlVar("startTime"),s=SW.Utility.getUrlVar("endTime");i&&s&&(t.startTime=parseInt(i,10),t.endTime=parseInt(s,10),this.navigate(SW.Utility.removeUrlVarsFromFragment(Backbone.history.fragment,["startTime","endTime"]),{replace:!0})),this.beforeSetPage(e,function(){sw.track.user("increment",{"Viewed Activity Report":1}),sw.track.user("set",{"Last Report Viewed":new Date}),sw.appRootRegion.setAppPage(new SW.ActivityReportPageView({model:new SW.ActivityReportPage(t)}))})},setClassesPage:function(){var e="classes",t={settings:this.getPageSettings(e,!0)};this.beforeSetPage(e),t.settings.navigation.breadcrumb=!1,sw.user.parentApp()&&this.navigate("my-kids",{replace:!0}),sw.appRootRegion.setAppPage(new SW.ClassesView({model:new SW.Classes(t)}))},setMembershipsPage:function(){var e="memberships",t={settings:this.getPageSettings(e,!0)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.MembershipsPageView({model:new SW.MembershipsPage(t)}))},setTutorialPage:function(){var e="tutorial",t={settings:this.getPageSettings(e,!0)};this.beforeSetPage(e),t.settings.navigation.account=!1,t.settings.navigation.notifications=!1,t.settings.navigation.breadcrumb=!1,sw.appRootRegion.setAppPage(new SW.TutorialPageView({model:new SW.TutorialPage(t)}))},setReportsPage:function(){var e="reports",t={settings:this.getPageSettings(e,!1)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.ReportsPageView({model:new SW.ReportsPage(t)}))},setAccountsPage:function(){var e="accounts",t={settings:this.getPageSettings(e,!0)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.AccountSettingsView({model:new SW.AccountSettings(t)}))},setStudentProfilePage:function(){var e="studentProfile",t={settings:this.getPageSettings(e,!1)};this.beforeSetPage(e),sw.appRootRegion.setAppPage(new SW.StudentProfilePageView({model:new SW.StudentProfilePage(t)}))},getPageSettings:function(e,t){var i=!!_.isBoolean(t)&&t,s=sw.user.parentApp();return{pageID:e,navigation:{page:!s&&!i,breadcrumb:!s&&"classes"!==e,classSelect:!i,account:!0,notifications:!1},page:{},footer:{}}},trackFirstLogin:function(){SW.Cookie.sessionTokenMatches(sw.user.get("authKey"))||(SW.Utility.getUrlVar("register")?this.trackRegister():SW.Utility.getUrlVar("login")&&this.trackLogin())},trackSession:function(){SW.Logger.track("session"),sw.track.event("dashboard","session",sw.user.get("usertype"))},trackLogin:function(){SW.Logger.track("login"),sw.track.event("dashboard","login",sw.user.get("usertype"))},trackRegister:function(){var e=SW.Utility.getUrlVar("referralOrigin"),t=2,i=SW.Cookie.get("influitiveReferralCampaignID"),s=SW.Cookie.get("influitiveShareToken");SW.Logger.track({name:"register",details:{"referral-origin":e,referrer:SW.Cookie.get("sw-referrer")||"","utm-source":SW.Cookie.get("sw-utm-source")||"","utm-medium":SW.Cookie.get("sw-utm-medium")||"","utm-campaign":SW.Cookie.get("sw-utm-campaign")||"","utm-content":SW.Cookie.get("sw-utm-content")||""}}),sw.user.isTeacher()&&(t=20),sw.track.event("Register Complete",sw.user.get("usertype")+"-freemium","",t),"teacher"===sw.user.get("usertype")&&window.fbq("track","CompleteRegistration"),i&&s&&SW.Logger.trackInfluitiveRegister(i,s),sw.user.isParent()&&sw.user.tutorials.save(SW.Tutorials.PARENT_APP_MIGRATION)},onNavigateRequest:function(e){sw.app.navigate(e,{trigger:!0})},hardReload:function(e){var t=e||"#classes";this.onNavigateRequest(t),location.reload()}}),SW.Array={},SW.Array.toggle=function(e,t,i){var e=i?e.slice(0):e;return index=e.indexOf(t),index>-1?e.splice(index,1):e.push(t),e},SW.Array.deepIncludes=function(e,t){return _.some(e,_.isEqual.bind(this,t))},SW.Http={},SW.Http.fetch=function(e){var t,i,s=prodigyWeb.session.authKey,n=sw.user?sw.user.get("userID"):void 0,a={"auth-key":s,token:s,userID:n};if(_.isObject(e.data)){if(i=_.merge({},a,e.data),e.stringify)try{i=JSON.stringify(i),e.contentType="application/json"}catch(e){console.log("unable to stringify data as JSON")}}else i=a;t={url:e.url,type:e.method||"GET",contentType:e.contentType||"application/x-www-form-urlencoded",dataType:e.dataType,data:i,success:e.success,error:e.error,complete:e.complete},_.isUndefined(e.cache)||(t.cache=e.cache),e._method&&(t._method=e._method),$.ajax(t)},SW.Utility={},SW.Utility.urlToJson=function(){for(var e=location.search.substr(1),t=e.split("&"),i={},s=0;s<t.length;s++){var n=t[s].split("=");i[n[0]]=n[1]}return i},SW.Utility.usingMobileNav=function(){return $(window).width()<770},SW.Utility.preloadImages=function(e){var t,i=[];for(t=0;t<e.length;t++)i[t]=new Image,i[t].src=e[t]},SW.Utility.imageExists=function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status},SW.Utility.postToUrl=function(e,t,i,s){i=i||"POST",s=s||!1;var n=document.createElement("form");n.setAttribute("method",i),n.setAttribute("action",e),s&&n.setAttribute("target",s);for(var a in t)if(t.hasOwnProperty(a)){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",a),r.setAttribute("value",t[a]),n.appendChild(r)}document.body.appendChild(n),n.submit()},SW.Utility.getUrlVars=function(){var e=decodeURIComponent(window.location.href),t={};e.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,i,s){t[i]=s});return t},SW.Utility.getUrlVar=function(e){var t=SW.Utility.getUrlVars();for(var i in t)if(i==e)return t[i];return!1},SW.Utility.removeUrlVarFromFragment=function(e,t){return e.indexOf(t)===-1?e:e.replace(new RegExp("[?&]"+t+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?&])"+t+"=[^&]*&"),"$1")},SW.Utility.removeUrlVarsFromFragment=function(e,t){var i=e;return t.forEach(function(e){i=i.replace(new RegExp("[?&]"+e+"=[^&#]*(#.*)?$"),"$1").replace(new RegExp("([?&])"+e+"=[^&]*&"),"$1")}),i},SW.Utility.pluralizer=function(e,t,i){return 1==i?e:t},SW.Utility.forceLogin=function(e,t){$.ajax({type:"POST",url:"/Includes/Server/Routers/user.php",dataType:"json",data:{method:"force-login-by-user-id",userID:e,hash:t},success:function(i){i.success&&(window.location.href="/actions/loginRedirect.php?userID="+e+"&h="+t+"&page=dashboard")}})},SW.Utility.getBaseUrl=function(){var e="http://";return location.host.indexOf("prodigygame")>=0&&(e="https://"),e+location.host},SW.Utility.getCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var n=i[s];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},SW.Utility.getDecodedCookie=function(e){var t=SW.Utility.getCookie(e);return t&&(t=SW.Utility.replaceAll(t,"+"," ")),t},SW.Utility.fullyInViewport=function(e){var t=e.offset().top,i=e.outerHeight()+t,s=$(window).scrollTop(),n=$(window).height()+s,a=s<t,r=n>i;return a&&r},SW.Utility.partiallyInViewport=function(e){var t=e.offset().top,i=e.outerHeight()+t,s=$(window).scrollTop(),n=$(window).height()+s,a=t<s&&i>s,r=t<n&&i>s,o=a||r;return o||SW.Utility.fullyInViewport(e)},SW.Utility.aboveViewportBottom=function(e,t){var i=e.offset().top+(t||0),s=$(window).scrollTop(),n=$(window).height()+s;return i<n},SW.Utility.minWidth=function(e){return!SW.Utility.maxWidth(e)},SW.Utility.maxWidth=function(e){return SW.Utility.getViewportWidth()<e},SW.Utility.getViewportWidth=function(){return SW.Utility.getViewportSize().width},SW.Utility.getViewportSize=function(){return{width:Math.max(document.documentElement.clientWidth,window.innerWidth||0),height:Math.max(document.documentElement.clientHeight,window.innerHeight||0)}},SW.Utility.isElement=function(e,t){return t="."===t.charAt(0)?t.substring(1):t,e.hasClass(t)||e.parents("."+t).length>0},SW.Utility.mouseOverlapEl=function(e,t){var i,s={left:e.pageX,top:e.pageY},n=t.position();return i=s.left>n.left&&s.left<n.left+t.outerWidth(),i=!!i&&(s.top>n.top&&s.top<n.top+t.outerHeight())},SW.Utility.moveElToMouse=function(e,t,i){var s={left:t.pageX,top:t.pageY};return this.moveElToPos(e,s,i)},SW.Utility.moveElToPos=function(e,t,i){var s,n,i=i||{},a={},r=$(window).scrollTop(),o=e.outerWidth(),l=e.outerHeight(),d={x:i.alignX||"center",y:i.alignY||"center"},c={x:i.offsetX||0,y:i.offsetY||0};return"center"===d.x?c.x-=o/2:"right"===d.x&&(c.x+=o),"center"===d.y?c.y-=l/2:"top"===d.y&&(c.y-=l),a.left=t.left+c.x,a.top=t.top+c.y,i.stayInViewport&&(s=$(window).width(),n=$(window).height()+r,a.left-=Math.max(a.left+o-s,0),a.left=Math.max(a.left,0),a.top-=Math.max(a.top+l-n,0),a.top=Math.max(a.top,r)),a.left+="px",a.top+="px",e.css(a)},SW.Utility.round=function(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)},SW.Utility.roundToNearest=function(e,t){return t*Math.round(e/t)},SW.Utility.numberCommaFormat=function(e){for(var t=e.toString(),i=t.indexOf("."),s=i>-1?i:t.length;s>3;)s-=3,t=[t.slice(0,s),",",t.slice(s)].join("");return t},SW.Utility.toTitleCase=function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},SW.Utility.replaceAll=function(e,t,i){return e.split(t).join(i)},SW.Utility.firstName=function(e,t){var i=_.upperFirst(e.trim(" ").split(" ")[0]);return t&&t.possessive&&(i+="s"===_.last(i).toLowerCase()?"'":"'s"),i},SW.Utility.parseName=function(e){var t=e.trim().split(" "),i=t[0],s=t.length>1?t.slice(1).join(" ").trim():null;return{firstName:i,lastName:s}},SW.Utility.uniqueBy=function(e,t){var i=[];return e.forEach(function(e){var s=_.findIndex(i,function(i){return i[t]===e[t]})>-1;s||i.push(e)}),i},SW.Utility.partitionBy=function(e,t,i){var s,n,a=[];for(i=i||2,t=t||function(){return 1},s=0;s<i;s++)a.push({value:0,items:[]});return n=_.sortBy(e,function(e){return-t(e)}),n.forEach(function(e){var i=_.sortBy(a,function(e){return e.value});i[0].value+=t(e),i[0].items.push(e)}),a.map(function(e){return e.items})},SW.Utility.dateMonths=[{full:"January",short:"Jan"},{full:"February",short:"Feb"},{full:"March",short:"Mar"},{full:"April",short:"Apr"},{full:"May",short:"May"},{full:"June",short:"Jun"},{full:"July",short:"Jul"},{full:"August",short:"Aug"},{full:"September",short:"Sep"},{full:"October",short:"Oct"},{full:"November",short:"Nov"},{full:"December",short:"Dec"}],SW.Utility.dateDays=[{full:"Sunday",short:"Sun"},{full:"Monday",short:"Mon"},{full:"Tuesday",short:"Tue"},{full:"Wednesday",short:"Wed"},{full:"Thursday",short:"Thu"},{full:"Friday",short:"Fri"},{full:"Saturday",short:"Sat"}],SW.Utility.millisecondsPerDay=864e5,SW.Utility.millisecondsPerWeek=7*SW.Utility.millisecondsPerDay,SW.Utility.isSameDate=function(e,t){isSameDate=!1;try{isSameDate=e.toLocaleDateString()===t.toLocaleDateString()}catch(e){console.log("SW.Utility.isSameDate method requires two Date objects.")}return isSameDate},SW.Utility.datesInRange=function(e,t){for(var i=[],s=new Date(e);s<=t;)i.push(new Date(s)),s=new Date(s.setDate(s.getDate()+1));return i},SW.Utility.groupDatesByWeek=function(e){var t=[],i=[];return e.forEach(function(s,n){i.push(s),6!==s.getDay()&&n!==e.length-1||(t.push(i.slice(0)),i=[])}),t},SW.Utility.firstDateInWeek=function(e,t){var i=new Date(e),t=t||0;return newDate=new Date(i.setDate(i.getDate()-i.getDay()+t))},SW.Utility.lastDateInWeek=function(e,t){var i=new Date(e),t=t||0;return newDate=new Date(i.setDate(i.getDate()+(6+t-i.getDay())))},SW.Utility.dateMonthName=function(e,t){var t=t||"full";return SW.Utility.dateMonths[e.getMonth()][t]},SW.Utility.dateDayName=function(e,t){var t=t||"full";return SW.Utility.dateDays[e.getDay()][t]},SW.Utility.getDateString=function(e,t){return t=t||"-",[e.getFullYear(),SW.Utility.dateMonthString(e),SW.Utility.dateDayString(e)].join(t)},SW.Utility.dateDayString=function(e){var t=e instanceof Date?e.getDate().toString():e+"";return 1===t.length&&(t="0"+t),t},SW.Utility.getMDYDateString=function(e){return SW.Utility.dateMonthName(e,"short")+" "+SW.Utility.dateDayString(e)+", "+e.getFullYear()},SW.Utility.dateMonthString=function(e){var t=(e.getMonth()+1).toString();return 1===t.length&&(t="0"+t),t},SW.Utility.setTimeInDayToZero=function(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},SW.Utility.setTimeInDayToMidnight=function(e){return e.setHours(23),e.setMinutes(59),e},SW.Utility.getUSDateString=function(e){var t=e.getMonth()+1,i=e.getDate(),s=e.getFullYear();return t+"/"+i+"/"+s},SW.Utility.getLocalDateFromUTCDate=function(e){var t;return t=_.isString(e)?new Date(e):new Date(e.getTime()-60*e.getTimezoneOffset()*1e3)},SW.Cookie={},SW.Cookie.get=function(e){var t,i,s="sw."+e+"=",n=document.cookie.split(";");for(i=0;i<n.length;i+=1){for(t=n[i];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(s))return t.substring(s.length,t.length)}return null},SW.Cookie.set=function(e,t,i){i=i||7;var s,n=new Date,a=24*i;n=new Date(n.getTime()+60*a*60*1e3),s=escape(t)+"; expires="+n.toUTCString(),document.cookie="sw."+e+"="+s},SW.Cookie.expire=function(e){SW.Cookie.set(e,"",-2)},SW.Cookie.sessionTokenMatches=function(e){var t=SW.Cookie.get("sessionToken");return e===t},SW.Cookie.setSessionToken=function(e){var t=1/24;SW.Cookie.set("sessionToken",e,t)},SW.Validate={minPasswordLength:4,minNameLength:2,emailRegex:{advanced:/^[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9\u007F-\uffff!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z]{2,}$/i,basic:/\S+@\S+.\S+/}},SW.Validate.getTextLength=function(e){return _.isString(e)?e.trim().length:0},SW.Validate.isTextLengthGreater=function(e,t){var i=SW.Validate.getTextLength(e);return i>t},SW.Validate.text=function(e){return SW.Validate.isTextLengthGreater(e,0)},SW.Validate.name=function(e){return SW.Validate.isTextLengthGreater(e,SW.Validate.minNameLength-1)},SW.Validate.password=function(e){return SW.Validate.isTextLengthGreater(e,SW.Validate.minPasswordLength-1)},SW.Validate.email=function(e,t){var i=t===!1?SW.Validate.emailRegex.basic:SW.Validate.emailRegex.advanced;return i.test(e)},SW.Validate.isEqual=function(e,t){return e===t},SW.Education={},SW.Education.curricula={},SW.Education.curricula.Ontario=[{name:"Grade 1",curriculumID:1,grade:1,country:"Canada",sub:"Ontario"},{name:"Grade 2",curriculumID:2,grade:2,country:"Canada",sub:"Ontario"},{name:"Grade 3",curriculumID:3,grade:3,country:"Canada",sub:"Ontario"},{name:"Grade 4",curriculumID:4,grade:4,country:"Canada",sub:"Ontario"},{name:"Grade 5",curriculumID:5,grade:5,country:"Canada",sub:"Ontario"},{name:"Grade 6",curriculumID:6,grade:6,country:"Canada",sub:"Ontario"},{name:"Grade 7",curriculumID:16,grade:7,country:"Canada",sub:"Ontario"},{name:"Grade 8",curriculumID:17,grade:8,country:"Canada",sub:"Ontario"}],SW.Education.curricula["Common Core"]=[{name:"1st Grade",curriculumID:8,grade:1,country:"United States",sub:"Common Core"},{name:"2nd Grade",curriculumID:9,grade:2,country:"United States",sub:"Common Core"},{name:"3rd Grade",curriculumID:10,grade:3,country:"United States",sub:"Common Core"},{name:"4th Grade",curriculumID:11,grade:4,country:"United States",sub:"Common Core"},{name:"5th Grade",curriculumID:12,grade:5,country:"United States",sub:"Common Core"},{name:"6th Grade",curriculumID:13,grade:6,country:"United States",sub:"Common Core"},{name:"7th Grade",curriculumID:35,grade:7,country:"United States",sub:"Common Core"},{name:"8th Grade",curriculumID:37,grade:8,country:"United States",sub:"Common Core"}],SW.Education.curricula.MAFS=[{name:"1st Grade",curriculumID:19,grade:1,country:"United States",sub:"Florida"},{name:"2nd Grade",curriculumID:20,grade:2,country:"United States",sub:"Florida"},{name:"3rd Grade",curriculumID:21,grade:3,country:"United States",sub:"Florida"},{name:"4th Grade",curriculumID:22,grade:4,country:"United States",sub:"Florida"},{name:"5th Grade",curriculumID:23,grade:5,country:"United States",sub:"Florida"},{name:"6th Grade",curriculumID:24,grade:6,country:"United States",sub:"Florida"},{name:"7th Grade",curriculumID:36,grade:7,country:"United States",sub:"Florida"},{name:"8th Grade",curriculumID:38,grade:8,country:"United States",sub:"Florida"}],SW.Education.curricula.TEKS=[{name:"1st Grade",curriculumID:25,grade:1,country:"United States",sub:"Texas"},{name:"2nd Grade",curriculumID:26,grade:2,country:"United States",sub:"Texas"},{name:"3rd Grade",curriculumID:27,grade:3,country:"United States",sub:"Texas"},{name:"4th Grade",curriculumID:28,grade:4,country:"United States",sub:"Texas"},{name:"5th Grade",curriculumID:29,grade:5,country:"United States",sub:"Texas"},{name:"6th Grade",curriculumID:30,grade:6,country:"United States",sub:"Texas"},{name:"7th Grade",curriculumID:40,grade:7,country:"United States",sub:"Texas"},{name:"8th Grade",curriculumID:41,grade:8,country:"United States",sub:"Texas"}],SW.Education.curricula.Florida=SW.Education.curricula.MAFS,SW.Education.curricula.Texas=SW.Education.curricula.TEKS,SW.Education.getCurriculumCodeFromTreeID=function(e){switch(e){case 1:return"Ontario";case 2:return"Common Core";case 3:return"MAFS";case 4:return"TEKS";default:return"Common Core"}},SW.Education.getLocationName=function(e){switch(e){case 1:return"Ontario";case 2:return"Common Core";case 3:return"Florida";case 4:return"Texas";default:return"Common Core"}},SW.Education.curriculumIDs={1:{name:"Ontario Grade 1",grade:1,country:"Canada",sub:"Ontario",locationID:1},2:{name:"Ontario Grade 2",grade:2,country:"Canada",sub:"Ontario",locationID:1},3:{name:"Ontario Grade 3",grade:3,country:"Canada",sub:"Ontario",locationID:1},4:{name:"Ontario Grade 4",grade:4,country:"Canada",sub:"Ontario",locationID:1},5:{name:"Ontario Grade 5",grade:5,country:"Canada",sub:"Ontario",locationID:1},6:{name:"Ontario Grade 6",grade:6,country:"Canada",sub:"Ontario",locationID:1},8:{name:"Common Core 1st Grade",grade:1,country:"United States",sub:"Common Core",locationID:2},9:{name:"Common Core 2nd Grade",grade:2,country:"United States",sub:"Common Core",locationID:2},10:{name:"Common Core 3rd Grade",grade:3,country:"United States",sub:"Common Core",locationID:2},11:{name:"Common Core 4th Grade",grade:4,country:"United States",sub:"Common Core",locationID:2},12:{name:"Common Core 5th Grade",grade:5,country:"United States",sub:"Common Core",locationID:2},13:{name:"Common Core 6th Grade",grade:6,country:"United States",sub:"Common Core",locationID:2},16:{name:"Ontario Grade 7",grade:7,country:"Canada",sub:"Ontario",locationID:1},17:{name:"Ontario Grade 8",grade:8,country:"Canada",sub:"Ontario",locationID:1},19:{name:"MAFS 1st Grade",grade:1,country:"United States",sub:"Florida",locationID:3},20:{name:"MAFS 2nd Grade",grade:2,country:"United States",sub:"Florida",locationID:3},21:{name:"MAFS 3rd Grade",grade:3,country:"United States",sub:"Florida",locationID:3},22:{name:"MAFS 4th Grade",grade:4,country:"United States",sub:"Florida",locationID:3},23:{name:"MAFS 5th Grade",grade:5,country:"United States",sub:"Florida",locationID:3},24:{name:"MAFS 6th Grade",grade:6,country:"United States",sub:"Florida",locationID:3},25:{name:"TEKS 1st Grade",grade:1,country:"United States",sub:"Texas",locationID:4},26:{name:"TEKS 2nd Grade",grade:2,country:"United States",sub:"Texas",locationID:4},27:{name:"TEKS 3rd Grade",grade:3,country:"United States",sub:"Texas",locationID:4},28:{name:"TEKS 4th Grade",grade:4,country:"United States",sub:"Texas",locationID:4},29:{name:"TEKS 5th Grade",grade:5,country:"United States",sub:"Texas",locationID:4},30:{name:"TEKS 6th Grade",grade:6,country:"United States",sub:"Texas",locationID:4},35:{name:"Common Core 7th Grade",grade:7,country:"United States",sub:"Common Core",locationID:2},36:{name:"MAFS 7th Grade",grade:7,country:"United States",sub:"Florida",locationID:3},37:{name:"Common Core 8th Grade",grade:8,country:"United States",sub:"Common Core",locationID:2},38:{name:"MAFS 8th Grade",grade:8,country:"United States",sub:"Florida",locationID:3},40:{name:"TEKS 7th Grade",grade:7,country:"United States",sub:"Texas",locationID:4},41:{name:"TEKS 8th Grade",grade:8,country:"United States",sub:"Texas",locationID:4}},SW.Education.getGradeFromCurriculumID=function(e){},SW.Education.getCurriculumIDFromGradeAndTreeID=function(e,t){},SW.Education.skills={3:{ID:3,qID:322,name:"Add 1-digit numbers up to 18",isNew:0},4:{ID:4,qID:232,name:"Sums to 18, no regrouping",isNew:0},6:{ID:6,qID:367,name:"Add two-digit and one-digit numbers, no regrouping",isNew:0},7:{ID:7,qID:548,name:"Add two-digit and one-digit numbers, regrouping",isNew:0},25:{ID:25,qID:1182,name:"Divide by 1 and 2",isNew:0},26:{ID:26,qID:1206,name:"Divide by 3 and 4",isNew:0},27:{ID:27,qID:1230,name:"Divide by 5 and 6",isNew:0},28:{ID:28,qID:1254,name:"Divide by 7 and 8",isNew:0},29:{ID:29,qID:1278,name:"Divide by 9",isNew:0},31:{ID:31,qID:901,name:"Multiply by 0",isNew:0},32:{ID:32,qID:922,name:"Multiply by 1",isNew:0},33:{ID:33,qID:943,name:"Multiply by 2",isNew:0},34:{ID:34,qID:964,name:"Multiply by 3",isNew:0},35:{ID:35,qID:985,name:"Multiply by 4",isNew:0},36:{ID:36,qID:1006,name:"Multiply by 5",isNew:0},37:{ID:37,qID:1027,name:"Multiply by 6",isNew:0},38:{ID:38,qID:1048,name:"Multiply by 7",isNew:0},39:{ID:39,qID:1069,name:"Multiply by 8",isNew:0},40:{ID:40,qID:1090,name:"Multiply by 9",isNew:0},46:{ID:46,qID:10035,name:"Equivalent fractions",isNew:0},49:{ID:49,qID:1465,name:"Subtract one-digit from one-digit",isNew:0},50:{ID:50,qID:1376,name:"Add one-digit with a sum up to 9",isNew:0},51:{ID:51,qID:5162,name:"Rounding to the nearest tenth",isNew:0},52:{ID:52,qID:1560,name:"Subtract one-digit from two-digit, no regrouping",isNew:0},53:{ID:53,qID:1606,name:"Subtract one-digit from two-digit, regrouping",isNew:0},59:{ID:59,qID:1892,name:"Nearest ten of two-digit",isNew:0},60:{ID:60,qID:1942,name:"Composing two-digit numbers, no regrouping",isNew:0},62:{ID:62,qID:2042,name:"Multiplying decimals by 10,100,1000,10000",isNew:0},63:{ID:63,qID:2092,name:"Dividing decimals by 10 and 100",isNew:0},64:{ID:64,qID:2142,name:"Adding decimals to hundredths",isNew:0},65:{ID:65,qID:2192,name:"Subtracting decimals to hundredths",isNew:0},68:{ID:68,qID:2242,name:"Rounding 4-digit numbers to hundreds",isNew:0},72:{ID:72,qID:4024,name:"Counting forward by 10s and 25s",isNew:0},73:{ID:73,qID:2586,name:"Counting backward by 1s from 50",isNew:0},74:{ID:74,qID:3080,name:"Counting backward by 10s from 100",isNew:0},75:{ID:75,qID:2668,name:"Growing and shrinking patterns",isNew:0},76:{ID:76,qID:2718,name:"Extending the pattern",isNew:0},77:{ID:77,qID:2774,name:"Adding and subtracting patterns",isNew:0},82:{ID:82,qID:3030,name:"Equality expression for addition to 18",isNew:0},83:{ID:83,qID:3114,name:"Equality expression for subtraction to 18",isNew:0},84:{ID:84,qID:9985,name:"Odd/even numbers",isNew:0},86:{ID:86,qID:3214,name:"True/false addition equality expressions",isNew:0},87:{ID:87,qID:3264,name:"True/false subtraction equality expressions",isNew:0},89:{ID:89,qID:3314,name:"Comparing Numbers 0-50 (least)",isNew:0},90:{ID:90,qID:3364,name:"Comparing Numbers 0-50 (greatest)",isNew:0},91:{ID:91,qID:3414,name:"Order whole numbers to 50 (between)",isNew:0},92:{ID:92,qID:10606,name:"Writing numbers in words to 10",isNew:0},93:{ID:93,qID:3474,name:"Writing words in numbers to 10",isNew:0},94:{ID:94,qID:3484,name:"Counting forward by 1s to 100",isNew:0},95:{ID:95,qID:3534,name:"Counting forward by 2s to 100",isNew:0},96:{ID:96,qID:3584,name:"Counting forward by 5s to 100",isNew:0},97:{ID:97,qID:3634,name:"Counting forward by 10s to 100",isNew:0},98:{ID:98,qID:3684,name:"Count backward by 1s, 2s, and 5s from 20",isNew:0},99:{ID:99,qID:3723,name:"Addition of single-digit whole numbers",isNew:0},101:{ID:101,qID:3824,name:"Extend numeric repeating patterns",isNew:0},103:{ID:103,qID:4341,name:"Counting forward by 1s, 2s, 5s, and 10s to 100",isNew:0},106:{ID:106,qID:4046,name:"Fractions to equivalent decimal forms",isNew:0},107:{ID:107,qID:26995,name:"Composing numbers with addition up to 20",isNew:0},108:{ID:108,qID:4174,name:"Composing numbers with subtraction up to 20",isNew:0},109:{ID:109,qID:4234,name:"Ordinal numbers up to 10th",isNew:0},110:{ID:110,qID:4274,name:"Composing two-digit numbers, regrouping",isNew:0},111:{ID:111,qID:4324,name:"Anchors of 5 and 10",isNew:0},113:{ID:113,qID:4461,name:"Determining missing number in an addition equation",isNew:0},114:{ID:114,qID:4511,name:"Determining missing number in a subtraction equation",isNew:0},115:{ID:115,qID:4561,name:"Determining missing number in a multiplication equation",isNew:0},116:{ID:116,qID:4611,name:"Determining missing number in a division equation",isNew:0},117:{ID:117,qID:4711,name:"Next number in a sequence",isNew:0},119:{ID:119,qID:4912,name:"Read and write money amounts to $1000",isNew:0},120:{ID:120,qID:4962,name:"Adding decimals to tenths",isNew:0},121:{ID:121,qID:5012,name:"Subtracting decimals to tenths",isNew:0},122:{ID:122,qID:5062,name:"Converting between whole number place values ",isNew:0},123:{ID:123,qID:5112,name:"Converting between decimal place values",isNew:0},124:{ID:124,qID:5212,name:"Conversion of lengths",isNew:0},125:{ID:125,qID:7037,name:"Multiplicative relationships with whole number rates",isNew:0},126:{ID:126,qID:5262,
name:"Compare and order fractions",isNew:0},127:{ID:127,qID:5312,name:"Converting from expanded form (hundreds, tens, and ones)",isNew:0},128:{ID:128,qID:5337,name:"Converting from expanded form (thousands, hundreds, tens, and ones)",isNew:0},129:{ID:129,qID:5362,name:"Converting from expanded form (thousands, hundreds, tens, ones, and tenths)",isNew:0},130:{ID:130,qID:5387,name:"Greatest number possible",isNew:0},135:{ID:135,qID:5633,name:"Months of the year",isNew:0},136:{ID:136,qID:5657,name:"Missing number addition to 10",isNew:0},137:{ID:137,qID:5702,name:"Missing number subtraction to 10 (first value missing)",isNew:0},138:{ID:138,qID:5752,name:"Missing number subtraction to 10 (second value missing)",isNew:0},139:{ID:139,qID:5802,name:"Reading money amounts up to $100",isNew:0},140:{ID:140,qID:10358,name:"Missing symbol addition and subtraction",isNew:0},143:{ID:143,qID:6e3,name:"Greatest number to 1000",isNew:0},144:{ID:144,qID:6050,name:"Least number to 1000",isNew:0},146:{ID:146,qID:6150,name:"Round two-digit numbers to the nearest ten",isNew:0},148:{ID:148,qID:6300,name:"Ordering numbers 0-50 (least to greatest)",isNew:0},149:{ID:149,qID:6350,name:"Ordering numbers 0-50 (greatest to least)",isNew:0},152:{ID:152,qID:6500,name:"12 hour to 24 hour clock",isNew:0},153:{ID:153,qID:6550,name:"24 hour to 12 hour clock",isNew:0},154:{ID:154,qID:6600,name:"Composing three-digit numbers",isNew:0},158:{ID:158,qID:6800,name:"Counting forward by 10s and 100s to 1000",isNew:0},160:{ID:160,qID:10085,name:"Comparing improper fractions",isNew:0},161:{ID:161,qID:10135,name:"Elapsed time",isNew:0},162:{ID:162,qID:6987,name:"Divide 3-digit by 1-digit",isNew:0},163:{ID:163,qID:7087,name:"Multiply 2-digit by 2-digit",isNew:0},164:{ID:164,qID:7137,name:"Add two-digit numbers, no regrouping",isNew:0},165:{ID:165,qID:7187,name:"Subtract two-digit numbers, no regrouping",isNew:0},166:{ID:166,qID:7237,name:"Subtract two-digit numbers, regrouping",isNew:0},174:{ID:174,qID:7535,name:"Extend repeating, growing, and shrinking patterns",isNew:0},175:{ID:175,qID:7585,name:"Inverse relationship between addition and subtraction",isNew:0},176:{ID:176,qID:7635,name:"Counting backward by 2s, 5s, and 10s from 100",isNew:0},177:{ID:177,qID:7685,name:"Counting backward by 100s from 1000",isNew:0},178:{ID:178,qID:7735,name:"Missing number in addition and subtraction equations",isNew:0},179:{ID:179,qID:7835,name:"Multiplying 2-digit by 1-digit",isNew:0},180:{ID:180,qID:7885,name:"Multiplying and dividing whole numbers by 10, 100, and 1000",isNew:0},181:{ID:181,qID:7935,name:"Term and term number",isNew:0},182:{ID:182,qID:7985,name:"Add and subtract money amounts up to $100",isNew:0},183:{ID:183,qID:8035,name:"Inverse relationship between multiplication and division",isNew:0},184:{ID:184,qID:8085,name:"Missing number in multiplication equations",isNew:0},185:{ID:185,qID:8135,name:"Place value",isNew:0},186:{ID:186,qID:8185,name:"Value of a digit",isNew:0},187:{ID:187,qID:8235,name:"Relationships between coins and bills up to $10",isNew:0},192:{ID:192,qID:8475,name:"Comparing numbers 0.01-100000 (greatest)",isNew:0},193:{ID:193,qID:8525,name:"Comparing numbers 0.01-100000 (least)",isNew:0},194:{ID:194,qID:8575,name:"Ordering decimals (greatest to least)",isNew:0},195:{ID:195,qID:8625,name:"Ordering decimals (least to greatest)",isNew:0},196:{ID:196,qID:8675,name:"Identify 2D shapes",isNew:0},197:{ID:197,qID:8695,name:"Classify 2D shapes",isNew:0},198:{ID:198,qID:8719,name:"Compare sides and vertices of 2D shapes",isNew:0},200:{ID:200,qID:8817,name:"Relative locations (left and right)",isNew:0},201:{ID:201,qID:8845,name:"Relative locations (above and below)",isNew:0},205:{ID:205,qID:9003,name:"Relationships with simple whole number rates",isNew:0},206:{ID:206,qID:9053,name:"Understanding of median",isNew:0},207:{ID:207,qID:9243,name:"Dividing 2-digit by 1-digit",isNew:0},208:{ID:208,qID:9293,name:"Add and subtract 4 digit numbers",isNew:0},210:{ID:210,qID:9393,name:"Identify quadrilaterals",isNew:0},211:{ID:211,qID:9443,name:"Names of angles",isNew:0},212:{ID:212,qID:9493,name:"Classify angles (match angle to name)",isNew:0},213:{ID:213,qID:9543,name:"Estimate length, height, and distance (cm, m, and km)",isNew:0},214:{ID:214,qID:9568,name:"Compare objects with measurable attributes (longer or shorter; bigger or smaller)",isNew:0},215:{ID:215,qID:9652,name:"Read primary data",isNew:0},216:{ID:216,qID:9617,name:"Decades and centuries",isNew:0},218:{ID:218,qID:9732,name:"Elapsed time",isNew:0},219:{ID:219,qID:9807,name:"Fractions to equivalent decimal forms",isNew:0},220:{ID:220,qID:9733,name:"Order objects based on linear measurement (least to greatest)",isNew:0},221:{ID:221,qID:9837,name:"Order objects based on linear measurements (greatest to least)",isNew:0},222:{ID:222,qID:9887,name:"Understanding of mode",isNew:0},223:{ID:223,qID:9937,name:"Measures of central tendency",isNew:0},224:{ID:224,qID:10185,name:"Number of sides",isNew:0},225:{ID:225,qID:10225,name:"Sorting 2D shapes",isNew:0},226:{ID:226,qID:10275,name:"Similar 2D shapes",isNew:0},227:{ID:227,qID:10325,name:"Addition with images",isNew:0},228:{ID:228,qID:10406,name:"Add three single-digit whole numbers",isNew:0},229:{ID:229,qID:10456,name:"Greater, less, or equal to (to 50)",isNew:0},230:{ID:230,qID:10506,name:"Composing numbers with mixed operations up to 20",isNew:0},231:{ID:231,qID:10556,name:"Counting with images",isNew:0},232:{ID:232,qID:10586,name:"Subtraction with images",isNew:0},233:{ID:233,qID:10646,name:"Compare sides and vertices of 2D shapes",isNew:0},237:{ID:237,qID:10839,name:"Greater, less, or equal to (0 to 100)",isNew:0},238:{ID:238,qID:10889,name:"Composing with base ten blocks, no regrouping",isNew:0},239:{ID:239,qID:10939,name:"Composing with base ten blocks, regrouping",isNew:0},240:{ID:240,qID:10989,name:"Compare sides, vertices, interior angles, and right angles of 2D shapes",isNew:0},241:{ID:241,qID:11037,name:"Add two-digit numbers, regrouping",isNew:0},242:{ID:242,qID:11087,name:"Add three-digit numbers, no regrouping",isNew:0},243:{ID:243,qID:11137,name:"Add three-digit numbers, regrouping",isNew:0},246:{ID:246,qID:11287,name:"Add three-digit and two-digit numbers, no regrouping",isNew:0},247:{ID:247,qID:11337,name:"Add three-digit and two-digit numbers, regrouping",isNew:0},248:{ID:248,qID:11387,name:"Subtract three-digit numbers, no regrouping",isNew:0},249:{ID:249,qID:11437,name:"Subtract three-digit numbers, regrouping",isNew:0},250:{ID:250,qID:11487,name:"Subtract two-digit from three-digit, no regrouping",isNew:0},251:{ID:251,qID:11587,name:"Subtract two-digit from three-digit, regrouping",isNew:0},252:{ID:252,qID:11637,name:"Identify quadrilaterals (matching name to shape)",isNew:0},253:{ID:253,qID:11687,name:"Sorting quadrilaterals",isNew:0},254:{ID:254,qID:11737,name:"Similar quadrilaterals",isNew:0},255:{ID:255,qID:11787,name:"Symmetry of quadrilaterals",isNew:0},256:{ID:256,qID:11837,name:"Properties of quadrilaterals, with images",isNew:0},257:{ID:257,qID:11882,name:"Properties of quadrilaterals, without images",isNew:0},258:{ID:258,qID:11927,name:"Add 4, 5, and 6 digit numbers",isNew:0},259:{ID:259,qID:12027,name:"Missing value in addition sentence",isNew:0},260:{ID:260,qID:12077,name:"Missing value in addition sentence (2nd value missing)",isNew:0},261:{ID:261,qID:12127,name:"Missing digit in addition sentence",isNew:0},263:{ID:263,qID:12227,name:"Subtract 4, 5, and 6 digit numbers",isNew:0},264:{ID:264,qID:12277,name:"Missing value in subtraction sentence",isNew:0},265:{ID:265,qID:12327,name:"Missing value in subtraction sentence (2nd value missing)",isNew:0},266:{ID:266,qID:12377,name:"Missing digit in subtraction sentence",isNew:0},268:{ID:268,qID:12428,name:"Next three numbers in a pattern",isNew:0},269:{ID:269,qID:12478,name:"Missing number in a pattern",isNew:0},270:{ID:270,qID:12528,name:"Missing three numbers in a pattern",isNew:0},271:{ID:271,qID:12578,name:"Total number in pictograph",isNew:0},272:{ID:272,qID:12628,name:"Next three shapes in a pattern",isNew:0},273:{ID:273,qID:12678,name:"Missing shape in a pattern",isNew:0},277:{ID:277,qID:12878,name:"Conversion word problems (months, weeks, days)",isNew:0},278:{ID:278,qID:12928,name:"Money word problems",isNew:0},279:{ID:279,qID:12978,name:"Pattern rules",isNew:0},281:{ID:281,qID:13078,name:"Multiplication, addition, and subtraction word problems",isNew:0},282:{ID:282,qID:13128,name:"Multiplication and division word problems",isNew:0},283:{ID:283,qID:13178,name:"Conversion word problems (hours, minutes, seconds)",isNew:0},284:{ID:284,qID:13224,name:"Similar and congruent 2D shapes",isNew:0},285:{ID:285,qID:13274,name:"Prime factors of a composite number",isNew:0},286:{ID:286,qID:13324,name:"Multiply 4-digit by 2-digit",isNew:0},287:{ID:287,qID:13374,name:"Prime and composite numbers",isNew:0},288:{ID:288,qID:13424,name:"Add decimals to thousandths",isNew:0},289:{ID:289,qID:13474,name:"Subtract decimals to thousandths",isNew:0},290:{ID:290,qID:13524,name:"Multiply whole numbers by 0.1, 0.01, and 0.001",isNew:0},291:{ID:291,qID:13574,name:"Divide 4-digit by 2-digit",isNew:0},292:{ID:292,qID:13624,name:"Ordering decimals (G-L)",isNew:0},303:{ID:303,qID:13828,name:"Multiply and divide decimals by 10, 100, 1000, and 10000",isNew:0},305:{ID:305,qID:13928,name:"Multiply decimal numbers to tenths",isNew:0},306:{ID:306,qID:13978,name:"Dividing decimal numbers to tenths",isNew:0},307:{ID:307,qID:14028,name:"Order decimals (L-G)",isNew:0},308:{ID:308,qID:14078,name:"Place value in whole numbers",isNew:0},309:{ID:309,qID:14128,name:"Place value in decimal numbers",isNew:0},310:{ID:310,qID:14178,name:"Add numbers to 1 000 000",isNew:0},311:{ID:311,qID:14228,name:"Subtract numbers up to 1 000 000",isNew:0},312:{ID:312,qID:14278,name:"Estimate sums and differences of decimals to thousandths",isNew:0},313:{ID:313,qID:14328,name:"Estimate sums and differences of whole numbers",isNew:0},314:{ID:314,qID:14378,name:"Addition properties",isNew:0},315:{ID:315,qID:14428,name:"Multiplication properties",isNew:0},316:{ID:316,qID:14478,name:"Compare fractions with like and unlike denominators",isNew:0},318:{ID:318,qID:14578,name:"Estimate products",isNew:0},319:{ID:319,qID:14628,name:"Estimate quotients",isNew:0},320:{ID:320,qID:14678,name:"Compare fractions and decimals",isNew:0},321:{ID:321,qID:14728,name:"Multiply numbers ending in zero",isNew:0},322:{ID:322,qID:14778,name:"Order decimals and fractions (greatest to least)",isNew:0},323:{ID:323,qID:14828,name:"Order decimals and fractions (least to greatest)",isNew:0},324:{ID:324,qID:14878,name:"Unit rates",isNew:0},325:{ID:325,qID:14928,name:"Lines of symmetry of polygons",isNew:0},326:{ID:326,qID:14978,name:"Classify angles (match name to angle)",isNew:0},327:{ID:327,qID:15028,name:"Convert metric units",isNew:0},328:{ID:328,qID:15078,name:"Describe pattern rules",isNew:0},329:{ID:329,qID:15118,name:"Mean, median, mode, and range",isNew:0},330:{ID:330,qID:15168,name:"Missing value in measures of central tendency",isNew:0},331:{ID:331,qID:15218,name:"Variable expressions with whole numbers",isNew:0},332:{ID:332,qID:15268,name:"Variable expressions with decimal numbers",isNew:0},333:{ID:333,qID:15318,name:"Solving an equation with one variable",isNew:0},334:{ID:334,qID:15368,name:"Relative coordinates in the first quadrant",isNew:0},335:{ID:335,qID:15418,name:"Extend patterns of rotations",isNew:0},336:{ID:336,qID:15468,name:"Writing decimals in words",isNew:0},337:{ID:337,qID:15518,name:"Writing decimals in numeric form",isNew:0},338:{ID:338,qID:15568,name:"Calculating the mean",isNew:0},339:{ID:339,qID:15618,name:"Solving equations with 2 variables",isNew:0},340:{ID:340,qID:15666,name:"Convert between decimals and percents",isNew:0},341:{ID:341,qID:15716,name:"Convert between fractions and decimals",isNew:0},342:{ID:342,qID:15766,name:"Convert between fractions and percents",isNew:0},343:{ID:343,qID:15816,name:"Convert between decimals, percents, and fractions",isNew:0},344:{ID:344,qID:15866,name:"Determine missing coins",isNew:0},345:{ID:345,qID:15915,name:"Identify coin value",isNew:0},346:{ID:346,qID:15965,name:"Telling time",isNew:0},347:{ID:347,qID:16015,name:"Reading thermometers",isNew:0},348:{ID:348,qID:16065,name:"Numbers in base ten blocks",isNew:0},349:{ID:349,qID:16115,name:"Base ten blocks in numbers",isNew:0},350:{ID:350,qID:16165,name:"Adding base ten blocks",isNew:0},351:{ID:351,qID:16215,name:"Number of faces, edges, and vertices",isNew:0},352:{ID:352,qID:16263,name:"Greatest probability with spinners",isNew:0},353:{ID:353,qID:16331,name:"Ordering fractions with unlike denominators (greatest to least)",isNew:0},354:{ID:354,qID:16381,name:"Ordering fractions with unlike denominators (least to greatest)",isNew:0},355:{ID:355,qID:16431,name:"Probability with dice",isNew:0},356:{ID:356,qID:16481,name:"Probability of a selection",isNew:0},357:{ID:357,qID:16531,name:"Probability of not selecting",isNew:0},358:{ID:358,qID:16581,name:"Order of operations",isNew:0},359:{ID:359,qID:16626,name:"Order of operations (answer)",isNew:0},360:{ID:360,qID:16671,name:"Comparing fractions",isNew:0},361:{ID:361,qID:16721,name:"Term number and term value",isNew:0},362:{ID:362,qID:16761,name:"First pattern to reach a value",isNew:0},363:{ID:363,qID:16861,name:"Unit rate with money",isNew:0},364:{ID:364,qID:16811,name:"Money word problems",isNew:0},365:{ID:365,qID:17924,name:"Ratio word problems",isNew:0},366:{ID:366,qID:16955,name:"Volume of 3D shapes without images",isNew:0},367:{ID:367,qID:17005,name:"Area of 2D shapes",isNew:0},368:{ID:368,qID:17055,name:"Estimating angle size",isNew:0},369:{ID:369,qID:17105,name:"Area of quadrilaterals",isNew:0},372:{ID:372,qID:17203,name:"Area of 2D shapes with images",isNew:0},373:{ID:373,qID:17253,name:"Expression to calculate area",isNew:0},374:{ID:374,qID:17303,name:"Compare area of shapes",isNew:0},375:{ID:375,qID:17353,name:"Area and perimeter of 2D shapes",isNew:0},376:{ID:376,qID:17403,name:"Area of parallelograms",isNew:0},377:{ID:377,qID:17453,name:"Spinner probabilities",isNew:0},378:{ID:378,qID:17503,name:"Spinner labels",isNew:0},379:{ID:379,qID:17553,name:"Spinner probabilities (multiple spins)",isNew:0},380:{ID:380,qID:17603,name:"Perimeter of 2D shapes",isNew:0},381:{ID:381,qID:17653,name:"Compare perimeters",isNew:0},382:{ID:382,qID:17703,name:"Compare faces, edges, and vertices",isNew:0},383:{ID:383,qID:17751,name:"2D faces of a 3D shape",isNew:0},384:{ID:384,qID:17786,name:"Matching image to geometric attributes",isNew:0},385:{ID:385,qID:17834,name:"Volume of 3D shapes",isNew:0},386:{ID:386,qID:17884,name:"Surface area of 3D shapes without images",isNew:0},387:{ID:387,qID:17904,name:"Surface area of 3D shapes",isNew:0},388:{ID:388,qID:17968,name:"2D shapes word problems",isNew:0},389:{ID:389,qID:18018,name:"Counting word problems",isNew:0},390:{ID:390,qID:18068,name:"Mixed addition and subtraction word problems",isNew:0},391:{ID:391,qID:18118,name:"Ordering/comparing numbers word problems",isNew:0},392:{ID:392,qID:18158,name:"Single digit addition word problems",isNew:0},393:{ID:393,qID:18208,name:"Single digit subtraction word problems",isNew:0},395:{ID:395,qID:18308,name:"2-digit addition word problems",isNew:0},396:{ID:396,qID:18358,name:"2-digit subtraction word problems",isNew:0},398:{ID:398,qID:18458,name:"Mixed 2-digit addition and subtraction word problems",isNew:0},399:{ID:399,qID:18508,name:"Ordering/comparing numbers word problems",isNew:0},400:{ID:400,qID:18558,name:"Single digit addition word problems",isNew:0},401:{ID:401,qID:18608,name:"Single digit subtraction word problems",isNew:0},402:{ID:402,qID:18658,name:"2D shapes word problems",isNew:0},406:{ID:406,qID:18838,name:"Mixed addition and subtraction word problems",isNew:0},408:{ID:408,qID:18918,name:"Place value word problems",isNew:0},409:{ID:409,qID:18968,name:"Subtraction word problems",isNew:0},412:{ID:412,qID:19098,name:"Money word problems",isNew:0},414:{ID:414,qID:19178,name:"Add and subtract decimals word problems",isNew:0},415:{ID:415,qID:19228,name:"Division word problems",isNew:0},416:{ID:416,qID:19268,name:"Multiplication word problems",isNew:0},417:{ID:417,qID:19318,name:"Addition word problems ",isNew:0},419:{ID:419,qID:19418,name:"Add and subtract decimals word problems",isNew:0},421:{ID:421,qID:19518,name:"Time word problems",isNew:0},424:{ID:424,qID:19658,name:"Writing words in numbers 10-20",isNew:0},425:{ID:425,qID:19668,name:"Writing numbers in words 10-20",isNew:0},426:{ID:426,qID:19678,name:"Counting forward by 1s from 100 to 200",isNew:0},427:{ID:427,qID:19728,name:"Counting forward by 2s from 100 to 200",isNew:0},428:{ID:428,qID:19777,name:"Counting forward by 5s from 100 to 200",isNew:0},429:{ID:429,qID:19797,name:"Counting forward by 1s, 2s, 5s, 10s, and 25s from 100 to 200",isNew:0},430:{ID:430,qID:19847,name:"Counting forward by 1s from 200 to 1000",isNew:0},431:{ID:431,qID:19897,name:"Counting forward by 2s from 200 to 1000",isNew:0},432:{ID:432,qID:19947,name:"Counting forward by 5s from 200 to 1000",isNew:0},434:{ID:434,qID:19997,name:"Counting forward by 25s from 200 to 1000",isNew:0},435:{ID:435,qID:20029,name:"Read and print whole numbers from 20-100",isNew:0},436:{ID:436,qID:20079,name:"Ordering numbers 50-100 (least to greatest)",isNew:0},437:{ID:437,qID:20129,name:"Ordering numbers 50-100 (greatest to least)",isNew:0},438:{ID:438,qID:20179,name:"Order whole numbers 50-100 (between)",isNew:0},439:{ID:439,qID:20229,name:"Comparing numbers 50-100 (greatest)",isNew:0},440:{ID:440,qID:20279,name:"Comparing numbers 50-100 (least)",isNew:0},441:{ID:441,qID:20329,name:"Ordering numbers 100-1000 (least to greatest)",isNew:0},442:{ID:442,qID:20379,name:"Ordering numbers 100-1000 (greatest to least)",isNew:0},443:{ID:443,qID:20429,name:"Comparing numbers 100-1000 (greatest)",isNew:0},444:{ID:444,qID:20479,name:"Comparing numbers 100-1000 (least)",isNew:0},445:{ID:445,qID:20529,name:"Ordering numbers 1000-10000 (greatest to least)",isNew:0},446:{ID:446,qID:20579,name:"Ordering numbers 1000-10000 (least to greatest)",isNew:0},447:{ID:447,qID:20629,name:"Comparing numbers 1000-10000 (greatest)",isNew:0},448:{ID:448,qID:20679,name:"Comparing numbers 1000-10000 (least)",isNew:0},449:{ID:449,qID:20729,name:"Read and print whole numbers 100-10000",isNew:0},450:{ID:450,qID:20779,name:"Read and print whole numbers 10000-100000",isNew:0},451:{ID:451,qID:20829,name:"Missing number addition from 10 to 18",isNew:0},452:{ID:452,qID:20879,name:"Missing number subtraction from 10 to 18",isNew:0},453:{ID:453,qID:20929,name:"Missing number subtraction from 10 to 18 (2nd value missing)",isNew:0},454:{ID:454,qID:20979,name:"Classifying 2D shapes ",isNew:0},455:{ID:455,qID:21009,name:"Sorting 2D shapes",isNew:0},456:{ID:456,qID:21054,name:"Similar 2D shapes",isNew:0},457:{ID:457,qID:21094,name:"Identifying 2D shapes (matching name to shape)",isNew:0},458:{ID:458,qID:21134,name:"Identifying 2D shapes (matching shape to name)",isNew:0},459:{ID:459,qID:21169,name:"2D shapes word problems",isNew:0},460:{ID:460,qID:21209,name:"Counting word problems",isNew:0},461:{ID:461,qID:21249,name:"Counting word problems",isNew:0},462:{ID:462,qID:21299,name:"Multiplication word problems",isNew:0},463:{ID:463,qID:21339,name:"Division word problems",isNew:0},464:{ID:464,qID:21384,name:"Classify 2D shapes ",isNew:0},465:{ID:465,qID:21424,name:"Order decimals (greatest to least)",isNew:0},466:{ID:466,qID:21474,name:"Order decimals (least to greatest)",isNew:0},467:{ID:467,qID:21575,name:"Least number possible",isNew:0},470:{ID:470,qID:22810,name:"Hour and half hour",isNew:0},471:{ID:471,qID:21675,name:"Nearest five minutes",isNew:0},472:{ID:472,qID:21725,name:"Closest to a minute",isNew:0},473:{ID:473,qID:21775,name:"Match digital and analog clocks",isNew:0},474:{ID:474,qID:21825,name:"Match digital and analog clocks",isNew:0},475:{ID:475,qID:21875,name:"Reading clocks",isNew:0},476:{ID:476,qID:21899,name:"Reading clocks and writing time",isNew:0},477:{ID:477,qID:21949,name:"Reading clocks (quarter hour)",isNew:0},478:{ID:478,qID:21973,name:"Telling time (quarter hour)",isNew:0},479:{ID:479,qID:22023,name:"Match digital and analog clocks (quarter hour)",isNew:0},480:{ID:480,qID:22940,name:"Recognize a pattern with one attribute",isNew:0},481:{ID:481,qID:22900,name:"Matching patterns with one attribute",isNew:0},482:{ID:482,qID:22860,name:"Describe patterns",isNew:0},483:{ID:483,qID:23100,name:"Recognize a pattern with 2 attributes",isNew:0},484:{ID:484,qID:23020,name:"Matching patterns with 2 attributes",isNew:0},485:{ID:485,qID:22980,name:"Describe patterns with 2 attributes",isNew:0},486:{ID:486,qID:22660,name:"Comparing angles to right angles",isNew:0},487:{ID:487,qID:22310,name:"Comparing mass",isNew:0},488:{ID:488,qID:22350,name:"Comparing mass (g, kg)",isNew:0},489:{ID:489,qID:22400,name:"Convert mass (g, kg)",isNew:0},490:{ID:490,qID:22420,name:"Comparing capacity (mL, L)",isNew:0},491:{ID:491,qID:22470,name:"Convert capacity (mL, L)",isNew:0},492:{ID:492,qID:22490,name:"Select most appropriate standard unit (mg, g, kg, tonne)",isNew:0},493:{ID:493,qID:22530,name:"Select most appropriate standard unit (mm, cm, dm, m, km)",isNew:0},494:{ID:494,qID:22570,name:"Convert square units",isNew:0},495:{ID:495,qID:22610,name:"Elapsed time with clocks",isNew:0},496:{ID:496,qID:23140,name:"Comparing angles",isNew:0},497:{ID:497,qID:22760,name:"Calculate probability",isNew:0},499:{ID:499,qID:23173,name:"Absolute values",isNew:0},500:{ID:500,qID:23313,name:"Comparing rational numbers (greatest)",isNew:0},501:{ID:501,qID:23363,name:"Comparing rational numbers (least)",isNew:0},502:{ID:502,qID:23413,name:"Equivalent ratios",isNew:0},503:{ID:503,qID:23263,name:"Greater, less, or equal to rational numbers",isNew:0},504:{ID:504,qID:23463,name:"Greatest common factor",isNew:0},505:{ID:505,qID:23513,name:"Least common multiple",isNew:0},506:{ID:506,qID:23561,name:"Missing number in ratios",isNew:0},507:{ID:507,qID:23213,name:"Opposite numbers",isNew:0},508:{ID:508,qID:53342,name:"Ratio tables",isNew:0},509:{ID:509,qID:23611,name:"Ratios with images",isNew:0},510:{ID:510,qID:42447,name:"Reciprocals",isNew:0},511:{ID:511,qID:23661,name:"Outcomes of 2 independent events",isNew:0},512:{ID:512,qID:23691,name:"Classify triangles",isNew:0},513:{ID:513,qID:23741,name:"Parallel, perpendicular, and intersecting lines",isNew:0},514:{ID:514,qID:23766,name:"Add and subtract integers with counters",isNew:0},515:{ID:515,qID:23806,name:"Add and subtract integers ",isNew:0},516:{ID:516,qID:23856,name:"Comparing decimals to hundredths (greatest)",isNew:0},517:{ID:517,qID:23906,name:"Comparing decimals to hundredths (least)",isNew:0},518:{ID:518,qID:23956,name:"Divide decimals to thousandths",isNew:0},519:{ID:519,qID:24006,name:"Greater, less, or equal to integers",isNew:0},520:{ID:520,qID:24056,name:"Writing pattern rules algebraically",isNew:0},521:{ID:521,qID:24081,name:"Multiply decimals to thousandths",isNew:0},522:{ID:522,qID:24131,name:"Calculate the hypotenuse",isNew:0},523:{ID:523,qID:24171,name:"Compare fractions and decimals (greatest)",isNew:0},524:{ID:524,qID:24221,name:"Compare fractions and decimals (least)",isNew:0},525:{ID:525,qID:24271,name:"Complementary events",isNew:0},526:{ID:526,qID:25065,name:"Convert between decimals, fractions, and percents",isNew:0},527:{ID:527,qID:24330,name:"Convert mixed metric units",isNew:0},528:{ID:528,qID:24380,name:"Determine a term in a pattern",isNew:0},529:{ID:529,qID:24425,name:"Determine if a triangle is a right triangle",isNew:0},530:{ID:530,qID:24465,name:"Estimate area of a circle",isNew:0},531:{ID:531,qID:24495,name:"Estimate circumference of a circle",isNew:0},532:{ID:532,qID:24525,name:"Estimate square roots",isNew:0},533:{ID:533,qID:24575,name:"Evaluate algebraic expressions with up to 3 terms",isNew:0},534:{ID:534,qID:24625,name:"Evaluate order of operation with exponents",isNew:0},535:{ID:535,qID:24675,name:"Exponential notation",isNew:0},536:{ID:536,qID:24725,name:"Express multiplication with exponents",isNew:0},537:{ID:537,qID:24775,name:"Multiply and divide decimals by powers of 10",isNew:0},538:{ID:538,qID:24825,name:"Order of operations with exponents",isNew:0},539:{ID:539,qID:24875,name:"Square roots of perfect squares",isNew:0},540:{ID:540,qID:24895,name:"Value of a variable",isNew:0},541:{ID:541,qID:25135,name:"Volume of cylinders",isNew:0},542:{ID:542,qID:24975,name:"Whole numbers in expanded form",isNew:0},543:{ID:543,qID:25165,name:"10 more or less",isNew:0},544:{ID:544,qID:25215,name:"Compare two-digit numbers using symbols",isNew:0},545:{ID:545,qID:25265,name:"Place value to 100",isNew:0},546:{ID:546,qID:25315,name:"Related addition facts",isNew:0},547:{ID:547,qID:25357,name:"Subtract multiples of 10",isNew:0},548:{ID:548,qID:25401,name:"Value of a digit to 100",isNew:0},549:{ID:549,qID:25451,name:"Add and subtract 10 or 100",isNew:0},550:{ID:550,qID:25501,name:"Add up to four 2-digit numbers",isNew:0},552:{ID:552,qID:25587,name:"Greater, less than, or equal to",isNew:0},554:{ID:554,qID:25673,name:"Identify a fraction",isNew:0},555:{ID:555,qID:25713,name:"Relate multiplication and addition",isNew:0},556:{ID:556,qID:25763,name:"Round to the nearest hundred",isNew:0},557:{ID:557,qID:25813,name:"Understand a fraction",isNew:0},558:{ID:558,qID:25857,name:"Add fractions with denominators of 10 and 100",isNew:0},559:{ID:559,qID:25907,name:"Compare decimals to hundredths with symbols",isNew:0},560:{ID:560,qID:27054,name:"Compare like and unlike fractions with symbols",isNew:0},561:{ID:561,qID:25977,name:"Decimal notation for denominators of 10 and 100",isNew:0},562:{ID:562,qID:26027,name:"Decompose a fraction",isNew:0},563:{ID:563,qID:26077,name:"Denominators of 10 and 100",isNew:0},564:{ID:564,qID:26095,name:"Divide 4-digit by 1-digit",isNew:0},565:{ID:565,qID:26145,name:"Multiply 4-digit by 1-digit",isNew:0},566:{ID:566,qID:26195,name:"Rounding decimals to thousandths",isNew:0},567:{ID:567,qID:26245,name:"Rounding decimals to hundredths",isNew:0},568:{ID:568,qID:26295,name:"Absolute value of a rational number",isNew:0},569:{ID:569,qID:26345,name:"Add and subtract rational numbers",isNew:0},570:{ID:570,qID:26395,name:"Divide rational numbers",isNew:0},571:{ID:571,qID:26445,name:"Multiply rational numbers",isNew:0},572:{ID:572,qID:26495,name:"Rational numbers",isNew:0},573:{ID:573,qID:26545,name:"Subtracting rational numbers",isNew:0},574:{ID:574,qID:26595,name:"Adding opposite numbers",isNew:0},576:{ID:576,qID:26645,name:"Add and subtract linear expressions",isNew:0},577:{ID:577,qID:26695,name:"Expand linear expressions",isNew:0},578:{ID:578,qID:26745,name:"Factor linear expressions",isNew:0},579:{ID:579,qID:26795,name:"Probability from 0 - 1",isNew:0},580:{ID:580,qID:26845,name:"Probability on a number line",isNew:0},581:{ID:581,qID:26895,name:"Unit rates with fractions",isNew:0},582:{ID:582,qID:26945,name:"Convert a fraction to a decimal",isNew:0},583:{ID:583,qID:27104,name:"Extending number patterns with multiple text boxes",isNew:0},584:{ID:584,qID:27154,name:"Writing a pattern rule from a number line with multiple text boxes",isNew:0},586:{ID:586,qID:27204,name:"Patterning word problem - reach a point",isNew:0},587:{ID:587,qID:27254,name:"Patterning word problem - will it reach",isNew:0},588:{ID:588,qID:27304,name:"Which outcomes are equal",isNew:0},589:{ID:589,qID:27354,name:"Pick the appropriate spinner",isNew:0},590:{ID:590,qID:27404,name:"Which spinner is fair",isNew:0},591:{ID:591,qID:27454,name:"Determining mode from horizontal bar graph",isNew:0},592:{ID:592,qID:27504,name:"Determining mode from a vertical bar graph",isNew:0},593:{ID:593,qID:27604,name:"Finding a missing value from horizontal bar graph",isNew:0},594:{ID:594,qID:27654,name:"Finding a missing value vertical bar graph",isNew:0},595:{ID:595,qID:27704,name:"How many more/fewer from horizontal bar graph",isNew:0},596:{ID:596,qID:27754,name:"How many more/fewer from vertical bar graph",isNew:0},597:{ID:597,qID:27804,name:"Most/ least popular from a horizontal bar graph",isNew:0},598:{ID:598,qID:27854,name:"Most/ least popular from a vertical bar graph",isNew:0},599:{ID:599,qID:28004,name:"Adding fractions",isNew:0},600:{ID:600,qID:27904,name:"Total of data in a horizontal bar graph",isNew:0},601:{ID:601,qID:27954,name:"Total of data in a vertical bar graph",isNew:0},602:{ID:602,qID:28054,name:"Reading data from a horizontal bar graph",isNew:0},603:{ID:603,qID:28104,name:"Reading data from a vertical bar graph",isNew:0},604:{ID:604,qID:28154,name:"Decimals in expanded form",isNew:0},605:{ID:605,qID:28204,name:"Determining change",isNew:0},606:{ID:606,qID:28254,name:"Divide unit fractions by a whole number",isNew:0},607:{ID:607,qID:28354,name:"Non-equivalent representations of money",isNew:0},608:{ID:608,qID:28304,name:"Multiply a fraction by a whole number",isNew:0},609:{ID:609,qID:28404,name:"Multiply two fractions",isNew:0},610:{ID:610,qID:28454,name:"Subtracting fractions",isNew:0},611:{ID:611,qID:28504,name:"Total of multiple items",isNew:0},612:{ID:612,qID:28554,name:"What angles are in this shape",isNew:0},613:{ID:613,qID:28596,name:"Reading a continuous line graph",isNew:0},614:{ID:614,qID:28646,name:"How many more/fewer from vertical bar graph.",isNew:0},615:{ID:615,qID:28696,name:"Data from a scatter plot",isNew:0},617:{ID:617,qID:28726,name:"Missing mean values - 2 sets",isNew:0},618:{ID:618,qID:28776,name:"Expected outcomes - cards",isNew:0},619:{ID:619,qID:28826,name:"Expected outcomes - spinner",isNew:0},620:{ID:620,qID:28876,name:"Pattern rule from graph",isNew:0},621:{ID:621,qID:28926,name:"Which graph is correct",isNew:0},622:{ID:622,qID:28976,name:"Future value of a pattern using a graph",isNew:0},623:{ID:623,qID:29026,name:"Conversion word problem - distance",isNew:0},624:{ID:624,qID:29076,name:"Non-equivalent equations with 2 variables",isNew:0},625:{ID:625,qID:29116,name:"Conversion word problem - mass",isNew:0},626:{ID:626,qID:29166,name:"Conversion word problem - volume",isNew:0},628:{ID:628,qID:29216,name:"Exponent rules - multiple rules",isNew:0},629:{ID:629,qID:29266,name:"Exponent rules - dividing same base",isNew:0},630:{ID:630,qID:29316,name:"Exponent rules - multiplying same bases",isNew:0},631:{ID:631,qID:29366,name:"Exponent rules - negative exponents",isNew:0},632:{ID:632,qID:29416,name:"Exponent rules - multiple exponents",isNew:0},633:{ID:633,qID:29466,name:"Evaluate exponent rule - multiple rules",isNew:0},634:{ID:634,qID:29516,name:"Evaluate exponent rule - negative exponents",isNew:0},635:{ID:635,qID:29556,name:"Evaluate exponent rule - multiple exponents",isNew:0},636:{ID:636,qID:29606,name:"Evaluate exponent rule - dividing same base",isNew:0},637:{ID:637,qID:29656,name:"Evaluate exponent rule - multiplying same bases",isNew:0},638:{ID:638,qID:29696,name:"Evaluate perfect roots",isNew:0},639:{ID:639,qID:29718,name:"Re-writing exponents as roots",isNew:0},640:{ID:640,qID:29740,name:"Compare scientific notation - greater/less/equal",isNew:0},641:{ID:641,qID:29790,name:"Convert from scientific to standard notation",isNew:0},642:{ID:642,qID:29840,name:"Convert from standard to scientific notation",isNew:0},643:{ID:643,qID:29890,name:"Compare irrational numbers",isNew:0},644:{ID:644,qID:29920,name:"Estimate value of irrational expression",isNew:0},645:{ID:645,qID:30182,name:"Pick the correct decimal expansion",isNew:0},646:{ID:646,qID:29970,name:"Comparing money",isNew:0},647:{ID:647,qID:30020,name:"Total of coins",isNew:0},648:{ID:648,qID:30070,name:"Identify money",isNew:0},649:{ID:649,qID:30082,name:"Equivalent coins",isNew:0},650:{ID:650,qID:30132,name:"Total of multiple items",isNew:0},651:{ID:651,qID:30232,name:"Rational or irrational",isNew:0},652:{ID:652,qID:30282,name:"Compare scientific notation - times bigger/smaller",isNew:0},653:{ID:653,qID:30332,name:"Multiply with scientific notation",
isNew:0},654:{ID:654,qID:30382,name:"Divide with scientific notation",isNew:0},655:{ID:655,qID:30422,name:"Which graph matches unit rate",isNew:0},656:{ID:656,qID:30452,name:"Which graph matches unit rate - word problem",isNew:0},658:{ID:658,qID:30482,name:"Compare unit rate and graph",isNew:0},659:{ID:659,qID:30512,name:"Compare unit rate and graph word problem",isNew:0},660:{ID:660,qID:30542,name:"Slope of a line from slope/intercept",isNew:0},661:{ID:661,qID:30592,name:"Intercept of a line from slope/intercept",isNew:0},662:{ID:662,qID:30642,name:"How many solutions to a linear equation",isNew:0},663:{ID:663,qID:30692,name:"Solving a linear equation",isNew:0},664:{ID:664,qID:30742,name:"Is this a point of intersection?",isNew:0},665:{ID:665,qID:30784,name:"Solve linear system - substitution",isNew:0},666:{ID:666,qID:30826,name:"Solve linear system - elimination",isNew:0},667:{ID:667,qID:30862,name:"Is there an intersection - pairs of coordinates",isNew:0},668:{ID:668,qID:30902,name:"Reading data from a horizontal bar graph",isNew:0},669:{ID:669,qID:30952,name:"Reading data from a vertical bar graph",isNew:0},670:{ID:670,qID:31002,name:"More or less from a horizontal bar graph",isNew:0},671:{ID:671,qID:31052,name:"More or less from a vertical bar graph",isNew:0},672:{ID:672,qID:31102,name:"More or less from a horizontal bar graph",isNew:0},673:{ID:673,qID:31152,name:"More or less from a vertical bar graph",isNew:0},674:{ID:674,qID:31202,name:"Most or least from a horizontal bar graph",isNew:0},675:{ID:675,qID:31252,name:"Most or least from a vertical bar graph",isNew:0},676:{ID:676,qID:31302,name:"Reading data from horizontal bar graphs",isNew:0},677:{ID:677,qID:31352,name:"Reading data from vertical bar graphs",isNew:0},678:{ID:678,qID:31402,name:"What is the intersection - pairs of coordinates",isNew:0},679:{ID:679,qID:31442,name:"Solve by substitution - word problem",isNew:0},680:{ID:680,qID:31469,name:"Solve by elimination - word problem",isNew:0},681:{ID:681,qID:31499,name:"Value of a function at a given input",isNew:0},682:{ID:682,qID:31549,name:"Compare rate of change - slope/intercept and coordinates",isNew:0},683:{ID:683,qID:31589,name:"Compare functions at a value- slope/intercept and coordinates",isNew:0},684:{ID:684,qID:31629,name:"Is this function linear or nonlinear",isNew:0},685:{ID:685,qID:31679,name:"Which function is nonlinear",isNew:0},686:{ID:686,qID:31700,name:"Rate of change from coordinates",isNew:0},687:{ID:687,qID:31740,name:"Initial value from coordinates",isNew:0},688:{ID:688,qID:31780,name:"Pythagorean Theorem - missing hypotenuse length",isNew:0},689:{ID:689,qID:31830,name:"Pythagorean Theorem - missing non-hypotenuse",isNew:0},690:{ID:690,qID:31880,name:"Pythagorean Theorem - perimeter of triangle missing a side length",isNew:0},691:{ID:691,qID:31930,name:"Missing triangle angle - numbers",isNew:0},692:{ID:692,qID:31980,name:"What data pattern from scatter plot",isNew:0},693:{ID:693,qID:32010,name:"Interpret data from a scatter plot",isNew:0},694:{ID:694,qID:32040,name:"Interpret intercept from a linear equation",isNew:0},695:{ID:695,qID:32062,name:"Interpret slope from a linear equation",isNew:0},696:{ID:696,qID:32106,name:"Interpret intercept from a linear equation graph",isNew:0},697:{ID:697,qID:32084,name:"Interpret slope from a linear equation graph",isNew:0},698:{ID:698,qID:32128,name:"Missing triangle angle - images",isNew:0},699:{ID:699,qID:32228,name:"Pythagorean Theorem - missing non-hypotenuse image",isNew:0},700:{ID:700,qID:32278,name:"Pythagorean Theorem - perimeter of triangle missing a side length image",isNew:0},701:{ID:701,qID:32178,name:"Pythagorean Theorem - missing hypotenuse length with image",isNew:0},702:{ID:702,qID:32328,name:"2-step word problems with all operations",isNew:0},704:{ID:704,qID:32378,name:"Multiplication sentence from images",isNew:0},705:{ID:705,qID:32423,name:"Division sentence from images - multiple boxes",isNew:0},706:{ID:706,qID:32468,name:"Multiplication sentence from word problem - two missing",isNew:0},707:{ID:707,qID:32518,name:"Multiplication sentence from word problem - three missing",isNew:0},708:{ID:708,qID:32568,name:"Division sentence from word problem - two missing",isNew:0},709:{ID:709,qID:32618,name:"Division sentence from word problem - three missing",isNew:0},710:{ID:710,qID:32668,name:"Inverse of a division or multiplication sentence",isNew:0},711:{ID:711,qID:32718,name:"Distributive property - missing numbers",isNew:0},712:{ID:712,qID:32766,name:"Extend patterns 1s, 5s, 10s, 25s to 100",isNew:0},713:{ID:713,qID:32814,name:"Addition to 1000 in place value chart",isNew:0},714:{ID:714,qID:32864,name:"Subtraction to 1000 in place value chart",isNew:0},715:{ID:715,qID:32914,name:"Write a whole number as a fraction",isNew:0},716:{ID:716,qID:32964,name:"Volume & mass addition word problems",isNew:0},718:{ID:718,qID:45656,name:"Fraction on a number line",isNew:0},719:{ID:719,qID:33824,name:"Choose equivalent fraction strips",isNew:0},720:{ID:720,qID:34166,name:"Fraction strips equivalent",isNew:0},721:{ID:721,qID:34258,name:"Write equivalent fractions from fraction strips (to 1/12)",isNew:0},722:{ID:722,qID:34300,name:"Write the fraction from fraction strips",isNew:0},723:{ID:723,qID:48950,name:"Equivalent fractions with fraction circles (denominators only 2,3,4,6 & 8)",isNew:0},724:{ID:724,qID:48989,name:"Complete fraction equivalent statement from number line, strips and circles",isNew:0},726:{ID:726,qID:59131,name:"Complete vertical bar graph using a chart",isNew:0},728:{ID:728,qID:60123,name:"Fill in missing values on a bar graph, up to 4 categories",isNew:0},730:{ID:730,qID:55011,name:"Shade in a fraction using fraction strips (denominators 2,3,4,6,8)",isNew:0},733:{ID:733,qID:50395,name:"Growing and Shrinking Patterns (3 digit numbers)",isNew:0},734:{ID:734,qID:46821,name:"Compare and place two fractions on a number line",isNew:0},735:{ID:735,qID:47055,name:"Input/output table addition patterns",isNew:0},736:{ID:736,qID:47105,name:"Input/output table subtraction patterns",isNew:0},751:{ID:751,qID:36126,name:"Fill in 10s on a number line",isNew:0},752:{ID:752,qID:36176,name:"Fill in 100s on a number line",isNew:0},753:{ID:753,qID:48438,name:"Divide a whole circle into equal parts",isNew:0},754:{ID:754,qID:46771,name:"Select a pattern rule that matches pattern on 100s chart",isNew:0},755:{ID:755,qID:33774,name:"Volume & mass division word problem",isNew:0},756:{ID:756,qID:34445,name:"Write a multiplication sentence from multiplication grid",isNew:0},757:{ID:757,qID:35094,name:"Equations with 2-step word problems with all operations",isNew:0},758:{ID:758,qID:34544,name:"Write a division sentence from a multiplication grid",isNew:0},759:{ID:759,qID:34593,name:"Equivalent multiplication sentences",isNew:0},760:{ID:760,qID:34643,name:"Missing value in multiplication sentence",isNew:0},761:{ID:761,qID:34693,name:"Missing value in division sentence",isNew:0},762:{ID:762,qID:34743,name:"Complete addition statement",isNew:0},763:{ID:763,qID:34793,name:"Complete subtraction statement",isNew:0},764:{ID:764,qID:34843,name:"Multiply multiples of 10",isNew:0},765:{ID:765,qID:48609,name:"Determine if fractions on number line are equivalent",isNew:0},766:{ID:766,qID:48570,name:"Write fractions from number line and determine if equivalent",isNew:0},767:{ID:767,qID:34893,name:"Compare fractions with same numerator/denominator",isNew:0},769:{ID:769,qID:35331,name:"Find the missing side length",isNew:0},770:{ID:770,qID:35381,name:"Find dimensions of a shape given area or perimeter",isNew:0},771:{ID:771,qID:35431,name:"Identify quadrilaterals",isNew:0},772:{ID:772,qID:33014,name:"Multiplication sentence from images - drop down",isNew:0},773:{ID:773,qID:33059,name:"Division sentence from images - drop down",isNew:0},775:{ID:775,qID:33104,name:"Multiplication sentence from word problem - drop down",isNew:0},776:{ID:776,qID:33154,name:"Division sentence from word problem - drop down",isNew:0},777:{ID:777,qID:33204,name:"Addition in expanded form - no regrouping",isNew:0},778:{ID:778,qID:33244,name:"Subtraction in expanded form",isNew:0},779:{ID:779,qID:33324,name:"Equivalent addition sentence",isNew:0},780:{ID:780,qID:33424,name:"Volume & mass subtraction word problems",isNew:0},781:{ID:781,qID:33474,name:"Multiplication sentence missing number",isNew:0},782:{ID:782,qID:33524,name:"Division sentence missing number",isNew:0},783:{ID:783,qID:33574,name:"Inverse of a division or multiplication sentence - drop down",isNew:0},784:{ID:784,qID:33624,name:"2-step word problems with all operations - drop down",isNew:0},785:{ID:785,qID:33674,name:"Equivalent subtraction sentence",isNew:0},786:{ID:786,qID:33724,name:"Volume & mass multiplication word problem",isNew:0},787:{ID:787,qID:33866,name:"Convert between place value",isNew:0},788:{ID:788,qID:33916,name:"Write number from expanded form",isNew:0},789:{ID:789,qID:33966,name:"Place value of a digit",isNew:0},790:{ID:790,qID:34016,name:"Compare more value of one place to another",isNew:0},791:{ID:791,qID:34066,name:"Compare less value of one place to another",isNew:0},792:{ID:792,qID:34116,name:"Compare value of numbers with <  >  =",isNew:0},793:{ID:793,qID:34208,name:"Round to nearest ten",isNew:0},794:{ID:794,qID:34345,name:"Round to nearest hundred",isNew:0},795:{ID:795,qID:34395,name:"Round to nearest thousand",isNew:0},796:{ID:796,qID:34494,name:"Round to nearest one",isNew:0},797:{ID:797,qID:34943,name:"Round from expanded form",isNew:0},798:{ID:798,qID:34993,name:"Interpret line plots (more/less)",isNew:0},799:{ID:799,qID:35043,name:"Interpret line plots (most/least)",isNew:0},800:{ID:800,qID:35093,name:"Subtraction problems from a line plot",isNew:0},801:{ID:801,qID:35193,name:"Estimate volume and add",isNew:0},802:{ID:802,qID:35241,name:"Estimate mass and add",isNew:0},803:{ID:803,qID:35281,name:"Area word problems",isNew:0},804:{ID:804,qID:35526,name:"Addition problems from line plots",isNew:0},805:{ID:805,qID:35476,name:"Complete steps for adding decimals to hundredths",isNew:0},806:{ID:806,qID:35576,name:"Complete steps for dividing 2-digit by 1-digit",isNew:0},807:{ID:807,qID:35626,name:"Complete steps for dividing 3-digit by 1-digit",isNew:0},808:{ID:808,qID:35676,name:"Complete steps for multiplying 2-digit by 1-digit",isNew:0},809:{ID:809,qID:35726,name:"Complete steps for multiplying 2-digit by 2-digit",isNew:0},810:{ID:810,qID:35776,name:"Complete steps for multiplying 4-digit by 2-digit",isNew:0},811:{ID:811,qID:35826,name:"Division pattern for multiples of 10",isNew:0},812:{ID:812,qID:35876,name:"Multiplication pattern for multiples of 10",isNew:0},813:{ID:813,qID:35926,name:"Missing decimal addend to hundredths",isNew:0},814:{ID:814,qID:35976,name:"Missing decimal minuend to hundredths",isNew:0},815:{ID:815,qID:36026,name:"Missing steps for dividing 2-digit by 1-digit",isNew:0},816:{ID:816,qID:36076,name:"Missing steps for dividing 3-digit by 1-digit",isNew:0},817:{ID:817,qID:36226,name:"Exponent rules - multiplying same base",isNew:0},818:{ID:818,qID:36276,name:"Exponent rules - dividing same base",isNew:0},819:{ID:819,qID:36326,name:"Exponent rules - negative exponent",isNew:0},820:{ID:820,qID:36376,name:"Exponent rules - multiple exponents",isNew:0},821:{ID:821,qID:36426,name:"Missing steps for multiplying 2-digit by 1-digit",isNew:0},822:{ID:822,qID:36526,name:"Exponent rules - multiple rules",isNew:0},823:{ID:823,qID:36576,name:"Evaluate exponent rule - multiplying same bases",isNew:0},824:{ID:824,qID:36666,name:"Evaluate exponent rule - dividing same base",isNew:0},825:{ID:825,qID:36616,name:"Missing steps for multiplying 2-digit by 2-digit",isNew:0},826:{ID:826,qID:36716,name:"Evaluate exponent rules - negative exponent",isNew:0},827:{ID:827,qID:36756,name:"Evaluate exponent rule - multiple exponents",isNew:0},828:{ID:828,qID:36806,name:"Evaluate exponent rule - multiple rules",isNew:0},829:{ID:829,qID:36856,name:"Missing steps for multiplying 4-digit by 2-digit",isNew:0},830:{ID:830,qID:37056,name:"Write in expanded form, to millions",isNew:0},831:{ID:831,qID:37106,name:"Add two-digit numbers, show algorithm and regrouping",isNew:0},832:{ID:832,qID:37156,name:"Add three-digit numbers, show algorithm and regrouping",isNew:0},833:{ID:833,qID:37256,name:"Add four-digit numbers, show algorithm and regrouping",isNew:0},834:{ID:834,qID:37616,name:"Subtract two-digit numbers, show algorithm and regrouping",isNew:0},835:{ID:835,qID:37716,name:"Subtract three-digit numbers, show algorithm and regrouping",isNew:0},836:{ID:836,qID:37816,name:"Subtract four-digit numbers, show algorithm and regrouping",isNew:0},837:{ID:837,qID:36906,name:"Multiplication of 4-digit by 1-digit with missing steps",isNew:0},838:{ID:838,qID:38046,name:"Multiplication of 2-digit by 2-digit with missing steps",isNew:0},839:{ID:839,qID:38596,name:"Convert km, m, cm",isNew:0},840:{ID:840,qID:38646,name:"Convert lbs., oz.",isNew:0},841:{ID:841,qID:38696,name:"Convert mL, L",isNew:0},843:{ID:843,qID:38896,name:"Compare (< > =) km, m, cm",isNew:0},844:{ID:844,qID:38746,name:"Compare (< > =)  mL, L",isNew:0},846:{ID:846,qID:38946,name:"Compare (< > =) lbs., oz.",isNew:0},847:{ID:847,qID:37456,name:"Write number from base ten blocks",isNew:0},848:{ID:848,qID:38196,name:"Division of 2-digit by 1-digit with missing steps, with remainder",isNew:0},849:{ID:849,qID:38246,name:"Division of 3-digit by 1-digit with missing steps, with remainder",isNew:0},850:{ID:850,qID:38346,name:"Division of 4-digit by 1-digit with missing steps",isNew:0},851:{ID:851,qID:38296,name:"Division of 4-digit by 1-digit with missing steps, with remainder",isNew:0},852:{ID:852,qID:39296,name:"Find 2 numbers based on sum (up to 100) and difference",isNew:0},853:{ID:853,qID:42096,name:"Find 2 numbers from different operations",isNew:0},854:{ID:854,qID:36956,name:"Missing fraction subtrahend",isNew:0},855:{ID:855,qID:37006,name:"Missing fraction addend",isNew:0},856:{ID:856,qID:37306,name:"Unit rates with fractions",isNew:0},857:{ID:857,qID:37356,name:"Unit rates with fractions",isNew:0},858:{ID:858,qID:37406,name:"Are these ratios proportional",isNew:0},859:{ID:859,qID:37506,name:"Constant of proportionality/unit rate from a table",isNew:0},860:{ID:860,qID:37536,name:"Constant of proportionality/unit rate from an equation",isNew:0},861:{ID:861,qID:37586,name:"Constant of proportionality/unit rate from graph",isNew:0},863:{ID:863,qID:37666,name:"Write equation from word problem",isNew:0},864:{ID:864,qID:37866,name:"Write equation from table",isNew:0},865:{ID:865,qID:37916,name:"Write equation from a graph",isNew:0},866:{ID:866,qID:37946,name:"Percent of a number",isNew:0},867:{ID:867,qID:37996,name:"Calculate interest",isNew:0},868:{ID:868,qID:38096,name:"Price after a markdown",isNew:0},869:{ID:869,qID:38146,name:"Original price of an item",isNew:0},870:{ID:870,qID:38446,name:"Drop down adding decimals to hundredths",isNew:0},871:{ID:871,qID:38496,name:"Drop down subtracting decimals to hundredths",isNew:0},872:{ID:872,qID:38546,name:"Drop down multiplying decimals to hundredths",isNew:0},873:{ID:873,qID:38796,name:"Missing second fraction multiplied by a fraction",isNew:0},874:{ID:874,qID:38846,name:"Multiply a whole number by a missing fraction",isNew:0},875:{ID:875,qID:39846,name:"Missing unit fraction divided by a whole number",isNew:0},876:{ID:876,qID:39896,name:"Divide a whole number by a unit fraction",isNew:0},877:{ID:877,qID:39946,name:"Whole number divided by a missing unit fraction",isNew:0},878:{ID:878,qID:39246,name:"Adding rational numbers",isNew:0},879:{ID:879,qID:41546,name:"Times as many comparison",isNew:0},880:{ID:880,qID:39196,name:"Addition problems from line plots",isNew:0},881:{ID:881,qID:39346,name:"Multiplication problems from a line plot",isNew:0},882:{ID:882,qID:39396,name:"Subtracting rational numbers",isNew:0},883:{ID:883,qID:39446,name:"Multiplying rational numbers word problems",isNew:0},884:{ID:884,qID:39496,name:"Distributive property with rational numbers",isNew:0},885:{ID:885,qID:39546,name:"Complete rational multiplication sentence",isNew:0},886:{ID:886,qID:39596,name:"Complete rational multiplication sentence",isNew:0},887:{ID:887,qID:39646,name:"Complete rational division sentence",isNew:0},888:{ID:888,qID:39696,name:"Add and subtract mixed numbers with like denominators, using properties of operations",isNew:0},889:{ID:889,qID:39746,name:"Add and subtract mixed numbers with like denominators, converting to improper fractions",isNew:0},890:{ID:890,qID:42146,name:"Equivalent fraction multiplier",isNew:0},891:{ID:891,qID:40046,name:"Multiply a proper fraction by a whole number",isNew:0},892:{ID:892,qID:39996,name:"Equivalent fractions pattern, missing numerator and denominator",isNew:0},893:{ID:893,qID:40096,name:"Complete rational division sentence",isNew:0},894:{ID:894,qID:40146,name:"Compare fractions with unlike denominators (convert to lowest common denominator first)",isNew:0},895:{ID:895,qID:40196,name:"Multiplying rational numbers - drop down",isNew:0},896:{ID:896,qID:40246,name:"Dividing rational numbers - drop down",isNew:0},897:{ID:897,qID:40296,name:"Decompose a fraction into sum of fractions with a common denominator",isNew:0},898:{ID:898,qID:40396,name:"Multiplication sentence word problems",isNew:0},899:{ID:899,qID:40346,name:"Fraction written as a product of a whole number and unit fraction (a/b = a x 1/b)",isNew:0},900:{ID:900,qID:40546,name:"Fraction addition using fraction strips, like denominators",isNew:0},901:{ID:901,qID:40746,name:"Fraction subtraction using fraction strips, like denominators",isNew:0},902:{ID:902,qID:40446,name:"Addition sentence - rational numbers",isNew:0},903:{ID:903,qID:40496,name:"Adding rational numbers - word problem",isNew:0},904:{ID:904,qID:40596,name:"Subtracting rational numbers - word problem",isNew:0},905:{ID:905,qID:40646,name:"Subtraction sentence - rational numbers",isNew:0},906:{ID:906,qID:40796,name:"Dividing rational numbers - word problem",isNew:0},907:{ID:907,qID:40696,name:"Division sentence - rational numbers",isNew:0},908:{ID:908,qID:42046,name:"Fraction multiples as a product (visual)",isNew:0},909:{ID:909,qID:40846,name:"Write simple expressions drop down",isNew:0},910:{ID:910,qID:40896,name:"Write simple expressions",isNew:0},911:{ID:911,qID:40946,name:"Complete steps for subtracting decimals to hundredths",isNew:0},912:{ID:912,qID:40996,name:"Missing steps for multiplying decimals to hundredths",isNew:0},913:{ID:913,qID:41046,name:"Drop down dividing decimals to hundredths",isNew:0},914:{ID:914,qID:41096,name:"Missing decimal factor",isNew:0},915:{ID:915,qID:41146,name:"Missing decimal divisor",isNew:0},916:{ID:916,qID:41196,name:"Adding mixed numbers",isNew:0},917:{ID:917,qID:41246,name:"Subtracting mixed numbers",isNew:0},918:{ID:918,qID:41296,name:"Add and subtract fractions word problems",isNew:0},919:{ID:919,qID:41346,name:"Missing first fraction multiplied by a fraction",isNew:0},920:{ID:920,qID:41396,name:"Multiply two fractions word problems",isNew:0},922:{ID:922,qID:41446,name:"Write decimal in fraction form, with denominators 10 or 100",isNew:0},923:{ID:923,qID:41496,name:"Multiply a fraction by a mixed number",isNew:0},924:{ID:924,qID:41596,name:"Divide a whole number by a unit fraction word problems",isNew:0},925:{ID:925,qID:42246,name:"Add fractions with like denominators using number line",isNew:0},926:{ID:926,qID:41846,name:"Compare sums and differences of fractions with like denominators",isNew:0},927:{ID:927,qID:42296,name:"Subtract fractions with like denominators using number line",isNew:0},928:{ID:928,qID:41646,name:"Divide a unit fraction by a whole number word problems",isNew:0},929:{ID:929,qID:42346,name:"Multiply fractions with like denominators using number line",isNew:0},930:{ID:930,qID:41696,name:"Write the equation for dividing a unit fraction by a whole number",isNew:0},931:{ID:931,qID:41746,name:"Write the equation for divide a whole number by a unit fraction",isNew:0},932:{ID:932,qID:41796,name:"Division problems from a line plot",isNew:0},934:{ID:934,qID:41896,name:"Multiplication or division, write equation from a word problem",isNew:0},935:{ID:935,qID:41996,name:"Addition of fractions from word problems, write and solve with like denominators",isNew:0},936:{ID:936,qID:41946,name:"Add and subtract mixed numbers word problems",isNew:0},937:{ID:937,qID:42196,name:"Subtraction of fractions from word problems, write and solve with like denominators",isNew:0},939:{ID:939,qID:43347,name:"Improper fraction placed on number line",isNew:0},940:{ID:940,qID:42397,name:"Equations with 2-step word problems with all operations",isNew:0},941:{ID:941,qID:42547,name:"Equations with 2-step word problems with all operations drop down",isNew:0},942:{ID:942,qID:42497,name:"Expand and group linear expressions",isNew:0},943:{ID:943,qID:42597,name:"Writing equivalent ratios",isNew:0},944:{ID:944,qID:42747,name:"Fill in missing part of equation and solve",isNew:0},945:{ID:945,qID:42647,name:"Divide fractions by a whole number",isNew:0},946:{ID:946,qID:42697,name:"Divide fractions",isNew:0},947:{ID:947,qID:42847,name:"Write and solve rational equation from word problem",isNew:0},948:{ID:948,qID:42797,name:"Fraction divided by a missing whole number",isNew:0},949:{ID:949,qID:42897,name:"Solve given rational equation from word problem",isNew:0},950:{ID:950,qID:42997,name:"Fill in and solve inequality from word problem",isNew:0},951:{ID:951,qID:42947,name:"Missing fraction divided by a whole number",isNew:0},952:{ID:952,qID:43047,name:"Mixed number written as an improper fraction",isNew:0},953:{ID:953,qID:43097,name:"Complete steps for multiplying 3-digit by 2-digit",isNew:0},954:{ID:954,qID:43147,name:"Write and solve rational inequality from word problem",isNew:0},955:{ID:955,qID:43197,name:"Solve given inequality",isNew:0},956:{ID:956,qID:43247,name:"Compound event probability from table",isNew:0},957:{ID:957,qID:43297,name:"Probability of simple events",isNew:0},959:{ID:959,qID:43397,name:"Write first 4 terms of pattern",isNew:0},960:{ID:960,qID:43447,name:"Write the missing terms throughout pattern",isNew:0},961:{ID:961,qID:43497,name:"Complete steps for dividing 3-digit by 2-digit",isNew:0},962:{ID:962,qID:43647,name:"Is 'x' a factor of a number?",isNew:0},963:{ID:963,qID:43547,name:"Complete steps for dividing 4-digit by 2-digit",isNew:0},964:{ID:964,qID:43597,name:"Missing steps for dividing 3-digit by 2-digit",isNew:0},965:{ID:965,qID:43697,name:"Missing steps for dividing 4-digit by 2-digit",isNew:0},966:{ID:966,qID:43747,name:"Complete steps for adding decimals to thousandths",isNew:0},967:{ID:967,qID:43897,name:"Write equations from a word problem",isNew:0},968:{ID:968,qID:43797,name:"Complete steps for subtracting decimals to thousandths",isNew:0},969:{ID:969,qID:43947,name:"Drop down adding decimals to thousandths",isNew:0},970:{ID:970,qID:43997,name:"Drop down subtracting decimals to thousandths",isNew:0},971:{ID:971,qID:44047,name:"Missing decimal addend to thousandths",isNew:0},972:{ID:972,qID:44097,name:"Missing decimal minuend to thousandths",isNew:0},973:{ID:973,qID:44147,name:"Write multiplication expression with exponents",isNew:0},974:{ID:974,qID:44297,name:"Write equations (options to select) from a word problem, using a variety of operations.",isNew:0},975:{ID:975,qID:44197,name:"Missing steps for multiplying decimals to thousandths",isNew:0},976:{ID:976,qID:44247,name:"Drop down multiplying decimals to thousandths",isNew:0},977:{ID:977,qID:44347,name:"Percent of a number - multiple choice",isNew:0},978:{ID:978,qID:44397,name:"Percent of a number - word problem",isNew:0},979:{ID:979,qID:44447,name:"Calculate interest from word problem - drop down",isNew:0},980:{ID:980,qID:44497,name:"Marked down new price",isNew:0},981:{ID:981,qID:44547,name:"Find the new price - drop down",isNew:0},982:{ID:982,qID:44597,name:"Original price of an item - multiple choice",isNew:0},983:{ID:983,qID:44647,name:"Probability of opposite, exclusive, and overlapping events",isNew:0},984:{ID:984,qID:44697,name:"Find central measure and compare",isNew:0},985:{ID:985,qID:44747,name:"Find central measure and difference",isNew:0},986:{ID:986,qID:44797,name:"Write a fraction as a sum of fractions with fraction strips",isNew:0},987:{ID:987,qID:44847,name:"Complete missing factor from 2 or 3 sets of factor pairs",isNew:0},989:{ID:989,qID:44947,name:"Perimeter word problems",isNew:0},990:{ID:990,qID:45056,name:"Area word problems",isNew:0},991:{ID:991,qID:53306,name:"Mass word problems",isNew:0},994:{ID:994,qID:52870,name:"Distance word problems, multi-step",isNew:0},995:{ID:995,qID:45106,name:"Missing decimal factor to thousandths",isNew:0},996:{ID:996,qID:45156,name:"Writing equivalent expressions",isNew:0},997:{ID:997,qID:45206,name:"Write variable expression from a word problem",isNew:0},998:{ID:998,qID:45256,name:"Opposite numbers on a number line",isNew:0},999:{ID:999,qID:45306,name:"Comparing rational numbers on a number line",isNew:0},1000:{ID:1e3,qID:45356,name:"Solve exponents with whole number bases",isNew:0},1001:{ID:1001,qID:45406,name:"Solve exponents with fractional bases",isNew:0},1002:{ID:1002,qID:45456,name:"Solve exponents with decimal bases",isNew:0},1003:{ID:1003,qID:45506,name:"Identify parts of an expression",isNew:0},1004:{ID:1004,qID:45556,name:"Equivalent expressions (T/F)",isNew:0},1005:{ID:1005,qID:45606,name:"Positive or negative number",isNew:0},1006:{ID:1006,qID:45706,name:"Experimental probability",isNew:0},1007:{ID:1007,qID:45756,name:"Making predictions - spinner",isNew:0},1008:{ID:1008,qID:45822,name:"Making predictions - cards",isNew:0},1009:{ID:1009,qID:45872,name:"Estimate population using ratios in table",isNew:0},1010:{ID:1010,qID:46381,name:"Estimate population using ratios word problem",isNew:0},1011:{ID:1011,qID:45960,name:"Compare and place two fractions on a number line",isNew:0},1012:{ID:1012,qID:45922,name:"Identify nets of 3D shapes",isNew:0},1013:{ID:1013,qID:45940,name:"Surface area of a net",isNew:0},1014:{ID:1014,qID:46231,name:"Place fraction on number line in decimal format",isNew:0},1015:{ID:1015,qID:46281,name:"Round on number line",isNew:0},1016:{ID:1016,qID:46181,name:"Compare two decimals and plot on number line",isNew:0},1017:{ID:1017,qID:46010,name:"Matching net to surface area",isNew:0},1018:{ID:1018,qID:46031,name:"Percent of a quantity",isNew:0},1019:{ID:1019,qID:46081,name:"Find the percent of a quantity",isNew:0},1020:{ID:1020,qID:46131,name:"Find the whole given a part and the percent",isNew:0},1021:{ID:1021,qID:46331,name:"Add and subtract fraction word problems (common denominator)",isNew:0},1022:{ID:1022,qID:46431,name:"Create a proportional ratio",isNew:0},1023:{ID:1023,qID:46481,name:"Are these ratios proportional word problem",isNew:0},1024:{ID:1024,qID:46531,name:"Plot start and end points of subtraction on number line",isNew:0},1025:{ID:1025,qID:46581,name:"Fill in missing values in ratio table",isNew:0},1026:{ID:1026,qID:46631,name:"Interpret a point from a proportional relation with graph",isNew:0},1027:{ID:1027,qID:46721,name:"Place fraction on number line",isNew:0},1028:{ID:1028,qID:46855,name:"Addition pattern with missing values in input/output table",isNew:0},1029:{ID:1029,qID:46905,name:"Subtraction pattern with missing values in input/output table",isNew:0},1030:{ID:1030,qID:46955,name:"Multiplication pattern with missing values in input/output table",isNew:0},1031:{ID:1031,qID:47005,name:"Division pattern with missing values in input/output table",isNew:0},1032:{ID:1032,qID:47155,name:"Conversion table from L to mL",isNew:0},1033:{ID:1033,qID:47255,name:"Conversion table from lbs. to oz.",isNew:0},1034:{ID:1034,qID:47375,name:"Conversion table from km to m and cm",isNew:0},1035:{ID:1035,qID:47525,name:"Conversion table from hr to min and s",isNew:0},1036:{ID:1036,qID:47205,name:"Number line rational subtraction",isNew:0},1037:{ID:1037,qID:47305,name:"Number line rational addition",isNew:0},1038:{ID:1038,qID:47355,name:"Identify parts of a circle",isNew:0},1039:{ID:1039,qID:47425,name:"Unit rates with fractions - lengths",isNew:0},1040:{ID:1040,qID:47475,name:"Unit rates with fractions - area",isNew:0},1041:{ID:1041,qID:47575,name:"Unit rates with conversion",isNew:0},1042:{ID:1042,qID:47626,name:"Missing number in unit rate",isNew:0},1043:{ID:1043,qID:47726,name:"Match re-written expression/equation",isNew:0},1044:{ID:1044,qID:47676,name:"Solve one-step equations drop down",isNew:0},1045:{ID:1045,qID:47776,name:"Match net to 3D shape",isNew:0},1046:{ID:1046,qID:47794,name:"Identify representative or biased samples",isNew:0},1047:{ID:1047,qID:47819,name:"Match 3D shape to net",isNew:0},1048:{ID:1048,qID:47837,name:"Solve one-step equations",isNew:0},1049:{ID:1049,qID:47887,name:"Check if an equation is true",isNew:0},1050:{ID:1050,qID:48088,name:"Identify parallel, perpendicular and angle types on 2D shapes",isNew:0},1051:{ID:1051,qID:47937,name:"Variable inequalities",isNew:0},1052:{ID:1052,qID:48038,name:"Find coordinates of a point (1st quadrant)",isNew:0},1053:{ID:1053,qID:48138,name:"Identify the reflection",isNew:0},1054:{ID:1054,qID:48188,name:"Classify triangles on angles",isNew:0},1055:{ID:1055,qID:48238,name:"Write and solve an equation from a word problem",isNew:0},1056:{ID:1056,qID:48288,name:"Find coordinates of a point (4 quadrants)",isNew:0},1057:{ID:1057,qID:48338,name:"Quadrant of a point",isNew:0},1058:{ID:1058,qID:48388,name:"Distance between two points",isNew:0},1059:{ID:1059,qID:48470,name:"Fill in missing numbers on a number line",isNew:0},1060:{ID:1060,qID:48520,name:"Comparing temperatures",isNew:0},1061:{ID:1061,qID:48648,name:"Identify the translation",isNew:0},1062:{ID:1062,qID:48698,name:"Identify the rotation",isNew:0},1063:{ID:1063,qID:48748,name:"Are these shapes congruent",isNew:0},1064:{ID:1064,qID:48798,name:"Match cross-section to a 3D shape",isNew:0},1065:{ID:1065,qID:48848,name:"Solve for missing exponent",isNew:0},1066:{ID:1066,qID:49690,name:"Match shape to an area and perimeter",isNew:0},1067:{ID:1067,qID:49028,name:"Choose addition or multiplication to solve word problem",isNew:0},1068:{ID:1068,qID:49208,name:"Choose equation that represents word problem",isNew:0},1069:{ID:1069,qID:49078,name:"Distribution of a bar graph",isNew:0},1070:{ID:1070,qID:49128,name:"Distribution of a line plot",isNew:0},1071:{ID:1071,qID:49178,name:"Distribution of a scatter plot",isNew:0},1073:{ID:1073,qID:49258,name:"Value of a place value",isNew:0},1074:{ID:1074,qID:49308,name:"Write a decimal from a number line",isNew:0},1075:{ID:1075,qID:49458,name:"Proportional relationships with equations",isNew:0},1076:{ID:1076,qID:49358,name:"Comparing decimals to thousandths",isNew:0},1077:{ID:1077,qID:49408,name:"Compare addition and subtraction sentences",isNew:0},1078:{ID:1078,qID:49508,name:"Find and compare volume of shapes",isNew:0},1079:{ID:1079,qID:49540,name:"Match chart to probability",isNew:0},1080:{ID:1080,qID:49590,name:"Probability of dependent events",isNew:0},1081:{ID:1081,qID:49640,name:"Describe the transformation - no dilations",isNew:0},1082:{ID:1082,qID:49740,name:"Are these shapes similar",isNew:0},1083:{ID:1083,qID:49840,name:"Describe the transformation - with dilations",isNew:0},1084:{ID:1084,qID:49890,name:"Point of intersection from graph",isNew:0},1085:{ID:1085,qID:49921,name:"Slope in first quadrant from a graph",isNew:0},1086:{ID:1086,qID:50003,name:"Intercept of a line in first quadrant from graph",isNew:0},1087:{ID:1087,qID:50051,name:"Equation of a line in first quadrant from graph",isNew:0},1088:{ID:1088,qID:50099,name:"Match equation of a line to a graph - first quadrant",isNew:0},1089:{ID:1089,qID:50147,name:"Convert between place value",isNew:0},1090:{ID:1090,qID:50195,name:"Fractions adding to a total",isNew:0},1091:{ID:1091,qID:50245,name:"Fractions subtracting to a total",isNew:0},1092:{
ID:1092,qID:50295,name:"Scaling whole numbers by fractions",isNew:0},1093:{ID:1093,qID:50345,name:"Scaling fractions by fractions",isNew:0},1094:{ID:1094,qID:50445,name:"Extend the pattern, up to 3 digits",isNew:0},1095:{ID:1095,qID:50495,name:"Adding and Subtracting patterns, up to 3-digit numbers",isNew:0},1096:{ID:1096,qID:50595,name:"Inverse relation between addition and subtraction of 3 digit numbers",isNew:0},1097:{ID:1097,qID:50545,name:"Match equation of a line to a graph  - all quadrants",isNew:0},1098:{ID:1098,qID:50645,name:"Slope in all quadrants from a graph",isNew:0},1099:{ID:1099,qID:50695,name:"Intercept of a line in all quadrants from graph",isNew:0},1100:{ID:1100,qID:50745,name:"Equation of a line in all quadrants from graph",isNew:0},1101:{ID:1101,qID:50795,name:"Match function table to a graph  - all quadrants",isNew:0},1102:{ID:1102,qID:50845,name:"Choose equivalent fractions (denominators 2,3,4,6,8 only)",isNew:0},1103:{ID:1103,qID:50896,name:"Write equivalent fraction (denominators 2,3,4,6,8)",isNew:0},1104:{ID:1104,qID:50945,name:"Compare fractions (denominators 2,3,4,6,8)",isNew:0},1105:{ID:1105,qID:50995,name:"Compare improper fractions (denominators 2,3,4,6,8)",isNew:0},1106:{ID:1106,qID:51045,name:"Convert metric units (large to small)",isNew:0},1107:{ID:1107,qID:51297,name:"Where is a point after translation",isNew:0},1108:{ID:1108,qID:51096,name:"Compare rate of change from coordinates to a line - first quadrant",isNew:0},1109:{ID:1109,qID:51194,name:"Place decimal on a number line",isNew:0},1110:{ID:1110,qID:51347,name:"Round decimal number to tenths, hundredths or thousandths using number line",isNew:0},1111:{ID:1111,qID:51144,name:"Compare rate of change from coordinates to a line -  all quadrants",isNew:0},1112:{ID:1112,qID:51397,name:"Compare value at a point of coordinates and graph - all quadrants",isNew:0},1113:{ID:1113,qID:51447,name:"Compare value at a point of coordinates and graph - first quadrant",isNew:0},1114:{ID:1114,qID:51495,name:"Which function is linear",isNew:0},1115:{ID:1115,qID:51545,name:"Rate of change between points",isNew:0},1116:{ID:1116,qID:51595,name:"Match function table to a graph  - first quadrant",isNew:0},1118:{ID:1118,qID:51693,name:"Convert km, m, cm, mm",isNew:0},1119:{ID:1119,qID:51743,name:"Convert lbs., oz.",isNew:0},1120:{ID:1120,qID:51793,name:"Convert gal., qt., c.,pt.",isNew:0},1121:{ID:1121,qID:51843,name:"Convert in., ft., y.",isNew:0},1122:{ID:1122,qID:51943,name:"Convert mL, L, kL",isNew:0},1123:{ID:1123,qID:51993,name:"Convert mg, g, kg",isNew:0},1124:{ID:1124,qID:51643,name:"Where is a point after reflection",isNew:0},1125:{ID:1125,qID:52045,name:"Where is a line after translation",isNew:0},1126:{ID:1126,qID:52095,name:"Conversion table of length (km, m, cm)",isNew:0},1127:{ID:1127,qID:52145,name:"Conversion table of volume (L, mL)",isNew:0},1128:{ID:1128,qID:52195,name:"Conversion table of weight (lbs., oz.)",isNew:0},1129:{ID:1129,qID:52245,name:"Graph a point on coordinate plane (1st quadrant)",isNew:0},1130:{ID:1130,qID:52295,name:"New coordinates when a point is moved (1st quadrant)",isNew:0},1131:{ID:1131,qID:52345,name:"Graph a point on coordinate plane (4 quadrants)",isNew:0},1132:{ID:1132,qID:52395,name:"Draw a shape on coordinate plane (4 quadrants)",isNew:0},1133:{ID:1133,qID:52445,name:"Where is a shape after transformation - with dilations",isNew:0},1134:{ID:1134,qID:52495,name:"Where is a shape after translation",isNew:0},1135:{ID:1135,qID:52545,name:"Where is a line after reflection",isNew:0},1136:{ID:1136,qID:52595,name:"Where is a shape after dilation",isNew:0},1137:{ID:1137,qID:52645,name:"Where is a shape after rotation",isNew:0},1138:{ID:1138,qID:52695,name:"Where is a line after rotation",isNew:0},1139:{ID:1139,qID:52745,name:"Where is a point after rotation",isNew:0},1140:{ID:1140,qID:52795,name:"Where is a shape after reflection",isNew:0},1141:{ID:1141,qID:52891,name:"Distance word problems (single step)",isNew:0},1142:{ID:1142,qID:52966,name:"Compare (< > =) km, m, cm, mm",isNew:0},1143:{ID:1143,qID:53016,name:"Compare (< > =) Length (in., ft., yd.)",isNew:0},1144:{ID:1144,qID:53066,name:"Compare (< > =) Volume (kL, mL, L)",isNew:0},1145:{ID:1145,qID:53116,name:"Compare (< > =) Weight (lbs., oz.)",isNew:0},1146:{ID:1146,qID:52916,name:"Match an image to coordinates",isNew:0},1147:{ID:1147,qID:53166,name:"Write coordinates of a shape",isNew:0},1148:{ID:1148,qID:53216,name:"Length conversions in word problems",isNew:0},1149:{ID:1149,qID:53392,name:"Measure of center or variation",isNew:0},1150:{ID:1150,qID:53400,name:"Pythagorean Theorem in 3D",isNew:0},1151:{ID:1151,qID:53450,name:"Pythagorean Theorem - distance between two points",isNew:0},1152:{ID:1152,qID:53500,name:"Pythagorean Theorem - distance between two points on a line",isNew:0},1153:{ID:1153,qID:53550,name:"Mass word problems with conversion",isNew:0},1154:{ID:1154,qID:53586,name:"Weight conversions in word problems",isNew:0},1155:{ID:1155,qID:53658,name:"Area of rectangles with fraction side lengths",isNew:0},1156:{ID:1156,qID:53708,name:"Expression from word problem",isNew:0},1157:{ID:1157,qID:53758,name:"Match pattern to graph",isNew:0},1158:{ID:1158,qID:53808,name:"Match graph to pattern",isNew:0},1159:{ID:1159,qID:53858,name:"Find central measure from table",isNew:0},1160:{ID:1160,qID:53908,name:"Write a variable expression from word problem",isNew:0},1161:{ID:1161,qID:54309,name:"Match graph to pattern description",isNew:0},1162:{ID:1162,qID:53958,name:"Write an inequality statement",isNew:0},1163:{ID:1163,qID:54008,name:"Complete an inequality statement",isNew:0},1164:{ID:1164,qID:54058,name:"What is the unit rate and apply it - word problem",isNew:0},1165:{ID:1165,qID:54108,name:"What is the unit rate - word problem",isNew:0},1166:{ID:1166,qID:54509,name:"Fill in missing values on a line plot",isNew:0},1167:{ID:1167,qID:54159,name:"Unit rate - which is the better buy",isNew:0},1168:{ID:1168,qID:54209,name:"Which coupon is better",isNew:0},1169:{ID:1169,qID:54259,name:"Find the new price",isNew:0},1170:{ID:1170,qID:54359,name:"Unit rate - which is the better buy with conversion",isNew:0},1171:{ID:1171,qID:54459,name:"Conversions with ratios",isNew:0},1172:{ID:1172,qID:54559,name:"Use line graph to fill in missing values in table of ordered pairs",isNew:0},1173:{ID:1173,qID:54609,name:"Scaling mixed numbers by fractions",isNew:0},1174:{ID:1174,qID:54711,name:"Create a line plot from a chart",isNew:0},1175:{ID:1175,qID:54761,name:"Determine angle sum or part",isNew:0},1176:{ID:1176,qID:54660,name:"Complete a two-way table",isNew:0},1177:{ID:1177,qID:54811,name:"Relative frequency from a two-way table",isNew:0},1178:{ID:1178,qID:54911,name:"Make an equivalent fraction using fraction strips",isNew:0},1179:{ID:1179,qID:54861,name:"Volume of spheres, cones, and cylinders",isNew:0},1180:{ID:1180,qID:54961,name:"Make an equivalent fraction using fraction strips (denominators 2,3,4,6,8)",isNew:0},1181:{ID:1181,qID:55061,name:"Missing number addition from 11 to 20",isNew:0},1182:{ID:1182,qID:55807,name:"Missing number subtraction from 11 to 20",isNew:0},1183:{ID:1183,qID:56421,name:"Addition from 11 to 20 word problems",isNew:0},1184:{ID:1184,qID:55858,name:"Subtraction from 11 to 20 word problems",isNew:0},1185:{ID:1185,qID:55213,name:"Addition sentence from number line - to 20",isNew:0},1186:{ID:1186,qID:55263,name:"Subtraction sentence from number line - to 20",isNew:0},1187:{ID:1187,qID:55313,name:"Addition to 20 on a number line",isNew:0},1188:{ID:1188,qID:55363,name:"Subtraction to 20 on a number line",isNew:0},1189:{ID:1189,qID:55413,name:"Missing number addition from 1 to 20",isNew:0},1190:{ID:1190,qID:55463,name:"Missing number subtraction from 1 to 20",isNew:0},1191:{ID:1191,qID:55513,name:"Write the inverse of a subtraction sentence - to 20",isNew:0},1192:{ID:1192,qID:56371,name:"Addition one step word problems with numbers up to 100",isNew:0},1193:{ID:1193,qID:55569,name:"Write the inverse of an addition sentence - to 20",isNew:0},1194:{ID:1194,qID:55707,name:"Inverse of a subtraction sentence - to 20",isNew:0},1195:{ID:1195,qID:55757,name:"Inverse of an addition sentence - to 20",isNew:0},1197:{ID:1197,qID:55908,name:"Subtraction one step word problems with numbers up to 100",isNew:0},1198:{ID:1198,qID:55958,name:"Counting forward by 1s to 120",isNew:0},1199:{ID:1199,qID:56008,name:"Counting forward by 2s to 120",isNew:0},1200:{ID:1200,qID:56058,name:"Counting forward by 10s to 120",isNew:0},1201:{ID:1201,qID:56108,name:"Counting forward by 1s, 2s, 5s, and 10s to 120",isNew:0},1202:{ID:1202,qID:56571,name:"Write equation from addition (to 100) word problem and solve, two-step",isNew:0},1203:{ID:1203,qID:56158,name:"Counting on a number line",isNew:0},1204:{ID:1204,qID:56208,name:"Tens and ones with base ten blocks",isNew:0},1205:{ID:1205,qID:56258,name:"Tens and ones on a hundreds chart",isNew:0},1206:{ID:1206,qID:56621,name:"Solve two-step addition word problem",isNew:0},1207:{ID:1207,qID:56471,name:"Select the correct subtraction equation - to 20",isNew:0},1208:{ID:1208,qID:56521,name:"Select the correct addition equation",isNew:0},1209:{ID:1209,qID:56671,name:"Missing minuend in a table - to 20",isNew:0},1210:{ID:1210,qID:56721,name:"Missing addend in a table - to 20",isNew:0},1211:{ID:1211,qID:56821,name:"Write addition equation from one-step word problems with numbers up to 100 and solve.",isNew:0},1212:{ID:1212,qID:56771,name:"Pick addition or subtraction - to 20",isNew:0},1213:{ID:1213,qID:57023,name:"Select the inverse of an addition sentence (numbers to 100)",isNew:0},1214:{ID:1214,qID:56973,name:"Inverse of a subtraction sentence (numbers to 100)",isNew:0},1215:{ID:1215,qID:56873,name:"Write the inverse of an addition sentence (numbers to 100)",isNew:0},1216:{ID:1216,qID:56923,name:"Write Inverse of a subtraction sentence (numbers to 100)",isNew:0},1217:{ID:1217,qID:57123,name:"Write subtraction sentence (numbers to 100) from number line",isNew:0},1218:{ID:1218,qID:57073,name:"Write addition sentence (numbers to 100) from number line",isNew:0},1219:{ID:1219,qID:57173,name:"Write subtraction equation from one step word problems with numbers up to 100",isNew:0},1220:{ID:1220,qID:57223,name:"Comparing numbers to 120 using symbols",isNew:0},1221:{ID:1221,qID:58075,name:"Write equation from subtraction (to 100) word problem and solve, two step",isNew:0},1222:{ID:1222,qID:58125,name:"Solve two-step subtraction word problem (to 100)",isNew:0},1223:{ID:1223,qID:57273,name:"Add two-digit and one-digit in a PVC",isNew:0},1224:{ID:1224,qID:57323,name:"Add two-digit numbers in a PVC",isNew:0},1225:{ID:1225,qID:57469,name:"Add a multiple of 10 to a 3 digit number",isNew:0},1226:{ID:1226,qID:57969,name:"Subtract a multiple of 10 from a 3 digit number",isNew:0},1227:{ID:1227,qID:57373,name:"Add two digits and multiples of 10",isNew:0},1228:{ID:1228,qID:57423,name:"Composing a ten",isNew:0},1229:{ID:1229,qID:57519,name:"Write and solve addition equation from word problem - to 20",isNew:0},1230:{ID:1230,qID:57719,name:"Write and solve subtraction equation from word problem - to 20",isNew:0},1231:{ID:1231,qID:57569,name:"Hundreds, tens, and ones in a PVC",isNew:0},1232:{ID:1232,qID:57619,name:"Hundreds, tens, and ones with base ten blocks",isNew:0},1233:{ID:1233,qID:57669,name:"Add a multiple of 100 to a 3 digit number",isNew:0},1234:{ID:1234,qID:57769,name:"Solve addition from word problem - 3 numbers to 20",isNew:0},1235:{ID:1235,qID:57819,name:"Pick addition or subtraction within 1000",isNew:0},1236:{ID:1236,qID:57869,name:"Select the correct subtraction equation to 1000",isNew:0},1237:{ID:1237,qID:57919,name:"Select the correct addition equation to 1000",isNew:0},1239:{ID:1239,qID:58019,name:"Subtract a multiple of 100 from a 3 digit number",isNew:0},1240:{ID:1240,qID:58175,name:"Read and print whole numbers to 1000",isNew:0},1241:{ID:1241,qID:58225,name:"Write numbers in expanded form to 1000",isNew:0},1242:{ID:1242,qID:58275,name:"Missing addend in a table to 1000",isNew:0},1243:{ID:1243,qID:58325,name:"Missing minuend in a table to 1000",isNew:0},1244:{ID:1244,qID:58425,name:"Addition sentence from number line to 1000",isNew:0},1245:{ID:1245,qID:58475,name:"Subtraction sentence from number line to 1000",isNew:0},1246:{ID:1246,qID:58525,name:"Divide a whole circle into equal parts (2,3,4)",isNew:0},1247:{ID:1247,qID:58548,name:"Divide a whole circle into equal parts (2,4)",isNew:0},1248:{ID:1248,qID:58567,name:"Identify partitions of circles and rectangles",isNew:0},1249:{ID:1249,qID:58597,name:"Identify partitions of circles and rectangles",isNew:0},1251:{ID:1251,qID:58619,name:"Missing numbers in a pattern to 20",isNew:0},1252:{ID:1252,qID:58669,name:"Even or odd number of objects to 20",isNew:0},1253:{ID:1253,qID:58719,name:"Split even number into two addends to 100",isNew:0},1254:{ID:1254,qID:58767,name:"Difference between values in a table to 20",isNew:0},1255:{ID:1255,qID:58817,name:"Missing numbers in a pattern to 1000",isNew:0},1256:{ID:1256,qID:58918,name:"Count the counters and then fill in the number of tens and ones in the number",isNew:0},1257:{ID:1257,qID:59018,name:"Create a scatter plot from table",isNew:0},1259:{ID:1259,qID:58968,name:"Counting with counters and write the number (up to 34)",isNew:0},1260:{ID:1260,qID:59100,name:"Is this line a good fit",isNew:0},1264:{ID:1264,qID:59324,name:"Show a number up to 20 using counters",isNew:0},1265:{ID:1265,qID:59364,name:"Show addition sentence using counters (within 20)",isNew:0},1266:{ID:1266,qID:59463,name:"Show subtraction using counters (within 20)",isNew:0},1267:{ID:1267,qID:59464,name:"Clicking on a hundreds chart",isNew:0},1268:{ID:1268,qID:59564,name:"Show a number using base ten blocks",isNew:0},1269:{ID:1269,qID:59614,name:"Addition to 20 from word problem using tens frames",isNew:0},1270:{ID:1270,qID:59942,name:"Fill in missing values on a line plot of lengths",isNew:0},1271:{ID:1271,qID:59665,name:"Subtraction within 20 from word problem using tens frames",isNew:0},1272:{ID:1272,qID:59715,name:"Addition to 20 with 3 numbers from word problem using tens frames",isNew:0},1273:{ID:1273,qID:59765,name:"How many tens and ones in tens frames to 20",isNew:0},1274:{ID:1274,qID:59816,name:"How many from a table to 20",isNew:0},1275:{ID:1275,qID:59866,name:"Subtracting multiples of 10 within 100 on a hundreds chart",isNew:0},1276:{ID:1276,qID:59910,name:"Graph unit rate from word problem",isNew:0},1277:{ID:1277,qID:59941,name:"Graph unit rate",isNew:0},1278:{ID:1278,qID:60021,name:"Create a line plot of length measurements",isNew:0},1279:{ID:1279,qID:60071,name:"Fill in missing values on a line plot of lengths in inches (wholes, halves, quarters)",isNew:0},1280:{ID:1280,qID:60173,name:"Create a bar graph, up to 4 categories",isNew:0},1281:{ID:1281,qID:60223,name:"Addition and Subtraction word problems with lengths up to 100",isNew:0},1282:{ID:1282,qID:60430,name:"Counting forward by 1s between 100 - 200 on number line",isNew:0},1283:{ID:1283,qID:60480,name:"Counting forward by 2s between 100 - 200 on number line",isNew:0},1284:{ID:1284,qID:60380,name:"Counting forward by 5s between 100 - 200 on number line",isNew:0},1285:{ID:1285,qID:60530,name:"Counting forward by 10s and 25s between 100 - 200 on number line",isNew:0},1286:{ID:1286,qID:60580,name:"Counting forward by 1s, 2s, 5s, 10s, 25s between 100-200 on a number line",isNew:0},1287:{ID:1287,qID:62600,name:"Nearest 10 to 2-digit number on a number line",isNew:0},1288:{ID:1288,qID:60767,name:"Counting backward by 10s between 1- 100 on number line",isNew:0},1289:{ID:1289,qID:60630,name:"Counting backward by 1s between 1- 50 on number line",isNew:0},1290:{ID:1290,qID:60274,name:"Multiply by 1 - up to 7",isNew:0},1291:{ID:1291,qID:60289,name:"Multiply by 2 - up to 7",isNew:0},1292:{ID:1292,qID:60304,name:"Multiply by 3 - up to 7",isNew:0},1293:{ID:1293,qID:60319,name:"Multiply by 4 - up to 7",isNew:0},1294:{ID:1294,qID:60334,name:"Multiply by 5 - up to 7",isNew:0},1295:{ID:1295,qID:60349,name:"Multiply by 6 - up to 7",isNew:0},1296:{ID:1296,qID:60364,name:"Multiply by 7 - up to 7",isNew:0},1297:{ID:1297,qID:60680,name:"Counting forward by 1s to 1000 - on a number line",isNew:0},1298:{ID:1298,qID:60730,name:"Counting forward by 25s to 1000 - on a number line",isNew:0},1299:{ID:1299,qID:60817,name:"Counting forward by 10 and 100 to 1000 - on a number line",isNew:0},1300:{ID:1300,qID:60867,name:"Counting forward by 5s to 1000 - on a number line",isNew:0},1301:{ID:1301,qID:60917,name:"Counting forward by 2s to 1000 - on a number line",isNew:0},1302:{ID:1302,qID:60967,name:"Choose equivalent subtraction sentence",isNew:0},1303:{ID:1303,qID:61017,name:"Identifying 3D shapes with names (prisms and pyramids)",isNew:0},1304:{ID:1304,qID:61032,name:"Writing a pattern rule from number line - drop down",isNew:0},1305:{ID:1305,qID:62656,name:"Comparing numbers 50-100(greatest) using base ten blocks",isNew:0},1306:{ID:1306,qID:61184,name:"Comparing numbers 0-50(greatest) using number line",isNew:0},1307:{ID:1307,qID:61134,name:"Comparing numbers 0-50(least) using number line",isNew:0},1308:{ID:1308,qID:61084,name:"Greater than or less than numbers 0-50, using number line",isNew:0},1309:{ID:1309,qID:61334,name:"Comparing numbers 50-100(greatest) using number line",isNew:0},1310:{ID:1310,qID:61284,name:"Comparing numbers 50-100(least) using number line",isNew:0},1311:{ID:1311,qID:61234,name:"Greater than or less than numbers 50-100, using number line",isNew:0},1312:{ID:1312,qID:61393,name:"Locate number on number line (to 100)",isNew:0},1313:{ID:1313,qID:61443,name:"Counting backward by 100s from 1000 - number line",isNew:0},1314:{ID:1314,qID:61493,name:"Counting backward by 2s, 5s, and 10s from 100 - number line",isNew:0},1315:{ID:1315,qID:61543,name:"Reading a line plot",isNew:0},1316:{ID:1316,qID:62300,name:"Order 3 numbers between 50-100, using number line",isNew:0},1317:{ID:1317,qID:61593,name:"Conversion problems (hours and minutes)",isNew:0},1318:{ID:1318,qID:61633,name:"Conversion problems (hours and minutes) - table",isNew:0},1319:{ID:1319,qID:61674,name:"Conversion problems (hours, days, weeks, years)",isNew:0},1321:{ID:1321,qID:61716,name:"Conversion problems (hours, days, weeks, years) - table",isNew:0},1322:{ID:1322,qID:61758,name:"Counting forward by 1s to 100 - hundreds chart",isNew:0},1323:{ID:1323,qID:61808,name:"Counting forward by 2s to 100 - hundreds chart",isNew:0},1324:{ID:1324,qID:61858,name:"Counting forward by 5s to 100 - hundreds chart",isNew:0},1325:{ID:1325,qID:61908,name:"Counting forward by 10s to 100 - hundreds chart",isNew:0},1326:{ID:1326,qID:61958,name:"Counting forward by 1s, 2s, 5s, and 10s to 100 - hundreds chart",isNew:0},1327:{ID:1327,qID:62008,name:"Counting forward by 1s to 100 - number line",isNew:0},1328:{ID:1328,qID:62058,name:"Counting forward by 10s to 100 - number line",isNew:0},1329:{ID:1329,qID:62108,name:"Counting forward by 1s, 2s, 5s, and 10s to 100 - number line",isNew:0},1330:{ID:1330,qID:62158,name:"Counting forward by 2s to 100 - number line",isNew:0},1331:{ID:1331,qID:62208,name:"Counting forward by 5s to 100 - number line",isNew:0},1332:{ID:1332,qID:62261,name:"Count backward by 1s, 2s, and 5s from 20 - number line",isNew:0},1333:{ID:1333,qID:62350,name:"Order 3 numbers between 0-100, using number line",isNew:0},1334:{ID:1334,qID:62400,name:"Order 3 numbers between 0-50, using number line",isNew:0},1335:{ID:1335,qID:62550,name:"Comparing 3 numbers 0-100(greatest) using number line",isNew:0},1336:{ID:1336,qID:62500,name:"Comparing 3 numbers 0-100(least) using number line",isNew:0},1337:{ID:1337,qID:62450,name:"Greater than or less than numbers 0-100, using number line",isNew:0},1338:{ID:1338,qID:62706,name:"Comparing numbers 50-100(least) using base ten blocks",isNew:0},1340:{ID:1340,qID:62756,name:"Comparing numbers 0-100(least) using base ten blocks",isNew:0},1341:{ID:1341,qID:62806,name:"Comparing numbers 0-100 (greatest) using base ten blocks",isNew:0},1342:{ID:1342,qID:62856,name:"Comparing numbers 0-50(least) using base ten blocks",isNew:0},1343:{ID:1343,qID:62906,name:"Comparing numbers 0-50(greatest) using base ten blocks",isNew:0},1344:{ID:1344,qID:62958,name:"Greater or less than numbers 0-50, using base ten blocks",isNew:0},1345:{ID:1345,qID:63008,name:"Greater or less,  numbers 50-100, using base ten blocks",isNew:0},1346:{ID:1346,qID:63058,name:"Greater or less,  numbers 0-100, using base ten blocks",isNew:0},1348:{ID:1348,qID:63340,name:"Show a number to 50 using base ten blocks",isNew:0},1349:{ID:1349,qID:63390,name:"Show a number to 100 using base ten blocks",isNew:0},1350:{ID:1350,qID:63290,name:"Compose a number to 100 using base ten blocks, with regrouping",isNew:0},1351:{ID:1351,qID:63240,name:"Compose a number using base ten blocks, to 100, no regrouping",isNew:0},1352:{ID:1352,qID:63155,name:"Compose a number to 50 using base ten blocks",isNew:0},1353:{ID:1353,qID:63109,name:"Add missing counters - to 10",isNew:0},1354:{ID:1354,qID:63154,name:"Single digit addition to 9 - tens frame",isNew:0},1356:{ID:1356,qID:63542,name:"Missing number addition to 10 - number line",isNew:0},1357:{ID:1357,qID:63587,name:"Missing number subtraction to 10 - number line",isNew:0},1360:{ID:1360,qID:63688,name:"Rules for multiplying integers",isNew:0},1361:{ID:1361,qID:63740,name:"Rules for dividing integers",isNew:0},1362:{ID:1362,qID:63790,name:"Multiply and divide integers",isNew:0},1363:{ID:1363,qID:63840,name:"Divisibility rules",isNew:0},1364:{ID:1364,qID:63890,name:"Understanding integers",isNew:0},1365:{ID:1365,qID:63940,name:"Representing integers - text box",isNew:0},1367:{ID:1367,qID:63990,name:"Unit price",isNew:0},1368:{ID:1368,qID:64090,name:"2-step world problems with all operations with math sentences",isNew:0},1369:{ID:1369,qID:64040,name:"Equivalent subtraction and addition sentences - text box",isNew:0},1370:{ID:1370,qID:64140,name:"Subtraction to 20 in a number line - missing first number",isNew:0},1371:{ID:1371,qID:64190,name:"Missing first number addition to 20 - number line",isNew:0},1372:{ID:1372,qID:64240,name:"Addition family facts up to 20",isNew:0},1373:{ID:1373,qID:64290,name:"Identify multiplication facts in distributive property (drop down)",isNew:0},1374:{ID:1374,qID:64338,name:"Multiplication and division word problems - step by step",isNew:0},1375:{ID:1375,qID:64388,name:"Mixed number written as an improper fraction - step-by-step",isNew:0},1376:{ID:1376,qID:64438,name:"Represent mixed fractions using fraction strips",isNew:0},1377:{ID:1377,qID:64482,name:"Represent improper fractions using fraction strips",isNew:0},1378:{ID:1378,qID:64526,name:"Understanding Parts of a Vertical and Horizontal Bar Graph",isNew:0},1379:{ID:1379,qID:64762,name:"Investigating scale of bar graphs, multiple choice",isNew:0},1380:{ID:1380,qID:64554,name:"Missing fraction addend, no reducing",isNew:0},1381:{ID:1381,qID:64612,name:"Missing fraction subtrahend, no reducing",isNew:0},1382:{ID:1382,qID:64662,name:"Perimeter of rectangles (metric) - multiple choice",isNew:0},1383:{ID:1383,qID:64712,name:"Perimeter of rectangles (imperial) - multiple choice",isNew:0},1384:{ID:1384,qID:64802,name:"Perimeter of rectangles (metric) - text box",isNew:0},1385:{ID:1385,qID:64852,name:"Perimeter of rectangles (imperial) - text box",isNew:0},1386:{ID:1386,qID:64902,name:"Missing measurement using perimeter of rectangles (metric)",isNew:0},1387:{ID:1387,qID:64952,name:"Missing measurement using perimeter of rectangles (imperial)",isNew:0},1388:{ID:1388,qID:65002,name:"Match rectangle to perimeter (metric)",isNew:0},1389:{ID:1389,qID:65052,name:"Match rectangle to perimeter (imperial)",isNew:0},1390:{ID:1390,qID:65102,name:"Addition by 10s",isNew:0},1391:{ID:1391,qID:65152,name:"Subtraction through decomposition",isNew:0},1392:{ID:1392,qID:65202,name:"Addition through decomposition",isNew:0},1395:{ID:1395,qID:65242,name:"Find 2 numbers based on sum (up to 100) and difference, multiple choice",isNew:0},1396:{ID:1396,qID:65342,name:"Find 2 numbers based on sum (up to 20) and difference, multiple choice",isNew:0},1397:{ID:1397,qID:65292,name:"Find 2 numbers based on sum (up to 20) and difference",isNew:0},1398:{ID:1398,qID:65392,name:"Mixed fraction on a number line",isNew:0},1399:{ID:1399,qID:65792,name:"Area of rectangles (metric) - multiple choice",isNew:0},1400:{ID:1400,qID:65442,name:"Volume of rectangular prisms (imperial) - multiple choice",isNew:0},1401:{ID:1401,qID:65492,name:"Select the pair of numbers that does not sum to a number up to 100, multiple choice.",isNew:0},1402:{ID:1402,qID:65542,name:"Select the pair of numbers that has a given difference, numbers up to 100, multiple choice",isNew:0},1403:{ID:1403,qID:65592,name:"Select the pair of numbers that does not sum to a number up to 20, multiple choice.",isNew:0},1404:{ID:1404,qID:65642,name:"Select the pair of numbers that has a given difference, up to 20, multiple choice",isNew:0},1405:{ID:1405,qID:65692,name:"Complete pairs to match a sum to a number up to 20",isNew:0},1406:{ID:1406,qID:65742,name:"Complete pairs to match a difference, up to 20.",isNew:0},1407:{ID:1407,qID:65842,name:"Area of rectangles (imperial) - multiple choice",isNew:0},1408:{ID:1408,qID:65892,name:"Area of rectangles (metric) - text box",isNew:0},1409:{ID:1409,qID:65942,name:"Area of rectangles (imperial) - text box",isNew:0},1410:{ID:1410,qID:65992,name:"Match rectangle to area (imperial)",isNew:0},1411:{ID:1411,qID:66042,name:"Match rectangle to area (metric)",isNew:0},1415:{ID:1415,qID:66242,name:"Place fractions as decimals on number line",isNew:0},1423:{ID:1423,qID:66347,name:"Subtraction with images- towards 20",isNew:0},1424:{ID:1424,qID:66397,name:"Subtraction sentences with images.",isNew:0},1425:{ID:1425,qID:66497,name:"Describing subtraction sentences using images",isNew:0},1426:{ID:1426,qID:66447,name:"Subtraction sentence using images- multiple choice",isNew:0},1427:{ID:1427,qID:66578,name:"Dividing decimals by 10 and 100 - missing divisor",isNew:0},1428:{ID:1428,qID:66539,name:"Subtraction word problems with images- within 20",isNew:0},1429:{ID:1429,qID:66628,name:"Multiplying decimals by 10, 100, 1000, and 10000 - missing multiplier",isNew:0},1430:{ID:1430,qID:66678,name:"Multiplying decimals by 10, 100, 1000, and 10000 - multiple choice",isNew:0},1431:{ID:1431,qID:66728,name:"Dividing decimals by 10 and 100 - multiple choice",isNew:0},1432:{ID:1432,qID:66778,name:"Volume of triangular prisms (imperial) - text box",isNew:0},1433:{ID:1433,qID:66828,name:"Volume of triangular prisms (imperial) - multiple choice",isNew:0},1434:{ID:1434,qID:66878,name:"Volume of triangular prisms (metric) - multiple choice",isNew:0},1435:{ID:1435,qID:66928,name:"Volume of triangular prisms (metric) - text box",isNew:0},1436:{ID:1436,qID:66978,name:"Select addition rule from In/Out table, numbers 0 to 20",isNew:0},1437:{ID:1437,qID:67028,name:"Select subtraction rule from In/Out table, numbers 0 to 20",isNew:0},1438:{ID:1438,qID:67178,name:"Complete In/Out table when given the addition rule, numbers 0 to 20",isNew:0},1439:{ID:1439,qID:67128,name:"Complete In/Out table when given the subtraction rule, numbers 0 to 20",isNew:0},1440:{ID:1440,qID:67078,name:"Select addition rule from In/Out table, numbers to 1000",isNew:0},1441:{ID:1441,qID:67228,name:"Select subtraction rule from In/Out table, numbers to 1 000",isNew:0},1442:{ID:1442,qID:67278,name:"Complete In/Out table when given the addition rule with numbers up to 1000",isNew:0},1443:{ID:1443,qID:67428,name:"Complete In/Out table when given the subtraction rule with numbers up to 1000",isNew:0},1444:{ID:1444,qID:67328,name:"Select place & value of a digit to tens",isNew:0},1445:{ID:1445,qID:67378,name:"Select place & value of a digit to hundreds",isNew:0},1446:{ID:1446,qID:67478,name:"Select the correct statement about the place & value of a digit to hundreds",isNew:0},1447:{ID:1447,qID:67528,name:"Select the correct statement about the place & value of a digit to tens",isNew:0},1448:{ID:1448,qID:67579,name:"Group of tens and ones from a number to 100 in a Place Value Chart",isNew:0},1449:{ID:1449,qID:67629,name:"Select how many from a picture graph",isNew:0},1450:{ID:1450,qID:67679,name:"Add integers using integer tiles",isNew:1},1451:{ID:1451,qID:67781,name:"Divide a rectangle into equal parts (2,4)",isNew:1},1452:{ID:1452,qID:67846,name:"Divide a rectangle into equal parts (2,3,4)",isNew:1},1453:{ID:1453,qID:67681,name:"How many from a picture graph",isNew:0},1454:{ID:1454,qID:67731,name:"How many in total from a picture graph",isNew:0},1455:{ID:1455,qID:67869,name:"Determine which sum is greater using integer tiles",isNew:1}},SW.Device={},SW.Device.isWindows=function(){return navigator.appVersion.indexOf("Win")!=-1},SW.Device.isIpad=function(){return null!=navigator.userAgent.match(/iPad/i)},SW.Device.isIphone=function(){return null!=navigator.userAgent.match(/iPhone/i)},SW.Device.isEdge=function(){return null!=navigator.userAgent.match(/Edge/i)},SW.Device.isLargeResolutionIpad=function(){return!(!SW.Device.isIpad()||!(screen.availWidth>768&&screen.availHeight>1024||screen.availWidth>1024&&screen.availHeight>768||window.devicePixelRatio>=2))},SW.Device.getIOSVersion=function(){if(/iP(hone|od|ad)/.test(navigator.platform)){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e=[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)],e[0]}return!1},SW.Device.isIOS=function(){var e=navigator.userAgent,t=/iPad/i.test(e)||/iPhone/i.test(e);return t},SW.Device.isIOSApp=function(){return!!SW.Utility.getUrlVar("iosApp")},SW.Device.isDeprecatedIpad=function(){return!!(SW.Device.isIpad()&&(screen.availWidth<=768&&screen.availHeight<=1024||screen.availWidth<=1024&&screen.availHeight<=768)&&window.devicePixelRatio<2)},SW.Device.isDeprecatedIphone=function(){var e=320,t=480;return!(!SW.Device.isIphone()||!(screen.availWidth<=e&&screen.availHeight<=t||screen.availWidth<=t&&screen.availHeight<=e))},SW.SocialMedia={},SW.SocialMedia.popup=function(e,t){var i,s,n,a;return null===t&&(t={}),s={width:500,height:350},s.top=screen.height/2-s.height/2,s.left=screen.width/2-s.width/2,n=function(){var e;e=[];for(i in t)a=t[i],e.push(i+"="+SW.SocialMedia.encode(a));return e}.call(SW.SocialMedia).join("&"),n&&(n="?"+n),window.open(e+n,"targetWindow","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,left="+s.left+",top="+s.top+",width="+s.width+",height="+s.height)},SW.SocialMedia.is_encoded=function(e){return e=e.to_rfc3986(),decodeURIComponent(e)!==e},SW.SocialMedia.encode=function(e){return"undefined"==typeof e||SW.SocialMedia.is_encoded(e)?e:e.to_rfc3986()},SW.Storage={},SW.Storage.get=function(e){return JSON.parse(localStorage.getItem(e))},SW.Storage.set=function(e,t){localStorage.setItem(e,JSON.stringify(t))},SW.Browser={},function(){function e(e,t,i){i.length&&(e=e||"%c %s",t=t||"color: #bada55;",i=[e,t].concat(i),console.log.apply(console,i))}console.todo=function(){var t=[].splice.call(arguments,0);t.unshift("TODO: "),e("%c %s %s","background-color: #000; color: #bada55",t)},console.viewLog=function(){var t=[].splice.call(arguments,0);t.unshift("view: "),e("%c %s %s","background-color: purple; color: #fff;",t)}}(),function(){function e(e){var t={};return _.forEach(e,function(e,i){t[e.type]=t[e.type]||[],t[e.type].push(i)}),t}var t,i={mariner:{type:"vibrant",hex:"#3498db"},fiord:{type:"vibrant",hex:"#34495e"},buttercup:{type:"vibrant",hex:"#f1c30f"},seafoam:{type:"vibrant",hex:"#1abb9b"},eucalyptus:{type:"vibrant",hex:"#2DAF4A"},wisteria:{type:"vibrant",hex:"#9b59b5"},tango:{type:"vibrant",hex:"#f39c12"},"mariner-dark":{type:"vibrant-dark",hex:"#2980b9"},"fiord-dark":{type:"vibrant-dark",hex:"#2c3e50"},"buttercup-dark":{type:"vibrant-dark",hex:"#e2961b"},"seafoam-dark":{type:"vibrant-dark",hex:"#169f85"},"wisteria-dark":{type:"vibrant-dark",hex:"#8d44ad"
},"tango-dark":{type:"vibrant-dark",hex:"#e67e22"},mystic:{type:"grayscale",hex:"#f9f9f9"},ghost:{type:"grayscale",hex:"#eeeeee"},alto:{type:"grayscale",hex:"#e0e0e0"},dove:{type:"grayscale",hex:"#696969"},dusty:{type:"grayscale",hex:"#999999"}},s=e(i);t={get:function(e){return i[e].hex},colorizeID:function(e){return this.get(s.vibrant[e%s.vibrant.length])}},window.SW.Colors=t}(),function(){var e={parent:{student:"kid","student's":"kid's",students:"kids","students'":"kids'",Student:"Kid","Student's":"Kid's",Students:"Kids","Students'":"Kids'"},teacher:{student:"student","student's":"student's",students:"students","students'":"students'",Student:"Student","Student's":"Student's",Students:"Students","Students'":"Students'"}};SW.Lexicon=function(t){var i=sw.user.get("usertype"),s=e[i];return s[t]}}(),SW.Logger=function(){function e(e){SW.Http.fetch(e)}function t(e){for(var t=_.isPlainObject(e)?Object.keys(e):[],i=t.length===n.length,s=0;i&&s<t.length;)i=_.indexOf(n,t[s])>-1,s+=1;return!i}function i(){var e=sw.user.toJSON(),t=[];return{id:e.userID,type:e.isAdmin?"admin":e.usertype,"register-date":e.registerDate,"location-id":null,referral:null,groups:t}}var s={},n=["name","details","user"],a={name:null,details:null,user:null},r={Authorization:"Token 9843f2fbf73180ca270feee7fd8f8d3043200443",X_ORG_ID:"ce2a5fb8-c468-4b35-ae51-b37c24e60526"};return s.pageView=function(e){this.track({name:"page-view",details:{page:e,origin:window.location.origin,pathname:window.location.pathname,hash:window.location.hash}})},s.track=function(s){var n,r=_.isString(s)?{name:s}:s||{};n=_.assign({},a,r,{user:i()}),t(n)?console.warn("Invalid event schema for:",n.name):e({url:sw.config.api.events+"/v1/web-event",method:"POST",data:{event:JSON.stringify(n)}})},s.trackStudent=function(e,t,i){var s=_.extend({},i);s.user.type="student",$.ajax({url:sw.config.api.events+"/v1/game-event",method:"POST",data:{event:JSON.stringify(s),userID:e,token:t}})},s.trackInfluitiveRegister=function(e,t){var i=this,s=sw.user.get("name").split(" "),n=s.shift(),a=s.join(" ");document.domain.indexOf("prodigygame.com")>=0&&$.ajax({url:"https://api.influitive.com/referrals",method:"POST",headers:r,data:{referral:{prospect:{email:sw.user.get("email"),first_name:n,last_name:a},contact:{share_token:t},campaign_id:e,status:"submitted"}},success:function(e){e.referral&&e.referral.id&&i.advanceInfluitiveReferral(e.referral.id,"qualified")}})},s.advanceInfluitiveReferral=function(e,t){$.ajax({url:"https://api.influitive.com/referrals/"+e+"/milestones/"+t,method:"PUT",headers:r})},s}(),SW.Model=Backbone.Model.extend({listenToAll:function(e,t,i){var s=[],n={},a=this;_.isUndefined(i)&&(i=a),e.forEach(function(r){a.listenTo(r.context,r.event,function(a){s.indexOf(r.event)===-1&&(s.push(r.event),_.isUndefined(r.returnData)||(n=a),s.length==e.length&&t.call(i,n))})})}}),SW.View=Backbone.View.extend({initialize:function(e){this.dialog=_.isObject(e)?e.dialog:void 0},listenToAll:function(e,t,i){var s=[],n={},a=this;_.isUndefined(i)&&(i=a),e.forEach(function(r){a.listenTo(r.context,r.event,function(a){s.indexOf(r.event)===-1&&(s.push(r.event),_.isUndefined(r.returnData)||(n=a),s.length==e.length&&t.call(i,n))})})},showTooltip:function(e){var t;e.anchor||(e.anchor=$(e.event.currentTarget)),t=new SW.Tooltip(e),this.tooltip=new SW.TooltipView({model:t}),this.tooltip.render()},hideTooltip:function(){_.isUndefined(this.tooltip)||this.tooltip.close()},resizeParentDialog:function(){this.dialog&&sw.dispatcher.trigger("dialog:resize")},findTemplate:function(e){return Handlebars.compile($("#"+e+"-template").html())},close:function(){this.remove(),this.unbind(),this.onClose&&this.onClose(),this.trigger("close")},initializeLoadingSpinner:function(){this.isLoadingSpinnerActive=!1,this.$loadingSpinner,this.loadingSpinnerHTML='<div class="spinner-block"><img class="spinner" src="/assets/images/svg/tail-spin.svg" alt="Content is loading."></div>'},addLoadingSpinner:function(e){var t=this;console.log("<DEPRECATED> Add loading spinner."),e=e||t.$el,t.$loadingSpinner=$(t.loadingSpinnerHTML),e.append(t.$loadingSpinner),t.isLoadingSpinnerActive=!0},removeLoadingSpinner:function(){console.log("<DEPRECATED> Remove loading spinner."),this.$loadingSpinner.remove(),this.$loadingSpinner=null,this.isLoadingSpinnerActive=!1}}),SW.Collection=Backbone.Collection.extend({listenToAll:function(e,t,i){var s=[],n={},a=this;_.isUndefined(i)&&(i=a),e.forEach(function(r){a.listenTo(r.context,r.event,function(a){s.indexOf(r.event)===-1&&(s.push(r.event),_.isUndefined(r.returnData)||(n=a),s.length==e.length&&t.call(i,n))})})},saveToStorage:function(e){SW.Storage.set(e,this.toJSON())},loadFromStorage:function(e){var t=SW.Storage.get(e);this.reset(t)}}),SW.Config=SW.Model.extend({initialize:function(){this._multipleClassesDevReleaseDateString="August 4, 2016",this._multipleClassesLiveReleaseDateString="August 9, 2016",document.domain.indexOf("prodigygame.com")>=0?this.initializeLive():document.domain.indexOf("www.prodigygame.org")>=0?this.initializeStaging():this.initializeDev()},initializeLive:function(){this.api={web:"https://prodigygame.com/web-api",accounts:"https://prodigygame.com/account-api",toy:"https://prodigygame.com/toy-api",planner:"https://prodigygame.com/planner-api",notifications:"https://prodigygame.com/notification-api",assignments:"https://prodigygame.com/assignment-api",education:"https://prodigygame.com/education-api",events:"https://event-api.prodigygame.com/events-api",membership:"https://prodigygame.com/membership-api",game:"https://prodigygame.com/game-api",reports:"https://prodigygame.com/report-api"},this.statsStartTime=14875488e5,this.stripePublicKey="pk_live_M3pcr0YEp4395yqH5gHVsmhc",this.set("multipleClassesReleaseDate",new Date(this._multipleClassesLiveReleaseDateString))},initializeStaging:function(){this.api={accounts:"https://www.prodigygame.org/account-api",web:"https://www.prodigygame.org/web-api",toy:"https://www.prodigygame.org/toy-api",planner:"https://www.prodigygame.org/planner-api",notifications:"https://www.prodigygame.org/notification-api",assignments:"https://www.prodigygame.org/assignment-api",education:"https://www.prodigygame.org/education-api",events:"https://www.prodigygame.org/events-api",membership:"https://www.prodigygame.org/membership-api",game:"https://www.prodigygame.org/game-api",reports:"https://www.prodigygame.org/report-api"},this.statsStartTime=14875488e5,this.stripePublicKey="pk_test_IMt6DAznCfweWxpQMYEbDRFr",this.set("multipleClassesReleaseDate",new Date(this._multipleClassesDevReleaseDateString))},initializeDev:function(){this.api={accounts:"https://dev.prodigygame.org/account-api",web:"https://dev.prodigygame.org/web-api",toy:"https://dev.prodigygame.org/toy-api",planner:"https://dev.prodigygame.org/planner-api",notifications:"https://dev.prodigygame.org/notification-api",assignments:"https://dev.prodigygame.org/assignment-api",education:"https://dev.prodigygame.org/education-api",events:"https://dev.prodigygame.org/events-api",membership:"https://dev.prodigygame.org/membership-api",game:"https://dev.prodigygame.org/game-api",reports:"https://dev.prodigygame.org/report-api"},this.statsStartTime=14875488e5,this.stripePublicKey="pk_test_ZYIDOnDhEw9Dia61ad2FGHmH",this.set("multipleClassesReleaseDate",new Date(this._multipleClassesDevReleaseDateString))}}),SW.ParentView=SW.View.extend({initialize:function(){this._super("initialize",arguments),this.childViews={},this.isModalActive=!1,this._hasDialog=!1},setup:function(){this.renderBase(),this.initializeChildren()},renderBase:function(){this.$el.html(this.templateBase())},templateBase:function(){},initializeChildren:function(){},render:function(){},createDialog:function(e,t){var i=sw.dialogManager.open(e,t);return this._hasDialog=!0,this.listenToOnce(i,"close",function(){this._hasDialog=!1}),i},openDialog:function(){return this.createDialog.apply(this,arguments)},closeDialog:function(e){sw.dialogManager.closeDialog(e)},createTooltip:function(e){return this.closeTooltip(),this.childViews.tooltip=new SW.TooltipView({model:new SW.Tooltip(e)}),this.childViews.tooltip.render(),this.childViews.tooltip},closeTooltip:function(){this.childViews.tooltip&&(this.childViews.tooltip.close(),this.childViews.tooltip=null)},close:function(){this.closeChildViews(),this._hasDialog&&this.closeDialog(),this._super("close")},closeChildViews:function(){_.forEach(this.childViews,function(e){e&&_.isFunction(e.close)?e.close():(_.isArray(e)||_.isPlainObject(e))&&_.forEach(e,function(e){_.isFunction(e.close)&&e.close()})})}}),SW.ChildView=SW.View.extend({initialize:function(){this._super("initialize")}}),SW.PageView=SW.ParentView.extend({template:function(){},initialize:function(){this.startLoading(),this.initializePage()},initializePage:function(){},startLoading:function(){},render:function(){this.renderPage(),this.finishLoading()},renderPage:function(){},finishLoading:function(){},remove:function(){}}),SW.Page=SW.Model.extend({defaults:{},initialize:function(){}}),SW.User=SW.Model.extend({defaults:function(){var e={userID:prodigyWeb.session.userID,usertype:prodigyWeb.session.usertype,isAdmin:prodigyWeb.session.isAdmin,name:prodigyWeb.session.name,email:prodigyWeb.session.email,username:prodigyWeb.session.username,classCode:prodigyWeb.session.classCode,referralCode:prodigyWeb.session.referralCode,authKey:prodigyWeb.session.authKey,registerDate:prodigyWeb.session.registerDate,curriculumTreeID:parseInt(prodigyWeb.session.curriculumTreeID),curricula:[]};return e},initialize:function(){this._parentExperiments=[{validUserID:function(e){return e%2===1},dateRange:["2017-02-02","2017-02-09"]},{validUserID:function(e){return e%3>0},dateRange:["2017-02-25","2017-03-11"]},{name:"student-profiles",validUserID:function(e){return e%2===1},dateRange:["2017-03-16","2017-03-23"]}],this.setCurricula(this.get("curriculumTreeID")),this.students=new SW.StudentList,this.classes=new SW.ClassList,this.classes.parentApp=this.parentApp(),this.classes.setClasses(prodigyWeb.session.classes),this.tutorials=new SW.Tutorials,this.memberships=new SW.MembershipCollection,this.influencer=null},setCurricula:function(e){this.set("curricula",SW.Education.curricula[SW.Education.getCurriculumCodeFromTreeID(e)])},updateSession:function(e,t){SW.Http.fetch({url:"/Includes/Server/Session/updateSession.php",dataType:"json",method:"POST",data:e,success:t})},loadInfluencerData:function(){SW.Http.fetch({url:sw.config.api.web+"/v1/user/"+this.get("userID")+"/influencerpoints",dataType:"json",data:{userID:sw.user.get("userID")},success:function(e){this.configureInfluencerData(e),sw.dispatcher.trigger("user:load-influencer:success")}.bind(this),error:function(){sw.dispatcher.trigger("user:load-influencer:failed")}})},configureInfluencerData:function(e){var t=1e3;this.influencer=new SW.Model(e),this.influencer.set("referrals",e.referrals.sort(this.sortInfluencerReferrals));var i=Math.floor(e.totalPoints/t),s=0;e.redeemed.length>0&&(s=e.redeemed[0].quantity),this.influencer.set("increment",1e3),this.influencer.set("totalMemberships",i),this.influencer.set("claimedMemberships",s),this.influencer.set("unclaimedMemberships",Math.max(0,i-s)),this.influencer.set("numReferrals",e.referrals.length)},sortInfluencerReferrals:function(e,t){return e.referralActiveStudents>t.referralActiveStudents?-1:e.referralActiveStudents<t.referralActiveStudents?1:e.name.toLowerCase()>t.name.toLowerCase()?1:-1},getRewardedMemberships:function(e){},logout:function(){SW.Cookie.expire("sessionToken"),$.ajax({type:"POST",url:"/Includes/Server/Routers/User.php",data:{method:"logout"},success:function(){SW.Cookie.expire("hideMaintenanceMessage"),SW.Logger.track("logout"),location.href="/"}})},isParent:function(){return"parent"===this.get("usertype")},isTeacher:function(){return"teacher"===this.get("usertype")},isAdmin:function(){return this.get("isAdmin")},isLoggedIn:function(){return 0!=this.get("userID")},registeredAfter:function(e){var t=new Date(this.get("registerDate")),i=e;return t>i},registeredBefore:function(e){var t=new Date(this.get("registerDate")),i=e;return t<i},getCurriculumByID:function(e){return _.find(this.get("curricula"),function(t){return t.curriculumID===e})},isReturningToMultipleClasses:function(){var e,t=!1,i=sw.config.get("multipleClassesReleaseDate"),s=this.tutorials.isCompleted(SW.Tutorials.INTRO);return s&&(e=new Date(s.get("dateCompleted").substr(0,10).replace(/-/g,"/")),t=e<i),t},hasIncompleteCriticalTutorials:function(){return this.tutorials.hasIncompleteCriticalTutorials(this)},isEligibleForActivityGoals:function(){return this.isTeacher()&&this.get("userID")%5===3},parentApp:function(){return this.isParent()},wasInParentAppDuringExperiment:function(){var e,t=!1;if(this.isParent())for(e=0;e<this._parentExperiments.length&&!(t=this._parentExperiments[e].validUserID(this.get("userID"))&&moment(this.get("registerDate")).isBetween(this._parentExperiments[e].dateRange[0],this._parentExperiments[e].dateRange[1]));e+=1);return t}}),sw.dispatcher=_.extend({resizeDebounce:100},Backbone.Events),sw.dispatcher.observeDOM=function(){var e=window.MutationObserver||window.WebKitMutationObserver,t=window.addEventListener;return function(i,s){var n;e?(n=new e(function(e,t){(e[0].addedNodes.length||e[0].removedNodes.length)&&s()}),n.observe(i,{childList:!0,subtree:!0})):t&&(i.addEventListener("DOMNodeInserted",s,!1),i.addEventListener("DOMNodeRemoved",s,!1))}}(),sw.dispatcher.triggerDOMChange=function(){sw.dispatcher.trigger("DOM:change")},sw.dispatcher.listenToResize=function(){$(window).on("resize",_.debounce(sw.dispatcher.triggerResize,sw.dispatcher.resizeDebounce))},sw.dispatcher.triggerResize=function(e){e.target==window&&sw.dispatcher.trigger("window:resize")},sw.dispatcher.listenToScroll=function(){$(window).scroll(_.debounce(sw.dispatcher.triggerScroll,sw.dispatcher.resizeDebounce))},sw.dispatcher.triggerScroll=function(e){sw.dispatcher.trigger("window:scroll")},sw.dispatcher.listenToBodyClick=function(){$("body").on("click",function(e){sw.dispatcher.trigger("body:click",e)})},sw.dispatcher.listenToBodyMousemove=function(){$("body").on("mousemove",function(e){sw.dispatcher.trigger("body:mousemove",e)})},$(function(){sw.dispatcher.listenToResize(),sw.dispatcher.listenToScroll(),sw.dispatcher.listenToBodyClick(),sw.dispatcher.listenToBodyMousemove(),sw.dispatcher.observeDOM(document.body,sw.dispatcher.triggerDOMChange)}),SW.Purchaser=SW.Model.extend({initialize:function(){Stripe.setPublishableKey(sw.config.stripePublicKey)},createToken:function(e,t){return this.card=e,this.callback=t,Stripe.card.createToken(e,this.stripeResponseHandler.bind(this)),!1},stripeResponseHandler:function(e,t){this.token=t.id,this.callback(e,t)},processPurchase:function(e,t,i){var s=this;$.ajax({type:"POST",url:sw.config.api.membership+"/v1/purchase",dataType:"json",data:{token:this.token,monthlyMemberships:JSON.stringify(e.monthlyMemberships),yearlyMemberships:JSON.stringify(e.yearlyMemberships),postalCode:e.postalCode,email:e.email,name:e.name,country:session_country},success:function(n){n.success?(s.trackPurchase(e),t(n)):i(n)}})},getTaxesFromPostalCode:function(e){var t={};return e.length&&e.length>0&&(e=e.toUpperCase(),"K"==e.charAt(0)?t={HST:.13}:"L"==e.charAt(0)?t={HST:.13}:"M"==e.charAt(0)?t={HST:.13}:"N"==e.charAt(0)?t={HST:.13}:"P"==e.charAt(0)?t={HST:.13}:"G"==e.charAt(0)?t={GST:.05,QST:.09975}:"H"==e.charAt(0)?t={GST:.05,QST:.09975}:"J"==e.charAt(0)?t={GST:.05,QST:.09975}:"A"==e.charAt(0)?t={HST:.13}:"B"==e.charAt(0)?t={HST:.15}:"C"==e.charAt(0)?t={HST:.14}:"E"==e.charAt(0)?t={HST:.13}:"R"==e.charAt(0)?t={GST:.05,PST:.08}:"S"==e.charAt(0)?t={GST:.05,PST:.05}:"T"==e.charAt(0)?t={GST:.05}:"V"==e.charAt(0)?t={GST:.05,PST:.07}:"X"==e.charAt(0)?t={GST:.05}:"Y"==e.charAt(0)&&(t={GST:.05})),t},trackPurchase:function(e){e.monthlyMemberships.length>0&&sw.track.event("membership","purchase","monthly",e.monthlyMemberships.length),e.yearlyMemberships.length>0&&sw.track.event("membership","purchase","yearly",e.yearlyMemberships.length),sw.track.pageView("membership:complete")}}),SW.Student=SW.Model.extend({idAttribute:"userID",initialize:function(){this._super("initialize",arguments),this.get("grade")<1&&this.set("grade",1),this.set({name:this.escape("name"),fullname:this.escape("fullname")}),this.setGradeOverride(),this.listenTo(this,"change:curriculumOverride",this.setGradeOverride)},setGradeOverride:function(){var e=this.get("curriculumOverride"),t=e?SW.Education.curriculumIDs[e]:null,i=_.get(t,"grade");i?this.set("gradeOverride",i):this.set("gradeOverride",null)},removeParentEmail:function(){if(!_.isString(this.get("parentEmail")))throw new Error("There is no email attached to this student.");SW.Http.fetch({url:sw.config.api.accounts+"/v2/student/"+this.get("userID"),method:"POST",data:{change_fields:JSON.stringify({parentEmail:null})},success:function(){console.log("success",arguments),this.removeParentEmailComplete(null)}.bind(this),error:function(){console.log("error",arguments),this.removeParentEmailComplete(!0)}.bind(this)})},removeParentEmailComplete:function(e){var t=this.get("parentEmail");this.set("parentEmail",void 0),this.trigger("remove-parent-email:complete",{error:e,parentEmail:t,student:this})},addParentEmail:function(e){var t={student_id:this.get("userID"),student_name:this.get("name"),user_name:sw.user.get("name"),user_email:sw.user.get("email"),parent_email:e};SW.Http.fetch({url:sw.config.api.web+"/v1/students/"+this.get("userID")+"/parent",method:"POST",data:t,success:this.handleAddParentEmailSuccess.bind(this,e),error:this.handleAddParentEmailError.bind(this)})},handleAddParentEmailSuccess:function(e){this.addParentEmailComplete(e)},handleAddParentEmailError:function(){this.addParentEmailComplete(null,!0)},addParentEmailComplete:function(e,t){_.isString(e)&&this.set("parentEmail",e),this.trigger("add-parent-email:complete",{error:t,parentEmail:e,student:this})},simpleName:function(){return nameArr=this.get("fullname").split(" "),[_.first(nameArr),_.last(nameArr).charAt(0)].join(" ")+"."},validate:function(){var e=[];if(SW.Validate.name(this.get("firstName"))||e.push({attribute:"firstName",errors:["First name must be at least two characters long."]}),SW.Validate.text(this.get("lastName"))||e.push({attribute:"lastName",errors:["Last name must be at least one character long."]}),e.length>0)return e},parse:function(e){var t=e.objectID||e.id||e.userID,i=e.name||e.fullname||e.firstName+" "+e.lastName,s=e.parent_email||e.parentEmail,n=_.extend({},e,{userID:t,id:t,name:i,fullname:i,usertype:"student",parentEmail:s});return delete n.objectID,delete n.parent_email,n}}),SW.Class=SW.Model.extend({initialize:function(){this.students=new SW.StudentList,this.isLoaded=!1,this.get("_students")&&this.students.reset(this.getFormatedStudents()),this.get("parentApp")&&this.students.at(0)&&this.listenTo(this.students.at(0),"change:gradeOverride",this.setCurriculum),this.setCurriculum()},setCurriculum:function(){var e,t,i;this.get("parentApp")&&this.students.length>0&&(e=this.students.at(0),t=e.get("gradeOverride")||e.get("grade"),i=_.find(sw.user.get("curricula"),{grade:t}),i&&this.set({curriculumID:i.curriculumID,override:!!e.get("gradeOverride")}))},getFormatedStudents:function(){return this.formatStudents(this.get("_students"))},getGrade:function(){return _.has(SW.Education.curriculumIDs,this.get("curriculumID"))?SW.Education.curriculumIDs[this.get("curriculumID")].grade:-1},getLocationID:function(){var e=this.get("curriculumID");return _.has(SW.Education.curriculumIDs,e)?SW.Education.curriculumIDs[e].locationID:-1},getLocationName:function(){var e=this.getLocationID();return SW.Education.getLocationName(e)},formatStudents:function(e){return e.map(function(e){return e.id=e.id||e.userID,e.userID=e.id||e.userID,e.usertype="student",e.fullname=e.name,e.parentEmail=e.parent_email||e.parentEmail,delete e.parent_email,e})},getSize:function(){return this.students.length},addStudents:function(e){this.students.addStudents(this.formatStudents(e))},getCurriculumIDFromTeachersCurriculum:function(){var e,t=sw.user.get("curricula")[0].curriculumID,i=SW.Education.curriculumIDs[sw.user.classes.getCurrentClass().get("curriculumID")];return _.isUndefined(i)?t:(e=_.find(sw.user.get("curricula"),function(e){return e.grade==i.grade}),e&&(t=e.curriculumID),t)},removeStudents:function(e){var t;this.startLoading("remove-students:loading"),t=e.map(function(e){return e.get("id")}),SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+this.get("id")+"/students",method:"DELETE",data:{student_ids:t},success:this.handleRemoveStudentsSuccess.bind(this,e),error:this.handleRemoveStudentsError.bind(this,e)})},removeAllStudents:function(){var e=this.students.map(function(e){return e.get("id")});SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+this.get("id")+"/students",method:"DELETE",data:{student_ids:e},success:this.handleRemoveAllStudentsSuccess.bind(this),error:this.handleRemoveAllStudentsError.bind(this)})},handleRemoveAllStudentsSuccess:function(){this.students.reset(),this.trigger("remove:all-students")},handleRemoveAllStudentsError:function(){this.trigger("remove:all-students",{error:"There was a problem trying to remove all students."})},handleRemoveStudentsSuccess:function(e){e.length>-1&&_.delay(function(){this.students.remove(e)}.bind(this),400),this.stopLoading("remove-students:complete")},handleRemoveStudentsError:function(e,t){},removeFromUser:function(){sw.user.classes.removeClass(this)},startLoading:function(e){this.trigger(e),this.isLoaded=!1},stopLoading:function(e){this.trigger(e),this.isLoaded=!0}}),SW.Membership=SW.Model.extend({getFormatedDate:function(e){var t=this.get(e),i=function(e){var t=new Date(e),i=SW.Utility.dateMonths[t.getUTCMonth()].short,s=t.getUTCDate(),n=t.getUTCFullYear();return i+" "+s+", "+n};return null===t?t:i(t)},cancelMembership:function(e){SW.Http.fetch({url:sw.config.api.membership+"/v1/users/"+sw.user.get("userID")+"/memberships/"+this.get("id")+"/cancel",method:"PUT",dataType:"json",success:this.handleCancelSuccess.bind(this,e),error:this.handleCancelError.bind(this,e)})},handleCancelSuccess:function(e,t){this.set({canceled:!0}),e()},handleCancelError:function(e,t){e(t.responseJSON)},assignMembership:function(e,t){SW.Http.fetch({url:sw.config.api.membership+"/v1/users/"+sw.user.get("userID")+"/memberships/"+this.get("id")+"/assign",method:"PUT",dataType:"json",data:{studentID:e},success:this.handleAssignSuccess.bind(this,e,t),error:this.handleAssignError.bind(this,e,t)})},handleAssignSuccess:function(e,t,i){var s=sw.user.classes.findStudent(e);s?this.set({licenseeID:s.get("id"),licenseeUsername:s.get("username"),licenseeName:s.get("name")}):this.set({licenseeID:0,licenseeUsername:null,licenseeName:null}),t(null)},handleAssignError:function(e,t,i){t(i)}}),SW.StudentList=SW.Collection.extend({model:SW.Student,defaults:{isLoaded:!1},comparator:function(e,t){return this.compareStudents(e.get("fullname"),t.get("fullname"))},compareStudents:function(e,t){return e.localeCompare(t)},addStudents:function(e){this.add(e.sort(function(e,t){return this.compareStudents(e.fullname,t.fullname)}.bind(this)),{sort:!0,silent:!1})},getStudentIDs:function(){var e=[];return _.forEach(this.models,function(t){e.push(t.get("userID"))}),e},getStudentsAttachedAfter:function(e){return this.getStudentsAttachedByDate("after",e)},getStudentsAttachedBefore:function(e){return this.getStudentsAttachedByDate("before",e)},getStudentsAttachedByDate:function(e,t){var i=[];return _.forEach(this.models,function(s){var n,a=new Date(s.get("licenseStartDate"));n="after"==e?a>t:a<t,n&&i.push(s)}),i},mergeStudentObjects:function(e){_.forEach(this.models,function(t){_.forEach(e,function(e){var i;if(t.get("userID")===e.userID)for(i in e)t.set(i,e[i])})})},getClassGrade:function(){var e,t={},i={grade:1,value:0};_.forEach(this.models,function(e){e.get("chosenGrade")&&(t.hasOwnProperty(e.get("chosenGrade"))||(t[e.get("chosenGrade")]=0),t[e.get("chosenGrade")]++)});for(e in t)t[e]>i.value&&(i={grade:e,value:t[e]});return i.grade},getClassCurriculum:function(e){var t=this.getClassGrade(),i=e[0];return e.forEach(function(e){e.grade==t&&e.name.indexOf("EQAO")===-1&&(i=e)}),i},load:function(){this.lastTimeLoaded=null,this.loaded=!1,this.loading=!0,this.error=null,this.listenToOnce(sw.dispatcher,"class-list:load:complete",this.handleClassListLoadComplete)},handleClassListLoadComplete:function(e){this.error=e.error,!this.error&&sw.user.classes.length&&(this._syncWithDefaultClass(),this.listenTo(sw.user.classes.getCurrentClass().students,"reset add remove",this._syncWithDefaultClass)),this.stopLoading()},_syncWithDefaultClass:function(){var e=sw.user.classes.getCurrentClass().students.models;e.forEach(function(e){e.set({userID:e.get("userID")||e.get("id"),fullname:e.get("fullname")||e.get("name"),usertype:"student"})}),this.reset(e)},stopLoading:function(){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.isLoaded=!0,this.trigger("load:complete",{error:this.error}),sw.dispatcher.trigger("student-list:load:complete")}}),SW.ClassList=SW.Collection.extend({model:SW.Class,initialize:function(e){this._currentClassId=SW.Storage.get("current-class-id")||void 0,this.lastTimeLoaded=null,this.loaded=!1,this.loading=!1,this.error=null},beforeLoad:function(){this.loaded=!1,this.loading=!0,this.error=null},load:function(e){this.beforeLoad(),SW.Http.fetch({url:sw.config.api.accounts+"/v2/teacher/"+sw.user.get("userID")+"/class",method:"GET",success:this.handleLoadSuccess.bind(this,e),error:this.handleLoadError.bind(this,e)})},setClasses:function(e){var t=this.formatClassesData(e);this.reset(t),this.classesLoaded(null)},handleLoadSuccess:function(e,t){this.setClasses(t),e&&e(null,t)},handleLoadError:function(e,t){var i=new Error(t.statusText);this.classesLoaded(i),e&&e(i,t)},classesLoaded:function(e){this.isLoaded=!0,this.afterLoad(e),sw.dispatcher.trigger("class-list:load:complete",{error:e})},afterLoad:function(e){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.error=e,this.trigger("load:complete",{error:e})},formatClassesData:function(e){var t=_.map(e).map(this.formatClassData.bind(this));return this.parentApp&&(t=_.filter(t,function(e){return e._students.length>0})),t},formatClassData:function(e){var t=e.info||e;return{id:t.id||t.class_id,name:t.name,curriculumID:t.grade,classCode:t.class_code,_students:e.students||[],parentApp:this.parentApp}},getCurrentClassID:function(){var e=this.length>0?this.at(0).get("id"):-1;return this.find({id:this._currentClassId})?this._currentClassId:e},getByID:function(e){return this.findWhere({id:e})},getCurrentClass:function(){return this.getByID(this.getCurrentClassID())},getAllStudents:function(e){var e=e||"Array",t=this.reduce(function(t,i){return t.concat(i.students["to"+e]())},[]);return _.uniqBy(t,"id")},findStudent:function(e){return _.find(this.getAllStudents(),{id:e})},changeToClassWithStudents:function(e){var t,i;for(t=0;t<this.length;t++)if(i=e.reduce(function(e,i){return e?_.isObject(this.at(t).students.find({id:i})):e},!0)){this.changeCurrentClass(this.at(t).id);break}},removeClass:function(e){var t=void 0!==this.get(e);t?(this.startLoading("remove-class:start"),SW.Http.fetch({url:sw.config.api.accounts+"/v2/teachers/"+sw.user.get("userID")+"/classes/"+e.get("id"),method:"DELETE",success:function(t){this.handleRemoveClassSuccess(e)}.bind(this),error:function(t){this.handleRemoveClassFail(e)}.bind(this)})):this.handleRemoveClassFail(e)},handleRemoveClassSuccess:function(e){this.remove(e),this.stopLoading("remove-class:success",e.toJSON())},handleRemoveClassFail:function(e){this.stopLoading("remove-class:fail",e.toJSON())},startLoading:function(e,t){this.isLoaded=!1,this.trigger(e,t)},stopLoading:function(e,t){this.isLoaded=!0,this.trigger(e,t)},changeCurrentClass:function(e,t){e=parseInt(e,10),this.getCurrentClassID()!==e&&(this._currentClassId=e,SW.Storage.set("current-class-id",e),t||sw.dispatcher.trigger("class:change"))}}),SW.MembershipCollection=SW.Collection.extend({model:SW.Membership,comparator:function(e,t){var i=function(e){var t=20;return e.get("expired")||(e.get("licenseeID")||(t-=10),t-=e.get("recurringPayment")?e.get("canceled")?3:2:1),t},s=1e13-Date.parse(e.get("expiryDate")),n=1e13-Date.parse(t.get("expiryDate")),a=i(e).toString()+s.toString()+e.get("licenseeName")+e.get("licenseeUsername"),r=i(t).toString()+n.toString()+t.get("licenseeName")+t.get("licenseeUsername"),o=function(e,t){var i=[],s=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,s){i.push([t||1/0,s||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,i){s.push([t||1/0,i||""])});i.length&&s.length;){var n=i.shift(),a=s.shift(),r=n[0]-a[0]||n[1].localeCompare(a[1]);if(r)return r}return i.length-s.length};return o(a,r)},initialize:function(e){this.lastTimeLoaded=null,this.loaded=!1,this.loading=!1,this.error=null},beforeLoad:function(){this.loaded=!1,this.loading=!0,this.error=null},load:function(){this.beforeLoad(),SW.Http.fetch({url:sw.config.api.membership+"/v1/users/"+sw.user.get("userID")+"/memberships",method:"GET",dataType:"json",success:this.handleLoadSuccess.bind(this),error:this.handleLoadError.bind(this)})},handleLoadSuccess:function(e){this.reset(e),this.afterLoad(null)},handleLoadError:function(e){this.afterLoad(new Error(e.statusText))},afterLoad:function(e){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.error=e,this.trigger("load:complete",{error:e})}}),SW.Tutorials=SW.Collection.extend({initialize:function(){this.lastTimeLoaded=null,this.loaded=!1,this.loading=!1,this.error=null,this.listenTo(sw.dispatcher,"tutorials:load",this.load),this.listenTo(sw.dispatcher,"tutorials:save",this.save)},beforeLoad:function(){this.loaded=!1,this.loading=!0,this.error=null},load:function(){this.beforeLoad(),SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/tutorials",method:"GET",dataType:"json",data:{userID:sw.user.get("userID")},success:this.handleLoadSuccess.bind(this),error:this.handleLoadError.bind(this)})},handleLoadSuccess:function(e){this.reset(e),this.afterLoad(null),sw.dispatcher.trigger("tutorials:load:complete")},handleLoadError:function(e,t){this.afterLoad(new Error(t))},afterLoad:function(e){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.error=e,this.trigger("load:complete",{error:e})},save:function(e){SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/tutorials/"+e,method:"POST",data:{userID:sw.user.get("userID")},success:function(){this.add({id:e,dateCompleted:(new Date).toISOString()})}.bind(this)})},isCompleted:function(e){return!!this.get(e)&&this.get(e)},hasIncompleteCriticalTutorials:function(e){var t=!this.isCompleted(SW.Tutorials.INTRO),i=e.isTeacher()&&e.isReturningToMultipleClasses()&&!this.isCompleted(SW.Tutorials.MULTIPLE_CLASSES_MIGRATION);return t||i}}),SW.Tutorials.INTRO=0,SW.Tutorials.PLANNER_TOOL=101,SW.Tutorials.ASSIGNMENTS_IN_PLANNER=102,SW.Tutorials.MULTIPLE_CLASSES_MIGRATION=103,SW.Tutorials.EXISTING_USER_MODAL_TUTORIAL=104,SW.Tutorials.PARENT_FIRST_ADD_STUDENT=1,SW.Tutorials.PARENT_FIRST_REPORT_PAGEVIEW=2,SW.Tutorials.PARENT_FIRST_STUDENT_PROFILE_PAGEVIEW=3,SW.Tutorials.PARENT_APP_MIGRATION=4,SW.Track=SW.Model.extend({pageView:function(e,t){ga("send","pageview",{page:"/"+e}),t&&mixpanel.track(e)},event:function(e,t,i,s){ga("send","event",e,t,i,s)},milestone:function(e,t){mixpanel.track(e,t)},purchase:function(){},user:function(e,t){switch(e){case"set":this._set(t);break;case"setOnce":this._setOnce(t);break;case"increment":this._increment(t);break;case"alias":this._alias(t)}},_alias:function(e){mixpanel.alias(e)},_set:function(e){mixpanel.people.set(e)},_setOnce:function(e){mixpanel.people.set_once(e)},_increment:function(e){mixpanel.people.increment(e)},trackFacebookConversion:function(e){if(!_.isUndefined(_fbq)){var t={};t.value=e,t.currency="CAD",_fbq.push(["track","6018520487093",t])}},adRollConversion:function(){adroll_custom_data={usertype:sw.user.get("usertype")},console.log("AdRoll");try{
__adroll.record_user({adroll_segments:"b4d27576"})}catch(e){console.log("caught an error")}}}),SW.SplitTest=SW.Model.extend({getTutorialVariation:function(){var e;return sw.user.get("userID")%4===0?e=SW.SplitTest.TUTORIAL_WIDGET:sw.user.get("userID")%4===1?e=SW.SplitTest.TUTORIAL_WEBSIDE:sw.user.get("userID")%4===2?e=SW.SplitTest.TUTORIAL_ALEX:sw.user.get("userID")%4===3&&(e=SW.SplitTest.TUTORIAL_ROHAN),e},addToTutorialTest:function(){var e=this.getTutorialVariation();this.trackSplitTest("tutorial-test",e)},trackSplitTest:function(e,t){var i={};i[e]=t,sw.track.user("setOnce",i)},addStudents:function(){return sw.user.isTeacher()&&sw.user.get("userID")%5===2}}),SW.SplitTest.TUTORIAL_WIDGET="tutorial-widget",SW.SplitTest.TUTORIAL_WEBSIDE="tutorial-webside",SW.SplitTest.TUTORIAL_ALEX="tutorial-alex",SW.SplitTest.TUTORIAL_ROHAN="tutorial-rohan",SW.Loader=new(SW.Model.extend({whenLoaded:function(e){function t(t){t.error?n.push(t):s.push(t),s.length===e.entities.length?(e.success(s),s=null,n=null):s.length+n.length===e.entities.length&&(_.isFunction(e.fail)&&e.fail(n),s=null,n=null)}var i=e.context||this,s=[],n=[];e.entities.forEach(function(s){s.loaded?t(s):(s.loading||s.load(),_.isFunction(e.loading)&&(e.loading(),e.loading=null),i.listenToOnce(s,"load:complete",function(e){t(s)}))})}})),SW.AppRootRegionView=SW.ParentView.extend({className:"app-root-region",initialize:function(){this._super("initialize"),this.childViews.regions={},this.childViews.page=null,this.template=Handlebars.compile($("#app-root-region-template").html())},render:function(){return this.$el.html(this.template()),this.initializeAppRegionsOnce(),this.renderAppRegions(),this},renderAppRegions:function(){_.forEach(this.childViews.regions,function(e){e.render()})},initializeAppRegionsOnce:function(){this.regionsInitialized||(this.regionsInitialized=!0,this.initializeAppRegions())},initializeAppRegions:function(){this.initializeModalRegion(),this.initializeHeaderRegion(),this.initializePageRegion(),this.initializeFooterRegion()},initializeHeaderRegion:function(){var e=new SW.AppHeaderRegionView({el:"#app-header-region",model:new SW.AppHeaderRegion});this.storeRegionReference("header",e)},initializePageRegion:function(){var e=new SW.AppPageRegionView({el:"#app-page-region",model:new SW.AppPageRegion});this.storeRegionReference("page",e)},initializeFooterRegion:function(){var e=new SW.AppFooterRegionView({el:"#app-footer-region",model:new SW.AppFooterRegion});this.storeRegionReference("footer",e)},initializeModalRegion:function(){var e=new SW.AppModalRegionView({el:"#app-modal-region",model:new SW.AppModalRegion});this.storeRegionReference("modal",e)},storeRegionReference:function(e,t){this.childViews.regions[e]=t},setAppPage:function(e){this.childViews.page&&this.childViews.page.close(),this.childViews.page=e,window.scrollTo(0,0),sw.dispatcher.trigger("page:change",{error:null,data:e})},getAppPage:function(){return this.childViews.page},isAppPage:function(e){return this.getAppPage().model.get("settings").pageID===e}}),SW.AppRootRegion=SW.Model.extend({}),SW.AppHeaderRegionView=SW.ParentView.extend({tagName:"header",className:"app-header-region",initialize:function(){this.$el&&this.$el.addClass("app-header-region"),this._super("initialize"),this.childViews.navigation={},this.listenTo(sw.dispatcher,"page:change",this.handlePageChange)},handlePageChange:function(e){var t=e.data.model.get("settings");t.navigation?this.syncNavigation(_.extend({pageID:t.pageID},t.navigation)):this.closeChildNavigation(),this.syncMaintenanceMessage()},render:function(){},syncNavigation:function(e){this.syncPrimaryNavigation(e),this.syncPageNavigation(e)},syncPageNavigation:function(e){e.page?this.childViews.navigation.page?this.updatePageNavigation(e):this.createPageNavigation(e):this.childViews.navigation.page&&this.removePageNavigation()},updatePageNavigation:function(e){var t={pageID:e.pageID};this.childViews.navigation.page.model.set(t)},createPageNavigation:function(e){var t={pageID:e.pageID};this.childViews.navigation.page=new SW.PageNavigationView({model:new SW.PageNavigation(t)}),this.$el.append(this.childViews.navigation.page.render())},removePageNavigation:function(){this.childViews.navigation.page.close(),this.childViews.navigation.page=null},syncPrimaryNavigation:function(e){this.childViews.navigation.primary?this.updatePrimaryNavigation(e):this.createPrimaryNavigation(e)},updatePrimaryNavigation:function(e){var t={breadcrumb:e.breadcrumb,classSelect:e.classSelect,account:e.account,notifications:e.notifications};this.childViews.navigation.primary.model.set(t)},createPrimaryNavigation:function(e){var t={breadcrumb:e.breadcrumb,classSelect:e.classSelect,account:e.account,notifications:e.notifications};this.childViews.navigation.primary=new SW.PrimaryNavigationView({model:new SW.PrimaryNavigation(t)}),this.$el.append(this.childViews.navigation.primary.render())},closeChildNavigation:function(){_.forEach(this.childViews.navigation,function(e){e.close()}),this.childViews.navigation={}},syncMaintenanceMessage:function(){this.childViews.maintenanceMessage||this.createMaintenanceMessage()},createMaintenanceMessage:function(){this.childViews.maintenanceMessage=new SW.MaintenanceMessageView({model:new SW.MaintenanceMessage}),this.$el.prepend(this.childViews.maintenanceMessage.render())}}),SW.AppHeaderRegion=SW.Model.extend({}),SW.AppPageRegionView=SW.ParentView.extend({tagName:"main",className:"app-page-region",initialize:function(){this._super("initialize"),this.listenTo(sw.dispatcher,"page:change",this.handlePageChange)},handlePageChange:function(e){this.changePage(e.data)},changePage:function(e){this.$el.html(e.render())}}),SW.AppPageRegion=SW.Model.extend({}),SW.AppFooterRegionView=SW.ParentView.extend({tagName:"footer",className:"app-footer-region",initialize:function(){this._super("initialize",arguments),this.initializeSubNavigation()},initializeSubNavigation:function(){this.childViews.subNav=new SW.SubNavigationView({model:new SW.SubNavigation})},render:function(){return this.renderChildren(),this.$el},renderChildren:function(){this.$el.empty(),this.$el.append(this.childViews.subNav.render())}}),SW.AppFooterRegion=SW.Model.extend({}),SW.AppModalRegionView=SW.ParentView.extend({}),SW.AppModalRegion=SW.Model.extend({}),SW.PageManager=SW.Model.extend({defaults:{currentPage:!1,params:{}},openPage:function(e,t){sw.dispatcher.trigger("page:change",e),console.log("Open this page!",e)},createPage:function(e,t){var i;switch(sw.track.pageView(e),e){case"dashboard":i=new SW.DashboardView({model:new SW.Dashboard});break;case"influencer":sw.track.milestone("Share - Page View"),i=new SW.InfluencerView({model:new SW.Influencer});break;case"tutorial":i=new SW.TutorialView({model:new SW.Tutorial});break;case"planner":i=new SW.PlannerView({model:new SW.Planner});break;case"topicReport":i=new SW.TopicReportPageView({model:new SW.TopicReportPage});break;case"curriculumReport":i=new SW.CurriculumReportPageView({model:new SW.CurriculumReportPage});break;case"students":i=new SW.StudentsPageView({model:new SW.StudentsPage});break;case"account":i=new SW.AccountSettingsView({model:new SW.AccountSettings})}return i},isCurrentPage:function(e){var t=!1,i=this.get("currentPage");return i&&(t=i.model.get("page").id===e),t},closePage:function(){this.get("currentPage")&&this.get("currentPage").close()}}),SW.DialogManager=SW.View.extend({initialize:function(){this.dialog=null,this.listenTo(sw.dispatcher,"dialog:close",this.closeDialog)},open:function(e,t){return this.dialog?this._swapInNewDialog(e,t):this._setDialog(e,t),this.dialog},openCreateClass:function(){return this.open({type:"shell",size:"medium-small",title:"<span class='text-inline text-scales'>New Class</span>",headerClassName:"dialog__header--large-text dialog__header--tall dialog__header--blue",iconClassName:"dialog__close-icon--light text-white",$img:'<img class="dialog__header-img" width="250px" src="/assets/images/svg/classroom.svg" alt="A classroom with a whiteboard containing two charts.">',children:[{view:SW.CreateClassView,model:SW.CreateClass}]})},openAttachKid:function(){var e="Add account";return this.open({type:"shell",size:"medium-small",title:'<span class="text-inline text-scales">'+e+"</span>",headerClassName:"dialog__header--large-text dialog__header--tall dialog__header--blue",iconClassName:"dialog__close-icon--light text-white",$img:'<img class="dialog__header-img dialog__header-img--bottom" width="205px" src="/assets/images/svg/parent-onboarding-add-child.svg" alt="A group of excited kids.">',children:[{view:SW.CreateClassView,model:SW.CreateClass}]})},openEditClass:function(e){var t,i="Edit class";return sw.user.parentApp()&&(t=SW.Utility.firstName(e.students.at(0).get("name"),{possessive:!0}),i="Edit "+_.escape(t)+" account"),this.open({type:"confirmation",size:"medium-small",title:i,buttons:[{text:"Cancel"},{text:"Save changes",className:"btn-flat--primary"}],children:[{view:SW.EditClassView,model:e}]})},openActivateChildDialog:function(e){return this.open({type:"card",title:"How to play Prodigy at home",buttons:[{text:"Got it!",className:"btn btn--blue"}],children:[{view:SW.ActivateChildView,model:e}]})},openRegisterDialog:function(e){return this.open({type:"shell",size:"medium-small",className:"dialog dialog-form",title:"<span class='text-inline text-scales'>Sign Up</span>",headerClassName:"dialog__header--tall dialog__header--blue",iconClassName:"dialog__close-icon--light text-white",$img:'<img class="dialog__title-ed-img" width="140px" src="/assets/images/svg/ed/ed-balloon.svg" alt="Ed holding a heart-shaped balloon.">',children:[{view:SW.RegisterFormView,model:SW.RegisterForm,modelData:e}]})},openLocationSelectDialog:function(){return this.open({type:"shell",title:"Where would you like Hex shipped?",size:"medium",children:[{view:SW.ToyLocationSelectView}]})},closeDialog:function(e){this.dialog&&(this.dialog.close(e),this.dialog=null)},_swapInNewDialog:function(e,t){sw.overlayManager.lock(),this.closeDialog({instant:!0}),this._setDialog(e,t),sw.overlayManager.unlock()},_setDialog:function(e,t){this.dialog=this._instantiateDialog(e),t&&t()},_instantiateDialog:function(e){var t;switch(e.type){case"alert":t=this._createAlertDialog(e);break;case"confirmation":t=this._createConfirmationDialog(e);break;case"shell":t=this._createShellDialog(e);break;case"load":t=this._createLoadDialog(e);break;case"card":t=this._createCardDialog(e);break;default:t=this._createCustomDialog(e)}return t},_createAlertDialog:function(e){return e.template="alert-dialog-template",e.size=e.size||"smaller",e.buttons=e.buttons||[{text:"Okay",className:"btn-flat--primary"}],this._createCustomDialog(e)},_createConfirmationDialog:function(e){return e.template="confirmation-dialog-template",e.size=e.size||"small",e.buttons=e.buttons||[{text:"Cancel"},{text:"Okay",className:"btn-flat--primary"}],this._createCustomDialog(e)},_createShellDialog:function(e){return e.template="shell-dialog-template",e.size=e.size||"small",this._createCustomDialog(e)},_createLoadDialog:function(e){return e.loader=!0,this._createCustomDialog(e)},_createCustomDialog:function(e){return e.className=e.className||"dialog",e.size=e.size||"small",e.template=e.template||"alert-dialog-template",_.isArray(e.buttons)&&e.length>2&&console.log("%c Dialogs currently only supportup to 2 buttons.","background: #f2dede; color: #a94442"),dialog=new SW.DialogView({model:new SW.Dialog(e)})},_createCardDialog:function(e){var t=_.defaults({className:"dialog dialog--basic",template:"card-dialog-template"},e,{size:"small"});return this._createCustomDialog(t)}}),SW.OverlayManagerView=SW.View.extend({defaults:{},events:{click:"triggerClickEvent"},initialize:function(){this.isLocked=!1,this.index=1,this.$body=$("body")},moveMaskUp:function(){this.isLocked||(this.index<=1&&(this.$el.fadeIn("ease"),this.disablePageScrolling()),this.index+=10,this.$el.css("z-index",this.index))},moveMaskTo:function(e){this.isLocked||(this.index<=1&&(this.$el.fadeIn("ease"),this.disablePageScrolling()),this.index=e,this.$el.css("z-index",this.index))},moveMaskDown:function(){this.isLocked||(this.index-=10,this.index<1&&(this.index=1),this.$el.css("z-index",this.index),1===this.index&&(this.enablePageScrolling(),this.$el.fadeOut("ease")))},removeMask:function(){var e;if(!this.isLocked)for(e=this.index;e>1;e-=10)this.moveMaskDown()},forceRemoveMask:function(){this.index=1,this.$el.css("z-index",this.index).hide()},enablePageScrolling:function(){this.$body.css({position:"",width:"",height:"",overflow:"","padding-right":""}),_.isNumber(this.currentScrollPos)&&$("html, body").scrollTop(this.currentScrollPos)},disablePageScrolling:function(){var e={overflow:"hidden"},t={position:"fixed",width:"100%",height:"100%"};SW.Device.isIpad()?(_.extend(e,t),this.currentScrollPos=$(document).scrollTop()):this.currentScrollPos=null,SW.Utility.getViewportSize().height<this.$body.innerHeight()&&SW.Device.isWindows()&&(e["padding-right"]="17px"),this.$body.css(e)},triggerClickEvent:function(){sw.dispatcher.trigger("overlay:click")},lock:function(){this.isLocked=!0},unlock:function(){this.isLocked=!1}}),SW.ToastManager=SW.View.extend({create:function(e){var t=$("#"+e.id);if(!t.length)return new SW.ToastView({id:e.id,className:e.type?"toast toast--"+e.type:"toast",content:e.content,animation:e.animation!==!1,timer:e.timer})},closeById:function(e){sw.dispatcher.trigger(e+":close")}}),SW.LoadingIconView=SW.View.extend({loadingSpinnerHTML:'<div class="js-loading-icon css-spinner spinner-block"><img class="spinner" src="/assets/images/svg/tail-spin.svg" alt="Content is loading."></div>',initialize:function(e){var e=e||{};this.position=e.position},getPositionClass:function(){return"spinner--"+this.position},render:function(){return this.$el.html(this.loadingSpinnerHTML),this.position&&this.$(".js-loading-icon").addClass(this.getPositionClass()),this.$el}}),SW.ModalSequence=SW.Model.extend({defaults:{currentStep:1,steps:[]},getCurrentStep:function(){return this.get("steps")[this.get("currentStep")-1]},isComplete:function(){return this.get("currentStep")>this.get("steps").length},increment:function(){this.set("currentStep",this.get("currentStep")+1)},restart:function(){this.set("currentStep",1)}}),SW.ModalSequenceView=SW.ParentView.extend({events:{"click .js-modal-sequence-next":"next"},initialize:function(){this._super("initialize",arguments),this.tryToCreateCurrentStep(),this.listenTo(sw.dispatcher,"page:change",this.onPageChange)},onPageChange:function(){var e=this.model.getCurrentStep(),t=250;e&&this.childViews.step?this.isStepCreatable(e)?_.delay(this.tryToCreateCurrentStep.bind(this),t):(this.closeStep(),e.incrementOnPageChange&&_.delay(this.next.bind(this),t)):_.delay(this.tryToCreateCurrentStep.bind(this),t)},tryToCreateCurrentStep:function(){var e=this.model.getCurrentStep();this.isStepCreatable(e)&&this.createStep(e)},isStepCreatable:function(e){var t=sw.appRootRegion.getAppPage().model.toJSON();return isReady=!0,reqs=e.pageRequirements,reqs&&reqs.length&&(_.indexOf(reqs,"*")>-1?isReady=!0:_.indexOf(reqs,"universal")>-1?isReady=!t.settings.navigation.page:_.indexOf(reqs,"!universal")>-1?isReady=t.settings.navigation.page:isReady=_.indexOf(reqs,t.settings.pageID)>-1),isReady},createStep:function(e){this.closeStep(),_.isFunction(e.initialize)&&e.initialize(),this.childViews.step=this["create"+_.capitalize(e.modalType)+"Step"](e),this.$el=this.childViews.step.$el,this.delegateEvents()},createToastStep:function(e){return sw.toastManager.create(e.data)},createDialogStep:function(e){return this.createDialog(e.data)},createTooltipStep:function(e){var t,i;return e.template&&!e.wasTemplateRendered&&(t=_.assign({},this.model.toJSON(),e.data.node),i=this.findTemplate(e.template),e.data.node.content=i(t).trim(),e.wasTemplateRendered=!0),this.createTooltip(e.data)},closeStep:function(){this.childViews.step&&(this.childViews.step.close(),this.childViews.step=null,this.childViews.tooltip=null)},next:function(){this.model.increment(),this.model.isComplete()?(this.trigger("complete"),this.close()):this.tryToCreateCurrentStep()}}),SW.ExistingUserModalTutorial=SW.ModalSequence.extend({initialize:function(){var e=sw.user.get("usertype"),t={parent:["Your children are placed into groups called Classrooms. Let's have a look inside your class!","You can use these tools to help your children by creating assignments for them and viewing reports of their progress."],teacher:["Students are sorted into groups called Classrooms. Let's have a look inside your class!","Use these tools to manage your students, create assignments, and view reports for your class."]};this._super("initialize",arguments),this.set("steps",[{pageRequirements:["classes"],modalType:"tooltip",template:"existing-user-modal-tooltip",incrementOnPageChange:!0,initialize:function(){this.data.reference=$(".js-class-preview-manage")[0]},data:{node:{classNames:"tooltip--with-footer tooltip--tutorial tooltip--fade-in tooltip--margin-md",content:t[e][0]},options:{placement:"right",flipBehavior:["right","bottom","top"]}}},{pageRequirements:["!universal"],modalType:"tooltip",template:"existing-user-modal-tooltip",initialize:function(){var e=$(".page-navigation__menu");this.data.reference=e,this.data.node.parent=e},data:{node:{classNames:"tooltip--with-footer tooltip--tutorial tooltip--fade-in",content:t[e][1],buttonText:"Okay, got it!"},options:{placement:"right",flipBehavior:["right","bottom","top"]}}},{pageRequirements:["!universal"],modalType:"tooltip",template:"existing-user-modal-tooltip",initialize:function(){var e=$(".js-primary-nav-class-select");this.data.reference=e,this.data.node.parent=e},data:{node:{classNames:"tooltip--with-footer tooltip--tutorial tooltip--fade-in",content:"This is the class that you are currently viewing. You can click here to quickly switch to a different one.",buttonText:"Got it!"},options:{placement:"bottom",offset:75,flipBehavior:["bottom","right","left"]}}},{pageRequirements:["*"],modalType:"tooltip",template:"existing-user-modal-tooltip",initialize:function(){var e=$(".js-help-menu-container");this.data.reference=e,this.data.node.parent=e},data:{node:{classNames:"tooltip--with-footer tooltip--tutorial tooltip--fade-in",content:"And that's it! If you have any further questions you can get help over here.",buttonText:"Done!"},options:{placement:"bottom",flipBehavior:["bottom","right","left"]}}}])}}),SW.ExistingUserModalTutorialView=SW.ModalSequenceView.extend({}),SW.ProgressBar=SW.Model.extend({defaults:{total:null,segmentsTotal:null,segments:[]},initialize:function(){this.silentUpdate(),this.listenTo(this,"change",this.update)},silentUpdate:function(){this.calculateSegmentsTotal(),this.calculateSegmentsPercentages()},update:function(){this.silentUpdate(),this.trigger("update")},calculateSegmentsTotal:function(){this.set("segmentsTotal",this.get("segments").reduce(function(e,t){return e+t.value},0),{silent:!0})},calculateSegmentsPercentages:function(){_.forEach(this.get("segments"),function(e){this.get("total")&&(e.percentageOfTotal=e.value/this.get("total")*100),e.percentageOfSegmentsTotal=e.value/this.get("segmentsTotal")*100}.bind(this))}}),SW.ProgressBarView=SW.View.extend({className:"progress-bar",initialize:function(e){this.style=e&&e.style?e.style:"default",this.$el.addClass(e.elementClassModifiers),this.$el.addClass("progress-bar--"+this.style),this.delay=this.getDelayFromOptions(e),this.template=this.findTemplate("progress-bar-"+this.style),this.listenTo(this.model,"update",this.update.bind(this,{delay:this.delay.update}))},segmentsHaveDynamicWidths:function(){return"dot"!=this.style&&"discrete-dot"!=this.style},getDelayFromOptions:function(e){return e=e||{},_.assign({initial:250,update:0},e.delay)},render:function(){var e,t=this.model.toJSON();if("dot"==this.style)for(t.segment=this.model.get("segments")[0],t.completeSegments=[],t.incompleteSegments=[],e=1;e<=this.model.get("total");e++)e<=t.segment.value?t.completeSegments.push({key:"dot-"+e}):t.incompleteSegments.push({key:"dot-"+e});return this.$el.html(this.template(t)),this.update({delay:this.delay.initial}),this.$el},update:function(e){var t=e&&e.delay?e.delay:0;_.delay(function(){this.updateSegments()}.bind(this),t)},updateSegments:function(){var e;this.segmentsHaveDynamicWidths()&&_.forEach(this.model.get("segments"),function(t){e="100-percent"==this.style?t.percentageOfSegmentsTotal+"%":t.percentageOfTotal+"%",this.$('[data-segment-key="'+t.key+'"]').width(e)}.bind(this))},set:function(e,t){this.model.set(e,t),t&&t.silent&&this.model.silentUpdate()}}),SW.FilterListView=SW.View.extend({className:"filter-list",events:{"click .js-select-option":"selectOption","click .js-deselect-option":"deselectOption","input .js-filter-text":"setFilterText"},initialize:function(){this.template={filterList:this.findTemplate("filter-list"),filterListOptions:this.findTemplate("filter-list-options")},this.listenTo(this.model,"change:options change:selectedOption",this.render),this.listenTo(this.model,"change:filter change:filterText",this.renderFilterListOptions)},render:function(){return this.renderFilterList(),this.renderFilterListOptions(),this.$el},renderFilterList:function(){this.$el.html(this.template.filterList({label:this.model.get("label"),placeholder:this.model.get("placeholder"),filterText:this.model.get("filterText"),selectedOptionText:this.model.getSelectedOptionText()}))},renderFilterListOptions:function(){this.$(".js-filter-list-options").html(this.template.filterListOptions({filteredOptions:this.model.getFormattedFilteredOptions()}))},deselectOption:function(){this.model.deselectOption()},selectOption:function(e){var t=parseInt($(e.target).attr("data-index"),10);this.model.selectOptionByIndex(t)},setFilterText:function(e){var t=$(e.target).val().trim();this.model.setFilterText(t)}}),SW.FilterList=SW.Model.extend({defaults:{label:"",placeholder:"",options:[],unfilterableOptions:[],selectedOption:null,filterText:"",getOptionText:function(e){return e.toString()},filter:function(e,t,i){var s=e.toLowerCase(),n=t.toLowerCase();return _.includes(n,s)}},initialize:function(){this.listenTo(this,"change:selectedOption",this._triggerEvent),this.listenTo(this,"change:options",this._deselectInvalidSelection)},_triggerEvent:function(){var e=this.get("selectedOption"),t=this.get("filterText");this._isValidOption(e)?this.trigger("option:select",e,t):this.trigger("option:deselect",e,t)},_deselectInvalidSelection:function(){var e=this.get("selectedOption");this._isValidOption(e)||this.deselectOption()},_isValidOption:function(e){return SW.Array.deepIncludes(this.get("options"),e)},selectOptionByIndex:function(e){var t=this.get("options");this.set({selectedOption:t[e]})},deselectOption:function(){this.set({selectedOption:null})},setFilterText:function(e){this.set({filterText:e})},getSelectedOptionText:function(){var e=this.get("selectedOption");return this._getOptionText(e)},_getOptionText:function(e){return this._isValidOption(e)?this.get("getOptionText")(e):""},getFormattedFilteredOptions:function(){return _.reduce(this.get("options"),function(e,t,i){return this._satisfiesFilter(t)&&e.push({index:i,text:this._getOptionText(t)}),e}.bind(this),[])},_satisfiesFilter:function(e){var t=this.get("filter"),i=this.get("filterText"),s=this._getOptionText(e);return this._isFilterable(e)||t(i,s,e)},_isFilterable:function(e){var t=this.get("unfilterableOptions");return SW.Array.deepIncludes(t,e)}}),SW.LocationFilterListView=SW.ParentView.extend({className:"location-filter-list",initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("location-filter-list"),this.childViews.filterListView=new SW.FilterListView({model:this.model.filterList}),this.listenTo(this.model,"change:availableLocations change:hasError change:errorNotice",this.render)},render:function(){return this.renderTemplate(),this.renderFilterListView(),this.$el},renderTemplate:function(){this.$el.html(this.template({availableLocations:this.model.get("availableLocations"),hasError:this.model.get("hasError"),errorNotice:this.model.get("errorNotice")}))},renderFilterListView:function(){var e=this.childViews.filterListView;this.$(".js-filter-list").html(e.render()),e.delegateEvents()}}),SW.LocationFilterList=SW.Model.extend({defaults:{availableLocations:[],selectedLocation:null},initialize:function(){this.filterList=new SW.FilterList({placeholder:"Search for a location...",getOptionText:function(e){return e.name}}),this._updateFilterListOptions(),this._updateFilterListSelection(),this.listenTo(this,"change:availableLocations",this._updateFilterListOptions),this.listenTo(this,"change:selectedLocation",this._updateFilterListSelection),this.listenTo(this.filterList,"option:select",this.selectLocation),this.listenTo(this.filterList,"option:deselect",this.deselectLocation)},_updateFilterListOptions:function(){var e=this.get("availableLocations"),t=_.filter(e,{name:"Other"});this.filterList.set({options:e,unfilterableOptions:t})},_updateFilterListSelection:function(){this.filterList.set({selectedOption:this.get("selectedLocation")})},selectLocation:function(e,t){SW.Logger.track({name:"location:filter",details:{location:e.name,filter:t}}),this.set({selectedLocation:e}),this.trigger("location:select",e)},deselectLocation:function(){var e=null;this.set({selectedLocation:e}),this.trigger("location:deselect",e)},loadLocationData:function(){this._loadAvailableLocations(this._loadUserLocation.bind(this,this._triggerLoadSuccess.bind(this)),this._triggerLoadError.bind(this))},_loadAvailableLocations:function(e,t){SW.Http.fetch({url:sw.config.api.assignments+"/v1/test-prep/locations",method:"GET",success:function(t){this.set({availableLocations:this._parseLocationData(t)}),e()}.bind(this),error:t})},_parseLocationData:function(e){var t=_(e).filter({countryCode:"USA"}).orderBy("province").value(),i=_(e).filter({countryCode:"CAN"}).orderBy("province").value(),s=_(e).difference(t).difference(i).orderBy(["countryCode","province"]).value(),n=t.concat(i).concat(s);return _.map(n,function(e){return{id:e.id,name:e.province}})},_loadUserLocation:function(e){SW.Http.fetch({url:sw.config.api.accounts+"/v2/user/"+sw.user.get("userID")+"/location-data",method:"GET",success:function(t){this._attemptSelectSchoolLocation(t),this.get("selectedLocation")||this._attempSelectCurriculumLocation(),e()}.bind(this),error:function(){this._attempSelectCurriculumLocation(),e()}.bind(this)})},_attemptSelectSchoolLocation:function(e){if(e){var t=e.province,i=this.get("availableLocations"),s=_.find(i,{name:t});this.set({selectedLocation:s})}},_attempSelectCurriculumLocation:function(){var e=sw.user.classes.getCurrentClass(),t=e.getLocationName(),i=this.get("availableLocations"),s=_.find(i,{name:t});this.set({selectedLocation:s})},_triggerLoadSuccess:function(){var e=this.get("selectedLocation");this.trigger("load:success",e)},_triggerLoadError:function(){var e=this.get("selectedLocation");this.trigger("load:error",e)}}),SW.TutorialStep=SW.Model.extend({defaults:{id:"",url:"",index:""},initialize:function(){this.lastTimeLoaded=null,this.loaded=!1,this.loading=!1,this.error=null},beforeLoad:function(){this.loaded=!1,this.loading=!0,this.error=null},load:function(){var e;this.beforeLoad(),this.afterLoad(e)},afterLoad:function(e){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.error=e,this.trigger("load:complete",{error:e})}}),SW.TutorialStepView=SW.ParentView.extend({events:{"click .js-tutorial-next-step":"nextStep","click .js-tutorial-start":"trackTutorialStart"},initialize:function(e){this._super("initialize",arguments),this.template={},e.template&&(this.template.base=this.findTemplate(e.template)),this.createProgressBar()},createProgressBar:function(){var e=this.model.get("progress");e.totalSteps>1&&(this.childViews.progressBar=new SW.ProgressBarView({style:"dot",elementClassModifiers:"tutorial-step__progress-bar",model:new SW.ProgressBar({total:e.totalSteps+1,segments:[{key:"progress",value:e.currentStep}]})}))},render:function(e){var t=_.extend(e||{},this.model.toJSON()),i=this.template.base(t);return this.$el.html(i),this.additionalRendering(),this.renderProgressBar(),this.$el},renderProgressBar:function(){this.childViews.progressBar&&this.$(".app-section").append(this.childViews.progressBar.render())},additionalRendering:function(){},enableNextButton:function(){_.delay(function(){this.$(".js-tutorial-next-step").removeClass("invisible btn--disabled")}.bind(this),100)},nextStep:function(){sw.dispatcher.trigger("tutorial-step:next",this.model.get("index"))},trackTutorialStart:function(){sw.user.isTeacher()&&sw.track.adRollConversion()}}),SW.TutorialCreateClassStep=SW.TutorialStep.extend({}),SW.TutorialCreateClassStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-actions-submit-edit-class":"submitEditClass"})},initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("tutorial-step-create-class"),this.listenTo(sw.dispatcher,"class-list:edit:info",this.nextStep),this.createEditClass()},additionalRendering:function(){this.renderEditClass()},createEditClass:function(){this.childViews.editClass||(this.childViews.editClass=new SW.EditClassView({style:"form",model:sw.user.classes.getCurrentClass()}))},renderEditClass:function(){this.childViews.editClass&&(this.$(".js-edit-class-container").html(this.childViews.editClass.render()),this.$("#class-grade-select").val(""))},submitEditClass:function(){this.childViews.editClass.saveChanges()}}),SW.TutorialCreatePlanStep=SW.TutorialStep.extend({initialize:function(){this._super("initialize",arguments),this.load()},load:function(){this.beforeLoad(),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){this.loadSuccess(),this.afterLoad()}.bind(this),fail:function(){this.afterLoad("There was an error loading this step.")}.bind(this)})},loadSuccess:function(){this.set("curriculumID",sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum()),this.set("curriculumTreeID",this.getCurriculumTreeID()),this.set("grade",this.getGrade()),this.listenTo(this,"change:curriculumTreeID",this.setCurriculumID)},getGrade:function(){return SW.Education.curriculumIDs[this.get("curriculumID")].grade},getCurriculumTreeID:function(){return SW.Education.curriculumIDs[this.get("curriculumID")].locationID},setCurriculumID:function(){this.set("curriculumID",this.getCurriculumIDFromGradeAndTreeID())},getCurriculumIDFromGradeAndTreeID:function(){var e;return _.forEach(SW.Education.curriculumIDs,function(t,i){t.grade===this.get("grade")&&t.locationID===this.get("curriculumTreeID")&&(e=i)}.bind(this)),e}}),SW.TutorialCreatePlanStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-create-plan-step-submit":"submitCreatePlanStep"})},initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("tutorial-step-create-plan")},additionalRendering:function(){this.createTopicSelect(),this.renderTopicSelect(),this.listenToOnce(this.model,"load:complete",this.createCreatePlanForm),this.listenTo(this.model,"change:curriculumID",this.updateTopicSelect),this.model.load()},updateTopicSelect:function(){this.childViews.topicSelect.resetSelectedTopic(),this.childViews.topicSelect.model.changeSelectedGrade(this.model.get("curriculumID"))},createCreatePlanForm:function(){this.childViews.form||(this.childViews.form=new SW.FormView({el:this.$(".js-create-plan-form"),fetch:{method:"POST",url:sw.config.api.planner+"/v2/classes/"+sw.user.classes.getCurrentClassID()+"/plans",success:function(){this.nextStep()}.bind(this),error:function(){}},formatData:function(){var e=new Date,t=new Date;return t.setDate(t.getDate()+13),{startDate:SW.Utility.getDateString(e),endDate:SW.Utility.getDateString(t),timezone:moment.tz.guess(),curriculumID:this.model.get("curriculumID"),curriculumTreeID:this.model.get("curriculumTreeID"),topicName:this.childViews.topicSelect.model.get("selectedTopic").topicName,
skillIDs:this.childViews.topicSelect.model.get("selectedSkillIDs")}}.bind(this)}))},createTopicSelect:function(){var e;this.childViews.topicSelect||(e=sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum(),this.childViews.topicSelect=new SW.TopicSelectView({template:"topic-select-minimal-template",model:new SW.TopicSelect({selectedGrade:e})}))},renderTopicSelect:function(){this.childViews.topicSelect&&this.$(".js-create-plan-form-topic-select").html(this.childViews.topicSelect.render())},submitCreatePlanStep:function(){this.childViews.topicSelect.isValid()?this.childViews.form.submit():this.childViews.topicSelect.renderIncompleteForm()}}),SW.TutorialLocationStep=SW.TutorialStep.extend({}),SW.TutorialLocationStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-location-select-submit":"submitLocation"})},initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("tutorial-step-location"),this.createLocationSelect(),this.listenTo(this.childViews.locationSelect,"submit:complete",this.nextStep)},additionalRendering:function(){this.renderLocationSelect()},createLocationSelect:function(){this.childViews.locationSelect||(this.childViews.locationSelect=new SW.LocationSelectView({model:new SW.LocationSelect}))},renderLocationSelect:function(){this.$(".js-location-select").html(this.childViews.locationSelect.render())},submitLocation:function(){this.childViews.locationSelect.submitLocation()}}),SW.TutorialWelcomeStep=SW.TutorialStep.extend({}),SW.TutorialWelcomeStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-welcome-step-submit":"submitCurriculumSelectForm"})},initialize:function(){var e=sw.user.isParent()?"new-parent-welcome-tutorial-step":"tutorial-step-welcome";this._super("initialize",arguments),this.template.base=this.findTemplate(e),this.createCurriculumSelect()},additionalRendering:function(){this.renderCurriculumSelect(),this.renderCurriculumSelectForm()},createCurriculumSelect:function(){this.childViews.curriculumSelect||(this.childViews.curriculumSelect=new SW.CurriculumSelectView({template:sw.user.isParent()?"location":null,model:new SW.CurriculumSelect}))},renderCurriculumSelect:function(){this.childViews.curriculumSelect&&this.$(".js-curriculum-select-form").append(this.childViews.curriculumSelect.render())},renderCurriculumSelectForm:function(){this.childViews.curriculumSelectForm||(this.childViews.curriculumSelectForm=new SW.FormView({el:this.$(".js-curriculum-select-form"),fetch:{method:"POST",url:sw.config.api.accounts+"/v2/user/"+sw.user.get("userID"),success:function(e,t){var i=JSON.parse(t.change_fields),s=parseInt(i.curriculumTreeID,10);sw.user.set("curriculumTreeID",s),sw.user.setCurricula(s),sw.user.updateSession({curriculumTreeID:s}),this.nextStep()}.bind(this)},formatData:function(e){var t=e["curriculum-select"];return{change_fields:JSON.stringify({curriculumTreeID:t})}}}))},submitCurriculumSelectForm:function(){this.childViews.curriculumSelectForm.submit()}}),SW.MultipleClassesMigrationReviewClassTutorialStep=SW.TutorialStep.extend({initialize:function(e,t){this._super("initialize",arguments),this.load()},load:function(){this.beforeLoad(),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){this.loadSuccess(),this.afterLoad()}.bind(this),fail:function(){this.afterLoad("There was an error loading this step.")}.bind(this)})},loadSuccess:function(){this.set("class",sw.user.classes.getCurrentClass())}}),SW.MultipleClassesMigrationReviewClassTutorialStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-actions-continue":"continueWithExistingClass","click .js-actions-new-class":"continueWithNewClass"})},initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("tutorial-step-multiple-classes-migration-review-class")},additionalRendering:function(){this.listenToOnce(this.model,"load:complete",this.renderStudentList),this.model.load()},renderStudentList:function(){this.model.get("class").students.each(function(e){this.$(".js-students-list").append("<li>"+e.get("name")+"</li>")}.bind(this))},continueWithNewClass:function(){this.createDialog({type:"confirmation",size:"medium-small",title:"Are you sure?",main:"You are about to remove your current students from your class list, and will no longer be able to access their data. You can always add them back later if you wish!",buttons:[{text:"Cancel"},{text:"Yes, Remove Students",className:"btn-flat--warning",callback:function(){this.clearStudentsInClass(),this.closeDialog()}.bind(this)}]})},clearStudentsInClass:function(){this.listenTo(sw.user.classes,"remove:all-students",this.nextStep),sw.user.classes.getCurrentClass().removeAllStudents()},continueWithExistingClass:function(){this.nextStep()}}),SW.MultipleClassesMigrationUpdateClassTutorialStep=SW.TutorialStep.extend({initialize:function(e,t){this._super("initialize",arguments),this.load()},load:function(){this.beforeLoad(),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){this.loadSuccess(),this.afterLoad()}.bind(this),fail:function(){this.afterLoad("There was an error loading this step.")}.bind(this)})},loadSuccess:function(){this.set("class",sw.user.classes.getCurrentClass())}}),SW.MultipleClassesMigrationUpdateClassTutorialStepView=SW.TutorialStepView.extend({events:function(){return _.extend({},SW.TutorialStepView.prototype.events,{"click .js-actions-submit-edit-class":"submitEditClass"})},initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("tutorial-step-multiple-classes-migration-update-class"),this.listenTo(this.model,"load:complete",this.createEditClass),this.model.loaded?this.createEditClass():this.model.loading||this.model.load(),this.listenTo(sw.dispatcher,"class-list:edit:info",this.nextStep),this.model.load()},additionalRendering:function(){this.listenTo(this.model,"load:complete",this.renderEditClass),this.model.loaded?this.renderEditClass():this.model.loading||this.model.load()},createEditClass:function(){this.childViews.editClass||(this.childViews.editClass=new SW.EditClassView({style:"form",model:this.model.get("class")}))},renderEditClass:function(){this.childViews.editClass&&this.$(".js-edit-class-container").html(this.childViews.editClass.render())},submitEditClass:function(){this.childViews.editClass.saveChanges()}}),SW.CreateClassView=SW.ParentView.extend({className:"create-class",events:{"click [sw-method]":"onChangeMethod"},initialize:function(e){this._super("initialize",arguments),this.dialog=e.dialog,this.currentMethod="existing-account",this.className+=sw.user.parentApp()?" create-class--parent-app":"",this.$el.attr("class",this.className),sw.user.parentApp()?(this.template=this.findTemplate("create-kid"),this.templateLoginInfo=this.findTemplate("create-kid-login-info")):e.style?(this.$el.addClass("create-class--"+e.style),this.template=Handlebars.compile($("#create-class-"+e.style+"-template").html())):this.template=Handlebars.compile($("#create-class-template").html())},onChangeMethod:function(e){var t=$(e.currentTarget),i=t.attr("sw-method");i!==this.currentMethod&&(this.currentMethod=i,this.$("[sw-method]").removeClass("toggle-btn--selected"),t.addClass("toggle-btn--selected"),this.$(".js-form-method").addClass("gone"),this.$(".js-"+i+"-form").removeClass("gone"),this.dialog&&sw.dispatcher.trigger("dialog:resize"))},render:function(){var e={curricula:this.getCurricula()},t=this.template(e);return this.$el.html(t),this.initializeFormView(),this.$el},getCurricula:function(){return sw.user.get("curricula").filter(function(e){return e.name.indexOf("EQAO")===-1})},initializeFormView:function(){sw.user.parentApp()?this.createParentFormView():this.createTeacherFormView()},createTeacherFormView:function(){var e=!!this.dialog;this.childViews.form=new SW.FormView({el:this.$("form"),inDialog:e,fetch:{url:sw.config.api.accounts+"/v2/teacher/"+sw.user.get("userID")+"/class",method:"PUT",success:this.submitComplete.bind(this)}})},createParentFormView:function(){var e=!!this.dialog;this.childViews.formExisting=new SW.FormView({el:this.$(".js-existing-account-form"),inDialog:e,removeLoadingIconOnSuccess:!1,fetch:{url:sw.config.api.accounts+"/v2/child",method:"POST",success:this.onParentFormSubmitSuccess.bind(this,!1)}}),this.childViews.formCreate=new SW.FormView({el:this.$(".js-new-account-form"),inDialog:e,removeLoadingIconOnSuccess:!1,fetch:{url:sw.config.api.accounts+"/v2/child",method:"POST",success:this.onParentFormSubmitSuccess.bind(this,!0)},formatData:function(e){return _.assign({},e,{curriculumTreeID:sw.user.get("curriculumTreeID")})}})},onParentFormSubmitSuccess:function(e,t){var i=t.classroom;this.submitComplete(i),sw.user.classes.load(function(){var t=sw.user.classes.find(function(e){return e.get("classCode")===i.class_code}).students.at(0).toJSON();e?_.delay(function(){var e,i=SW.Utility.firstName(t.name),s=this.openDialog({type:"alert",size:"medium-small",title:"Account created",main:this.templateLoginInfo({username:t.username,password:t.password,firstName:i})});e=s.close,s.close=function(){e.call(this),sw.dispatcher.trigger("parent:student-added",[t])}.bind(s)}.bind(this),500):sw.dispatcher.trigger("parent:student-added",[t]),SW.Logger.track({name:"add-student",details:{isNewStudent:e,student:_.omit(t,"password")}})}.bind(this))},submitComplete:function(e){var t=sw.user.classes.add(sw.user.classes.formatClassData(e));this.model.trigger("class:create",t),this.dialog&&this.closeDialog()}}),SW.CreateClass=SW.Model.extend({}),SW.ClassPreviewView=SW.ParentView.extend({className:"class-preview",events:{"click .js-edit-class-btn":"openEditClassDialog","click .js-class-preview-manage":"onManageClassClick"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("class-preview"),this.listenTo(this.model,"change",this.render)},render:function(){var e,t=this.model.toJSON(),i=this.model.students.length,s=SW.Lexicon(SW.Utility.pluralizer("Student","Students",i)),n=_.find(sw.user.get("curricula"),{curriculumID:t.curriculumID});return t.studentsText=i+" "+s,t.parentApp=sw.user.parentApp(),t.grade=n?n.name:null,e=this.template(t),this.$el.html(e)},openEditClassDialog:function(){sw.dialogManager.openEditClass(this.model)},onManageClassClick:function(){var e="";sw.user.parentApp()&&(e="profile"),sw.user.classes.changeCurrentClass(this.model.get("id")),sw.dispatcher.trigger("navigate",e)}}),SW.AddStudentsView=SW.ParentView.extend({className:"add-students",events:{"click [sw-method]":"changeMethod","click .js-create-students":"handleCreateStudents","input [sw-student-row] input":"handleStudentInputChange"},initialize:function(e){this._super("initialize",arguments),this.dialog=e.dialog,this._addStudentRowsNumber=45,this._methodToggleSelectClassName="add-students__method-toggle-btn--selected",this.template={base:Handlebars.compile($("#add-students-template").html()),classcode:Handlebars.compile($("#add-students-classcode-template").html()),manual:Handlebars.compile($("#add-students-manual-template").html()),createStudentsRow:Handlebars.compile($("#add-students-manual-new-student-row-template").html()),existingStudentsRow:Handlebars.compile($("#add-students-manual-existing-student-row-template").html()),manualErrors:Handlebars.compile($("#add-students-manual-errors-template").html())},this.listenTo(this.model,"change:method",this.handleMethodChange),this.listenTo(this.model,"add-students:start",this.handleLoading),this.listenTo(this.model,"add-students:success",this.handleAddStudentsSuccess),this.listenTo(this.model,"add-students:error",this.handleAddStudentsError),this.listenTo(this.model,"add-students:invalid-students",this.handleInvalidStudentsError)},render:function(){var e=this.getTemplateData(),t=this.template.base(e);return this.$el.html(t),e.method&&this.renderSelectedMethod(e),this.$el},getTemplateData:function(){var e=this.model.toJSON();return e.classcode=sw.user.classes.getByID(e.classID).get("classCode")||"CODE NOT FOUND","create-students"===e.method?e.isCreateStudents=!0:"existing-students"===e.method&&(e.isExistingStudents=!0),e},renderSelectedMethod:function(e){var t,i,e=e||this.getTemplateData();"classcode"===e.method?(t=this.template.classcode(e),i=".js-change-method[sw-method=classcode]"):(t=this.template.manual(e),i=".js-change-method[sw-method=create-students]"),this.$(".js-selected-method-container").html(t),"classcode"!=e.method&&(this.renderAddStudentTableRows(e),this.updateAllStudentRowInputs()),this.$("."+this._methodToggleSelectClassName).removeClass(this._methodToggleSelectClassName),this.$(i).addClass(this._methodToggleSelectClassName),sw.dispatcher.trigger("dialog:resize")},renderAddStudentTableRows:function(e){var t,e=e||this.getTemplateData(),s=this.$(".js-add-student-table tbody");for("create-students"===e.method?t="createStudentsRow":"existing-students"===e.method&&(t="existingStudentsRow"),i=0;i<this._addStudentRowsNumber;i++)s.append(this.template[t]({index:i+1}))},updateAllStudentRowInputs:function(){var e,t=this.model.get("method");"create-students"===t?e=this.model.get("newAccounts"):"existing-students"===t&&(e=this.model.get("existingAccounts")),e.forEach(this.updateStudentRowInputs.bind(this))},updateStudentRowInputs:function(e){var t=this.getRowFromAccount(e);t.find("[name=first_name]").val(e.first_name),t.find("[name=last_name]").val(e.last_name),t.find("[name=username]").val(e.username),t.find("[name=password]").val(e.password)},getRowFromAccount:function(e){return this.$("[sw-student-row="+e.index+"]")},changeMethod:function(e){var t=$(e.target),i=t.attr("sw-method");t.hasClass("js-change-method")||SW.Storage.set("manual-method",i),t.hasClass("js-change-method")&&"classcode"!==i&&(SW.Storage.get("manual-method"),i=SW.Storage.get("manual-method")||i),_.isString(i)&&this.model.setMethod(i)},handleMethodChange:function(){this.renderSelectedMethod()},handleCreateStudents:function(){var e;this.model.get(this.model.getCurrentMethodAccountsPropName()).length>0?(e=this.validateAccountData(!0),e&&this.model.submitAccounts()):sw.toastManager.create({id:"add-students-empty",type:"warning",content:"You haven't entered any account info yet!",timer:7e3})},validateAccountData:function(e){var t,i={},s=!0,n=this.model.getInvalidAccountInfo(e);return this.removeErrorMessages(),n.length&&(t=n.map(function(e){return i.firstName=i.firstName||e.isFirstNameValid===!1,i.lastName=i.lastName||e.isLastNameValid===!1,i.username=i.username||e.isUsernameValid===!1,i.password=i.password||e.isPasswordValid===!1,this.renderAccountError(e)," "+e.index}.bind(this)),this.$(".js-add-students-error-container").html(this.template.manualErrors({firstNameError:i.firstName,lastNameError:i.lastName,usernameError:i.username,passwordError:i.password,rowsWithErrors:t.toString(),minNameLength:SW.Validate.minNameLength,minPasswordLength:SW.Validate.minPasswordLength})),s=!1),s},removeErrorMessages:function(){this.$(".js-add-students-error-container").html(""),this.removeAllInputErrors()},removeAllInputErrors:function(){this.$("[sw-student-row] input.js-warning").removeClass("js-warning warning-text warning-bg")},renderAccountError:function(e){var t=this.getRowFromAccount(e),i=this.model.get("method");"existing-students"===i?(e.isUsernameValid||this.renderInputError(t.find("[name=username]")),e.isPasswordValid||this.renderInputError(t.find("[name=password]"))):"create-students"===i&&(e.isFirstNameValid||this.renderInputError(t.find("[name=first_name]")),e.isLastNameValid||this.renderInputError(t.find("[name=last_name]")))},renderInputError:function(e,t){e.addClass("js-warning warning-text warning-bg")},handleStudentInputChange:function(e){var t=$(e.target),i=t.hasClass("js-warning"),s=t.parents("[sw-student-row]"),n=this.getStudentFromRow(s);this.syncStudentData(n),i&&this.validateAccountData(!0)},syncStudentData:function(e){var t=this.studentRowHasValues(e);t?this.model.addAccountData(e):this.model.removeAccountData(e)},studentRowHasValues:function(e){var t=["first_name","last_name","username","password"];return this._checkForValue(e,t)},_checkForValue:function(e,t,i){var i=i||0,s=t.length===i-1,n=e[t[i]],a=_.isString(n)&&0!=n.length;return s?a:a||this._checkForValue(e,t,++i)},getStudentFromRow:function(e){var t={index:e.attr("sw-student-row")},i=e.find("input");return i.each(function(){var e=$(this);t[e.attr("name")]=e.val()}),t},handleLoading:function(){this.dialog?this.createLoadingOverlay():this.createDialog({type:"load"})},createLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:create")},removeLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:remove")},handleAddStudentsSuccess:function(e){var t=this.model.get("studentCopy"),i=t.singularCapitalized+" added!",s=t.pluralCapitalized+" added!",n=sw.user.isParent()?"children's":"students'",a=SW.Utility.pluralizer(i,s,e.numOfStudents);this.openDialog({type:"confirmation",title:a,main:"Do you want to view a printable list of your "+n+" login&nbsp;info?",buttons:[{text:"Not now"},{text:"View login info",className:"btn-flat--blue",href:"/actions/printStudentLogins.php?class-id="+this.model.get("classID"),target:"_blank",callback:function(){sw.dispatcher.trigger("dialog:close",{instant:!0})}}]})},handleAddStudentsError:function(){var e=this.model.get("studentCopy"),t="There was an error adding "+e.plural+" to your class.";this.dialog?(this.removeLoadingOverlay(),sw.toastManager.create({id:"add-students-error-toast",type:"error",content:t,timer:1e4})):this.createDialog({type:"alert",title:"Whoops",main:t})},handleInvalidStudentsError:function(e){var t=[];this.dialog?this.removeLoadingOverlay():this.closeDialog(),e.forEach(function(e){e.isPasswordValid=!1,e.isUsernameValid=!1,t.push(e.index),this.renderAccountError(e)}.bind(this)),this.$(".js-add-students-error-container").html(this.template.manualErrors({invalidAccountError:!0,rowsWithErrors:t.join(", ")}))}}),SW.AddStudents=SW.Model.extend({defaults:{method:void 0,newAccounts:[],existingAccounts:[],feature:{classcode:!0,newAccounts:!0,existingAccounts:!0},studentCopy:{singular:"student",singularCapitalized:"Student",plural:"students",pluralCapitalized:"Students"}},initialize:function(){var e=SW.Storage.get("method");this.toggleFeatures(),this.setStudentCopy(),this.setMethod(e||"classcode")},toggleFeatures:function(){var e=sw.user.isParent();this.set("feature",{classcode:!e,newAccounts:!0,existingAccounts:!0})},setStudentCopy:function(){var e=sw.user.isParent();e&&this.set("studentCopy",{singular:"child",singularCapitalized:"Child",plural:"children",pluralCapitalized:"Children"})},setMethod:function(e){var t=this.get("feature");t.classcode||"classcode"!==e||(e="create-students"),this.set("method",e),SW.Storage.set("method",e)},addAccountData:function(e){var t=this.getCurrentMethodAccountsPropName();accounts=this.get(t).slice(0),existingIndex=this.getAccountIndexFromAccounts(e,accounts),existingIndex>-1?accounts[existingIndex]=e:accounts.push(e),this.set(t,accounts)},removeAccountData:function(e){var t=this.getCurrentMethodAccountsPropName();accounts=this.get(t).slice(0),existingIndex=this.getAccountIndexFromAccounts(e,accounts),existingIndex>-1&&(accounts.splice(existingIndex,1),this.set(t,accounts))},getAccountIndexFromAccounts:function(e,t){return _.findIndex(t,{index:e.index})},getCurrentMethodAccountsPropName:function(){var e,t=this.get("method");return"create-students"===t?e="newAccounts":"existing-students"===t&&(e="existingAccounts"),e},getInvalidAccountInfo:function(e){var t,i=this.get("method");return"create-students"===i?t=this.get("newAccounts"):"existing-students"===i&&(t=this.get("existingAccounts")),t.filter(function(t){return!this.validateAccount(t,e)}.bind(this))},validateAccount:function(e,t){var i=this.get("method"),s=!1;return"existing-students"===i?(e.isUsernameValid=this.validateProperty(e.username,SW.Validate.name,t),e.isPasswordValid=this.validateProperty(e.password,SW.Validate.text,t),s=e.isUsernameValid&&e.isPasswordValid):"create-students"===i&&(e.isFirstNameValid=this.validateProperty(e.first_name,SW.Validate.name,t),e.isLastNameValid=this.validateProperty(e.last_name,SW.Validate.text,t),s=e.isFirstNameValid&&e.isLastNameValid),s},validateProperty:function(e,t,i){var s=!0;return(i||_.isString(e)&&e.length>0)&&(s=t(e)),s},submitAccounts:function(){var e=this.get("method"),t=this.get(this.getCurrentMethodAccountsPropName());this.trigger("add-students:start"),"create-students"===e?(t.forEach(function(e){e.first_name=e.first_name.trim(),e.last_name=e.last_name.trim()}),this.addNewStudents(t)):"existing-students"===e&&this.addExistingStudents(this.filterOutDuplicateAccounts(t))},filterOutDuplicateAccounts:function(e){var t=[];return e.forEach(function(e){var i=_.findIndex(t,function(t){return t.username.toLowerCase()===e.username.toLowerCase()})>-1;i||t.push(e)}),t},addNewStudents:function(e){var t={students:[]},i=sw.user.classes.getCurrentClass().getGrade(),s=sw.user.classes.getCurrentClassID(),n=sw.user.get("curriculumTreeID");t.students=e.map(function(e){return{firstName:e.first_name,lastName:e.last_name,grade:i,chosenGrade:i,curriculumTreeID:n,classID:s}}),SW.Http.fetch({url:sw.config.api.accounts+"/v2/students-batch",method:"post",data:t,stringify:!0,success:this.addNewStudentsSuccessCallback.bind(this),error:this.addNewStudentsErrorCallback.bind(this)})},addNewStudentsSuccessCallback:function(e){var t=e.map(function(e){var t=e;return t.userID=t.objectID,t});sw.user.classes.getByID(this.get("classID")).addStudents(t),this.trigger("add-students:success",{numOfStudents:t.length})},addNewStudentsErrorCallback:function(){this.trigger("add-students:error")},addExistingStudents:function(e){this._attachStudents(e,"PUT")},_attachStudents:function(e,t){var t=t.toUpperCase(),i={students:e};"POST"===t&&(i.curriculum_tree_id=sw.user.get("curriculumTreeID")),SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+this.get("classID")+"/students",method:t.toUpperCase(),data:i,stringify:!0,success:this.handleAttachStudentsSuccess.bind(this),error:this.handleAttachStudentsError.bind(this)})},handleAttachStudentsSuccess:function(e){var t,i,s=sw.user.classes.getCurrentClass().getGrade();_.isArray(e)&&(t=_.filter(e,function(e){return _.isPlainObject(e)}),t.length===e.length?(sw.user.classes.getByID(this.get("classID")).addStudents(e),s>=0&&sw.user.isTeacher()&&(i=_.map(e,function(e){return{id:e.userID,grade:s}}),SW.Http.fetch({url:sw.config.api.accounts+"/v2/students",method:"patch",data:{students:i}}))):sw.user.classes.load(),this.trigger("add-students:success",{numOfStudents:e.length}))},handleAttachStudentsError:function(e){var t=e&&e.responseJSON&&e.responseJSON.students&&e.responseJSON.students.invalid.length>0;t?this.trigger("add-students:invalid-students",e.responseJSON.students.invalid):this.trigger("add-students:error")}}),SW.StudentPreviewView=SW.ParentView.extend({className:"student-preview",events:{"click .js-edit-student":"openEditDialog","click .js-open-connect-parents":"openConnectParentsDialog","change .js-select-checkbox":"toggleSelect"},initialize:function(){this._super("initialize"),this.isSelected=!1,this.template=this.findTemplate("student-preview"),this.listenTo(this.model,"change",this.render)},render:function(){var e,t=this.model.toJSON();return t.feature={connectParents:!sw.user.isParent()},t.initials=this.getStudentInitials(t),t.isSelected=this.isSelected,t.studentColor=SW.Colors.colorizeID(t.userID),t.isParentConnected=_.isString(t.parentEmail),e=this.template(t),this.$el.html(e)},getStudentInitials:function(e){var t,i,s=e.fullname.split(" "),n=[];return s.forEach(function(e){var t=e.trim();t.length>0&&n.push(t)}),t=n[0].charAt(0).toUpperCase(),i=n.length>1?_.last(n).charAt(0).toUpperCase():"",t+i},openEditDialog:function(){this.createDialog({type:"confirmation",size:"medium-small",title:"Edit "+SW.Lexicon("student"),buttons:[{text:"Cancel"},{text:"Save changes",className:"btn-flat--blue"}],children:[{view:SW.EditStudentView,model:this.model}]})},openConnectParentsDialog:function(){this.createDialog({type:"shell",title:"Keep parents informed!",headerClassName:"text-center row-collapse-b",size:"medium",children:[{view:SW.ConnectParentsView,model:SW.ConnectParents,modelData:{classID:sw.user.classes.getCurrentClassID()}}]})},toggleSelect:function(){this.isSelected=!this.isSelected,sw.dispatcher.trigger("student-preview:selection",this.isSelected)},deselect:function(){this.isSelected&&this.$(".js-select-checkbox").prop("checked",!1).change()},select:function(){this.isSelected||this.$(".js-select-checkbox").prop("checked",!0).change()},close:function(){this.deselect(),this._super("close")}}),SW.StudentPreview=SW.Model.extend({}),SW.EditClassView=SW.ParentView.extend({events:{"click .js-delete-class-btn":"deleteClass","click .js-remove-student-btn":"removeStudent","change #class-grade-select":"trackGradeSelect"},initialize:function(e){this._super("initialize",arguments),e.dialog&&(this.dialog=e.dialog,this.listenTo(this.dialog,"click:button-1",this.saveChanges)),sw.user.parentApp()?this.template=this.findTemplate("edit-kid"):e.style?(this.$el.addClass("edit-class--"+e.style),this.template=this.findTemplate("edit-class-"+e.style)):this.template=this.findTemplate("edit-class"),sw.track.event("edit-class","open")},render:function(){var e,t,i=this.model.toJSON();return i.curricula=_.cloneDeep(this.getCurricula()),i.inDialog=!!this.dialog,sw.user.parentApp()&&(i.student=this.getFirstStudent().toJSON(),t=_.find(i.curricula,{curriculumID:i.student.curriculumOverride}),t&&(t.selected=!0)),e=this.template(i),this.$el.html(e),this.initializeFormView(i),this.selectGrade(),this.$el},getCurricula:function(){return sw.user.get("curricula").filter(function(e){return e.name.indexOf("EQAO")===-1})},trackGradeSelect:function(){sw.track.event("edit-class","change-grade")},initializeFormView:function(e){var t=this.getFirstStudent(),i=t&&t.id,s=e.id,n=!!this.dialog,a=sw.user.parentApp()?sw.config.api.accounts+"/v2/child/"+s+"/"+i:sw.config.api.accounts+"/v2/class/"+s,r=this.submitComplete.bind(this,e);this.childViews.form=new SW.FormView({el:this.$("form"),inDialog:n,fetch:{url:a,method:"POST",success:r}})},submitComplete:function(e,t,i){var s,n=sw.user.classes.getByID(e.id);sw.user.parentApp()?(n.set({name:i.name}),s=this.getFirstStudent(),s.set({fullname:i.name,name:i.name}),i.password&&s.set({password:i.password}),this.shouldUpdateGradeOverride(s,i["student-grade-override"])?this.updateChildGradeOverride(s,n,i["student-grade-override"]):(sw.dispatcher.trigger("class-list:edit:info",n),this.dialog&&this.closeDialog())):(n.set({name:i.name,curriculumID:parseInt(i.grade,10)}),sw.dispatcher.trigger("class-list:edit:info",n),this.dialog&&this.closeDialog())},shouldUpdateGradeOverride:function(e,t){var i=SW.Education.curriculumIDs[e.get("curriculumOverride")],s=SW.Education.curriculumIDs[t];return typeof i!=typeof s||i&&s&&i.grade!==s.grade},updateChildGradeOverride:function(e,t,i){var s={curriculumOverride:i||null};SW.Http.fetch({url:sw.config.api.accounts+"/v2/student/"+e.get("userID"),method:"POST",data:{change_fields:JSON.stringify(s)},success:function(){e.set({curriculumOverride:i?parseInt(i,10):null}),sw.dispatcher.trigger("class-list:edit:info",t),this.dialog&&this.closeDialog()}.bind(this)})},selectGrade:function(){var e=this.model.get("curriculumID");sw.user.parentApp()?this.$("#student-override").val(e.toString()):this.$("#class-grade-select").val(e.toString())},deleteClass:function(){var e=this.model;this.createDialog({type:"confirmation",title:"Delete class",main:"Are you sure you want to remove your <b>"+this.model.get("name")+"</b> class from your account?",buttons:[{text:"Cancel"},{text:"Delete class",className:"btn-flat--warning",callback:function(){e.removeFromUser()}}]})},removeStudent:function(){var e=this.model,t=this.getFirstStudent(),i=SW.Utility.firstName(t.get("name"));this.createDialog({type:"confirmation",title:"Remove account",main:"Are you sure you want to remove <b>"+this.model.get("name")+'</b>  from your account? <small class="text-block" style="margin-top: 11px;">'+i+" will still be able to log in and play as normal, but you will no longer be able to view their progress.</small>",buttons:[{text:"Cancel"},{text:"Remove",className:"btn-flat--warning",callback:function(){e.removeFromUser()}}]})},saveChanges:function(){this.childViews.form.submit()},getFirstStudent:function(){return this.model.students.at(0)}}),SW.EditStudentView=SW.ParentView.extend({className:"edit-student",events:{"click .js-remove-student":"removeStudentFromClass"},initialize:function(e){this._super("initialize",arguments),e.dialog&&(this.dialog=e.dialog,this.listenTo(this.dialog,"click:button-1",this.saveChanges)),this.template=this.findTemplate("edit-student")},render:function(){var e,t=this.model.toJSON();return t.curricula=sw.user.get("curricula"),t.inDialog=!!this.dialog,t.student={singularCapPossesive:SW.Lexicon("Student's"),singular:SW.Lexicon("student")},e=this.template(t),this.$el.html(e),this.initializeFormView(),this.$el},initializeFormView:function(){var e,t=!!this.dialog,i=SW.Education.curriculumIDs[this.model.get("curriculumOverride")];i&&(e=_.find(sw.user.get("curricula"),{grade:i.grade}),this.$("#student-override").val(e.curriculumID)),this.childViews.form=new SW.FormView({el:this.$("form"),inDialog:t,fetch:{url:sw.config.api.accounts+"/v2/student/"+this.model.get("id"),method:"POST",success:function(e,i){var s=JSON.parse(i.change_fields),n=s.name;this.model.set({fullname:n,name:n,curriculumOverride:s.curriculumOverride}),t&&this.closeDialog()}.bind(this)},formatData:function(e){var t={},i=e["student-name"],s=e["student-new-password"],n=e["student-override"];return i&&(t.name=i.trim()),s&&(t.password=s),n||(n=null),t.curriculumOverride=n,{change_fields:JSON.stringify(t)}}})},removeStudentFromClass:function(){var e=sw.user.classes.getCurrentClassID(),t=this.model;this.createDialog({type:"confirmation",title:"Remove student",main:"Are you sure you want to remove "+this.model.get("fullname")+" from this class?",buttons:[{text:"Cancel"},{text:"Remove student",className:"btn-flat--warning",callback:function(){sw.user.classes.getByID(e).removeStudents([t])}}]})},saveChanges:function(){this.childViews.form.submit()}}),SW.MoveStudentsView=SW.ParentView.extend({className:"move-students",events:{"change .js-select-class":"handleSelectChange","click .js-open-create-class-dialog":"handleCreateClass"},initialize:function(e){this._super("initialize",arguments),this.dialog=e.dialog,this.template=Handlebars.compile($("#move-students-template").html()),this.dialog&&this.listenTo(this.dialog,"click:button-1",this.moveSelectedStudents),this.listenTo(this.model,"move:start",this.handleMoveStart),this.listenTo(this.model,"move:error",this.handleMoveError),this.listenTo(this.model,"move:complete",this.handleMoveComplete)},render:function(){var e=_.extend(this.model.toJSON(),{classes:sw.user.classes.toJSON(),inDialog:!0}),t=this.template(e);return this.$el.html(t),this.selectDefaultClass(),this.$el},selectDefaultClass:function(){var e=parseInt(this.model.get("curentClassID"));this.$(".js-select-class").val(e),this.$(".js-select-class option:selected")[0].innerText+=" - current class"},moveSelectedStudents:function(){this.model.moveStudentsTo(this.$(".js-select-class").val())},handleSelectChange:function(){this.removeErrorMessage()},removeErrorMessage:function(){this.$(".js-error-container").html("")},handleMoveStart:function(){this.dialog&&this.createLoadingOverlay()},handleMoveError:function(e){this.$(".js-error-container").html(e)},handleMoveComplete:function(){var e=this.model.get("studentCopy");sw.toastManager.create({type:"success",content:e.pluralCapitalized+" moved successfully!",timer:5e3}),this.dialog&&sw.dialogManager.closeDialog();
},createLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:create")},removeLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:remove")},handleCreateClass:function(){this.dialog||sw.dialogManager.openCreateClass()}}),SW.MoveStudents=SW.Model.extend({defaults:{students:[],curentClassID:void 0,studentCopy:{singular:"student",singularCapitalized:"Student",plural:"students",pluralCapitalized:"Students"}},initialize:function(){this._super("initialize"),this.setStudentCopy(),this.set("isParent",sw.user.isParent())},setStudentCopy:function(){var e=sw.user.isParent();e&&this.set("studentCopy",{singular:"child",singularCapitalized:"Child",plural:"children",pluralCapitalized:"Children"})},moveStudentsTo:function(e){var t,i=this.get("studentCopy"),s=_.toInteger(e);s===this.get("curentClassID")?this.onError(new Error("These "+i.plural+" are already in that class!")):(t={class_ids:[this.get("curentClassID"),s],student_ids:this.get("students").map(function(e){return e.model.id})},this.trigger("move:start"),SW.Http.fetch({url:sw.config.api.web+"/v1/classes/students",method:"PUT",data:t,success:this.onSuccessfulMove.bind(this,s),error:this.onError.bind(this)}))},onSuccessfulMove:function(e,t){var i=t.map(function(e){return sw.user.classes.getCurrentClass().students.remove(e)});sw.user.classes.get(e).students.add(i),this.trigger("move:complete")},onError:function(e){this.trigger("move:error",e)}}),SW.ConnectParentsView=SW.ParentView.extend({className:"connect-parents",events:{"keydown .js-invite-parent-input":"handleInviteParentKeydown","click .js-invite-parent":"handleInviteParent","click .js-remove-parent":"handleRemoveParent"},initialize:function(){this._super("initialize"),sw.track.event("connect-parents","open"),this.template={base:Handlebars.compile($("#connect-parents-template").html()),student:Handlebars.compile($("#connect-parents-student-template").html())},this.createProgressBar(),this.listenTo(this.model,"connect-parent:complete",this.handleParentConnected),this.listenTo(this.model,"remove-parent:complete",this.handleParentRemoved)},createProgressBar:function(){this.childViews.progressBar=new SW.ProgressBarView({delay:{initial:500},model:new SW.ProgressBar})},render:function(){var e=this.model.getTemplateData();return this.updateProgressBar(e,{silent:!0}),this.$el.html(this.template.base(e)),this.$(".js-progress-bar-wrapper").html(this.childViews.progressBar.render()),e.students.forEach(this.renderStudent.bind(this)),this.$el},updateProgressBar:function(e,t){this.childViews.progressBar.set({total:e.totalStudents,segments:[{key:"connected-students",value:e.totalConnectedStudents,elementClassModifiers:"progress-bar__segment--green",description:"Connected Students"}]},t)},handleRemoveParent:function(e){var t=$(e.target),i=t.attr("sw-user-id");this.disableRemoveParentButton(t),this.removeParentEmailFromStudent(i),sw.track.event("connect-parents","remove")},removeParentEmailFromStudent:function(e){this.model.removeParentEmailFromStudent(e)},handleInviteParentKeydown:function(e){var t=e.keyCode?e.keyCode:e.which;13==t&&this.handleInviteParent(e)},handleInviteParent:function(e){var t=this.getInviteParentInput(e),i=t.val(),s=t.attr("sw-user-id");SW.Validate.email(i,!0)?this.connectParentToStudent(i,s):sw.toastManager.create({id:"connect-parent-email-warning",type:"warning",content:"Make sure you are inviting a valid email!",timer:4e3})},getInviteParentInput:function(e){var t,i=$(e.target);return t=i.hasClass("js-invite-parent")?i.siblings("input"):i},connectParentToStudent:function(e,t){var i=this.$("[sw-user-id="+t+"]");this.disableParentEmailInput(i),this.model.connectParentToStudent(e,t),sw.track.event("connect-parents","connect")},disableParentEmailInput:function(e){e.prop("disabled",!0).siblings("button").css("pointer-events","none").html("Sending...").parents(".input-btn-group").addClass("input-btn-group--disabled")},enableParentEmailInput:function(e){e.prop("disabled",!1).siblings("button").css("pointer-events","auto").html("Invite").parents(".input-btn-group").removeClass("input-btn-group--disabled")},disableRemoveParentButton:function(e){e.css("pointer-events","none").html("...")},enableRemoveParentButton:function(e){e.css("pointer-events","auto").html("Remove")},handleParentConnected:function(e){var t=this.$("[sw-user-id="+e.student.get("userID")+"]");this.enableParentEmailInput(t),e.error?sw.toastManager.create({id:"connect-parent-email-error-"+e.student.get("userID"),type:"error",content:"Something went wrong inviting "+e.student.get("name")+"'s parent.",timer:4e3}):(this.renderStudent(e.student),_.delay(function(){var e=this.model.getTemplateData();this.$(".js-total-connected-students").html(e.totalConnectedStudents),this.updateProgressBar(e)}.bind(this),200))},renderStudent:function(e){var t=e.toJSON(),i=this.template.student(t);this.$(".js-student-list-item-"+e.cid).html(i)},handleParentRemoved:function(e){var t;e.error?(t=this.$("[sw-user-id="+e.student.get("userID")+"]"),this.enableRemoveParentButton(t),sw.toastManager.create({id:"connect-parent-email-error-"+e.student.get("userID"),type:"error",content:"Something went wrong removing "+e.student.get("name")+"'s parent.",timer:4e3})):(sw.toastManager.create({type:"success",content:"<b>"+e.parentEmail+"</b> was removed from "+e.student.get("name")+".",timer:8e3}),this.renderStudent(e.student),_.delay(function(){var e=this.model.getTemplateData();this.$(".js-total-connected-students").html(e.totalConnectedStudents),this.updateProgressBar(e)}.bind(this),200))}}),SW.ConnectParents=SW.Model.extend({defaults:{classID:void 0},getTemplateData:function(){var e=sw.user.classes.getCurrentClass(),t=0,i=e.students.each(function(e){return e.get("parentEmail")&&t++,e});return{totalStudents:i.length,totalConnectedStudents:t,progress:t/i.length*100,students:_.sortBy(i,function(e){return _.isString(e.get("parentEmail"))})}},removeParentEmailFromStudent:function(e){var t=sw.user.classes.getCurrentClass().students.findWhere({userID:parseInt(e,10)});t&&(this.listenToOnce(t,"remove-parent-email:complete",this.removeParentEmailComplete),t.removeParentEmail())},removeParentEmailComplete:function(e){this.trigger("remove-parent:complete",e)},connectParentToStudent:function(e,t){var i=sw.user.classes.getCurrentClass().students.findWhere({userID:parseInt(t)});i&&(this.listenToOnce(i,"add-parent-email:complete",this.connectParentEmailComplete),i.addParentEmail(e))},connectParentEmailComplete:function(e){this.trigger("connect-parent:complete",e)}}),SW.PrimaryNavigationView=SW.ParentView.extend({tagName:"nav",className:"primary-nav",initialize:function(){this._super("initialize"),this.isAccountMenuOpen=!1,this.template=Handlebars.compile($("#primary-navigation-template").html()),this.model.get("classSelect")&&this.createClassSelect(),this.model.get("help")&&this.createHelpMenu(),this.model.get("account")&&this.createAccountMenu(),this.createMobileMenu(),this.model.get("notifications")&&this.createNotifications(),this.listenTo(this.model,"change",this.handleSettingsChange)},handleSettingsChange:function(){this.syncClassSelect(),this.syncAccountMenu(),this.render()},syncClassSelect:function(){this.model.get("classSelect")?this.createClassSelect():this.removeClassSelect()},syncAccountMenu:function(){this.model.get("account")?this.createAccountMenu():this.removeAccountMenu()},createClassSelect:function(){this.childViews.classSelect||(this.childViews.classSelect=new SW.ClassSelectView({model:new SW.ClassSelect}))},createHelpMenu:function(){this.childViews.helpMenu||(this.childViews.helpMenu=new SW.CollapseMenuView({model:new SW.CollapseMenu({iconType:"question-circle",menuItems:this.model.get("helpMenuItems")})}))},createMobileMenu:function(){this.childViews.mobileMenu||(this.childViews.mobileMenu=new SW.CollapseMenuView({model:new SW.CollapseMenu({iconType:"bars",menuItems:this.model.get("mobileMenuItems")})}))},createAccountMenu:function(){this.childViews.accountMenu||(this.childViews.accountMenu=new SW.CollapseMenuView({model:new SW.CollapseMenu({iconText:sw.user.get("name"),iconType:"caret-down",menuItems:this.model.get("accountMenuItems")})}),this.childViews.accountMenu.listenTo(this.childViews.accountMenu.model,"change:iconText",this.renderAccountMenu.bind(this)),this.childViews.accountMenu.model.listenTo(sw.user,"change:name",function(){this.childViews.accountMenu.model.set({iconText:sw.user.get("name")})}.bind(this)))},createNotifications:function(){this.childViews.notifications||(this.childViews.notifications=new SW.NotificationsView({model:new SW.Notifications}))},removeClassSelect:function(){this.childViews.classSelect&&(this.childViews.classSelect.close(),this.childViews.classSelect=null)},removeAccountMenu:function(){this.childViews.accountMenu&&(this.childViews.accountMenu.close(),this.childViews.accountMenu=null)},render:function(){var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t),this.renderClassSelect(),this.renderNotifications(),this.renderHelpMenu(),this.renderMobileMenu(),this.renderAccountMenu(),this.$el},renderClassSelect:function(){this.childViews.classSelect&&(this.$(".js-primary-nav-class-select").html(this.childViews.classSelect.render()).removeClass("gone"),this.childViews.classSelect.delegateEvents())},renderNotifications:function(){this.childViews.notifications&&(this.$(".js-notifications-container").html(this.childViews.notifications.render()),this.childViews.notifications.delegateEvents())},renderHelpMenu:function(){this.childViews.helpMenu&&(this.$(".js-help-menu-container").html(this.childViews.helpMenu.render()),this.childViews.helpMenu.delegateEvents())},renderMobileMenu:function(){this.childViews.mobileMenu&&(this.$(".js-mobile-menu-container").html(this.childViews.mobileMenu.render()),this.childViews.mobileMenu.delegateEvents())},renderAccountMenu:function(){this.childViews.accountMenu&&(this.$(".js-account-menu-container").html(this.childViews.accountMenu.render()),this.childViews.accountMenu.delegateEvents())}}),SW.PrimaryNavigation=SW.Model.extend({defaults:{breadcrumb:!1,classSelect:!1,account:!0,notifications:!0,help:!0},initialize:function(){var e=sw.user.parentApp(),t={text:e?"My Kids":"Classrooms",href:e?"my-kids":"classes"},i=[{url:"https://prodigygame.zendesk.com/hc/en-us",target:"_blank",text:"Support"},{url:"/resources/",target:"_blank",text:"Resources"}],s=[{url:"/play/",target:"_blank",text:"Play Prodigy"},{url:"/dashboard/#memberships",text:"Memberships"},{url:"/dashboard/#account",text:"Account"},{text:"Logout",onclick:"sw.user.logout()"}],n=[{url:"/dashboard/#"+t.href,text:t.text}].concat(s);this.set({breadcrumbConfig:t,helpMenuItems:i,accountMenuItems:s,mobileMenuItems:n})}}),SW.PageNavigationView=SW.ParentView.extend({className:"page-navigation page-navigation--mobile",initialize:function(){this._highlightClassName="page-navigation__menu-item--highlight",this._super("initialize"),this.template=Handlebars.compile($("#page-navigation-template").html()),this.listenTo(this.model,"change:pageID",this.handlePageIDChange)},handlePageIDChange:function(e,t){this.highlightPage(t)},highlightPage:function(e){this.$("."+this._highlightClassName).removeClass(this._highlightClassName),this.$("#app-link-"+e).addClass(this._highlightClassName)},render:function(){var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t),this.highlightPage(e.pageID),this.$el}}),SW.PageNavigation=SW.Model.extend({defaults:{pageID:void 0,pages:[]},initialize:function(){var e=new Date("August 4, 2016")<new Date(sw.user.get("registerDate")),t=[{id:"app-link-dashboard",label:"Dashboard",href:"#",extraClasses:"",iconClasses:"fa-tachometer"},{id:"app-link-students",label:sw.user.isParent()?"Child Accounts":"Students",href:"#students",extraClasses:"",iconClasses:"fa-users"},{id:"app-link-planner",label:"Planner",href:"#planner",extraClasses:"",iconClasses:"fa-calendar-o"},{id:"app-link-reports",label:"Reports",href:"#reports",extraClasses:"",iconClasses:"fa-bar-chart"}];e&&_.remove(t,{id:"app-link-assignments"}),this.set("pages",t)}}),SW.SubNavigationView=SW.View.extend({tagName:"nav",className:"sub-nav",initialize:function(){this.template=Handlebars.compile($("#sub-navigation-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON()))}}),SW.SubNavigation=SW.Model.extend({defaults:{hidden:{copyRight:!1,jobs:!1,blog:!1,termsAnServices:!1,privacyPolicy:!1},currentYear:(new Date).getFullYear()}}),SW.ClassSelectView=SW.View.extend({events:{"change select":"handleClassSelectChange"},initialize:function(){this._super("initialize"),this.template=Handlebars.compile($("#class-select-template").html()),this.listenTo(sw.dispatcher,"class-list:load:complete",this.render),this.listenTo(sw.dispatcher,"class-list:edit:info",this.render),this.listenTo(sw.user.classes,"add remove",this.render)},render:function(){var e=this.model.getTemplateData(),t=this.template(e);return this.$el.html(t)},handleClassSelectChange:function(e){var t=$(e.target).val();sw.user.classes.changeCurrentClass(t)}}),SW.ClassSelect=SW.Model.extend({getTemplateData:function(){return{classes:this.getClasses()}},getClasses:function(){return sw.user.classes.map(function(e){return{name:e.escape("name"),id:e.id,isSelected:e.id===sw.user.classes.getCurrentClassID()}})}}),SW.CollapseMenuView=SW.ParentView.extend({className:"collapse-menu",events:{"click .js-toggle-collapse-menu-btn":"toggle"},initialize:function(){this._super("initialize"),this._isOpen=!1,this.template=this.findTemplate("collapse-menu")},render:function(){return this.$el.html(this.template(this.model.toJSON()))},toggle:function(){this.$(".js-collapse-menu-item-container").toggleClass("gone"),this._isOpen=!this._isOpen,this._isOpen&&_.defer(function(){this.listenToOnce(sw.dispatcher,"body:click",this.hide)}.bind(this))},hide:function(){this._isOpen&&(this.$(".js-collapse-menu-item-container").addClass("gone"),this._isOpen=!1)}}),SW.CollapseMenu=SW.Model.extend({defaults:{iconType:"bars",menuItems:[]}}),SW.SkillGroup=SW.Model.extend({defaults:{name:void 0,type:void 0,skills:[]},initialize:function(){this.set("skills",this.uniqSkills(this.get("skills")))},uniqSkills:function(e){var t=[];return e.forEach(function(e){_.findIndex(t,{skillID:e.skillID})===-1&&t.push(e)}),t}}),SW.SkillGroupView=SW.ParentView.extend({className:"skill-group",initialize:function(e){this._super("initialize",arguments),this._enableSelection=e.enableSelection||!1,this.template=Handlebars.compile($("#skill-group-template").html()),this.initializeSkillSampleControllers(),this.listenTo(this.model,"change",this.render)},initializeSkillSampleControllers:function(){this.childViews.samples=this.model.get("skills").map(function(e){return new SW.SkillSampleControllerView({closeOnScroll:!0,model:new SW.Model({skillID:e.skillID})})}.bind(this))},render:function(){var e=this.model.toJSON();return e.enableSelection=this._enableSelection,this.$el.html(this.template(e)),this.renderSkillSampleControllers(),this.$el},renderSkillSampleControllers:function(){this.childViews.samples.forEach(function(e){this.$("#skill-group-skill-"+e.model.get("skillID")).append(e.render())}.bind(this))}}),SW.SkillGroupCollectionView=SW.ParentView.extend({className:"skill-group-collection",events:{"click .js-reload-skills":"reloadSkills","change .js-skill-group-curriculum-select":"onCurriculumSelectChange","change .js-skill-group-grade-select":"onGradeSelectChange","change .js-skill-groups-container":"onSkillSelectionChange"},initialize:function(e){this._super("initialize",arguments),this._enableSelection=e.enableSelection||!1,this.childViews.skillGroups=[],this.partitionedSkillGroups=[],this.template={base:Handlebars.compile($("#skill-group-collection-template").html()),error:Handlebars.compile($("#skill-group-collection-error-template").html())},this.listenTo(this.collection,"load:start",this.onSkillsLoadStart),this.listenTo(this.collection,"load:complete",this.onSkillsLoadComplete),this.listenTo(this.collection,"add remove reset",this.onCollectionChange),this.listenTo(this.model,"change:curriculumID",this.loadSkills),this.listenTo(this.model,"change:curriculumTree",this.onCurriculumTreeChange),this.listenTo(sw.dispatcher,"window:resize",function(){this._isSingleColumn!==this.shouldBeSingleColumn()&&this.renderSkillGroups()}),this.model.loaded?this.loadSkills():this.listenToOnce(this.model,"load:complete",this.onModelLoad)},shouldBeSingleColumn:function(){return window.matchMedia("(max-width: 769px)").matches},loadSkills:function(){this.collection.loadSkillList(this.model.get("curriculumID"))},reloadSkills:function(){this.collection.reset(null,{silent:!0}),this.loadSkills()},initializeSkillGroups:function(){this.collection.forEach(function(e){this.childViews.skillGroups.push(new SW.SkillGroupView({enableSelection:this._enableSelection,model:e}))}.bind(this)),this.partitionedSkillGroups=this.partitionSkillGroups(this.childViews.skillGroups)},partitionSkillGroups:function(e){return SW.Utility.partitionBy(e,null,3)},sortParitionedSkillGroups:function(e){return e.map(this.sortSkillGroups)},sortSkillGroups:function(e){return _.sortBy(e,function(e){return e.model.get("name").toLowerCase()})},render:function(){return this.renderBase(),this.renderContent(),this.$el},renderBase:function(){var e=this.model.toJSON();this.$el.html(this.template.base(e))},renderContent:function(){this.model.loaded&&(this.renderCurriculumSelectOptions(),this.renderGradeSelectOptions(),this.renderSkillGroups(),this.resizeParentDialog())},renderCurriculumSelectOptions:function(){var e="";e+="<option>Ontario</option>",e+="<option>Common Core</option>",e+="<option>Florida</option>",e+="<option>Texas</option>",this.$(".js-skill-group-curriculum-select").html(e).val(this.model.get("curriculumTree"))},renderGradeSelectOptions:function(){var e=this.model.get("curriculumTree"),t=SW.Education.curricula[e].map(function(e){return"<option value='"+e.curriculumID+"'>"+e.name+"</option>"});this.$(".js-skill-group-grade-select").html(t.join()).val(this.model.get("curriculumID"))},renderSkillGroups:function(){var e=this.shouldBeSingleColumn();e?this.renderSingleColumnSkillGroups():this.renderPartitionedSkillGroups()},renderSingleColumnSkillGroups:function(){var e,t=this.childViews.skillGroups;_.isEmpty(t)||(this._isSingleColumn=!0,e=this.$(".js-skill-groups-col-1"),e.empty(),t.forEach(this.renderSkillGroup.bind(this,e)),this.trigger("rendered:skill-groups"))},renderPartitionedSkillGroups:function(){_.isEmpty(this.partitionedSkillGroups)||(this._isSingleColumn=!1,this.partitionedSkillGroups.forEach(function(e,t){var i=this.$(".js-skill-groups-col-"+(t+1));i.empty(),e.forEach(this.renderSkillGroup.bind(this,i))}.bind(this)),this.trigger("rendered:skill-groups"))},renderSkillGroup:function(e,t){e.append(t.render()),t.delegateEvents()},renderSkillGroupsLoadingError:function(e){var t=this.template.error(e);this.$(".js-skill-group-loading-container").html(t)},onCollectionChange:function(){this.closeSkillGroups(),this.initializeSkillGroups(),this.renderSkillGroups(),this.resizeParentDialog()},onSkillsLoadStart:function(){this.childViews.loader=this.childViews.loader||new SW.LoadingIconView,_.defer(function(){this.closeSkillGroups(),this.$(".js-skill-group-loading-container").html(this.childViews.loader.render()),this.resizeParentDialog()}.bind(this))},onSkillsLoadComplete:function(e){e.error?this.renderSkillGroupsLoadingError(e.data):this.$(".js-skill-group-loading-container").empty(),this.resizeParentDialog()},onModelLoad:function(e){e.error||this.loadSkills()},onCurriculumSelectChange:function(e){var t=$(e.target).val();this.model.set({curriculumTree:t,curriculumID:SW.Education.curricula[t][0].curriculumID})},onGradeSelectChange:function(e){var t=$(e.target);this.model.set("curriculumID",parseInt(t.val(),10))},onSkillSelectionChange:function(e){var t=this.$(".js-skill-groups-container").serializeArray();this.model.set("selectedSkills",t)},onCurriculumTreeChange:function(){this.renderGradeSelectOptions()},closeSkillGroups:function(){this.childViews.skillGroups.length>0&&(this.childViews.skillGroups.forEach(function(e){e.close()}),this.childViews.skillGroups=[])}}),SW.SkillGroupCollection=SW.Collection.extend({model:SW.SkillGroup,loadSkillList:function(e){this.trigger("load:start"),$.ajax({url:sw.config.api.education+"/v1/curriculum/"+e+"/skills",type:"GET",data:{curriculumID:e},cache:!1,dataType:"json",success:this.onLoadSuccess.bind(this),error:this.onLoadError.bind(this)})},onLoadSuccess:function(e){var t=[];e.length>0&&(e.forEach(function(e){var i=[];e.skills.forEach(function(t){i.push({isNew:1===SW.Education.skills[t].isNew,name:SW.Education.skills[t].name,skillID:t,topic:e.topic})}),t.push({name:e.topic,skills:i})}),_.defer(function(){this.reset(t),this.trigger("load:complete",{error:null,data:{}})}.bind(this)))},onLoadError:function(e){this.trigger("load:complete",{error:new Error("Failed to load skills."),data:e})},getSkillGroupNamesFrom:function(e,t){var i=_.map(e,t);return i=_.union(i)}}),SW.SkillGroupCollectionModel=SW.Model.extend({defaults:{curriculumTree:void 0,curriculumID:void 0,selectedSkills:void 0,forcePublic:!1},initialize:function(){sw.user.get("userID")&&!this.get("forcePublic")?this.initializePrivate():this.initializePublic()},initializePublic:function(){var e=this.toJSON(),t=e.curriculumTree||SW.Education.getCurriculumCodeFromTreeID(0);this.loaded=!0,this.set({curriculumTree:t,curriculumID:e.curriculumID||SW.Education.curricula[t][0].curriculumID})},initializePrivate:function(){this.loaded=!1,SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.onLoadSuccess.bind(this),fail:function(){}})},onLoadSuccess:function(){var e=(sw.user.get("curriculumTreeID"),sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum());curriculumTree=SW.Education.curriculumIDs[e].sub,this.set({curriculumTree:curriculumTree,curriculumID:e!==-1?e:SW.Education.curricula[curriculumTree][0].curriculumID}),this.loaded=!0,this.trigger("load:complete",{error:null})}}),SW.PurchaseFlow=SW.Model.extend({defaults:{activeStep:1,activePlan:void 0,lastStep:null,completedSteps:[],isUserInGame:!1,totalCost:void 0,totalCostAfterTax:void 0,selectedStudents:[],memberships:[],purchase:{monthlyMemberships:[],yearlyMemberships:[],postalCode:void 0,email:void 0,name:void 0}},initialize:function(){this.yearlyCost="59.88 per year",this.monthlyCost="8.95 per month",this.listenTo(this,"change:activePlan",this.updatedAllMembershipPlans)},updateSelectedStudents:function(e){this.set("selectedStudents",e)},changeStepTo:function(e,t){this.set({activePlan:e,activeStep:t})},setMemberships:function(){if(this.get("selectedStudents").length){var e=this,t=[];_.forEach(this.get("selectedStudents"),function(i){var s="monthly"===e.get("activePlan"),n=s?e.monthlyCost:e.yearlyCost;t.push({student:i,plan:e.get("activePlan"),isMonthly:s,cost:n})}),this.set("memberships",t),this.set("totalCost",this.calculateTotalCost()),this.set("totalCostAfterTax",this.calculateTotalCostAfterTax())}},updatedAllMembershipPlans:function(){var e=this,t=this.get("memberships"),i=this.get("activePlan");_.forEach(t,function(t){var s="monthly"===i,n=s?e.monthlyCost:e.yearlyCost;t.plan=i,t.isMonthly=s,t.cost=n}),this.set("totalCost",this.calculateTotalCost()),this.set("totalCostAfterTax",this.calculateTotalCostAfterTax()),this.trigger("memberships:changed")},calculateTotalCost:function(){var e=0;return _.forEach(this.get("memberships"),function(t){e+=parseFloat(t.cost)}),this.configureDollarValue(e)},calculateTotalCostAfterTax:function(){var e={beforeTax:parseFloat(this.get("totalCost")),afterTax:void 0},t=this.getTaxRates();if(t)return _.forEach(t,function(t){e.afterTax=_.isNumber(e.afterTax)?e.afterTax:0,e.afterTax+=e.beforeTax*t}),_.isNumber(e.afterTax)?(e.afterTax+=e.beforeTax,this.configureDollarValue(e.afterTax)):void 0},getTaxRates:function(){var e=this.get("purchase").postalCode,t=void 0;return e&&(t=sw.purchaser.getTaxesFromPostalCode(e)),t},configureDollarValue:function(e){var t=SW.Utility.round(e,2),i=t.toFixed(2);return i},trackConfirm:function(e){var t=e?"success":"fail";sw.track.pageView("membership:confirm:"+t,!0)},completePurchase:function(){this.trigger("purchase-data:request")},submitPurchase:function(){sw.purchaser.processPurchase(this.get("purchase"),this.purchaseSuccess.bind(this),this.purchaseFail.bind(this)),this.trigger("complete-purchase:started")},purchaseSuccess:function(e){this.trigger("complete-purchase:success",e),sw.dispatcher.trigger("complete-purchase:success"),this.trackConfirm(!0)},purchaseFail:function(e){this.trigger("complete-purchase:failed",e),this.trackConfirm(!1)}}),SW.PurchaseFlowSelectionStep=SW.Model.extend({defaults:{step:1,selectedStudents:[],isStepComplete:!1,hasClassList:!1,classListStudents:[]},initialize:function(){this.set("selectedStudents",[]),this.listenTo(this,"student:added",this.lockStep),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.getClassList.bind(this)})},lockStep:function(){this.set("isStepComplete",!1)},getClassList:function(){var e=sw.user.classes.getAllStudents("JSON");e.length>0&&(this.set("hasClassList",!0),this.set("classListStudents",e))},addStudent:function(e){var t=this;this.isValidStudentCredentials(e)&&(this.trigger("student:verification:start"),$.ajax({url:"/includes/server/routers/user.php",type:"POST",data:{method:"authenticate-student-credentials",username:e.username,password:e.password},dataType:"json",success:function(i){i.success?(e.name=i.result.name,e.userID=i.result.objectID,t.isStudentSelected(e.userID)?t.trigger("student:verification:duplicate"):(t.get("selectedStudents").push(e),t.trigger("student:added"),t.trackAddChild(!0))):(t.trigger("student:verification:failed"),t.trackAddChild(!1))},error:function(){t.trigger("student:verification:failed")}}))},addStudentFromClassList:function(e){e=parseInt(e);var t=this.get("classListStudents");if(t.length>0){var i=_.find(t,{userID:e});this.get("selectedStudents").push(i),this.trackSelectChild(),this.trigger("student:added")}},removeSelectedStudentAt:function(e){var t=this.get("selectedStudents")[e].userID;if(this.lockStep(),t&&this.get("hasClassList")){var i=_.find(this.get("classListStudents"),{userID:t});void 0!=i&&this.trigger("classlist:user:removed",i)}this.get("selectedStudents")[e]=null,this.trigger("selected-students:removed"),this.isEntireStudentSelectionNull()&&(this.set("selectedStudents",[]),this.trigger("selected-students:all-removed"))},isEntireStudentSelectionNull:function(){var e=_.clone(this.get("selectedStudents")),t=!1;return _.pull(e,null),e.length<1&&(t=!0),t},removeNullStudentSelections:function(){_.pull(this.get("selectedStudents"),null)},isStudentSelected:function(e){var t=_.compact(this.get("selectedStudents")),i=_.find(t,{userID:e});return!!_.isObject(i)},isValidStudentCredentials:function(e){var t=!0;return _.forEach(e,function(e){_.isString(e)?e.trim().length<1&&(t=!1):t=!1}),t},trackAddChild:function(e){var t="membership:add-child:";t+=e?"success":"fail",sw.track.pageView(t,!0)},trackSelectChild:function(){sw.track.pageView("membership:select-child",!0)},completeStep:function(){this.get("selectedStudents").length&&!this.isEntireStudentSelectionNull()&&(this.removeNullStudentSelections(),this.set("isStepComplete",!0),sw.dispatcher.trigger("step:completed",{completedStep:this.get("step"),selectedStudents:this.get("selectedStudents")}))}}),SW.PurchaseFlowBillingStep=SW.Model.extend({defaults:{step:2,isStepComplete:!1,isUserLoggedIn:!1,fields:{name:{value:"",isValid:!1,id:"billing-name-field"},email:{value:"",isValid:!1,id:"billing-email-field"},confirmEmail:{value:"",isValid:!1,id:"billing-confirm-email-field"},cardNumber:{value:"",isValid:!1,id:"billing-card-number-field"},postalCode:{value:"",isValid:!1,id:"billing-postal-code-field"},cardMonthExp:{value:"",isValid:!1,id:"billing-card-month-exp-field"},cardYearExp:{value:"",isValid:!1,id:"billing-card-year-exp-field"},cardCvc:{value:"",isValid:!1,id:"billing-card-cvc-field"}},cardExpMonths:[{name:"January",number:"01"},{name:"February",number:"02"},{name:"March",number:"03"},{name:"April",number:"04"},{name:"May",number:"05"},{name:"June",number:"06"},{name:"July",number:"07"},{name:"August",number:"08"},{name:"September",number:"09"},{name:"October",number:"10"},{name:"November",number:"11"},{name:"December",number:"12"}],cardExpYears:[]},initialize:function(){this.trackPaymentInit(),this.generateDates(),this.loggedInUserFlow(),this.listenTo(sw.dispatcher,"complete-purchase:success",this.resetCardData)},resetCardData:function(){var e=this.get("fields");this.set("fields",_.assign({},e,{cardNumber:{value:"",isValid:!1,id:"billing-card-number-field"},postalCode:{value:"",isValid:!1,id:"billing-postal-code-field"},cardMonthExp:{value:"",isValid:!1,id:"billing-card-month-exp-field"},cardYearExp:{value:"",isValid:!1,id:"billing-card-year-exp-field"},cardCvc:{value:"",isValid:!1,id:"billing-card-cvc-field"}}))},generateDates:function(){var e=new Date,t=e.getFullYear().toString().substr(2),i=[];t=parseInt(t);for(var s=t;s<=t+10;s++)i.push({yearValue:s});this.set("cardExpYears",i)},loggedInUserFlow:function(){if(sw.user.isLoggedIn()){var e=this.get("fields");e.name.value=sw.user.get("name"),e.name.isValid=!0,e.email.value=sw.user.get("username"),e.email.isValid=!0,e.confirmEmail.value=sw.user.get("username"),e.confirmEmail.isValid=!0,this.set("isUserLoggedIn",!0)}},setDefaultDates:function(){var e=this.get("cardExpMonths")[0].number,t=this.get("cardExpYears")[0].yearValue;this.get("fields").cardMonthExp.value=e,this.get("fields").cardYearExp.value=t},updateFieldData:function(e){var t=this.get("fields"),i=e.propertyName;t[i].value=e.value.trim(),t[i].isValid=e.isValid,this.set("fields",t)},setConfirmEmail:function(e){var t=this.get("fields").confirmEmail;t.isValid=t.value.length>0&&e},checkFormIsValid:function(){var e=this.getInvalidFieldIds();return!(e.length>0)},getInvalidFieldIds:function(){var e=this.get("fields"),t=[];for(var i in e)e[i].isValid||t.push(e[i].id);return t},trackPaymentInit:function(){sw.track.pageView("membership:payment:init",!0)},trackPayment:function(e){var t=e?"success":"fail";sw.track.pageView("membership:payment:"+t,!0)},completeStep:function(){var e=this.get("fields"),t={number:e.cardNumber.value,cvc:e.cardCvc.value,exp_month:e.cardMonthExp.value,exp_year:e.cardYearExp.value,address_zip:e.postalCode.value,name:e.name.value};sw.purchaser.createToken(t,this.stripeCallback.bind(this)),this.trigger("payment-verify:started")},stripeCallback:function(e,t){200==e?(this.set("isStepComplete",!0),sw.dispatcher.trigger("step:completed",{completedStep:this.get("step")}),this.trackPayment(!0)):(this.set("isStepComplete",!1),this.trigger("payment-verify:failed",t.error),this.trackPayment(!1))}}),SW.PurchaseFlowView=SW.ParentView.extend({events:{"click .js-exit-purchasing":"exitPurchaseFlow"},initialize:function(){this._super("initialize"),this.stepModels={},this.childViews.activeStep=void 0,this.$container,this.$navItems,this.initStep=[_.bind(this.initStepOne,this),_.bind(this.initStepTwo,this),_.bind(this.initStepThree,this)],this.totalSteps=this.initStep.length,this.model.set("lastStep",this.totalSteps),SW.Utility.preloadImages(["/assets/images/svg/tail-spin.svg"]),SW.Utility.preloadImages(["/assets/images/ed/happy-heart-small.png"]),this.getTemplates(),this.renderBase(),this.listenTo(this.model,"change:activePlan",this.handlePlanChange),this.listenTo(this.model,"change:activeStep",this.handleStepChange),this.listenTo(this.model,"purchase-data:request",this.preparePurchaseData),this.listenTo(sw.dispatcher,"step:completed",this.handleStepCompletion),this.listenTo(sw.dispatcher,"step-three:flow:close",this.completePurchaseFlow)},initStepOne:function(){return _.isUndefined(this.stepModels.stepOne)&&$("html, body").scrollTop(0),this.stepModels.stepOne=this.stepModels.stepOne||new SW.PurchaseFlowSelectionStep,this.stepModels.stepOne.set("selectedStudents",this.model.get("selectedStudents")),
new SW.PurchaseFlowSelectionStepView({model:this.stepModels.stepOne})},initStepTwo:function(){return this.stepModels.stepTwo=this.stepModels.stepTwo||new SW.PurchaseFlowBillingStep,new SW.PurchaseFlowBillingStepView({model:this.stepModels.stepTwo})},initStepThree:function(){return this.updatePurchaseData(),this.stepModels.stepThree=this.model,this.stepModels.stepThree.setMemberships(),new SW.PurchaseFlowConfirmationStepView({model:this.stepModels.stepThree})},getTemplates:function(){this.templateBase=Handlebars.compile($("#purchase-flow-template").html()),this.templateNavigation=Handlebars.compile($("#purchase-flow-navigation-template").html())},renderBase:function(){var e=this.model.toJSON(),t=this.templateBase(e);this.$el.html(t),this.$container=this.$el.find(".js-container"),this.$navContainer=this.$el.find(".js-nav-container")},renderNavigation:function(){var e=this.model.toJSON(),t=this.templateNavigation(e);this.$navContainer.html(t),this.$navItems=this.$el.find(".js-nav-item"),this.updateNavItems()},renderStep:function(e){var t,i=e-1;e<1||e>this.totalSteps||(this.handleSmallScreenHeight(),this.closeActiveStepView(),this.childViews.activeStep=this.initStep[i](),t=this.childViews.activeStep.render(),this.$container.html(t))},updateNavItems:function(){this.$el.find(".active-step").removeClass("active-step"),$("#step"+this.model.get("activeStep")+"-nav-item").addClass("active-step")},handleSmallScreenHeight:function(){var e=$(window).scrollTop(),t=$("#conversion-flow-navigation").offset().top,i=20;t+i<e&&$("html, body").scrollTop(0)},preparePurchaseData:function(){this.updatePurchaseData(),this.model.submitPurchase()},updatePurchaseData:function(){var e={},t=this.stepModels.stepTwo.toJSON();e.name=t.fields.name.value,e.email=t.fields.email.value,e.postalCode=t.fields.postalCode.value,"monthly"===this.model.get("activePlan")?(e.monthlyMemberships=this.model.get("selectedStudents"),e.yearlyMemberships=[]):(e.monthlyMemberships=[],e.yearlyMemberships=this.model.get("selectedStudents")),this.model.set("purchase",e)},changeStepTo:function(e,t){this.model.changeStepTo(e,t)},handlePlanChange:function(){this.trackPlanChange(),this.renderNavigation()},handleStepChange:function(){var e=this.model.get("activeStep");this.renderStep(e),this.updateNavItems()},handleStepCompletion:function(e){var t=e.completedStep,i=e.selectedStudents||void 0,s=t+1;s<=this.model.get("lastStep")&&sw.dispatcher.trigger("purchase:navigate-to",{plan:this.model.get("activePlan"),step:s}),i&&this.model.updateSelectedStudents(i),$("#step"+t+"-nav-item").removeClass("active")},verifyStepIsUnlocked:function(e){var t=!0;return e=parseInt(e),t=this.checkStepIsUnlocked(e)},checkStepIsUnlocked:function(e){var t=!1;return 1===e?t=!0:2===e?t=!_.isUndefined(this.stepModels.stepOne)&&this.stepModels.stepOne.get("isStepComplete"):3===e&&(t=!_.isUndefined(this.stepModels.stepOne)&&!_.isUndefined(this.stepModels.stepTwo)&&(this.stepModels.stepOne.get("isStepComplete")&&this.stepModels.stepTwo.get("isStepComplete"))),t},closeActiveStepView:function(){this.childViews.activeStep&&(this.childViews.activeStep.close(),this.childViews.activeStep=null)},trackPlanChange:function(){var e=this.model.get("activePlan"),t="membership:plan:"+e;sw.track.pageView(t,!0)},completePurchaseFlow:function(){var e=!0;this.close(),sw.dispatcher.trigger("purchase-flow:close",e)},exitPurchaseFlow:function(){var e=!1;this.close(),sw.dispatcher.trigger("purchase-flow:close",e)},close:function(){this._super("close"),this.stepModels.stepOne.clear().set(this.stepModels.stepOne.defaults)}}),SW.PurchaseFlowSelectionStepView=SW.View.extend({className:"conversion-flow-step-wrapper",events:{"submit #add-student-form":"studentRequestedForMembership","click .js-remove-student":"removeStudentFromOrder","click .js-add-more":"handleAddMoreClick","click .js-select-student":"studentRequestedForMembershipFromClassList","click .js-tab":"changeAddStudentFormTab","click .js-complete-step":"completeStep"},initialize:function(){this.loadingIconView=null,this.isFormTabsEnabled=!0,this.initializeSplitTest(),this.stepHeadingText={unselected:"First, who will receive this membership?",singular:"Great! This child will receive the membership.",plural:"These children will each receive a membership."},this.template=Handlebars.compile($("#purchase-flow-selection-step-template").html()),this.listenTo(this.model,"change:classListStudents",this.render),this.listenTo(this.model,"student:verification:start",this.verifyingAddedChild),this.listenTo(this.model,"student:verification:failed",this.renderFormErrorMsg),this.listenTo(this.model,"student:verification:duplicate",this.renderFormDuplicateError),this.listenTo(this.model,"student:added",this.renderNewStudent),this.listenTo(this.model,"selected-students:removed",this.setStepHeadingText),this.listenTo(this.model,"selected-students:all-removed",this.handleNoStudentsSelected),this.listenTo(this.model,"classlist:user:removed",this.handleStudentFromClassListRemoval)},initializeSplitTest:function(){prodigyWeb.membershipSplitTest&&this.model.set("didYouKnow","Students with a membership <strong>master 92% more skills</strong> than non-members")},render:function(){this.model.removeNullStudentSelections();var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t),this.cacheElementSelections(),this.disableSelectChildButtons(),this.setStepHeadingText(),this.$el},renderNewStudent:function(){var e=this,t=this.model.get("selectedStudents"),i=_.last(t),s=t.length-1;this.enableFormTabs(),this.setStepHeadingText(),this.removeFormLoadingIconAnimated(),this.$lastStudentAdded=$('<div class="selected-student-block seam-bottom"><div class="js-opacity" style="opacity: 0;"><span class="selected-student-name">'+i.name+'</span><i data-index="'+s+'" class="js-remove-student remove-student-icon fa fa-times"></i></div></div>'),this.$studentHeader.css("border-bottom-color","transparent"),this.$addStudentFormContainer.slideUp(250,function(){e.$addStudentHeaderContainer.css("opacity",1).animate({opacity:0},250,"swing",function(){e.$addStudentWidget.hide(),e.$studentContainer.append(e.$lastStudentAdded),e.$addStudentHeaderContainer.css("opacity",""),e.$studentHeader.css("border-bottom-color",""),e.$lastStudentAdded.find(".js-opacity").animate({opacity:1},250),e.$addMoreStudentsButton.slideDown(250)})}),this.enableCompletionButton()},renderFormErrorMsg:function(){var e="<label class='warning'>Your child's Prodigy account was not found, make sure you are using the correct username and password.</label>";this.removeFormLoadingIcon(),this.enableFormTabs(),this.$formLoadingSpinnerContainer.html(e)},renderFormDuplicateError:function(){var e="<label class='warning'>You have already selected this account for a membership.</label>";this.removeFormLoadingIcon(),this.enableFormTabs(),this.$formLoadingSpinnerContainer.html(e)},setStepHeadingText:function(){var e,t=this.getValidStudentsSelectionLength();e=t<1?this.stepHeadingText.unselected:1===t?this.stepHeadingText.singular:this.stepHeadingText.plural,this.$stepHeading.text(e)},getValidStudentsSelectionLength:function(){var e=this.model.get("selectedStudents"),t=0;return e.length>0&&_.forEach(e,function(e){_.isObject(e)&&t++}),t},handleNoStudentsSelected:function(){var e=this;_.delay(function(){e.showAddStudentForm(),e.disableCompletionButton()},250)},handleAddMoreClick:function(){this.trackAnotherChild(),this.showAddStudentForm()},showAddStudentForm:function(){var e=this;this.$addMoreStudentsButton.hide(),this.$addStudentWidget.fadeIn(125,function(){e.$addStudentFormContainer.slideDown(125)})},changeAddStudentFormTab:function(e){if(this.isFormTabsEnabled===!0){var t=$(e.target);if(t.hasClass("add-student-header-title")&&(t=t.parent()),t.hasClass("inactive")){var i=t.attr("data-form-id"),s=this.$el.find("#"+i);this.$el.find(".student-header-tab").addClass("inactive"),this.$addStudentForm.addClass("inactive"),t.removeClass("inactive"),s.removeClass("inactive"),this.$formLoadingSpinnerContainer.html("")}}},handleStudentFromClassListRemoval:function(e){var t=this.$addStudentFormContainer.find('[data-user-id="'+e.userID+'"]');t.removeAttr("disabled")},cacheElementSelections:function(){this.$studentContainer=this.$el.find(".selected-student-container"),this.$addStudentWidget=this.$el.find(".add-student-widget"),this.$addStudentForm=this.$el.find(".add-student-form"),this.$addStudentFormContainer=this.$el.find("#add-student-form-container"),this.$formLoadingSpinnerContainer=this.$el.find(".form-loading-spinner-container"),this.$addStudentHeaderContainer=this.$el.find(".add-student-widget-header-container"),this.$studentHeader=this.$el.find(".add-student-header"),this.$stepHeading=this.$el.find(".flow-step-heading"),this.$addMoreStudentsButton=this.$el.find(".js-add-more"),this.$completeButton=this.$el.find(".js-complete-step")},disableFormTabs:function(){this.isFormTabsEnabled=!1},enableFormTabs:function(){this.isFormTabsEnabled=!0},createFormLoadingIcon:function(){this.loadingIconView=new SW.LoadingIconView,this.$formLoadingSpinnerContainer.html(this.loadingIconView.render()),this.$formLoadingSpinnerContainer.slideDown(250)},removeFormLoadingIcon:function(){null!==this.loadingIconView&&(this.$formLoadingSpinnerContainer.html(""),this.loadingIconView.close(),this.loadingIconView=null)},removeFormLoadingIconAnimated:function(){var e=this;null!==this.loadingIconView&&this.$formLoadingSpinnerContainer.slideUp(250,function(){e.removeFormLoadingIcon()})},trackAnotherChild:function(){sw.track.pageView("membership:another-child",!0)},trackRemoveChild:function(){sw.track.pageView("membership:remove-child",!0)},verifyingAddedChild:function(){this.disableFormTabs(),this.createFormLoadingIcon()},disableSelectChildButtons:function(){var e=this,t=this.model.get("selectedStudents");this.model.get("hasClassList")&&t.length&&_.forEach(t,function(t){e.$addStudentFormContainer.find('[data-user-id="'+t.userID+'"]').attr("disabled","")})},enableCompletionButton:function(){this.$completeButton.removeAttr("disabled")},disableCompletionButton:function(){this.$completeButton.attr("disabled","")},studentRequestedForMembership:function(e){e.preventDefault();var t=$(e.target).serializeArray(),i={username:_.find(t,{name:"student user name"}).value,password:_.find(t,{name:"student password"}).value};this.tryAddingStudent(i)},studentRequestedForMembershipFromClassList:function(e){var t=$(e.target);t.attr("disabled","").text("Selected").parent(".selectable-student").addClass("currently-selected"),this.model.addStudentFromClassList(t.attr("data-user-id"))},tryAddingStudent:function(e){this.model.addStudent(e)},removeStudentFromOrder:function(e){var t=$(e.target),i=t.attr("data-index");this.model.removeSelectedStudentAt(i),this.trackRemoveChild(),t.parents(".selected-student-block").animate({opacity:0},250,"swing",function(){$(this).slideUp(250,function(){$(this).remove()})})},completeStep:function(){this.model.completeStep()}}),SW.PurchaseFlowBillingStepView=SW.ParentView.extend({className:"conversion-flow-step-wrapper",events:{"change #billing-name-field":"handleNameFieldChange","change #billing-email-field":"handleEmailFieldChange","change #billing-confirm-email-field":"handleConfirmEmailFieldChange","change #billing-postal-code-field":"handleFieldChange","change #billing-card-number-field":"handleCardNumberFieldChange","change #billing-card-month-exp-field":"handleCardExpMonthFieldChange","change #billing-card-year-exp-field":"handleCardExpYearFieldChange","change #billing-card-cvc-field":"handleCardCvcFieldChange","keyup #billing-name-field":"handleNameFieldChange","keyup .warning#billing-email-field":"handleEmailFieldChange","keyup .warning#billing-confirm-email-field":"handleConfirmEmailFieldChange","keyup #billing-postal-code-field":"handleFieldChange","keyup #billing-card-number-field":"handleCardNumberFieldChange","keyup #billing-card-cvc-field":"handleCardCvcFieldChange","mouseenter .js-popover-icon":"togglePopoverHint","mouseleave .js-popover-icon":"togglePopoverHint","click .js-complete-step":"completeStep"},initialize:function(){this._super("initialize"),this.initializeSplitTest(),this.template=Handlebars.compile($("#purchase-flow-billing-step-template").html()),this.childViews.modal=null,this.isModalActive=!1,this.loadingIconView,this.listenTo(this.model,"payment-verify:started",this.renderLoadingModal),this.listenTo(this.model,"payment-verify:failed",this.renderError)},initializeSplitTest:function(){"fear"==prodigyWeb.membershipSplitTest?this.model.set("didYouKnow","<i style='margin-right: 10px;font-weight:bold;' class='icon-inline fa fa-lock'></i>  We will <strong>never share</strong> your personal or payment information."):"social"==prodigyWeb.membershipSplitTest&&this.model.set("didYouKnow","<i style='margin-right: 10px;font-weight:bold;' class='icon-inline fa fa-thumbs-o-up'></i>  Join over <strong>50,000 other parents</strong> with Prodigy memberships! ")},render:function(){var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t),this.cacheElementSelections(),this.selectInputOptionValues(),this.$el},cacheElementSelections:function(){this.$cvcPopover=this.$el.find(".cvc-popover"),this.$selectMonth=this.$el.find("#billing-card-month-exp-field"),this.$selectYear=this.$el.find("#billing-card-year-exp-field"),this.$selectCvc=this.$el.find("#billing-card-cvc-field"),this.$selectNumber=this.$el.find("#billing-card-number-field"),this.$cardIcons=this.$el.find(".credit-card-icon"),this.$amexCardIcon=this.$el.find("#amex-icon"),this.$visaCardIcon=this.$el.find("#visa-icon"),this.$masterCardIcon=this.$el.find("#mastercard-icon")},selectInputOptionValues:function(){var e=this.model.get("fields").cardMonthExp.value,t=this.model.get("fields").cardYearExp.value;this.$selectMonth.val(e),this.$selectYear.val(t)},togglePopoverHint:function(e){var t=$(e.target);t.siblings(".js-popover").fadeToggle(250)},toggleCvcHint:function(){this.$cvcPopover.fadeToggle(250)},handleNameFieldChange:function(e){this.handleFieldChange(e)},handleEmailFieldChange:function(e){this.handleFieldChange(e,this.validateEmail),this.handleEmailFieldSync(e)},handleEmailFieldSync:function(e){var t=$(e.target),i=this.$el.find("#billing-confirm-email-field");i.val().length>0&&(t.val()===i.val()?(this.model.setConfirmEmail(!0),this.removeInputWarning(i)):(this.model.setConfirmEmail(!1),this.addInputWarning(i)))},handleConfirmEmailFieldChange:function(e){this.handleFieldChange(e,this.validateConfirmedEmail)},handleCardNumberFieldChange:function(e){this.$cardIcons.removeClass("selected-card"),this.handleFieldChange(e,this.validateCardNumber)},handleCardExpMonthFieldChange:function(e){this.handleFieldChange(e)},handleCardExpYearFieldChange:function(e){this.handleFieldChange(e)},handleCardCvcFieldChange:function(e){this.handleFieldChange(e,this.validateCvc)},handleFieldChange:function(e,t){var i=$(e.target),s=this.configureFieldData(e);return this.model.set("isStepComplete",!1),"keyup"===e.type&&s.value.length<1?(s.isValid=!1,void this.model.updateFieldData(s)):(s.isValid=this.runValidationCallback(s,t),this.toggleInputWarnings(i,s.isValid),void this.model.updateFieldData(s))},runValidationCallback:function(e,t){return _.isFunction(t)?(t=_.bind(t,this),e.isValid=t(e)):e.isValid=this.basicFieldValidation(e),e.isValid},toggleInputWarnings:function(e,t){t===!0?this.removeInputWarning(e):this.addInputWarning(e)},removeInputWarning:function(e){e.removeClass("warning").siblings("label").removeClass("warning")},addInputWarning:function(e){e.addClass("warning").siblings("label").addClass("warning")},removeAllInputWarnings:function(){this.$el.find(".warning").removeClass(".warning")},addAllInputWarnings:function(){for(var e,t=this.model.getInvalidFieldIds(),i=0;i<t.length;i++)e=$("#"+t[i]),this.addInputWarning(e)},configureFieldData:function(e){var t=$(e.target),i={propertyName:t.attr("data-prop-name"),value:t.val(),type:e.type,isValid:!1};return i},basicFieldValidation:function(e){return this.isValidString(e.value)},isValidString:function(e){return!!(_.isString(e)&&e.trim().length>0)},validateEmail:function(e){var t=SW.Validate.email(e.value);return t},validateConfirmedEmail:function(e){var t=SW.Validate.email(e.value),i=this.model.get("fields").email.value===e.value.trim(),s=t&&i;return s},validateCardNumber:function(e){return this.selectCurrentCardIcon(e),this.validateNumber(e)},validateNumber:function(e){var t=e.value.replace(/\s+/g,"");return!isNaN(t)},validateYear:function(e){var t=e.value.replace(/\s+/g,""),i=!1;return 2!==t.length||isNaN(t)||(i=!0),i},validateMonth:function(e){var t=e.value.replace(/\s+/g,""),i=parseInt(t),s=!1;return 2!==t.length||isNaN(t)||(s=i>=1&&i<=12),s},validateCvc:function(e){var t=!1,i="keyup"===e.type&&e.value.length<3;return t=_.isFunction(Stripe)&&!i?Stripe.card.validateCVC(e.value):this.validateNumber(e)},selectCurrentCardIcon:function(e){this.isAmex(e.value)?this.$amexCardIcon.addClass("selected-card"):this.isVisa(e.value)?this.$visaCardIcon.addClass("selected-card"):this.isMasterCard(e.value)&&this.$masterCardIcon.addClass("selected-card")},isAmex:function(e){var t={first:"3",second:["4","7"]},i=15;return this.isCreditCard(e,t,i)},isVisa:function(e){var t={first:"4",second:_.range(0,10)},i=16;return this.isCreditCard(e,t,i)},isMasterCard:function(e){var t={first:"5",second:_.range(1,6)},i=16;return this.isCreditCard(e,t,i)},isCreditCard:function(e,t,i){_.isString(e)||(e=e.toString()),e=e.replace(/\s+/g,"");var s=this.isValidCreditCardDigit(e[0],t.first),n=this.isValidCreditCardDigit(e[1],t.second),a=e.length<=i,r=!isNaN(e);return s&&n&&a&&r},isValidCreditCardDigit:function(e,t){if(!_.isArray(t))return e==t;for(var i=0;i<t.length;i++)if(e==t[i])return!0;return!1},renderLoadingModal:function(){var e="We are verifying your information.",t="Please do not refresh the page or close your browser.";this.renderModalWith({heading:e,main:"<p>"+t+"</p>",loadingSpinner:!0})},renderError:function(e){this.highlightErrorField(e.code),this.renderErrorModal(e.message)},highlightErrorField:function(e){switch(e){case"invalid_cvc":this.addInputWarning(this.$selectCvc);break;case"invalid_expiry_month":this.addInputWarning(this.$selectMonth);break;case"invalid_expiry_year":this.addInputWarning(this.$selectYear);break;case"incorrect_number":this.addInputWarning(this.$selectNumber)}},renderErrorModal:function(e){this.renderModalWith({heading:"Oops, something went wrong!",main:"<p>"+e+"</p>",buttons:[{name:"Back",classList:"btn btn-ghost-secondary btn-modal",callback:"removeModal"}]})},renderModalWith:function(e){this.createModal(),this.childViews.modal.model.set("content",e),this.isModalActive=!0},createModal:function(){var e=this;this.childViews.modal||(this.childViews.modal=new SW.ModalView({parentView:e,model:new SW.Model({content:void 0})}))},removeModal:function(){this.stopListening(this.childViews.modal),this.childViews.modal.close(),this.childViews.modal=null,this.isModalActive=!1},completeStep:function(){this.model.checkFormIsValid()?this.model.completeStep():this.addAllInputWarnings()}}),SW.PurchaseFlowConfirmationStepView=SW.ParentView.extend({className:"conversion-flow-step-wrapper",events:{"change .js-plan-select":"requestPlanChange","click .js-remove-membership":"handleMembershipRemoval","click .js-complete-step":"completeStep"},initialize:function(){this._super("initialize"),this.template=Handlebars.compile($("#purchase-flow-confirmation-step-template").html()),this.defaultSuccessMessage="Your child is now a Prodigy Member! They will receive their benefits the next time they log into the game.",this.inGameSuccessMessage="Your child is now a Prodigy Member! They will receive their benefits immediately back in game.",this.listenTo(this.model,"memberships:change",this.render),this.listenTo(this.model,"change:activePlan",this.render),this.listenTo(this.model,"complete-purchase:started",this.renderLoadingModal),this.listenTo(this.model,"complete-purchase:success",this.renderPurchaseSuccess),this.listenTo(this.model,"complete-purchase:failed",this.renderErrorModal)},render:function(){var e,t=this.model.toJSON();return t.currency="CAD",(_.isUndefined(session_country)||"CA"!=session_country)&&(t.currency="USD"),t.isMonthly="monthly"===t.activePlan,e=this.template(t),this.$el.html(e)},renderPurchaseSuccess:function(e){var t=this.model.get("isUserInGame"),i=t?this.inGameSuccessMessage:this.defaultSuccessMessage,s=t?"Return to Game":"Close Purchase";e.hasPartialAccount&&e.userID&&e.token&&SW.Http.fetch({url:sw.config.api.events+"/v1/web-event",method:"POST",data:{userID:e.userID,token:e.token,event:JSON.stringify({name:"register:partial",details:{context:"membership-purchase",isInGame:t},user:{id:e.userID,type:"parent","register-date":(new Date).toISOString(),"location-id":null,referral:null,groups:null}})}}),e.hasPartialAccount&&e.userID&&e.token?(this.createDialog({className:"dialog dialog--basic dialog--membership-purchase-success",type:"custom",size:"medium-small",children:[{view:SW.MembershipPurchaseSuccessView,model:SW.MembershipPurchaseSuccess,modelData:{token:e.token,userID:e.userID,username:this.model.get("purchase").email,name:_.words(this.model.get("purchase").name)[0],isInGame:t}}]}),this.listenToOnce(sw.dispatcher,"dialog:close",this.closePurchaseFlow)):(this.isModalActive&&this.removeModal(),this.renderModalWith({heading:"Purchase Complete!",main:"<img width='100' height='120' src='/assets/images/ed/happy-heart-small.png' alt='Illustration of Prodigy's mascot, Ed, excited and holding a heart-shaped balloon.' /><p>"+i+"</p>",buttons:[{name:s,classList:"btn btn-primary btn-md",callback:"closePurchaseFlow"}]}))},requestPlanChange:function(e){var t=$(e.target);sw.dispatcher.trigger("purchase:navigate-to",{plan:t.val()})},renderLoadingModal:function(){var e="We are verifying your purchase.",t="Please do not refresh the page or close your browser.";this.renderModalWith({heading:e,main:"<p>"+t+"</p>",loadingSpinner:!0})},renderErrorModal:function(e){this.renderModalWith({heading:"Oops, something went wrong!",main:"<p>"+e.error+"</p>",buttons:[{name:"Back",classList:"btn btn-primary btn-modal",callback:"purchaseFail"}]})},renderModalWith:function(e){this.createModal(),this.childViews.modal.model.set("content",e),this.isModalActive=!0},createModal:function(){var e=this;this.childViews.modal||(this.childViews.modal=new SW.ModalView({parentView:e,model:new SW.Model({content:void 0})}))},purchaseFail:function(){this.removeModal(),sw.dispatcher.trigger("purchase:navigate-to",{plan:"monthly",step:2})},removeModal:function(){this.stopListening(this.childViews.modal),this.childViews.modal.close(),this.childViews.modal=null,this.isModalActive=!1},completeStep:function(){this.model.completePurchase()},closePurchaseFlow:function(){this.isModalActive&&this.removeModal(),sw.dispatcher.trigger("step-three:flow:close")}}),SW.MembershipPurchaseSuccessView=SW.ParentView.extend({className:"membership-purchase-success",initialize:function(){this._super("initialize"),this.template={main:this.findTemplate("membership-purchase-success"),complete:this.findTemplate("membership-purchase-success-complete")}},render:function(){var e=this.template.main(this.model.toJSON());return this.$el.html(e),this.createForm(),this.$el},createForm:function(){this.childViews.form=new SW.FormView({el:this.$(".js-complete-register-form"),inDialog:!0,fetch:{method:"PUT",url:sw.config.api.accounts+"/v2/parent/complete",success:this.renderCompleteState.bind(this)},formatData:function(e){return{token:this.model.get("token"),userID:this.model.get("userID"),password:e.password,marketing_consent:e.marketingConsent||"false"}}.bind(this)})},renderCompleteState:function(){var e=this.template.complete(this.model.toJSON()),t=this.$el.clone().html(e);return this.getCloneHeight(t,function(t){this.$el.animate({height:t,opacity:0},350,function(){this.$el.html(e).css("height",""),this.$el.animate({opacity:1},250)}.bind(this))}.bind(this)),this.$el},getCloneHeight:function(e,t){e.css({visibility:"hidden",position:"absolute","pointer-events":"none"}).appendTo("body"),_.defer(function(){var i=e.height();e.remove(),t(i)})}}),SW.MembershipPurchaseSuccess=SW.Model.extend({}),SW.InputView=SW.View.extend({events:{keyup:"validateIfWarning",change:"validateIfWarning"},initialize:function(e){this.options=e,this.model.set({name:this.$el.attr("name"),type:this.$el.attr("sw-type"),error:this.$el.attr("sw-error"),optional:this.$el.attr("sw-optional"),confirm:this.$el.attr("sw-confirm")})},setAllWarningContainers:function(){this.setLabel(),this.setWarningContainer()},setLabel:function(){var e=this.$el.attr("sw-label");e&&!this.$label&&(this.$label=$(e))},setConfirm:function(){var e=this.$el.attr("sw-confirm");e&&!this.$confirm&&(this.$confirm=$(e))},setWarningContainer:function(){this.$warningContainer=this.options.$warningContainer.length?this.options.$warningContainer:null},validate:function(){var e=this.model.get("optional"),t=SW.Validate[this.model.get("type")],i=this.$el.val();return!_.isFunction(t)||e&&!i?(console.log(this.model.get("name")+" input does not have a correct sw-type set for validation. Defaulting to valid."),this.valid=!0):(this.setAllWarningContainers(),this.setConfirm(),this.valid=t(i),this.valid&&this.model.get("confirm")&&(!e||i)&&(1===this.$confirm.length?this.valid=SW.Validate.isEqual(this.$el.val(),this.$confirm.val()):(console.log(this.model.get("name")+" input should be confirmed against an element with the selector ["+this.$confirm.selector+"], but a unique element matching that selector could not be found. Defaulting to valid."),this.valid=!0)),this.updateWarning()),this.valid},updateWarning:function(){this.valid?this.warningSet&&this.removeWarning():this.warningSet||this.addWarning()},removeWarning:function(){var e=this.model.get("error");this.warningSet=!1,this.$el.removeClass("warning"),this.$warningContainer&&e&&this.$warningContainer.find("#dialog-error-"+this.model.get("name")).remove(),this.$label&&(this.$label.removeClass("warning"),!this.$warningContainer&&e&&this.$label.find(".js-error-msg").remove()),this.triggerWarningChange()},addWarning:function(){var e=this.model.get("error");this.warningSet=!0,this.$el.addClass("warning"),this.$warningContainer&&e&&this.$warningContainer.append("<div id='dialog-error-"+this.model.get("name")+"' class='js-error-msg'><small>"+e+"</small></div>"),this.$label&&(this.$label.addClass("warning"),!this.$warningContainer&&e&&this.$label.append("<small class='js-error-msg text-normal'> - "+e+"</small>")),this.triggerWarningChange()},triggerWarningChange:function(){this.model.get("error")&&this.trigger("warning:change")},validateIfWarning:function(e){this.$el.hasClass("warning")&&this.validate()}}),SW.Form=SW.Model.extend({}),SW.FormView=SW.ParentView.extend({tagName:"form",events:{submit:"submit"},initialize:function(e){this.errorContainer=this.errorContainer||void 0,this._super("initialize",arguments),this.options=e,this.debouncedResized=_.debounce(this.resized.bind(this),50),this.watchInputs()},watchInputs:function(){var e=this,t=this.$(this.errorContainer);this.childViews.inputs=[],this.$("[sw-input]").each(function(){var i=new SW.InputView({el:$(this),$warningContainer:t,model:new SW.Model});e.childViews.inputs.push(i),e.listenTo(i,"warning:change",e.debouncedResized)})},syncInputs:function(){this.closeInputs(),this.watchInputs()},closeInputs:function(){this.childViews.inputs.forEach(this.closeInput)},closeInput:function(e){this.stopListening(e),e.close()},submit:function(e){var t,i=this.validateInputs();e&&e.preventDefault(),i&&(t=this.getFormData(),this.startSubmitLoading(),SW.Http.fetch({url:this.options.fetch.url,method:this.options.fetch.method,dataType:this.options.fetch.dataType,data:t,success:function(e){this.submitSuccess(e,t)}.bind(this),error:function(e){this.submitError(e,t)}.bind(this)}))},validateInputs:function(){var e=!1;return this.childViews.inputs.forEach(function(t){var i=t.validate();e=e||!i}.bind(this)),!e},getFormData:function(){var e={},t=this.options.formatData,i=this.$el.serializeArray();return i.forEach(function(t){e[t.name]=t.value}),_.isFunction(t)?t(e):e},startSubmitLoading:function(){this.options.inDialog?this.createLoadingOverlay():this.createLoadingDialog()},endSubmitLoading:function(){this.options.inDialog?this.removeLoadingOverlay():this.closeDialog()},submitSuccess:function(e,t){this.options.removeLoadingIconOnSuccess!==!1&&this.endSubmitLoading(),_.isFunction(this.options.fetch.success)&&this.options.fetch.success(e,t)},submitError:function(e,t){var i=_.isString(e)?e:_.get(e,"responseJSON.message","Form failed to submit");this.endSubmitLoading(),this.options.inDialog?this.createFormSubmitError(i):this.createErrorDialog(i),_.isFunction(this.options.fetch.error)&&this.options.fetch.error(e,t)},createLoadingDialog:function(){this.createDialog({type:"load"})},createLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:create")},removeLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:remove")},createErrorDialog:function(e){this.createDialog({type:"alert",title:"Oops, something went wrong!",main:e,size:"small",buttons:[{text:"Ok"}]})},createFormSubmitError:function(e){var t=this.$(".js-form-submission-warning");t.length?t.html(e):this.$el.prepend("<div class='js-form-submission-warning text-warning text-center small'>"+e+"</div>"),this.resized()},removeFormSubmitError:function(){this.$(".js-form-submission-warning").remove(),this.resized()},resized:function(){this.options.inDialog&&sw.dispatcher.trigger("dialog:resize")}}),SW.RegisterForm=SW.Form.extend({defaults:{userType:void 0,email:void 0,studentID:void 0}}),SW.RegisterFormView=SW.FormView.extend({className:"register-form",events:function(){return _.extend({},SW.FormView.prototype.events,{"change input[type='radio']":"onUserTypeChange"})},initialize:function(e){var t="#register-form-template";e.dialog&&(t="#register-form-dialog-template",e.inDialog=!0),e.fetch={url:"/includes/server/routers/user.php",method:"POST",dataType:"json"},e.formatData=function(e){return _.extend({},e,{method:"register",attachStudentID:this.model.get("studentID"),referredByCode:SW.Cookie.get("referredByCode"),referredByOrigin:SW.Cookie.get("referredByOrigin")})}.bind(this),this.hasSetPresets=!1,this.errorContainer=".js-dialog-error-container",this._super("initialize",arguments),this.template=this.template||{},this.template.form=Handlebars.compile($(t).html())},render:function(){return this.$el.html(this.template.form(this.options)),this.syncInputs(),_.defer(this.setPresetsOnce.bind(this)),this.$el},setPresetsOnce:function(){this.hasSetPresets||this.setPresets()},setPresets:function(){var e=this.model.toJSON();e.userType&&(this.$("#register-"+e.userType+"-radio").prop("checked",!0),this.showUserInputs(e.userType)),e.email&&this.$("#register-email").val(e.email),this.hasSetPresets=!0},onUserTypeChange:function(e){var t=$(e.target),i=t.val().toLowerCase();this.showUserInputs(i,!0),this.removeFormSubmitError(),sw.track.pageView("register:select-"+i)},showUserInputs:function(e,t){var i="parent"===e?"teacher":e,s=".js-"+i+"-inputs",n="student"===e?"teacher":"student",a=".js-"+n+"-inputs";t?this.$(a).not(":hidden").fadeOut(200,function(){this.setSignInLink(e),this.$(s).css({display:"block",opacity:"0"}).animate({opacity:1},200),_.defer(this.resized.bind(this))}.bind(this)):(this.$(a).hide(),this.$(s).show(),this.setSignInLink(e),this.resized())},setSignInLink:function(e){this.options.dialog&&("student"===e?$("#dialog-sign-in-link").html("Go&nbsp;play!").removeClass("js-login-link").attr("href","/play"):$("#dialog-sign-in-link").html("Sign&nbsp;in").addClass("js-login-link").attr("href","#"))},submit:function(e){var t=this.$("[name='usertype']:checked").val();e&&e.preventDefault(),t?"student"!==t?this._super("submit"):this.goToPage("/play"):this.submitError("Oops, you didn't select a user type!")},submitSuccess:function(e,t){e.success?this.handleSuccessfulRegistration(e,t):this.submitError(e.error);
},handleSuccessfulRegistration:function(e,t){var i="/dashboard?register=true",s=SW.Cookie.get("referredByOrigin");s&&(i+="&referralOrigin="+s),t.userID=e.userID,this.trackRegister(t),SW.Cookie.set("referredByCode",!1),SW.Cookie.set("referredByOrigin",!1),this.goToPage(i)},submitError:function(e){e.indexOf("already in use")>-1&&(e="That email is already in use.<br />If this is your email, you can <a class='js-login-link clickable'>log in here</a>."),this._super("submitError",[e])},trackRegister:function(e){sw.track.user("alias",e.userID)},goToPage:function(e){window.location.href=e}}),SW.DialogView=SW.ParentView.extend({id:"dialog",className:"",events:{"click .js-dialog-button-0":"handleButtonZero","click .js-dialog-button-1":"handleButtonOne","click .js-dialog-close":"triggerClose"},initialize:function(){sw.dispatcher.trigger("dialog:close"),this._super("initialize"),this.template=void 0,this.animDuration=200,sw.overlayManager=sw.overlayManager||new SW.OverlayManagerView({el:"#overlay-mask"}),this.setClassName(),this.setTemplate(),this.initializeChildren(),sw.overlayManager.moveMaskUp(),this.listenTo(sw.dispatcher,"window:resize",this.setTopMargin),this.listenTo(sw.dispatcher,"dialog:resize",this.setTopMargin),this.listenTo(sw.dispatcher,"dialog:loader-overlay:create",this.createLoaderOverlay),this.listenTo(sw.dispatcher,"dialog:loader-overlay:remove",this.removeOverlay),this.render()},setClassName:function(){this.className+=" dialog--"+this.model.get("size")+" ",this.className+=this.model.get("className"),this.$el.attr("class",this.className)},setTemplate:function(){var e=this.model.get("template");e=0===e.indexOf("#")?e:"#"+e,this.template=Handlebars.compile($(e).html())},initializeChildren:function(){var e=this.model.get("children");_.isArray(e)&&(this.childViews.modules=[],e.forEach(function(e,t){var i,s;this.isInstantiatedModule(e)?(i=e,i.dialog=this):(s=this.isInstantiatedModule(e.model)?e.model:new e.model(e.modelData),i=new e.view(_.extend({},e.viewData,{dialog:this,model:s}))),this.childViews.modules.push(i)}.bind(this)))},isInstantiatedModule:function(e){return _.isString(e.cid)},render:function(){var e=this.model.toJSON(),t=this.template(e);this.$el.html(t).appendTo("#modals"),this.createLoader(),this.renderChildren(),this.afterRender()},renderChildren:function(){var e;_.isArray(this.childViews.modules)&&(e=this.$(".dialog__main"),this.childViews.modules.forEach(function(t){e.append(t.render())}.bind(this)))},afterRender:function(){this.$el&&setTimeout(function(){this.setTopMargin(),this.$el.addClass("dialog--open")}.bind(this),50)},setTopMargin:function(){this.$el.css("margin-top",-(.5*this.$el.outerHeight()))},createLoader:function(){this.model.get("loader")&&(this.loadingIconView=new SW.LoadingIconView,this.$el.find(".js-loader-container").append(this.loadingIconView.render()))},removeLoader:function(){this.loadingIconView&&(this.loadingIconView.close(),this.loadingIconView=null)},createLoaderOverlay:function(){this.$overlay&&(this.removeOverlay(),this.removeLoader()),this.loadingIconView=new SW.LoadingIconView,this.$overlay=$("<div>").addClass("dialog__overlay"),this.$el.append(this.$overlay.html(this.loadingIconView.render()))},removeOverlay:function(){this.$overlay&&(this.$overlay.remove(),this.$overlay=null)},handleButtonZero:function(e){var t=this.model.get("buttons")[0];this.trigger("click:button-0",this),t&&_.isFunction(t.callback)&&t.callback(),this.triggerClose()},handleButtonOne:function(e){var t=this.model.get("buttons")[1];this.trigger("click:button-1",this),t&&_.isFunction(t.callback)&&t.callback()},triggerClose:function(){sw.dispatcher.trigger("dialog:close")},close:function(e){e=e||{},e.instant?this.closeEverything(e.closeOverlayInstant):(this.$el.addClass("dialog--close"),_.delay(this.closeEverything.bind(this),this.animDuration))},closeEverything:function(e){this.removeLoader(),this._super("close"),e===!0?sw.overlayManager.forceRemoveMask():sw.overlayManager.moveMaskDown()}}),SW.Dialog=SW.Model.extend({defaults:{className:"dialog",size:"small",template:"alert-dialog-template",title:void 0,main:void 0,loader:!1,buttons:[],children:[]}}),SW.ToastView=SW.View.extend({className:"toast",events:{"click .js-toast-close":"close"},initialize:function(e){this.options=e||{},this.template=Handlebars.compile($("#toast-template").html()),this.$toasts=$("#toasts"),this.setClassName(),this.setTimer(),this.render(),this.listenTo(sw.dispatcher,this.id+":close",this.close)},setClassName:function(){this.options.animation&&(this.el.className+=" anim-pop-in")},setTimer:function(){this.options.timer&&_.delay(this.close.bind(this),this.options.timer)},render:function(){var e={content:this.options.content||"No content was set for this alert."};this.$el.html(this.template(e)),this.$toasts.append(this.$el)},close:function(){this.options.animation?(this.$el.addClass("anim-pop-out"),_.delay(function(){this._super("close")}.bind(this),200)):this._super("close")}}),SW.ModalView=SW.View.extend({className:"slide-modal",initialize:function(e){sw.overlayManager=sw.overlayManager||new SW.OverlayManagerView({el:"#overlay-mask"}),this.template=$("#modal-base-template").html(),this.$buttons=[],this.LoadingIconView=null,this.options=e,this.animDuration=200,this.closeComplete=!1,sw.overlayManager.moveMaskUp(),this.listenTo(this.model,"change:content",this.render),this.listenTo(sw.dispatcher,"dialog:close",this.close)},render:function(){var e=this.model.get("content");return this.resetModalContents(),this.$heading=this.$el.find(".slide-modal-heading"),this.$container=this.$el.find(".modal-container"),this.$btnContainer=this.$el.find(".modal-btn-container"),this.renderHeadingContent(e),this.renderMainContent(e),this.renderLoadingIcon(e),this.renderButtons(e),this.$el.appendTo("#modals"),this.$el.css("margin-top",-(.5*this.$el.outerHeight())),this.$el},renderHeadingContent:function(e){_.has(e,"heading")?this.$heading.html(e.heading).removeClass("gone"):this.$heading.addClass("gone")},renderMainContent:function(e){this.$container.prepend(e.main||"")},renderLoadingIcon:function(e){_.has(e,"loadingSpinner")&&e.loadingSpinner===!0&&this.createLoader()},renderButtons:function(e){_.has(e,"buttons")?(this.$btnContainer.removeClass("gone"),this.createButtons()):this.$btnContainer.addClass("gone")},createButtons:function(){var e=this.model.get("content").buttons,t=this.options.parentView;this.createEachButton(e,t),this.$buttons=this.$el.find("button")},createEachButton:function(e,t){for(var i=0;i<e.length;i++){var s=$("<button>");s.html(e[i].name).addClass(e[i].classList).click(_.bind(t[e[i].callback],t)).appendTo(this.$btnContainer)}},createLoader:function(){this.loadingIconView=new SW.LoadingIconView,this.$container.append(this.loadingIconView.render())},resetModalContents:function(){var e=this;this.$el.html(e.template),this.$buttons.length>0&&this.removeButtonEvents(),this.loadingIconView&&this.removeLoader()},removeButtonEvents:function(){this.$buttons.off()},removeLoader:function(){this.loadingIconView.close(),this.loadingIconView=null},beforeClose:function(){},close:function(){var e=this;this.beforeClose(),this.$el.addClass("hide-modal"),_.delay(function(t){e.resetModalContents(),e.trigger("modal:close"),e._super("close"),sw.overlayManager.moveMaskDown(),e.closeComplete=!0},e.animDuration)}}),SW.AdvancedModalView=SW.ModalView.extend({className:"modal--advanced",events:{"click .modal--advanced__controls__exit":"close","click .modal--advanced__controls__back":"back","click .js-close-advanced-modal":"close"},initialize:function(e){sw.overlayManager=sw.overlayManager||new SW.OverlayManagerView({el:"#overlay-mask"}),this.template=$("#advanced-modal-base-template").html(),this.closeIcon='<i class="modal--advanced__controls__exit fa fa-times"></i>',this.backIcon='<i class="modal--advanced__controls__back fa fa-arrow-left"></i>',this.$buttons=[],this.loadingIconView=null,this.options=e,this.animDuration=200,sw.overlayManager.moveMaskUp(),this.listenTo(this.model,"change:content",this.render),this.listenTo(sw.dispatcher,"advanced-modal:spinner:add",this.addSpinner),this.listenTo(sw.dispatcher,"advanced-modal:spinner:remove",this.removeSpinner)},render:function(){return this.resetModalContents(),this.$controls=this.$el.find(".modal--advanced__controls"),this.$content=this.$el.find(".modal--advanced__content"),this.$spinner=this.$el.find(".modal--advanced__spinner"),this.renderControls(),this.$el.appendTo("#modals"),this.renderChild(),this.centerModal(),this.$el},centerModal:function(){this.$el.css("margin-top",-(.5*this.$el.outerHeight()))},renderChild:function(){this.centerModal()},addSpinner:function(){this.loadingIconView=new SW.LoadingIconView,this.$spinner.html(this.loadingIconView.render()),this.$spinner.css("left",.5*this.$el.outerWidth),this.$spinner.css("top",.5*this.$el.outerHeight)},removeSpinner:function(){this.$spinner.html("")},renderControls:function(){var e=this.model.get("controls")||{};e.close&&this.$controls.append(this.closeIcon),e.back&&this.$controls.append(this.backIcon),0===e.length&&this.$controls.addClass("no-controls")},toggleBackButton:function(e){e?$(".modal--advanced__controls__back").removeClass("gone"):$(".modal--advanced__controls__back").addClass("gone")}}),SW.ModalContentView=SW.ChildView.extend({className:"",initialize:function(e){},render:function(){return this.$el},renderSection:function(e,t){var i=this["$"+e];console.log("rendering "+e+" with content: "+t),_.has(t,e)?i.removeClass("gone").html(t[e]):i.addClass("gone")},renderSubSection:function(e){this.renderSection("subSection",e)},addModalSpinner:function(){sw.dispatcher.trigger("advanced-modal:spinner:add")},removeModalSpinner:function(){sw.dispatcher.trigger("advanced-modal:spinner:remove")},renderInputWarning:function(e){this.inputs[e].$el.addClass("warning"),this.inputs[e].$errorLabel.addClass("warning").removeClass("gone").text(this.inputs[e].errorMsg)},removeInputWarning:function(e){this.inputs[e].$el.removeClass("warning"),this.inputs[e].$errorLabel.removeClass("warning").addClass("gone").text("")}}),SW.AdvancedModal=SW.Model.extend({defaults:{content:void 0}}),SW.LightboxView=SW.AdvancedModalView.extend({className:"lightbox",initialize:function(){this.isClosing=!1,this.checkWindowSize(),this._super("initialize"),this.heightOffset=150,this.vidSrc=this.model.get("src"),_.isString(this.vidSrc)?this.render():(console.error("Invalid src for lightbox video"),this.close()),this.listenTo(sw.dispatcher,"window:resize",_.debounce(this.handleWindowResize,200)),this.listenTo(sw.dispatcher,"overlay:click",this.close)},renderChild:function(){this.$content.html('<div class="fluid-vid-wrapper"><iframe src="'+this.vidSrc+'" frameborder="0" allowfullscreen></iframe></div>')},handleWindowResize:function(){this.checkWindowSize(),this.centerModal()},checkWindowSize:function(){this.model.get("minWidth")&&!this.isClosing&&this.model.get("minWidth")>window.innerWidth&&(this.isClosing=!0,this.close())},centerModal:function(){var e=this,t=window.innerHeight;this.$el.css("width",(t-this.heightOffset)/.5625+"px");var i=(window.innerWidth-e.$el.innerWidth())/2,s=(t-e.$el.innerHeight())/2;e.$el.css({top:s+"px",left:i+"px",right:"auto"})}}),SW.Countdown=SW.Model.extend({defaults:{blockVariant:"",timeVariant:"","firsw.ariant":""},initialize:function(){this.view=new SW.CountdownView({model:this,el:this.get("el")}),"small"===this.get("variant")&&(this.set("blockVariant","countdown-block-sm"),this.set("timeVariant","countdown-time-sm"),this.set("firsw.ariant","countdown-shift-sm")),this.updateTime()},updateTime:function(){var e=new Date(this.get("endDate")),t=new Date,i=e.getTime()-t.getTime();if(i>0){var s=i/1e3,n=Math.floor(s%60);s/=60;var a=Math.floor(s%60);s/=60;var r=Math.floor(s%24);s/=24;var o=Math.floor(s)}else var n=0,a=0,r=0,o=0;this.set("days",o),this.set("hours",r),this.set("minutes",a),this.set("seconds",n),setTimeout(_.bind(this.updateTime,this),1e3)}}),SW.CountdownView=SW.View.extend({template:Handlebars.compile("<div class='countdown'><div class='countdown-block {{blockVariant}} {{firstVariant}}'><p class='countdown-days {{timeVariant}}'>{{days}}</p><p class='countdown-days-title'>Days</p></div><div class='countdown-block {{blockVariant}}'><p class='countdown-hours {{timeVariant}}'>{{hours}}</p><p class='countdown-hours-title'>Hours</p></div><div class='countdown-block {{blockVariant}}'><p class='countdown-minutes {{timeVariant}}'>{{minutes}}</p><p class='countdown-minutes-title'>Mins</p></div><div class='countdown-block {{blockVariant}}'><p class='countdown-seconds {{timeVariant}}'>{{seconds}}</p><p class='countdown-seconds-title'>Secs</p></div></div>"),initialize:function(){this.listenToOnce(this.model,"destroy",this.remove,this),this.listenTo(this.model,"change",this.render,this),this.render()},render:function(){var e=this.template(this.model.toJSON());this.$el.html(e)},remove:function(){this.cleanup(),this.$el.remove()},cleanup:function(){}}),SW.Widget=SW.Model.extend({defaults:{settings:{requiresLoading:!1,useSampleData:!1},controls:{close:!1,hint:!1},masterControls:{refresh:!1},content:{title:""},hint:{title:"Sample Hint",main:"Some text that explains <i>how</i> the widget works."},error:{imgSrc:"/assets/images/svg/spot-illustrations/device-cry.svg"},footerLink:{text:""},confirmClose:{text:"Are you sure you want to close this widget?"},contentList:[],filterBy:{isEnabled:!1,value:"",text:""},filterSelectOptions:[{value:"",text:""}]},initialize:function(){this._super("initialize"),this.isLoading=!1,this.setConfirmCloseText()},setConfirmCloseText:function(){if(this.get("controls").close){var e=this.get("content").title.length?"the "+this.get("content").title+" widget":"this widget";e+="?",this.set("confirmClose",{text:"Are you sure you want to close "+e})}},trySampleData:function(){this.get("settings").useSampleData?this.setSampleData():this.load()},setSampleData:function(){},load:function(){this.isLoading=!0,this.trigger("loading:started")},changeFilterBy:function(e){e.isEnabled=!0,this.set("filterBy",e),this.load()}}),SW.WidgetView=SW.ParentView.extend({className:"dash-widget",events:{"click .js-close":"handleClose","click .js-force-close":"close","click .js-open-hint":"toggleHint","click .js-close-modal":"hideModal","click .js-dash-previous":"previousContent","click .js-dash-next":"nextContent","click .js-reload-btn":"reloadContent","click .js-footer-link":"handleFooterLink","click .js-filter-btn":"toggleFilterOptions","click .js-filter-option":"changeFilter"},initialize:function(){this._super("initialize"),this.template={base:Handlebars.compile($("#dash-widget-base-template").html()),error:Handlebars.compile($("#dash-widget-error-template").html()),hint:Handlebars.compile($("#dash-widget-hint-template").html()),listControl:Handlebars.compile($("#dash-widget-list-control-template").html()),confirmation:Handlebars.compile($("#dash-widget-confirmation-template").html()),filterOptions:Handlebars.compile($("#dash-widget-filter-options-template").html()),content:void 0},this.$headerControls=void 0,this.$masterControls=void 0,this.$footerControls=void 0,this.$contentContainer=void 0,this.$filterOptionModal=void 0,this.currentContentIndex=0,this.isloading=!1,this.hasError=!1,this.isHintOpen=!1,this.isModalOpen=!1,this.isFilterOptionModalOpen=!1,this.listenTo(this.model,"loading:started",this.setLoadingState),this.listenTo(this.model,"loading:completed",this.setLoadedState),this.listenTo(this.model,"loading:failed",this.setErrorState),this.model.get("filterBy").isEnabled&&(this.listenTo(sw.dispatcher,"body:click",this.closeFilterOptions),this.listenTo(this.model,"change:filterBy",this.renderFilterOptions))},renderInitialState:function(){this.model.isLoading?this.setLoadingState():this.setLoadedState()},cleanState:function(){this.isModalOpen||this.removeWidgetModal(),this.isloading||this.removeLoader(),this.isModalOpen?this.isModalOpen||this.removeTopControlsDisabled():this.removeDisabled()},setLoadingState:function(){this.isloading=!0,this.hasError=!1,this.cleanState(),this.removeFooterControls(),this.removeMasterControls(),this.renderLoader()},setLoadedState:function(){this.isloading=!1,this.hasError=!1,this.cleanState(),this.renderContent(),this.renderFooterControls(),this.renderMasterControls()},setDeactiveState:function(){this.disableAllControls(),this.disableContent()},setErrorState:function(){this.isloading=!1,this.hasError=!0,this.cleanState(),this.renderError()},cacheSelections:function(){this.$masterControls=this.$el.find(".js-master-controls"),this.$headerControls=this.$el.find(".js-top-controls"),this.$footerControls=this.$el.find(".js-bottom-controls"),this.$modalContainer=this.$el.find(".dash-widget__modals"),this.$contentContainer=this.$el.find(".dash-widget__content")},render:function(){return this.renderBase(),this.renderInitialState(),this.$el},renderBase:function(){var e=this.model.get("content");return this.$el.html(this.template.base(e)),this.cacheSelections(),this.renderFilterOptions(),this.renderHeaderControls(),this.$el},renderFilterOptions:function(){var e=this.model.get("filterBy");if(e.isEnabled){var t;e.title=this.model.get("content").title,e.selectOptions=this.model.get("filterSelectOptions"),t=this.template.filterOptions(e),this.$el.find(".dash-widget__title").html(t),this.$filterOptionModal=this.$el.find(".js-filter-options")}},renderControls:function(){this.renderHeaderControls(),this.renderFooterControls()},renderMasterControls:function(){var e=this.model.get("masterControls"),t=!1;e.refresh&&this.renderRefreshControl();for(var i in e)e[i]&&(t=!0);t&&this.$masterControls.removeClass("gone")},renderHeaderControls:function(){var e=this.model.get("controls"),t=!1;e.hint&&(this.renderHintControl(),t=!0),e.close&&(this.renderCloseControl(),t=!0),t&&this.$headerControls.removeClass("gone")},renderFooterControls:function(){var e=!1;this.model.get("contentList").length?(this.renderListControl(),e=!0):this.model.get("footerLink").text.length&&(this.renderFooterLink(),e=!0),e&&this.$footerControls.removeClass("gone")},renderRefreshControl:function(){this.$masterControls.append('<i class="js-reload-btn dash-widget__control fa fa-refresh hide-mobile"></i>')},renderCloseControl:function(){this.$headerControls.append("<i class='js-close dash-widget__control fa fa-times'></i>")},renderFooterLink:function(){this.$footerControls.html("<span class='js-footer-link dash-widget__control dash-widget__footer-link'>"+this.model.get("footerLink").text+" <i class='fa fa-chevron-right'></i></span>")},renderHintControl:function(){this.$headerControls.append("<i class='js-open-hint dash-widget__control fa fa-question-circle'></i>")},renderListControl:function(){var e=this.model.get("contentList").length,t={isFirstItem:0===this.currentContentIndex,isLastItem:this.currentContentIndex===e-1,currentItem:this.currentContentIndex+1,lastItem:e};this.$footerControls.html(this.template.listControl(t))},renderContent:function(){},renderError:function(){var e=this.model.get("error"),t=this.template.error(e);this.$contentContainer.html(t)},renderHint:function(){var e=this.model.get("hint"),t=this.template.hint(e);this.$modalContainer.html(t)},renderCloseConfirmation:function(){var e=this.model.get("confirmClose"),t=this.template.confirmation(e);this.$modalContainer.html(t)},renderLoader:function(){this.childViews.loader=new SW.LoadingIconView,this.$contentContainer.html(this.childViews.loader.render())},handleFooterLink:function(){},handleClose:function(){this.showModal(this.renderCloseConfirmation)},removeFooterControls:function(){this.$footerControls.empty()},removeMasterControls:function(){this.$masterControls.empty()},removeHint:function(){this.removeWidgetModal()},removeWidgetModal:function(){this.$modalContainer.empty()},removeLoader:function(){this.childViews.loader&&(this.childViews.loader.close(),this.childViews.loader=null)},showModal:function(e){this.isModalOpen=!0,e.call(this),this.$modalContainer.css("opacity",0).removeClass("gone").animate({opacity:1},250,"easeInOutQuint")},hideModal:function(){this.isModalOpen=!1,this.removeWidgetModal(),this.$modalContainer.addClass("gone")},toggleFilterOptions:function(){var e=this;this.isFilterOptionModalOpen?this.closeFilterOptions():setTimeout(function(){e.$filterOptionModal.toggleClass("open"),e.isFilterOptionModalOpen=e.$filterOptionModal.hasClass("open")},0)},closeFilterOptions:function(){this.isFilterOptionModalOpen&&(this.$filterOptionModal.removeClass("open"),this.isFilterOptionModalOpen=!1)},changeFilter:function(e){var t=$(e.target),i={text:t.text().toLowerCase(),value:t.attr("data-value")};this.model.changeFilterBy(i)},animatedClose:function(){var e=this,t=500;this.$el.addClass("scale--out"),setTimeout(function(){e.close()},t)},toggleHint:function(){this.isModalOpen?this.hideModal():this.showModal(this.renderHint)},showHint:function(){this.isHintOpen=!0,this.renderHint(),this.setDeactiveState(),this.$modalContainer.removeClass("gone")},hideHint:function(){this.isHintOpen=!1,this.removeHint(),this.cleanState(),this.$modalContainer.addClass("gone")},disableAllControls:function(){this.disableTopControls(),this.disableBottomControls()},disableTopControls:function(){this.$headerControls.addClass("control--disabled")},disableBottomControls:function(){this.$footerControls.addClass("control--disabled")},disableContent:function(){this.$contentContainer.addClass("disabled")},removeDisabled:function(){this.$el.find(".control--disabled").removeClass("control--disabled"),this.$el.find(".disabled").removeClass("disabled"),this.$el.find(".disabled--forced").removeClass("disabled--forced")},removeTopControlsDisabled:function(){this.$headerControls.removeClass("control--disabled")},reloadContent:function(){this.model.load()},nextContent:function(e){this.currentContentIndex++,this.currentContentIndex===this.model.get("contentList").length&&(this.currentContentIndex=0),this.renderContent(),this.renderListControl()},previousContent:function(e){0===this.currentContentIndex?this.currentContentIndex=this.model.get("contentList").length-1:this.currentContentIndex--,this.renderContent(),this.renderListControl()}}),SW.AssignmentWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Active assignments"},masterControls:{refresh:!0},footerLink:{text:"View Full Report"},assignmentsOptions:{daysExpiredAllowance:7,limit:3},assignments:[],assignmentIndex:0})},initialize:function(){this._super("initialize"),this.trySampleData()},setSampleData:function(){var e=[{id:"000000",name:"Classify 2D shapes",endDate:this.oneWeekFromNow(),totalQuestions:5,students:[{completedDate:!0,questionsAnswered:5,questionsCorrect:4},{completedDate:!1,questionsAnswered:0,questionsCorrect:0},{completedDate:!0,questionsAnswered:5,questionsCorrect:2},{completedDate:!1,questionsAnswered:4,questionsCorrect:4},{completedDate:!0,questionsAnswered:5,questionsCorrect:4}]},{id:"000000",name:"Missing number subtraction to 10 (first value missing)",endDate:this.oneWeekFromNow(),totalQuestions:10,students:[{completedDate:!0,questionsAnswered:10,questionsCorrect:10},{completedDate:!0,questionsAnswered:10,questionsCorrect:9},{completedDate:!0,questionsAnswered:10,questionsCorrect:5},{completedDate:!1,questionsAnswered:8,questionsCorrect:6},{completedDate:!0,questionsAnswered:10,questionsCorrect:7}]}];this.get("footerLink").text="",this.configureData(e)},oneWeekFromNow:function(){var e=new Date;return e.setTime(e.getTime()+6048e5),e},load:function(){var e=this.get("assignmentsOptions");this._super("load"),SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+sw.user.classes.getCurrentClassID()+"/assignments/summary",dataType:"json",data:{daysExpiredAllowance:e.daysExpiredAllowance,limit:e.limit,userID:sw.user.get("userID")},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){_.isArray(e)?(this.configureData(e),this.trigger("loading:completed")):this.handleFailedLoad()},handleFailedLoad:function(){this.trigger("loading:failed")},configureData:function(e){var t=[];e.forEach(function(e){var i=e.totalQuestions*e.students.length,s=0,n=0,a=e.students.length,r=0,o={};e.students.forEach(function(e){r+=e.completedDate?1:0,s+=e.questionsAnswered,n+=e.questionsCorrect});var l=Math.min(Math.round(s/i*100),100),d=new Date(e.endDate);d.setDate(d.getDate()+1),o={id:e.id,name:e.name,averageGrade:Math.round(n/s*100),endDate:d.toDateString(),questions:{total:i,answered:s,answeredPercentage:l,unanswered:i-s,unansweredPercentage:100-l},students:{total:a,complete:r,completePercentage:r/a*100||0,incomplete:a-r,incompletePercentage:(a-r)/a*100||0}},t.push(o)}),this.set("assignments",t)}}),SW.AssignmentWidgetView=SW.WidgetView.extend({className:"dash-widget--sm assignment-widget",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"change #assignment-select":"selectNewAssignment","click .js-footer-link":"goToAssignmentReport"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#assignment-widget-content-template").html()),this.template.noAssignments=Handlebars.compile($("#assignment-widget-no-assignments-template").html()),this.listenTo(this.model,"change:assignmentIndex",this.renderContent)},renderContent:function(){var e=_.cloneDeep(this.model.get("assignments"));this.model.get("assignmentIndex");e.length?this.renderHasAssignmentsState(e):this.renderNoAssignmentsState()},renderHasAssignmentsState:function(e){var t={},i=this.model.get("assignmentIndex");e[i].isSelected=!0,t={allAssignments:e,assignment:e[i]},this.$contentContainer.html(this.template.content(t))},renderNoAssignmentsState:function(){this.$contentContainer.html(this.template.noAssignments())},selectNewAssignment:function(e){var t=$(e.target);this.model.set("assignmentIndex",t.val())},renderFooterControls:function(){this.model.get("assignments").length&&this._super("renderFooterControls")},goToAssignmentReport:function(){var e=this.model.get("assignments"),t=this.model.get("assignmentIndex");window.open("/assignments/report.php?lock=1&id="+e[t].id,"_blank")}}),SW.QuestionsWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Questions answered"},masterControls:{refresh:!0},footerLink:{text:""},filterBy:{isEnabled:!0,value:"this-week",text:"this week"},filterSelectOptions:[{value:"this-week",text:"This week"},{value:"last-week",text:"Last week"}],questionData:{},hasQuestionData:!1})},initialize:function(){this._super("initialize"),this.set("instructionsUrl","/actions/printParentLetters.php?class-id="+sw.user.classes.getCurrentClassID()),this.trySampleData()},setSampleData:function(){for(var e=[],t=0;t<7;t++){var i=_.random(20,500),s=t<5?_.random(20,i):i;e.push({questionsAnswered:i,questionsAtHome:s})}this.handleSuccessfulLoad(e)},load:function(){var e=this,t=this.get("filterBy").value,i=moment().startOf("week").add(1,"days"),s=moment().endOf("week").add(1,"days");this._super("load"),this.set("hasQuestionData",!1),"last-week"===t&&(i.subtract(1,"weeks"),s.subtract(1,"weeks")),1e3*i.unix()<sw.config.statsStartTime?SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/classes/"+sw.user.classes.getCurrentClassID()+"/activity",dataType:"json",data:{dateKey:this.get("filterBy").value,timeZone:moment.tz.guess(),userID:sw.user.get("userID")},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)}):SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+sw.user.classes.getCurrentClassID()+"/student-usage",dataType:"json",data:{startDate:i.format("YYYY-MM-DD"),endDate:s.format("YYYY-MM-DD"),userID:sw.user.get("userID")},success:function(t){var i=[];t.data.forEach(function(e,t){var s={questionsAnswered:0,questionsAtHome:0};e.studentData.forEach(function(e){s.questionsAnswered+=e.questionsAnswered,s.questionsAtHome+=e.questionsAtHome}),i.push(s)}),e.handleSuccessfulLoad(i)},error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){_.isArray(e)?(this.configureQuestionData(e),this.trigger("loading:completed")):this.handleFailedLoad()},handleFailedLoad:function(){this.trigger("loading:failed")},configureQuestionData:function(e){for(var t={inClass:[],atHome:[]},i=0;i<e.length;i++)t.inClass.push(e[i].questionsAnswered-e[i].questionsAtHome),t.atHome.push(e[i].questionsAtHome),e[i].questionsAnswered>0&&(this.set("hasQuestionData",!0),this.set("footerLink",{text:"View Full Report"}));this.set("questionData",t)}}),SW.QuestionsWidgetView=SW.WidgetView.extend({className:"dash-widget--md questions-widget",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-footer-link":"goToQuestionsReport"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#questions-widget-content-template").html())},renderContent:function(){var e,t=this,i=this.model.toJSON(),s=this.model.get("questionData"),n=this.model.get("hasQuestionData"),a=sw.user.parentApp();i.parentApp=a,a&&(e=sw.user.classes.getCurrentClass().students.at(0),i.studentName=e?"<b>"+SW.Utility.firstName(e.get("name"))+"</b>":"your kid"),this.$contentContainer.html(this.template.content(i)),n&&_.defer(function(){t.chart=new Highcharts.Chart({chart:{type:"area",backgroundColor:"transparent",height:325,renderTo:"questions-chart"},credits:{enabled:!1},title:{text:""},xAxis:{categories:["MON","TUES","WED","THURS","FRI","SAT","SUN"],tickLength:0,title:{enabled:!1}},yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value}}},tooltip:{shared:!0,valueSuffix:" questions"},plotOptions:{area:{stacking:"normal",lineWidth:3,marker:{enabled:!1}}},legend:{layout:"vertical",align:"center",verticalAlign:"top",y:25,symbolWidth:35,symbolHeight:4,symbolPadding:16,itemMarginBottom:11,itemStyle:{fontSize:"13px"}},series:[{name:"At home",color:"rgb(78,151,213)",fillColor:"rgba(78,151,213, 0.2)",lineColor:"rgb(78,151,213)",marker:{fillColor:"rgba(78,151,213, 1)",symbol:"circle"},data:s.atHome},{name:"In class",color:"rgb(26,187,155)",fillColor:"rgba(26,187,155, 0.5)",lineColor:"rgb(26,187,155)",marker:{fillColor:"rgba(26,187,155, 1)",symbol:"circle"},data:s.inClass}]})})},goToQuestionsReport:function(){var e,t,i=this.model.get("filterBy"),s="#reports/student-usage-report";"last-week"===i.value&&(e=moment().startOf("week").subtract("days",6),t=moment().endOf("week").subtract("days",6),s+="?startTime="+e+"&endTime="+t),sw.app.navigate(s,{trigger:!0})}}),SW.LeaderboardWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Top "+SW.Lexicon("students")},masterControls:{refresh:!0},filterBy:{isEnabled:!0,value:"this-week",text:"this week"},filterSelectOptions:[{value:"today",text:"Today"},{value:"yesterday",text:"Yesterday"},{value:"this-week",text:"This week"},{value:"last-week",text:"Last week"}]})},initialize:function(){this._super("initialize"),this.trySampleData()},setupStudentData:function(){var e=this.sortRawStudentData();e=e.chunk(5),this.set("contentList",e)},setSampleData:function(){this.handleSuccessfulLoad([{studentName:"Brittany S.",questionsCorrect:50,questionsAnswered:56},{studentName:"Morgan F.",questionsCorrect:34,questionsAnswered:35},{studentName:"Natalie P.",questionsCorrect:22,questionsAnswered:33},{studentName:"Denzel W.",questionsCorrect:20,questionsAnswered:38},{studentName:"Johnny D.",questionsCorrect:17,questionsAnswered:22}])},load:function(){this._super("load"),this.loadRawStudentData()},loadRawStudentData:function(){var e=this,t=this.get("filterBy").value,i=moment().startOf("week").add(1,"days"),s=moment().endOf("week").add(1,"days");this._super("load"),"last-week"===t&&(i.subtract(1,"weeks"),s.subtract(1,"weeks")),"today"===t&&(i=moment(),s=i),"yesterday"===t&&(i=moment().subtract(1,"days"),s=i),1e3*i.unix()<sw.config.statsStartTime?SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/classes/"+sw.user.classes.getCurrentClassID()+"/leaderboard",
dataType:"json",data:{dateKey:this.get("filterBy").value,timeZone:moment.tz.guess(),userID:sw.user.get("userID")},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)}):SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+sw.user.classes.getCurrentClassID()+"/student-usage",dataType:"json",data:{startDate:i.format("YYYY-MM-DD"),endDate:s.format("YYYY-MM-DD"),userID:sw.user.get("userID")},success:function(t){var i=[],s={userID:null,studentID:null,studentName:null,questionsAnswered:0,questionsCorrect:0,questionsAtHome:0,secondsSpent:0};t.data.forEach(function(e,t){e.studentData.forEach(function(e,n){var a=e.userID;0===t&&(i[n]=JSON.parse(JSON.stringify(s)),i[n].userID=e.userID,i[n].studentID=e.studentID,i[n].studentName=sw.user.classes.getCurrentClass().students.get(a).get("name")),i[n].questionsAnswered+=e.questionsAnswered,i[n].questionsCorrect+=e.questionsCorrect,i[n].questionsAtHome+=e.questionsAtHome,i[n].secondsSpent+=e.secondsSpent})}),e.handleSuccessfulLoad(i)},error:this.handleFailedLoad.bind(this)})},addInactiveStudentsToLeaderboard:function(e){return sw.user.classes.getCurrentClass().students.forEach(function(t){var i=!1;e.forEach(function(e){e.userID==t.id&&(i=!0)}),i||e.push({studentName:t.get("name"),questionsAnswered:0,questionsAtHome:0,questionsCorrect:0,secondsSpent:0})}),e},handleSuccessfulLoad:function(e){_.isArray(e)?(e=this.addInactiveStudentsToLeaderboard(e),e.length&&(this.rawStudentData=e,this.setupStudentData()),this.trigger("loading:completed")):this.handleFailedLoad()},handleFailedLoad:function(){this.trigger("loading:failed")},sortRawStudentData:function(){var e=_.sortBy(this.rawStudentData,"questionsCorrect").reverse(),t=this.rankStudents(e);return t},rankStudents:function(e){var t=[],i=['<i class="trophy--gold fa fa-trophy"></i>','<i class="trophy--silver fa fa-trophy"></i>','<i class="trophy--bronze fa fa-trophy"></i>'];return t=_.forEach(e,function(e,t){t<i.length?e.rank=i[t]:e.rank=t+1})}}),SW.LeaderboardWidgetView=SW.WidgetView.extend({className:"dash-widget--sm leaderboard-widget",initialize:function(){this._super("initialize"),this.template.content=this.findTemplate("leaderboard-widget-content")},renderContent:function(){var e=this.model.get("contentList")[this.currentContentIndex];this.$contentContainer.html(this.template.content(e))}}),SW.LearningWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{controls:{close:!1,hint:!1},content:{title:"",tag:"",imgSrc:"",imgAlt:"",heading:"",main:"",videoSrc:""}})}}),SW.LearningWidgetView=SW.WidgetView.extend({className:"learning-widget dash-widget--sm",events:function(){return _.extend({},SW.Widget.prototype.defaults,{"click .js-learn-more-btn":"openVideo"})},initialize:function(){this._super("initialize"),this.videoSrcArgs="?controls=-8&showinfo=0",this.template.content=Handlebars.compile($("#learning-widget-content-template").html())},renderContent:function(){var e=this.model.get("content");this.$contentContainer.html(this.template.content(e))},openVideo:function(){this.trackOpenVideo(),this.childViews.lightbox=new SW.LightboxView({model:new SW.Model({src:this.model.get("content").videoSrc+this.videoSrcArgs,minWidth:0,controls:{close:!0}})})},trackOpenVideo:function(){var e={};e["Watched "+this.model.get("content").tag+" Video"]=1,sw.track.user("increment",e)}}),SW.NoticeWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{settings:{requiresLoading:!0},controls:{close:!0,hint:!0},content:{title:""}})},initialize:function(){this._super("initialize"),this.load()},load:function(){var e=this;this.trigger("loading:started"),setTimeout(function(){Math.random()>1?(e.set("contentList",[{main:"Notice 1"},{main:"Notice 2"}]),e.trigger("loading:completed")):e.trigger("loading:failed")},Math.ceil(5e3*Math.random()))}}),SW.NoticeWidgetView=SW.WidgetView.extend({className:"dash-widget--lg",initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#notice-widget-content-template").html())},renderContent:function(){var e;e=this.model.get("contentList").length?this.model.get("contentList")[this.currentContentIndex]:this.model.get("content"),this.$contentContainer.html(this.template.content(e))}}),SW.GradeComparisonWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{controls:{close:!1,hint:!0},masterControls:{refresh:!0},hint:{title:"What's this?",main:"When a student <b>doesn't have an active plan or assignment</b>, Prodigy runs them through a placement test to determine their current grade level. Once it is complete, you will see the results here!"},content:{title:"Placement test results"},footerLink:{text:"View Full Report"},gradeData:[]})},initialize:function(){this._super("initialize"),this.maxCurriculaShown=40,this.trySampleData()},setSampleData:function(){var e={"0000000":{placement:"Grade 4",name:"Sample Student 1",userID:"0000000"},"0000001":{placement:"Test In Progress",name:"Sample Student 2",userID:"0000001"},"0000002":{placement:"Grade 5",name:"Sample Student 3",userID:"0000002"},"0000003":{placement:"Grade 5",name:"Sample Student 4",userID:"0000003"},"0000004":{placement:"Grade 5",name:"Sample Student 5",userID:"0000004"}};this.handleSuccessfulLoad(e)},load:function(){this._super("load"),SW.Http.fetch({url:sw.config.api.web+"/v1/classes/"+sw.user.classes.getCurrentClassID()+"/students/curriculum",dataType:"json",data:{userID:sw.user.get("userID")},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){_.isObject(e)?(this.setConfiguredGradeData(e),this.trigger("loading:completed")):this.handleFailedLoad()},handleFailedLoad:function(){this.trigger("loading:failed")},setConfiguredGradeData:function(e){var t=this.extractPlacements(e),i=this.configureGradeData(t);this.set("gradeData",i)},extractPlacements:function(e){var t={};return _.forEach(e,function(e){_.has(t,e.placement)?t[e.placement].push(e.name):t[e.placement]=[e.name]}),t},configureGradeData:function(e){var t=this.extractGradeDataFromPlacements(e);return this.sortGradeData(t),t},extractGradeDataFromPlacements:function(e){var t=[];return _.forEach(e,function(e,i){t.push({name:i,y:e.length,students:e})}),t},sortGradeData:function(e){e.sort(function(e,t){return t.y-e.y})}}),SW.GradeComparisonWidgetView=SW.WidgetView.extend({className:"dash-widget--sm grade-comparison-widget",initialize:function(){this._super("initialize"),this.template.empty=Handlebars.compile($("#grade-comparison-widget-empty-template").html())},renderContent:function(){var e=this.model.get("gradeData");if(e.length)this.renderChart();else{var t=this.model.get("gradeData");this.$contentContainer.html(this.template.empty(t))}},renderChart:function(){var e=this,t=this.model.get("gradeData");this.$contentContainer.html('<div id="grade-comparison-chart"></div>'),setTimeout(function(){e.chart=new Highcharts.Chart({chart:{backgroundColor:"transparent",height:300,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,renderTo:"grade-comparison-chart"},credits:{enabled:!1},title:{text:""},legend:{layout:"vertical",align:"left",verticalAlign:"middle",symbolWidth:13,symbolHeight:13,symbolPadding:11,symbolRadius:2,itemMarginBottom:22,itemStyle:{fontSize:"14px"}},tooltip:{formatter:function(){for(var e,i="<b>Students:</b>",s=0;s<t.length;s++)if(t[s].name===this.key){e=t[s].students;break}return _.isArray(e)&&e.forEach(function(e){i+="<br>"+e}),i}},plotOptions:{pie:{innerSize:"55%",colors:["#1ABB9B","#3498DB","#34495E","#E74C3C","#F1C30F","#9B59B5","#2ECC71","#F39C12","#696969"],borderWidth:0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},series:[{type:"pie",name:"Students",data:t}]}),e.$el.find("#grade-comparison-chart svg").height(600)},0)}}),SW.StrugglingWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Struggling skills"},controls:{hint:!0},masterControls:{refresh:!0},footerLink:{text:"View Full Report"},filterBy:{isEnabled:!0,value:"this-week",text:"this week"},filterSelectOptions:[{value:"this-week",text:"This week"},{value:"last-week",text:"Last week"}],hint:{title:"What's this?",main:"This widget shows you the areas that your students are struggling in most. The chart is organized by the skill name, the number of students that have worked on that skill, and their average grade."},strugglingSkills:[]})},initialize:function(){this._super("initialize"),this.trySampleData()},setSampleData:function(){var e=[{name:"Bryan P.",numQuestions:20,grade:44},{name:"Wasee M.",numQuestions:14,grade:20},{name:"Marvin M.",numQuestions:33,grade:50},{name:"Anne D.",numQuestions:18,grade:41},{name:"Tamika V.",numQuestions:27,grade:53}],t=[{skillName:"Division word problems",grade:42,colorClass:this.getColorClassFromGrade(42),students:[e[0],e[1],e[2]],numStudents:3},{skillName:"Volume of 3D shapes",grade:50,colorClass:this.getColorClassFromGrade(50),students:[e[3],e[0]],numStudents:2},{skillName:"Multiply 2 digit by 2 digit",grade:63,colorClass:this.getColorClassFromGrade(63),students:[e[0],e[1],e[2],e[4],e[3]],numStudents:5}];t=_.sortBy(t,"grade"),this.set("strugglingSkills",t)},load:function(){var e=this,t=this.get("filterBy").value,i=moment().startOf("week").add(1,"days"),s=i.clone().add(1,"weeks");this._super("load"),"last-week"===t&&(i.subtract(1,"weeks"),s.subtract(1,"weeks")),1e3*i.unix()<sw.config.statsStartTime?SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/classes/"+sw.user.classes.getCurrentClassID()+"/trouble_spots",dataType:"json",data:{numResults:3,dateKey:this.get("filterBy").value,userID:sw.user.get("userID")},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)}):SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+sw.user.classes.getCurrentClassID()+"/stats",dataType:"json",data:{userID:sw.user.get("userID"),startDate:i.format("YYYY-MM-DD"),endDate:s.format("YYYY-MM-DD")},success:function(t){var i={},s=[];_.forIn(t,function(e){_.forIn(e,function(e){_.forEach(e.skills,function(e){e.questions_correct/e.questions_answered<.7&&(i[e.skill_id]||(i[e.skill_id]={},i[e.skill_id].questions_answered=0,i[e.skill_id].questions_at_school=0,i[e.skill_id].questions_correct=0,i[e.skill_id].seconds_spent=0),i[e.skill_id].questions_answered+=e.questions_answered,i[e.skill_id].questions_at_school+=e.questions_at_school,i[e.skill_id].questions_correct+=e.questions_correct,i[e.skill_id].seconds_spent+=e.seconds_spent,i[e.skill_id].grade=i[e.skill_id].questions_correct/i[e.skill_id].questions_answered*100,i[e.skill_id].students||(i[e.skill_id].students={}),i[e.skill_id].students[e.user_id]||(i[e.skill_id].students[e.user_id]={},i[e.skill_id].students[e.user_id].questions_answered=0,i[e.skill_id].students[e.user_id].questions_at_school=0,i[e.skill_id].students[e.user_id].questions_correct=0,i[e.skill_id].students[e.user_id].seconds_spent=0),i[e.skill_id].students[e.user_id].questions_answered+=e.questions_answered,i[e.skill_id].students[e.user_id].questions_at_school+=e.questions_at_school,i[e.skill_id].students[e.user_id].questions_correct+=e.questions_correct,i[e.skill_id].students[e.user_id].seconds_spent+=e.seconds_spent)})})}),_.forIn(i,function(e,t){var i={};_.forIn(e.students,function(e,t){i[t]={questionsCorrect:e.questions_correct,questionsIncorrect:e.questions_answered-e.questions_correct}}),s.push({skillID:t,questionsCorrect:e.questions_correct,questionsIncorrect:e.questions_answered-e.questions_correct,gradeSum:e.questions_correct/e.questions_answered,grade:(e.questions_correct/e.questions_answered*100).toString(),students:i})}),s=_.sortBy(s,function(e){return-e.students.length}).slice(0,3),e.handleSuccessfulLoad(s)},error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){_.isArray(e)?(this.configureSkillData(e),this.trigger("loading:completed")):this.handleFailedLoad()},handleFailedLoad:function(){this.trigger("loading:failed")},configureSkillData:function(e){for(var t=0;t<e.length;t++)e[t].skillName=SW.Education.skills[e[t].skillID].name,e[t].colorClass=this.getColorClassFromGrade(e[t].grade),e[t].grade=Math.round(e[t].grade),e[t].numStudents=Object.keys(e[t].students).length;e=_.sortBy(e,"grade"),this.set("strugglingSkills",e)},getColorClassFromGrade:function(e){var t;return t=e>=80?"not-struggling":e>=60?"struggling":"most-struggling"}}),SW.StrugglingWidgetView=SW.WidgetView.extend({className:"dash-widget--md struggling-widget",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-footer-link":"goToWeeklyActivityReport"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#struggling-widget-content-template").html())},renderContent:function(){var e=this.model.get("strugglingSkills");this.$contentContainer.html(this.template.content(e))},goToWeeklyActivityReport:function(){var e,t,i=this.model.get("filterBy"),s="#reports/activity-report";"last-week"===i.value&&(e=moment().startOf("week").subtract("days",6),t=moment().endOf("week").subtract("days",6),s+="?startTime="+e+"&endTime="+t),sw.app.navigate(s,{trigger:!0})}}),SW.InfluencerWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Get free memberships"},controls:{hint:!1},masterControls:{refresh:!0},points:{percentage:0,untilNextMembership:0}})},initialize:function(){this._super("initialize"),this.listenTo(sw.dispatcher,"user:load-influencer:success",this.handleSuccessfulLoad),this.listenTo(sw.dispatcher,"user:load-influencer:failed",this.handleFailedLoad),this.load()},load:function(){this._super("load"),sw.user.loadInfluencerData()},handleSuccessfulLoad:function(){var e=sw.user.influencer.toJSON(),t=Math.floor(e.totalPoints/e.increment)*e.increment,i=(t+e.increment,e.totalPoints),s=(i-t)/e.increment*100;this.set("points",{percentage:s,totalStudents:e.totalStudentsReferred,untilNextMembership:20-e.totalStudentsReferred%20,unclaimedMemberships:e.unclaimedMemberships}),this.trigger("loading:completed")},handleFailedLoad:function(){this.trigger("loading:failed-alt")}}),SW.InfluencerWidgetView=SW.WidgetView.extend({className:"dash-widget--sm influencer-widget",initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#influencer-widget-content-template").html()),this.listenTo(this.model,"loading:completed",this.renderContent),this.listenTo(this.model,"loading:failed-alt",this.renderContent)},renderContent:function(){var e=this.model.get("points");this.$contentContainer.html(this.template.content(e))}}),SW.PlannerWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Planner"},currentState:"empty",nearestPlan:void 0,footerLink:{text:"Footer"},state:{empty:{imgSrc:"/assets/images/svg/spot-illustrations/calendar.svg",imgAlt:"An empty calendar",buttonText:"Schedule a plan"},active:{title:"<div class='text-light small'>Your current plan:</div> Data&nbsp;Relationships",daysRemaining:void 0,imgSrc:"/assets/images/svg/spot-illustrations/calendar.svg",imgAlt:"days remaining.",buttonText:"View all plans"},upcoming:{daysUntil:1,topicName:void 0,imgSrc:"/assets/images/svg/spot-illustrations/calendar.svg",imgAlt:"Calendar with a clock infront of it.",buttonText:"View all plans"}}})},initialize:function(){this._super("initialize"),this.load(),this.set("footerLink",{text:"View all plans"})},load:function(){this._super("load"),SW.Http.fetch({url:sw.config.api.planner+"/v1/classes/"+sw.user.classes.getCurrentClassID()+"/plans",method:"GET",success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){_.isArray(e)?(e.length?this.determineStateFromPlans(e):this.setState("empty"),this.trigger("loading:completed")):this.handleFailedLoad()},determineStateFromPlans:function(e){var t,i=this.selectNearestPlan(e);i?(t=new Date,this.set("nearestPlan",i),t.getTime()<this.createDate(i.start_date).getTime()?this.setState("upcoming"):this.setState("active")):this.setState("empty")},selectNearestPlan:function(e){var t=void 0,i=void 0,s=new Date;return SW.Utility.setTimeInDayToZero(s),e.forEach(function(e){var n,a=this.createDate(e.end_date);s.getTime()<=a.getTime()&&(n=this.createDate(e.start_date),t&&i.getTime()<n.getTime()||(t=e,i=n))}.bind(this)),t},createDate:function(e){return new Date(e.substring(0,10).replace(/-/g,"/"))},setState:function(e){"upcoming"===e?this.setDaysUntilPlan():"active"===e&&this.setRemainingDays(),this.set("currentState",e)},setDaysUntilPlan:function(){var e=SW.Utility.datesInRange(new Date,this.createDate(this.get("nearestPlan").start_date)).length;this.get("state").upcoming.daysUntil=e,e>1&&(this.get("state").upcoming.moreThanOneDay=!0)},setRemainingDays:function(){var e=SW.Utility.datesInRange(new Date,this.createDate(this.get("nearestPlan").end_date)).length+1;this.get("state").active.daysRemaining=e,e>1&&(this.get("state").active.moreThanOneDay=!0)},handleFailedLoad:function(){this.trigger("loading:failed")}}),SW.PlannerWidgetView=SW.WidgetView.extend({className:"dash-widget--sm",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-footer-link":"goToPlanner"})},initialize:function(){this._super("initialize"),this.template.empty=this.findTemplate("planner-widget-empty"),this.template.active=this.findTemplate("planner-widget-active"),this.template.upcoming=this.findTemplate("planner-widget-upcoming")},renderContent:function(){var e,t=this.model.toJSON(),i=t.state[t.currentState];i.nearestPlan=t.nearestPlan,i.isParent=sw.user.isParent(),e=this.template[t.currentState](i),this.$contentContainer.html(e)},goToPlanner:function(){sw.app.navigate("#planner",{trigger:!0})},renderFooterControls:function(){var e=this.model.get("currentState");"empty"!==e&&this._super("renderFooterControls")}}),SW.ActivityGoalWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Activity goals"},masterControls:{refresh:!0},filterBy:{isEnabled:!0,value:"this-week",text:"this week"},filterSelectOptions:[{value:"this-week",text:"This week"},{value:"last-week",text:"Last week"}],currentQuestionsAnswered:0,targetQuestionsAnswered:this.computeTargetQuestionsAnswered()})},initialize:function(){this._super("initialize"),this.load()},load:function(){this._super("load"),this.loadStats()},loadStats:function(){var e=sw.user.classes.getCurrentClassID(),t=this.getStartDate(),i=this.getEndDate();SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+e+"/stats",dataType:"json",data:{startDate:t.format("YYYY-MM-DD"),endDate:i.format("YYYY-MM-DD"),userID:sw.user.get("userID")},success:this.parseLoadedStats.bind(this),error:this.handleFailedLoad.bind(this)})},getStartDate:function(){var e=this.get("filterBy").value;return"this-week"===e?moment().startOf("week").add(1,"day"):moment().startOf("week").add(1,"day").subtract(1,"week")},getEndDate:function(){var e=this.get("filterBy").value;return"this-week"===e?moment().endOf("week").add(1,"day"):moment().endOf("week").add(1,"day").subtract(1,"week")},parseLoadedStats:function(e){var t=_.map(e,function(e){var t=_(e).values().map("questions_answered").value();return _.sum(t)}),i=_.sum(t);this.handleSuccessfulLoad(i)},handleSuccessfulLoad:function(e){_.isNumber(e)?(this.set({currentQuestionsAnswered:e,targetQuestionsAnswered:this.computeTargetQuestionsAnswered()}),this.trigger("loading:completed")):this.handleFailedLoad()},computeTargetQuestionsAnswered:function(){var e=sw.user.classes.getCurrentClass(),t=e.students.length,i=50,s=t*i,n=50;return Math.max(s,n)},handleFailedLoad:function(){this.trigger("loading:failed")},getProgressPercent:function(){var e=this.get("currentQuestionsAnswered"),t=this.get("targetQuestionsAnswered"),i=e/t,s=100*i,n=_.clamp(s,0,100),a=SW.Utility.round(n,1);return a}}),SW.ActivityGoalWidgetView=SW.WidgetView.extend({className:"dash-widget--md activity-goal-widget",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-attempt-download":"attemptDownload","click .js-download":"trackDownload"})},initialize:function(){this._super("initialize"),this.template.content=this.findTemplate("activity-goal-widget-content")},renderContent:function(){this.$contentContainer.html(this.template.content({current:this.model.get("currentQuestionsAnswered"),target:this.model.get("targetQuestionsAnswered"),progress:this.model.getProgressPercent()}))},attemptDownload:function(){sw.toastManager.create({id:"activity-goal-attempt-download",type:"warning",content:"Whoops! You must reach your weekly goal before you can download the class certificate.",timer:4e3}),SW.Logger.track("activitygoal:download:attempt")},trackDownload:function(){SW.Logger.track("activitygoal:download")}}),SW.TopicOverviewWidgetView=SW.WidgetView.extend({className:SW.WidgetView.prototype.className+" topic-overview-widget",events:_.extend({},SW.WidgetView.prototype.events,{"click .js-get-student-started":"onGetStudentStartedClick"}),initialize:function(){this._super("initialize",arguments),this.template.content=this.findTemplate("topic-overview-widget"),this.template.emptyContent=this.findTemplate("topic-overview-widget-empty"),this.createDateRange()},createDateRange:function(){var e;this.childViews.dateRange||(e=this.model.get("dateRange"),this.childViews.dateRange=new SW.DateRangeView({model:e}),this.childViews.dateRange.listenTo(e,"range:shifted",this.childViews.dateRange.render),this.listenTo(e,"range:shifted",this.onDateChange))},onDateChange:function(){this.model.load()},renderMasterControls:function(){this.$masterControls.removeClass("gone").append(this.childViews.dateRange.render()),this.childViews.dateRange.delegateEvents()},renderContent:function(){var e,t=this.model.toJSON(),i=SW.Utility.firstName(t.student.get("name"));_.isEmpty(t.topicsWorkedOn)?this.$contentContainer.html(this.template.emptyContent({studentName:i,studentHasPlayed:!!t.student.get("lastVisited")})):(e=t.topicsWorkedOn.reduce(function(e,t){var i=_.find(e,{date:t.lastWorkedOn});return i||(i={date:t.lastWorkedOn,isToday:t.lastWorkedOn===moment().format("YYYY-MM-DD"),topics:[]},e.push(i)),i.topics.push(this.setColorForTopic(t)),e}.bind(this),[]).sort(function(e,t){return moment(e.date)>moment(t.date)}),this.$contentContainer.html(this.template.content({topicsDates:e})))},setColorForTopic:function(e){var t="red";return e.average>=80?t="green":e.average>=60&&(t="yellow"),_.extend({},e,{averageColor:t})},onGetStudentStartedClick:function(){var e=this.model.get("student");sw.dialogManager.open({type:"card",title:"How to play Prodigy at school or home",buttons:[{text:"Got it!",className:"btn btn--blue"}],children:[{view:SW.ActivateChildView,model:e}]})}}),SW.TopicOverviewWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Topic Overview"},footerLink:{text:""},classroomID:void 0,student:void 0})},initialize:function(){this._super("initialize",arguments),this.set("dateRange",new SW.DateRange),this.load(),window.widget=this},load:function(){var e,t;this._super("load"),this.get("topicsByGrade")?e={errors:null}:this.loadTopics(function(i,s){t?i.length||t.error?this.handleFailedLoad():this.handleSuccessfulLoad({topics:s,skills:t.skills}):e={errors:i,topics:s}}.bind(this)),this.loadSkills(function(i,s){e?i||!_.isEmpty(e.errors)?this.handleFailedLoad():this.handleSuccessfulLoad({topics:e.topics,skills:s}):t={error:i,skills:s}}.bind(this))},loadSkills:function(e){var t=this.get("classroomID"),i=this.get("dateRange").getDateRange();SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+t+"/stats",dataType:"json",data:{startDate:moment(i.startTime).format("YYYY-MM-DD"),endDate:moment(i.endTime).format("YYYY-MM-DD")},success:function(t){e(null,t)},error:function(){e(new Error("skills failed to load."))}})},loadTopics:function(e){var t=[],i=[],s=sw.user.get("curricula");s.forEach(function(n){SW.Http.fetch({url:sw.config.api.planner+"/v1/curriculum-topics/"+n.curriculumID,success:function(a){i.push({id:n.curriculumID,topic:a}),i.length+t.length===s.length&&e(t,i)},error:function(){t.push(n.curriculumID),i.length+t.length===s.length&&e(t,i)}})})},handleSuccessfulLoad:function(e){e.topics&&this.set("topicsByGrade",e.topics),this.configureSkillsToTopics(e.skills),this.isLoading=!1,this.trigger("loading:completed")},handleFailedLoad:function(){this.isLoading=!1,this.trigger("loading:failed")},configureSkillsToTopics:function(e){var t=this.get("student").get("userID"),i=_.reduce(e,function(e,i){var s=i[t];return s&&e.push.apply(e,s.skills),e},[]),s=i.reduce(function(e,t){var i,s=t.date.split("T")[0],n=this.findTopicFromSkillID(t.skill_id);return n&&(e[n.name]||(e[n.name]={name:n.name,gradeID:n.gradeID,grade:SW.Education.curriculumIDs[n.gradeID].grade,lastWorkedOn:0,totalAnswersCount:0,correctAnswersCount:0,average:0,skills:[]}),i=e[n.name],i.lastWorkedOn=moment(i.lastWorkedOn)<moment(s)?s:i.lastWorkedOn,i.totalAnswersCount+=t.questions_answered,i.correctAnswersCount+=t.questions_correct,i.average=i.correctAnswersCount/i.totalAnswersCount*100,i.skills.push(t)),e}.bind(this),{});this.set("topicsWorkedOn",_.map(s,function(e){return e.average=_.round(e.average,1),e}))},findTopicFromSkillID:function(e){var t,i=this.get("topicsByGrade");return _.find(i,function(i){var s=_.find(i.topic,function(t){return _.includes(t.skillIDs,e)});return s&&(t={name:s.topicName,gradeID:i.id}),!!t}),t}}),SW.GradeMasteryWidgetView=SW.WidgetView.extend({className:SW.WidgetView.prototype.className+" grade-mastery-widget",events:{"mouseenter .js-grade-mastery-tooltip":"renderTooltip","mouseleave .js-grade-mastery-tooltip":"closeTooltip"},initialize:function(){this._super("initialize",arguments),this.template.content=this.findTemplate("grade-mastery-widget"),this.template.tooltip=this.findTemplate("grade-mastery-widget-tooltip")},renderContent:function(){var e=this.model.get("gradeMasteryData");this.$contentContainer.html(this.template.content({gradeMasteryData:e})),_.defer(function(){this.renderProgressBars()}.bind(this))},renderProgressBars:function(){var e=this.model.get("gradeMasteryData");this.childViews.progressBars=[],_.forEach(e,function(e,t){var i=Math.round(e.skillsMastered/e.totalSkills*100);this.childViews.progressBars[t]&&this.childViews.progressBars[t].close(),this.childViews.progressBars[t]=new SW.ProgressBarView({style:"100-percent",model:new SW.ProgressBar({segments:[{key:"skillsMastered",value:i,elementClassModifiers:"progress-bar__segment--green"},{key:"totalSkills",value:100-i,elementClassModifiers:"progress-bar__segment--alto"}]})}),this.$(".js-grade-mastery-item-"+e.grade).html(this.childViews.progressBars[t].render())}.bind(this))},renderTooltip:function(e){var t=$(e.currentTarget),i=this.template.tooltip({mastered:t.data("mastered"),total:t.data("total")});this.createTooltip({reference:t,node:{content:i,classNames:"tooltip--dark text-center no-select"}})}}),SW.GradeMasteryWidget=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{title:"Grade Mastery"},masterControls:{refresh:!0},footerLink:{text:""},classroomID:"",currentGrade:void 0,gradeMasteryData:void 0})},initialize:function(){this._super("initialize",arguments),this.load()},load:function(){var e=this.get("classroomID"),t=_.map(sw.user.get("curricula"),function(e){return e.curriculumID});this._super("load"),SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+e+"/curriculum-mastery",dataType:"json",data:{userID:sw.user.get("userID"),curriculumIDs:JSON.stringify(t)},success:this.handleSuccessfulLoad.bind(this),error:this.handleFailedLoad.bind(this)})},handleSuccessfulLoad:function(e){this.configureGradeData(e),this.trigger("loading:completed")},handleFailedLoad:function(){this.isLoading=!1,this.trigger("loading:failed")},configureGradeData:function(e){var t=_.map(sw.user.get("curricula")),i=this.get("currentGrade"),s=_.map(t,function(t){var s="curriculumMastery."+t.curriculumID;return{grade:t.grade,isCurrentGrade:i&&i===t.grade,skillsMastered:_.sumBy(e,s+".skillsMastered"),totalSkills:_.sumBy(e,s+".totalSkills")}});this.set("gradeMasteryData",s)}}),SW.SupportChat=SW.View.extend({initialize:function(){SW.Utility.usingMobileNav()&&this.hideAll(),this.setupEvents(),sw.user&&this.identifyUser()},identifyUser:function(){zE(function(){zE.identify({name:sw.user.get("name"),email:sw.user.get("email")})})},setupEvents:function(){this.listenTo(sw.dispatcher,"window:resize",this.resize)},resize:function(){SW.Utility.usingMobileNav()?this.hideAll():"auto"!==$("iframe#launcher").css("top")&&this.show()},show:function(){zE(function(){zE.show()})},hideAll:function(){zE(function(){zE.hide()})}}),SW.Calendar=SW.Model.extend({defaults:{layout:"month",dateRangeOffset:0,maxWeeks:5,items:[]},initialize:function(){this._haveDatesBeenSet=!1,this.createDates(this.get("dateRangeOffset"))},createDates:function(e){var t=this.createFirstAndLastDate(e);this.set({firstDate:t.first,firstDateMonth:SW.Utility.dateMonthName(t.first),firstDateMonthShort:SW.Utility.dateMonthName(t.first,"short"),firstDateDay:SW.Utility.dateDayString(t.first),lastDate:t.last,lastDateMonth:SW.Utility.dateMonthName(t.last),lastDateMonthShort:SW.Utility.dateMonthName(t.last,"short"),lastDateDay:SW.Utility.dateDayString(t.last)}),this._haveDatesBeenSet=!0},createFirstAndLastDate:function(e){var t={};return this._haveDatesBeenSet?(t.first=this.get("firstDate"),t.last=this.get("lastDate")):t=this.createDatesByLayout(),e&&(t.first.setTime(t.first.getTime()+e*SW.Utility.millisecondsPerDay),t.last.setTime(t.last.getTime()+e*SW.Utility.millisecondsPerDay)),t},createDatesByLayout:function(){var e={},t=this.get("layout");return e.current=new Date,"weeks"===t?(e.first=SW.Utility.firstDateInWeek(e.current),e.last=new Date,e.last.setTime(e.first.getTime()+(7*this.get("maxWeeks")-1)*SW.Utility.millisecondsPerDay)):(e.first=SW.Utility.firstDateInWeek(new Date(e.current.getFullYear(),e.current.getMonth(),1)),e.last=SW.Utility.lastDateInWeek(new Date(e.current.getFullYear(),e.current.getMonth()+1,0))),e},shiftDates:function(e){this.createDates(e),this.trigger("dates:change")},shiftDatesReset:function(){this._haveDatesBeenSet=!1,this.shiftDates(this.get("dateRangeOffset"))},addItems:function(e,t){var i=_.clone(this.get("items"));e=_.isArray(e)?e:[e],i=i.concat(e),i.sort(SW.CalendarItem.prototype.comparePriority),this.set("items",i,t)},removeAllItems:function(){this.removeItems(this.get("items"))},removeItems:function(e){var t=_.clone(this.get("items"));e=_.isArray(e)?e:[e],e.forEach(function(e){this.removeItemFromArray(t,e)}.bind(this)),this.set("items",t)},removeItemFromArray:function(e,t){var i=null,s=_.findIndex(e,{cid:t.cid});return s>-1&&(i=e.splice(s,1)),i}}),SW.CalendarDay=SW.Model.extend({defaults:{isSelected:!1,dayNumber:0,dayMonth:void 0,isFirstDate:!1,isToday:!1,isPastDate:!1,isSelectable:!1,items:void 0},initialize:function(){var e=this.get("date"),t=new Date;this.set({items:[],isFirstDate:1===e.getDate(),dayNumber:e.getDate(),dayMonth:SW.Utility.dateMonthName(e,"short"),dateString:SW.Utility.getDateString(e)}),e.toDateString()==t.toDateString()?this.set("isToday",!0):e.getTime()<t.getTime()&&this.set({isPastDate:!0,isSelectable:!1}),this.initializeEventListeners()},initializeEventListeners:function(){this.listenTo(sw.dispatcher,"calendar-date:all:start-selected",this.verifyIsSelectable),this.listenTo(sw.dispatcher,"calendar-date:all:selection-removed",this.resetSelectionStates),this.listenTo(sw.dispatcher,"calendar-date:all:deselect",this.deselect),this.listenTo(sw.dispatcher,"calendar-date:"+this.get("dateString")+":selected",this.select)},select:function(e){this.set({isSelected:!0,isLastDate:e.isLastDate,isSelectionOpen:e.isSelectionOpen})},deselect:function(){this.set({isSelected:!1,isLastDate:!1,isSelectionOpen:!1})},verifyIsSelectable:function(e){var t=!0;
this.get("date").getTime()<new Date(e.replace(/-/g,"/")).getTime()&&(t=!1),this.set("isSelectable",t)},resetSelectionStates:function(){this.set({isSelectable:!this.get("isPastDate"),isSelected:!1,isLastDate:!1,isSelectionOpen:!1})}}),SW.CalendarView=SW.ParentView.extend({className:"calendar",events:{"click .js-previous-week":"shiftDatesBack","click .js-next-week":"shiftDatesAhead","click .js-back-to-today":"shiftDatesReset","click .js-calendar-day":"handleDateClick","mouseenter .js-calendar-day":"handleDateHover","mouseleave .calendar":"handleMouseLeave"},initialize:function(e){this._super("initialize"),this.options=e,this.options.enableSelection=e.enableSelection||!1,this.template={calendar:Handlebars.compile($("#calendar-template").html())},this.days={},this.weeks=this.groupDayViewsByWeek(this.createDates()),this.selection={opened:!1,start:void 0,end:void 0},this.listenTo(this.model,"dates:change",this.updateCalendarDates),this.listenTo(this.model,"change:items",this.redistributeItems)},createDates:function(){var e=this,t=[],i=this.model.get("firstDate"),s=this.model.get("lastDate"),n=SW.Utility.datesInRange(i,s),a=this.options.DayView||SW.CalendarDayView,r=this.options.DayModel||SW.CalendarDay;return n.forEach(function(i){var s=new a({model:new r({date:i,isSelectable:e.options.enableSelection})});t.push(s),this.days[SW.Utility.getDateString(i)]=s}.bind(this)),t},groupDayViewsByWeek:function(e){var t=[],i=[];return e.forEach(function(s,n){i.push(s),6!==s.model.get("date").getDay()&&n!==e.length-1||(t.push(i.slice(0)),i=[])}),t},updateCalendarDates:function(){this.closeDayViews(),this.weeks=this.groupDayViewsByWeek(this.createDates()),this.broadcastSelectedDates(),this.render(),this.redistributeItems()},render:function(){var e=this.model.toJSON(),t=this.$el.html(this.template.calendar(e)),i=t.find(".js-calendar-body");return this.weeks.forEach(function(e){var t,s=$('<tr class="calendar__week" data-max-pos="0">');for(t=0;t<e.length;t++)s.append(e[t].render());i.append(s)}),this.additionalRendering(e),this.$el},additionalRendering:function(e){this.reselectStartAndEndDates()},reselectStartAndEndDates:function(){var e=this.selection.start,t=this.selection.end,i=this.selection.opened;e&&(i?this.startSelection(e,!0):(this.startSelection(e),this.endSelection(t)))},shiftDatesAhead:function(){this.model.shiftDates(7)},shiftDatesBack:function(){this.model.shiftDates(-7)},shiftDatesReset:function(){this.model.shiftDatesReset()},handleMouseLeave:function(){this.options.enableSelection&&this.resetOpenSelection()},resetOpenSelection:function(){this.selection.opened&&(this.selection.end=this.selection.start,this.broadcastSelectedDates())},handleDateClick:function(e){var t=$(e.target);SW.Utility.isElement(t,".calendar__day-item")||this.options.enableSelection&&this.handleDateSelection(e)},handleDateSelection:function(e){var t=this.getCalendarDayElement(e),i=!this.selection.opened&&this.selection.end,s=this.isCalendarDaySelectable(t);i?(this.removeSelection(),selectionWasRemoved=!0):s&&(this.selection.opened&&this.selection.start?this.endSelection(t.attr("id")):this.startSelection(t.attr("id"))),this.broadcastSelectedDates()},startSelection:function(e,t){"string"==typeof e&&(t||this.updateSelectionStart(e),this.openSelection(),sw.dispatcher.trigger("calendar-date:all:start-selected",this.selection.start))},updateSelectionStart:function(e){this.selection.start=e,this.selection.end=e,this.selection.dates=[new Date(e.replace(/-/g,"/"))]},openSelection:function(){this.selection.opened=!0,this.$el.removeClass("calendar--closed-selection")},endSelection:function(e,t){var i=this.updateSelectionEnd(e,t);i&&(this.selection.opened=!1,this.$el.addClass("calendar--closed-selection"))},updateSelectionEnd:function(e,t){var i,s,n,a=!0,r=new Date(this.selection.start.replace(/-/g,"/")),o=new Date(e.replace(/-/g,"/"));for(this.selection.end=e,this.selection.isTrimmed=!1,this.selection.dates=SW.Utility.datesInRange(r,o),this.$(".calendar__day--warning").removeClass("calendar__day--warning"),s=0;s<this.selection.dates.length;s++)if(n=SW.Utility.getDateString(this.selection.dates[s]),i=this.$("#"+n),!t&&!this.isCalendarDaySelectable(i)){i.addClass("calendar__day--warning"),this.selection.dates.splice(s),this.selection.end=SW.Utility.getDateString(this.selection.dates[this.selection.dates.length-1]),this.selection.isTrimmed=!0,a=!1;break}return a},isCalendarDaySelectable:function(e){var t=!e.hasClass("calendar__day--unselectable")&&!e.hasClass("js-unselectable-day");return t},removeSelection:function(){this.selection.opened=!1,this.selection.isTrimmed=!1,this.selection.start=null,this.selection.end=null,this.selection.dates=null,this.$el.removeClass("calendar--closed-selection"),this.$(".calendar__day--warning").removeClass("calendar__day--warning"),sw.dispatcher.trigger("calendar-date:all:selection-removed")},handleDateHover:function(e){var t,i=$(e.target);SW.Utility.isElement(i,".calendar__day-item")||this.selection.opened&&(t=this.getCalendarDayElement(e),t.hasClass("calendar__day--unselectable")||t.hasClass("js-unselectable-day")||(this.updateSelectionEnd(t.attr("id")),this.broadcastSelectedDates()))},broadcastSelectedDates:function(){sw.dispatcher.trigger("calendar-date:all:deselect"),this.selection.dates&&this.selection.dates.forEach(function(e,t){var i={isLastDate:t===this.selection.dates.length-1,isSelectionOpen:this.selection.opened};sw.dispatcher.trigger("calendar-date:"+SW.Utility.getDateString(e)+":selected",i)}.bind(this))},getCalendarDayElement:function(e){var t=$(e.target);return t.hasClass("js-calendar-day")||(t=t.parents(".js-calendar-day")),t},findCalendarDaysInRange:function(e,t){var i=SW.Utility.datesInRange(e,t),s=i.map(function(e){return SW.Utility.getDateString(e)}),n=s.reduce(function(e,t){return this.days[t]&&e.push(this.days[t]),e}.bind(this),[]);return n},addItems:function(e){this.model.addItems(e)},removeItems:function(e){this.model.removeItems(e)},redistributeItems:function(){this.resetItemsPosition(),this.resetDayItemReferences(),this.resetWeekMaxPos(),this.distributeItems()},resetItemsPosition:function(){this.model.get("items").forEach(function(e){e.set({position:null})})},resetDayItemReferences:function(){_.forEach(this.days,function(e){e.model.set("items",[])})},resetWeekMaxPos:function(){this.$("[data-max-pos]").attr("data-max-pos",0)},distributeItems:function(){var e=this.model.get("items");e.forEach(function(e){var t=this.findCalendarDaysInRange(e.get("startDate"),e.get("endDate"));t.forEach(function(t){t.model.get("items").push(e)}),e.set("calendarDays",t)}.bind(this)),e.forEach(function(e){e.set("position",e.calculatePosition())}),_.defer(function(){sw.dispatcher.trigger("calendar-date:all:render-items")})},close:function(){this.closeDayViews(),this._super("close")},closeDayViews:function(){var e=this;this.weeks.forEach(function(t){t.forEach(function(t){delete e.days[SW.Utility.getDateString(t.model.get("date"))],t.close()})})}}),SW.CalendarDayView=SW.ParentView.extend({tagName:"td",className:"js-calendar-day calendar__day",events:{mouseenter:"handleMouseEnter",mouseleave:"handleMouseLeave","mousedown .calendar__day-item":"handleMouseDownItem","mouseup .calendar__day-item":"handleMouseUpItem","mouseenter .calendar__day-item":"handleMouseEnterItem","mouseleave .calendar__day-item":"handleMouseLeaveItem"},initialize:function(){this._super("initialize"),this.template={day:Handlebars.compile($("#calendar-day-template").html()),item:Handlebars.compile($("#calendar-item-template").html())},this.listenTo(this.model,"change:isSelected",this.updateSelection),this.listenTo(this.model,"change:isSelectable",this.updateSelectionAvailability),this.listenTo(sw.dispatcher,"calendar-date:all:render-items",this.renderAllItems)},setStates:function(){var e=this.model.toJSON();e.isPastDate&&this.$el.addClass("calendar__day--past"),this.updateSelectionAvailability(),this.updateSelection()},render:function(){var e=this.model.toJSON();return this.$el.attr({id:e.dateString,"sw-day":e.dayNumber}),this.$el.html(this.template.day(e)),this.setStates(),this.$el},renderAllItems:function(){var e=this.$(".calendar__day-events"),t=this.model.get("items");e.html(""),t.length>0&&t.forEach(function(e,t){this.renderItem(e,t)}.bind(this))},renderItem:function(e,t){var i,s,n,a,r,o,l,d=1.9,c="",u=this.model.get("date"),h=0===u.getDay(),m=SW.Utility.isSameDate(u,e.get("startDate"));SW.Utility.isSameDate(u,e.get("endDate"));(m||h)&&(s=e.toJSON(),a=SW.Utility.datesInRange(u,_.last(s.calendarDays).model.get("date")).length,u.getDay()+a>7?(n=7-u.getDay(),c+=" calendar__day-item--arrow-right"):n=a,m||(c+=" calendar__day-item--arrow-left"),SW.Utility.setTimeInDayToZero(new Date).getTime()>s.endDate.getTime()&&(c+=" calendar__day-item--inactive"),i=this.template.item(_.extend({},s,{index:t,extraClasses:c,topPosition:s.position*d+"em",segmentLength:n})),r=this.$el.parents(".calendar__week"),o=parseInt(r.attr("data-max-pos"),10),o<s.position&&(l=s.position*d+this.toEm(r.css("min-height"),r),r.attr("data-max-pos",s.position).height(l+"em")),this.$(".calendar__day-events").append(i))},toEm:function(e,t){return parseInt(e,10)/parseInt(t.css("font-size"),10)},updateSelection:function(){this.model.get("isSelected")?this.$el.addClass("calendar__day--selected"):this.$el.removeClass("calendar__day--selected")},updateSelectionAvailability:function(){this.model.get("isSelectable")?this.$el.removeClass("calendar__day--unselectable"):this.$el.addClass("calendar__day--unselectable")},handleMouseEnter:function(e){var t=$(e.target);SW.Utility.isElement(t,".calendar__day-item")?this.$el.removeClass("hover"):($(".js-calendar-day.hover").removeClass("hover"),this.$el.addClass("hover"))},handleMouseLeave:function(e){this.$el.removeClass("hover")},handleMouseEnterItem:function(e){var t=$(e.target);this.$el.removeClass("hover"),this.findAllItemSegments(t).addClass("hover")},handleMouseLeaveItem:function(e){var t=$(e.target);this.findAllItemSegments(t).removeClass("hover active"),SW.Utility.mouseOverlapEl(e,this.$el)&&this.$el.addClass("hover")},handleMouseDownItem:function(e){var t=$(e.target);this.findAllItemSegments(t).addClass("active")},handleMouseUpItem:function(e){var t=$(e.target);this.findAllItemSegments(t).removeClass("active")},findAllItemSegments:function(e){return $('[sw-item-id="'+e.attr("sw-item-id")+'"]')}}),SW.CalendarItemFormView=SW.ParentView.extend({clearStartDate:function(){this.model.resetDate("allDates")},clearEndDate:function(){this.model.resetDate("endDate")},scrollToCalendar:function(){var e,t,i;$(window).width()<=768&&(e=$(".planner-calendar__selection-toast"),t=e.length?e:$(".calendar"),i=t.offset().top,$("html, body").scrollTo(850,i))},cancel:function(){this.model.get("isBeingEdited")?this.model.cancelEdit():this.model.cancelCreation()}}),SW.CalendarItem=SW.Model.extend({defaults:{name:"",type:void 0,startDate:void 0,endDate:void 0,priority:void 0,position:void 0,calendarDays:[]},initialize:function(){var e=this.toJSON();e.startDate&&e.endDate&&this.set("priority",this.calculatePriority())},calculatePriority:function(){var e=this.toJSON(),t="plan"===e.type?1/0:0,i=SW.Utility.datesInRange(e.startDate,e.endDate).length;return t+i},calculatePosition:function(){var e,t=(this.toJSON(),[]),i=this.findSiblingItems();return i.forEach(function(e){var i=e.toJSON();_.isNumber(i.position)&&t.push(i.position)}),e=this.findGap(t)},findSiblingItems:function(){var e=this,t=[];return this.get("calendarDays").forEach(function(i){var s=i.model.get("items").filter(function(i){var s=e.cid!==i.cid;return s&&(s=_.findIndex(t,function(e){return e.cid===i.cid})===-1),s});t=t.concat(s)}),t.sort(e.comparePriority)},findGap:function(e){var t,i=0;if(e.length>0&&(e=_.uniq(e).sort(function(e,t){return e-t}),i=_.last(e)+1,i!==e.length))for(t=0;t<e.length;t++)if(e[t]!==t){i=t;break}return i},comparePriority:function(e,t){return-(e.get("priority")-t.get("priority"))},startEditing:function(){this.cacheState(),this.set("isBeingEdited",!0,{silent:!0}),sw.dispatcher.trigger("calendar-item:edit:start",this)},cancelEdit:function(){this.revertState(),this.set("isBeingEdited",!1,{silent:!0}),this.clearCache(),this.trigger("edit:cancel")},cancelCreation:function(){this.trigger("create:cancel")},create:function(){this.set("priority",this.calculatePriority()),this.trigger("create:submit")},edit:function(){this.set("priority",this.calculatePriority()),this.trigger("create:submit")},delete:function(){this.trigger("delete:submit")},cacheState:function(){this.set("cachedState",this.toJSON(),{silent:!0})},revertState:function(){this.set(this.get("cachedState"),{silent:!0})},clearCache:function(){this.set("cachedState",{},{silent:!0})},resetDate:function(e){"endDate"===e?this.set("endDate",null):this.set({startDate:null,endDate:null}),this.set("calendarDays",[]),this.trigger("dates:reset",e||"allDates")}}),SW.PlannerCalendar=SW.Calendar.extend({initialize:function(){this._itemTypes=["assignment","plan","test-prep"],this._loadedItemTypes=[],this._failedItemTypes=[],this._tempItems=[],this._super("initialize"),this.set("viewType",SW.Storage.get("planner-view-type")||"calendar"),this.loadItems()},loadItems:function(){this._loadedItemTypes=[],this._failedItemTypes=[],this._tempItems=[],this.removeAllItems(),this.loadPlans(),this.loadAssignments(),this.loadTestPrep()},loadPlans:function(){SW.Http.fetch({url:sw.config.api.planner+"/v1/classes/"+sw.user.classes.getCurrentClassID()+"/plans",method:"GET",cache:!1,success:this.onItemLoadSuccess.bind(this,"plan"),error:this.onItemLoadError.bind(this,"plan")})},loadAssignments:function(){SW.Http.fetch({url:sw.config.api.assignments+"/v1/class/"+sw.user.classes.getCurrentClassID()+"/assignments",method:"GET",cache:!1,success:this.onItemLoadSuccess.bind(this,"assignment"),error:this.onItemLoadError.bind(this,"assignment")})},loadTestPrep:function(){SW.Http.fetch({url:sw.config.api.assignments+"/v2/class/"+sw.user.classes.getCurrentClassID()+"/test-prep",method:"GET",cache:!1,success:this.onItemLoadSuccess.bind(this,"test-prep"),error:this.onItemLoadError.bind(this,"test-prep")})},onItemLoadSuccess:function(e,t){switch(e){case"plan":this.addLoadedPlans(t);break;case"assignment":this.addLoadedAssignments(t);break;case"test-prep":this.addLoadedTestPrep(t)}this.onItemLoadComplete(e)},onItemLoadError:function(e,t){409!=t.status&&this.onItemLoadComplete(e,!0)},onItemLoadComplete:function(e,t){var i;t?this._failedItemTypes=_.union(this._failedItemTypes,[e]):this._loadedItemTypes=_.union(this._loadedItemTypes,[e]),i={success:this._loadedItemTypes.length===this._itemTypes.length,partial:this._loadedItemTypes.length+this._failedItemTypes.length===this._itemTypes.length,fail:this._failedItemTypes.length===this._itemTypes.length},i.success?this.onLoadSuccess():i.partial?this.onLoadPartial():i.fail&&this.onLoadError()},addLoadedPlans:function(e){var t=e.map(function(e){return new SW.Plan({id:e.id,name:e.topic_name,topic:{topicName:e.topic_name},topicSkillIDs:e.skill_list.split(",").map(Number),topicGrade:e.curriculum_id,startDate:new Date(e.start_date.substring(0,10).replace(/-/g,"/")),endDate:new Date(e.end_date.substring(0,10).replace(/-/g,"/"))})}.bind(this));this._tempItems=this._tempItems.concat(t||[])},addLoadedAssignments:function(e){var t=[];e.forEach(function(e){var i,s;this.isValidItemData(e)?(i=SW.Utility.getLocalDateFromUTCDate(e.end_date),s=SW.Utility.getLocalDateFromUTCDate(e.start_date),t.push(new SW.Assignment({id:e.id,name:e.name,startDate:new Date(SW.Utility.getUSDateString(s)),endDate:new Date(SW.Utility.getUSDateString(i))}))):console.log("Invalid assignment data: ",e)}.bind(this)),this._tempItems=this._tempItems.concat(t||[])},addLoadedTestPrep:function(e){var t=e.map(function(e){var t=SW.Utility.getLocalDateFromUTCDate(e.end_date),i=SW.Utility.getLocalDateFromUTCDate(e.start_date);return new SW.TestPrep({id:e.id,name:e.name,selectedTest:{id:e.test_prep_id,name:e.name},startDate:new Date(SW.Utility.getUSDateString(i)),endDate:new Date(SW.Utility.getUSDateString(t))})});this._tempItems=this._tempItems.concat(t||[])},onLoadSuccess:function(){this.addItems(this._tempItems),this._tempItems=[],this.setLastLoadedTime(),this.trigger("items:load:success")},onLoadPartial:function(){this.addItems(this._tempItems),this._tempItems=[],this.onLoadError()},onLoadError:function(){this.setLastLoadedTime(),this.trigger("items:load:failed",this._failedItemTypes)},setLastLoadedTime:function(){this.set("lastLoadedTime",(new Date).getTime())},isValidItemData:function(e){return e.id&&e.name&&e.start_date&&e.end_date},arePlansLoaded:function(){return this._loadedItemTypes.indexOf("plan")!==-1},didPlansFail:function(){return this._failedItemTypes.indexOf("plan")!==-1},setViewPreference:function(e){this.set("viewType",e),SW.Storage.set("planner-view-type",e)}}),SW.PlannerCalendarDay=SW.CalendarDay.extend({initialize:function(){this.set("plans",[]),this._super("initialize")},initializeEventListeners:function(){this._super("initializeEventListeners"),this.listenTo(sw.dispatcher,"planner-calendar-date:"+this.get("dateString")+":add-plan",this.addPlan)},addPlan:function(e){this.get("plans").push(e),this.listenTo(e,"delete:success",this.removePlan),this.trigger("change:plans")},removePlan:function(e){var t=this.get("plans").indexOf(e),i=this.get("plans").splice(t,1)[0];this.stopListening(i),this.trigger("change:plans")}}),SW.PlannerCalendarView=SW.CalendarView.extend({events:function(){return _.extend({},SW.CalendarView.prototype.events,{"click .js-create-item":"handleStartItemCreation","click .js-remove-selection":"removeActiveItemDates","click .planner-calendar__selection-toast":"flicker","click .js-create-test-prep":"trackStandardizedTestPrepCreation","change input[name='planner-view-radio']":"onPlannerViewChange"})},initialize:function(e){this._super("initialize",arguments),this.disableSelections(),this.maxPlanLength=30,this.template.planCreationDialog=this.findTemplate("planner-calendar-success-dialog"),this.template.selectionToast=this.findTemplate("planner-calendar-selection-toast"),this.template.viewToggle=this.findTemplate("planner-calendar-view-toggle"),this.template.itemCreationButtons=this.findTemplate("planner-item-creation-buttons"),this.listenTo(this.model,"items:load:success",this.handleItemsLoadSuccess),this.listenTo(this.model,"items:load:failed",this.createItemLoadingFailDialog),this.listenTo(sw.dispatcher,"planner:edit-item",this.editItem),this.listenTo(sw.dispatcher,"planner:item:delete",this.removeItems),this.listenTo(sw.dispatcher,"calendar-item:edit:start",this.handeItemEditStart),this.listenTo(sw.dispatcher,"planner:enable-selection",this.enableSelections),this.listenTo(sw.dispatcher,"planner:flicker",this.flicker)},handeItemEditStart:function(e){this.removeItems(e)},editItem:function(e){var t=e.get("type");this.childViews.activeItem&&this.childViews.activeItem.cancel(),this.startItemCreation(t,e),this._super("startSelection",[SW.Utility.getDateString(e.get("startDate"))]),this._super("endSelection",[SW.Utility.getDateString(e.get("endDate")),!0]),this.broadcastSelectedDates()},handleDateSelection:function(e){var t=this.getCalendarDayElement(e);"plan"===this.childViews.activeItem.model.get("type")&&t.hasClass("planner-calendar__day--has-plan")&&this.alertOverlappingPlan(),this._super("handleDateSelection",arguments)},isCalendarDaySelectable:function(e){var t=!e.hasClass("calendar__day--unselectable")&&!e.hasClass("js-unselectable-day");return"plan"===this.options.selectionType&&t&&(t=!e.hasClass("planner-calendar__day--has-plan")&&t),t},updateCalendarDates:function(){var e;this.enableSelections(),this._super("updateCalendarDates"),this.childViews.activeItem?(e=this.childViews.activeItem.model.toJSON(),e.endDate?this.disableSelections():"plan"!==e.type||e.topic||this.disableSelections()):this.disableSelections()},enableSelections:function(e){var t;this.options.enableSelection||(t=!!this.childViews.activeItem&&this.childViews.activeItem.model.get("type"),e=e||t||"assignment",this.options.enableSelection=!0,this.options.selectionType=e||"assignment",this.$el.addClass("planner-calendar--selection-enabled planner-calendar--"+this.options.selectionType+"-selection"),t&&this.renderInternalSelectionToast())},disableSelections:function(){this.options.enableSelection=!1,this.$el.removeClass("planner-calendar--selection-enabled planner-calendar--"+this.options.selectionType+"-selection"),this.options.selectionType=null,this.removeInternalSelectionToast()},additionalRendering:function(e){var t=this.model.get("viewType");this._super("additionalRendering",arguments),this.$el.prepend(this.template.itemCreationButtons({isTeacher:sw.user.isTeacher()})),this.$newPlanButton=this.$("#planner-create-plan-btn"),this.$newAssignmentButton=this.$("#planner-create-assignment-btn"),this.$newTestPrepButton=this.$("#planner-create-test-prep-btn"),this.$(".js-calendar-nav").append(this.template.viewToggle()),this.childViews.activeItem&&(this.disableCreateItemButtons(),this.renderItemForm(),this.childViews.activeItem.delegateEvents()),this.$(".js-calendar-wrapper").after($('<div class="js-planner-list-wrapper">')),this._isPlannerItemListRendered=!1,this.viewAs(t)},handleStartItemCreation:function(e){var t=$(e.target).data("type");this.startItemCreation(t)},startItemCreation:function(e,t){sw.track.milestone("Planner: complete tutorial"),this.viewAs("calendar"),this.model.get("lastDate")<new Date&&this.shiftDatesReset(),this.toggleCreateItemButtons(),this.$el.addClass("calendar--extended-header"),this.createNewItemForm(e,t),this.renderItemForm(),sw.track.milestone("Planner: "+e+" create init")},toggleCreateItemButtons:function(){function e(e,t){return!t}this.$newPlanButton.prop("disabled",e),this.$newAssignmentButton.prop("disabled",e),this.$newTestPrepButton.prop("disabled",e)},disableCreateItemButtons:function(){this.$newPlanButton.prop("disabled",!0),this.$newAssignmentButton.prop("disabled",!0),this.$newTestPrepButton.prop("disabled",!0)},enableCreateItemButtons:function(){this.$newPlanButton.prop("disabled",!1),this.$newAssignmentButton.prop("disabled",!1),this.$newTestPrepButton.prop("disabled",!1)},createNewItemForm:function(e,t){var i;if("plan"===e){if(this.model.didPlansFail())return this.cancelActiveItem(),void this.createItemLoadingFailDialog(["plan"]);t=t||new SW.Plan,i=SW.PlanFormView}else if("assignment"===e)t=t||new SW.Assignment,i=SW.AssignmentFormView;else{if("test-prep"!==e)return;t=t||new SW.TestPrep,i=SW.TestPrepFormView}this.childViews.activeItem=new i({model:t}),this.bindActiveItemEvents()},bindActiveItemEvents:function(){var e=this.childViews.activeItem.model;this.listenTo(e,"create:submit",this.createLoadingDialog),this.listenTo(e,"create:success",this.handleItemCreationSuccess),this.listenTo(e,"create:error",this.createItemErrorDialog),this.listenTo(e,"create:cancel",this.handleItemCreateCancel),this.listenTo(e,"edit:success",this.handleItemEditSuccess),this.listenTo(e,"edit:cancel",this.handleItemEditCancel),this.listenTo(e,"edit:error",this.editItemErrorDialog),this.listenTo(e,"dates:reset",this.handleActiveItemDateReset)},renderItemForm:function(){this.childViews.activeItem&&this.$(".js-calendar-wrapper").prepend(this.childViews.activeItem.render())},createLoadingDialog:function(){this.createDialog({type:"load"})},readableDateString:function(e){var t=SW.Utility.dateMonthName(e,"short"),i=SW.Utility.dateDayName(e,"short"),s=SW.Utility.dateDayString(e);return i+", "+t+" "+s},createItemErrorDialog:function(){var e=this.childViews.activeItem.model.toJSON();this.createDialog({type:"alert",size:"small",title:"There was an error creating your&nbsp;"+e.type+".",main:"Check your Internet connection and try to create your "+e.type+" again in a few minutes.",buttons:[{text:"Close"}]})},editItemErrorDialog:function(){this.createDialog({type:"alert",size:"small",title:"There was an error saving your changes.",main:"Check your Internet connection and try to save your changes again in a few minutes.",buttons:[{text:"Close"}]})},createItemLoadingFailDialog:function(e){var t=e.map(function(e,t){return e+="s",0===t?e.capitalize():e});this.isLoadingErrorDialogOpen=!0,this.createDialog({type:"confirmation",size:"small",title:"Unable to load planner.",main:t.join(" and ")+" failed to load. Check your Internet connection and try loading again in a few minutes.",buttons:[{text:"Cancel"},{text:"Try again",className:"btn-flat--primary",callback:function(){this.reloadItems(),this.closeDialog()}.bind(this)}]})},reloadItems:function(){this.model.loadItems()},handleItemsLoadSuccess:function(){this.isLoadingErrorDialogOpen&&(this.isLoadingErrorDialogOpen=!1,this.closeDialog())},handleItemCreationSuccess:function(){var e=this.childViews.activeItem.model;this.addItems(e),this.cancelActiveItem(),this.createItemSuccessDialog(e)},createItemSuccessDialog:function(e){var t,i=e.toJSON();switch(i.type){case"plan":i.startDateString=this.readableDateString(i.startDate),i.endDateString=this.readableDateString(i.endDate),i.isParent=sw.user.isParent(),t=this.template.planCreationDialog(i),this.createDialog({type:"alert",size:"medium",main:t,buttons:[{text:"Got it!",className:"btn-flat--primary"}]});break;case"test-prep":this.createDialog({className:"dialog dialog--basic",type:"custom",size:"medium-small",children:[{model:SW.TestPrepCreationCard,modelData:{testName:e.getSelectedTestName(),estimatedTotalMinutes:e.getEstimatedTotalMinutes(),estimatedDailyMinutes:e.getEstimatedDailyMinutes(),onEditTest:e.adjustDates.bind(e)},view:SW.TestPrepCreationCardView}]});break;default:this.closeDialog()}},handleItemEditSuccess:function(){var e=this.childViews.activeItem.model,t=e.get("type");"test-prep"===t?(this.addItems(e),this.cancelActiveItem(),this.createItemSuccessDialog(e)):(sw.toastManager.create({type:"success",content:t+" updated!",timer:2500}),this.completeEdit())},handleItemEditCancel:function(){this.completeEdit()},handleItemCreateCancel:function(){this.cancelActiveItem()},completeEdit:function(){var e=this.childViews.activeItem.model;this.closeDialog(),this.addItems(e),this.cancelActiveItem()},handleActiveItemDateReset:function(e){"endDate"===e?(this.openSelection(),this.resetOpenSelection()):this.removeSelection(),this.enableSelections(this.childViews.activeItem.model.get("type"))},cancelActiveItem:function(){this.enableCreateItemButtons(),this.closeActiveItem()},closeActiveItem:function(){this.childViews.activeItem&&(this.stopListening(this.childViews.activeItem.model),this.childViews.activeItem.close(),this.childViews.activeItem=null,this.$el.removeClass("calendar--extended-header"),this.$selectionToast&&(this.$selectionToast.remove(),this.$selectionToast=null),this.removeSelection(),this.disableSelections())},startSelection:function(e){this._super("startSelection",arguments),this.childViews.activeItem.model.set("startDate",new Date(this.selection.start.replace(/-/g,"/")))},endSelection:function(e,t){this._super("endSelection",arguments),this.selection.isTrimmed?"plan"===this.childViews.activeItem.model.get("type")&&this.alertOverlappingPlan():this.selection.dates.length>this.maxPlanLength?(this.childViews.activeItem.clearEndDate(),this.alertTooManyDatesSelected()):(this.childViews.activeItem.model.set("endDate",new Date(this.selection.end.replace(/-/g,"/"))),this.disableSelections())},alertOverlappingPlan:function(e){var t=!1;e&&(t=this.checkForPlanClick(e)),this.options.enableSelection&&!t&&sw.toastManager.create({id:"plan-overlap-error",type:"error",content:"Oops, new plans cannot overlap existing ones!",timer:1e4})},checkForPlanClick:function(e){var t=$(e.target),i=t.hasClass("js-plan")||t.parents(".js-plan ").length;return i},alertTooManyDatesSelected:function(){var e;this.options.enableSelection&&(e=SW.Utility.toTitleCase(this.childViews.activeItem.model.get("type")),sw.toastManager.create({id:"calendar-item-length-error",type:"error",content:e+"s cannot be longer than 30 days.",timer:1e4}))},removeActiveItemDates:function(e){this.childViews.activeItem.model.resetDate("allDates")},handleDateClick:function(e){$(e.target).hasClass("js-remove-selection")||this._super("handleDateClick",arguments)},flicker:function(){var e=this.$el;e.addClass("calendar--flicker"),_.delay(function(){e.removeClass("calendar--flicker")},225),sw.track.event("planner","date-flicker")},renderInternalSelectionToast:function(e){var e=e||{},t=this.template.selectionToast();this.$selectionToast=$(t).hide(),this.$(".js-calendar-inner").before(this.$selectionToast),e.preventAnimation?this.$selectionToast.show():this.$selectionToast.slideDown(),sw.track.event("planner","date-prompt")},removeInternalSelectionToast:function(){this.$selectionToast&&(this.$selectionToast.slideUp(function(){$(this).remove()}),this.$selectionToast=null)},onPlannerViewChange:function(e){var t=$(e.target).val();this.viewAs(t)},viewAs:function(e){"list"===e?(this.childViews.plannerList||this.createPlannerItemList(),this._isPlannerItemListRendered||this.renderPlannerItemList(),this.childViews.activeItem&&this.childViews.activeItem.cancel(),this.$(".js-calendar-wrapper, .js-calendar-date-range").addClass("gone"),this.$(".js-planner-list-wrapper").removeClass("gone")):(this.$(".js-calendar-wrapper, .js-calendar-date-range").removeClass("gone"),this.$(".js-planner-list-wrapper").addClass("gone")),this.model.setViewPreference(e),this.$("[name='planner-view-radio'][value='"+e+"']").prop("checked",!0)},createPlannerItemList:function(){this.childViews.plannerList||(this.childViews.plannerList=new SW.PlannerItemListView({model:this.model}))},renderPlannerItemList:function(){this._isPlannerItemListRendered=!0,this.$(".js-planner-list-wrapper").html(this.childViews.plannerList.render()),this.childViews.plannerList.delegateEvents()},trackStandardizedTestPrepCreation:function(){SW.Logger.track("testprep:create:button")}}),SW.PlannerCalendarDayView=SW.CalendarDayView.extend({className:"js-calendar-day planner-calendar__day",events:function(){return _.extend({},SW.CalendarDayView.prototype.events,{"click .calendar__day-item":"openItemOptions","click .js-edit-item":"editItem","click .js-report-item":"goToReport","click .js-delete-item":"confirmDeleteItem"})},initialize:function(){this._super("initialize"),this._tooltipClass="js-item-options-tooltip",this.$closeSelectionIcon},renderAllItems:function(){var e={};this._super("renderAllItems",arguments),this.model.get("items").forEach(function(t){var i=t.get("type");e[i]=_.isNumber(e[i])?e[i]+1:1}),e.plan?this.$el.addClass("planner-calendar__day--has-plan"):this.$el.removeClass("planner-calendar__day--has-plan")},updateSelection:function(){this._super("updateSelection"),this.renderSelectionClose()},renderSelectionClose:function(){var e=this.model.toJSON();e.isLastDate&&!e.isSelectionOpen?(this.$closeSelectionIcon=$('<i class="js-remove-selection planner-calendar__cancel-selection-icon clickable fa fa-times"></i>'),this.$el.find(".calendar__day-number").after(this.$closeSelectionIcon)):this.$closeSelectionIcon&&(this.$closeSelectionIcon.remove(),this.$closeSelectionIcon=null)},openItemOptions:function(e){var t,i,s=$(e.target),n=s.hasClass(this._tooltipClass)||s.parents(this._tooltipClass).length>0;this.model.get("isItemOptionsOpen")||n||(s=s.hasClass("calendar__day-item")?s:s.parents(".calendar__day-item"),t=parseInt(s.attr("sw-item-index")),i=s.attr("sw-item-type"),i&&t>-1&&(this.model.set({isItemOptionsOpen:!0,tooltipItemIndex:t}),this.createItemTooltip(s,i,e),this.childViews.tooltip.$el.css("left",this.calcTooltipPosition({event:e,$container:s,$tooltip:this.childViews.tooltip.$el}))))},calcTooltipPosition:function(e){var t=e.$tooltip.outerWidth(),i=e.$container.outerWidth(),s=e.event.offsetX,n=s+t/2>i,a=s-t/2<0;return n&&a?"":(n?s=i-t/2:a&&(s=0+t/2),s/i*100+"%")},createItemTooltip:function(e,t,i){var s;"plan"!==t&&"assignment"!==t&&"test-prep"!==t||(s='<div class="tooltip__item-option-list"><div data-item-type="'+t+'" class="js-report-item tooltip__item-option"><div class="tooltip__item-option-inner">View Report</div></div>',
s+='<div data-item-type="'+t+'" class="js-edit-item tooltip__item-option"><div class="tooltip__item-option-inner">Edit</div></div>',s+='<div data-item-type="'+t+'" class="js-delete-item tooltip__item-option"><div class="tooltip__item-option-inner">Delete</div></div></div>',e.addClass("planner-calendar__day-item--open-tooltip"),this.createTooltip({reference:e,node:{parent:e,content:s,classNames:this._tooltipClass+" tooltip--dark tooltip--item-options invisible"},options:{boundariesElement:$(".calendar")}}),_.defer(function(){this.childViews.tooltip._tooltip.update(),this.childViews.tooltip.$el.removeClass("invisible")}.bind(this)))},createTooltip:function(e){this.removeTooltip(),this._super("createTooltip",arguments),_.defer(function(){this.listenTo(sw.dispatcher,"body:click",this.closeTooltipOnBodyClick)}.bind(this))},closeTooltipOnBodyClick:function(e){var t=$(e.target);t.hasClass(this._tooltipClass)||t.parents(this._tooltipClass).length||this.removeItemTooltip()},removeItemTooltip:function(){this.removeTooltip(),this.$(".planner-calendar__day-item--open-tooltip").removeClass("planner-calendar__day-item--open-tooltip")},removeTooltip:function(){this.childViews.tooltip&&(this.model.set({isItemOptionsOpen:!1}),this.stopListening(sw.dispatcher,"body:click")),this.closeTooltip()},editItem:function(){this.getTooltipItem().startEditing(),this.removeTooltip()},goToReport:function(e){var t=$(e.target).data("itemType")||"assignment",i=this.getTooltipItem().toJSON();"plan"===t?window.open("#reports/topic-report/"+i.topicGrade+"/"+encodeURIComponent(i.topic.topicName),"_blank"):(SW.Logger.track("assignment:viewReport"),window.open("/Assignments/report.php?lock=1&id="+i.id,"_blank"))},confirmDeleteItem:function(e){var t=$(e.target).data("itemType")||"assignment";this.childViews.tooltip.close(),this.createDialog({type:"confirmation",size:"small",title:"Are you sure?",main:"You are about to <b>delete</b> this "+t+". Deleting "+t+"s cannot be undone.",buttons:[{text:"Cancel"},{text:"Delete "+t,className:"btn-flat--warning",callback:function(){this.deleteItem(),this.closeDialog()}.bind(this)}]})},deleteItem:function(){this.getTooltipItem().delete(),this.removeTooltip()},getTooltipItem:function(){return this.model.get("items")[this.model.get("tooltipItemIndex")]}}),SW.PlannerItemListView=SW.ParentView.extend({className:"planner-item-list",events:{"click .js-planner-item-more-actions":"onMoreActionsClick","click .js-planne-item-list-report":"onReportClick","click .js-planne-item-list-edit":"onEditClick","click .js-planne-item-list-delete":"onDeleteClick"},initialize:function(){this._super("initialize",arguments),this.template={base:this.findTemplate("planner-item-list"),moreOptions:this.findTemplate("planner-item-list-more-options")},this._moreOptionsClass="js-planner-more-options-tooltip",this._isMoreOptionsOpen=!1,this._openMoreOptionitemID=null,this.listenTo(this.model,"change:items",this.render),this.listenTo(this.model,"change:lastLoadedTime",function(e){0===e.get("items").length&&this.render()}),this.listenTo(sw.dispatcher,"body:click",this.onBodyClick)},render:function(){var e=this.model.toJSON(),t=e.items.map(this.configureItemForTemplate),i=_.orderBy(t,["statusCompareValue","endTime"],["asc","desc"]);return this.$el.html(this.template.base({items:i,lastLoadedTime:e.lastLoadedTime}))},configureItemForTemplate:function(e){var t,i,s,n=SW.Utility.setTimeInDayToZero(new Date),a=e.toJSON();return n>=a.startDate&&n<=a.endDate?(i="In progress",s=1):n>a.endDate?(i="Complete",s=3):(i="Upcoming",s=2),"plan"===a.type?t="#reports/topic-report/"+a.topicGrade+"/"+encodeURIComponent(a.topic.topicName):"assignment"===a.type&&(t="/Assignments/report.php?lock=1&id="+a.id),{id:a.id,name:a.name,type:a.type,startTime:a.startDate.getTime(),startDateString:SW.Utility.getMDYDateString(a.startDate),endTime:a.endDate.getTime(),endDateString:SW.Utility.getMDYDateString(a.endDate),status:i,statusCompareValue:s,reportLink:t}},onMoreActionsClick:function(e){var t=$(e.target),i=_.toNumber(t.parents("[sw-item-id]").attr("sw-item-id"));this.showMoreOptionsFor($(e.target),i)},showMoreOptionsFor:function(e,t){var i=this.template.moreOptions();this._openMoreOptionitemID===t?this.closeMoreOptions():(this._isMoreOptionsOpen=!0,this._openMoreOptionitemID=t,this.createTooltip({reference:e,node:{parent:this.$el,content:i,classNames:this._moreOptionsClass+" planner-item-list__more-option-tooltip"}}))},closeMoreOptions:function(){this._isMoreOptionsOpen=!1,this._openMoreOptionitemID=null,this.closeTooltip()},onBodyClick:function(e){var t,i,s;this._isMoreOptionsOpen&&(t=$(e.target),i=t.hasClass(this._moreOptionsClass)||t.parents("."+this._moreOptionsClass).length>0,s=t.hasClass("js-planner-item-more-actions"),i||s||this.closeMoreOptions())},onReportClick:function(e){},onEditClick:function(e){var t=_.find(this.model.get("items"),{id:this._openMoreOptionitemID});t&&(scrollTo(0,0),t.startEditing())},onDeleteClick:function(e){var t=_.find(this.model.get("items"),{id:this._openMoreOptionitemID});t&&this.confirmDeleteItem(t)},confirmDeleteItem:function(e){var t=e.get("type");this.closeMoreOptions(),this.createDialog({type:"confirmation",size:"small",title:"Are you sure?",main:"You are about to <b>delete</b> this "+t+". Deleting "+t+"s cannot be undone.",buttons:[{text:"Cancel"},{text:"Delete "+t,className:"btn-flat--warning",callback:function(){this.deleteItem(e),this.closeDialog()}.bind(this)}]})},deleteItem:function(e){e.delete()}}),SW.PlannerItemList=SW.Model.extend({defaults:{items:[],lastLoadedTime:null}}),SW.Plan=SW.CalendarItem.extend({defaults:{type:"plan",topicSkillIDs:void 0,topicGrade:void 0,topic:"",isBeingEdited:!1,startDate:void 0,endDate:void 0},startEditing:function(){this._super("startEditing"),sw.dispatcher.trigger("planner:edit-item",this)},edit:function(){var e=this.getPlanCreationData();this._super("edit"),SW.Http.fetch({url:sw.config.api.planner+"/v2/classes/"+sw.user.classes.getCurrentClassID()+"/plans/"+this.get("id"),method:"PUT",data:e,success:function(e){this.trigger("edit:success")}.bind(this),error:function(e){this.trigger("edit:error")}.bind(this)})},delete:function(){this._super("delete"),SW.Http.fetch({url:sw.config.api.planner+"/v2/classes/"+sw.user.classes.getCurrentClassID()+"/plans/"+this.get("id"),method:"DELETE",success:function(e){this.trigger("delete:success",this),sw.dispatcher.trigger("planner:item:delete",this)}.bind(this),error:function(e){sw.toastManager.create({id:"plan-delete-error",type:"error",content:"Plan failed to deleted. Check your Internet connection.",timer:1e4}),this.trigger("delete:error")}.bind(this)})},create:function(){var e=this.getPlanCreationData();this._super("create"),SW.Http.fetch({url:sw.config.api.planner+"/v2/classes/"+sw.user.classes.getCurrentClassID()+"/plans",method:"POST",data:e,success:function(e){this.set("id",e.id,{silent:!0}),sw.track.user("increment",{"# Plans Created":1}),sw.track.milestone("Planner: create plan"),SW.Logger.track("plan:create"),this.trigger("create:success")}.bind(this),error:function(e){this.trigger("create:error")}.bind(this)})},getPlanCreationData:function(){var e=this.toJSON(),t={startDate:e.startDate,endDate:e.endDate,timezone:moment.tz.guess(),curriculumID:e.topicGrade,curriculumTreeID:sw.user.get("curriculumTreeID"),topicName:e.topic.topicName,skillIDs:e.topicSkillIDs};return t}}),SW.PlanFormView=SW.CalendarItemFormView.extend({events:{"click .js-cancel-plan-btn":"cancel","click .js-create-plan-btn":"finalizePlan","click .js-edit-start-date":"clearStartDate","click .js-edit-end-date":"clearEndDate","click .js-plan-topic-input-group":"openTopicModal","click .js-plan-start-date-input-group":"handleStartDateInputClick","click .js-plan-end-date-input-group":"handleEndDateInputClick"},initialize:function(){this._super("initialize"),this.template=Handlebars.compile($("#planner-calendar-form-template").html()),this.listenTo(this.model,"change:topicSkillIDs change:topicGrade change:topic change:startDate change:endDate",_.debounce(this.render.bind(this))),this.listenTo(this.model,"change:startDate",this.triggerStartDateSelectionEvents),this.listenTo(this.model,"change:endDate",this.triggerEndDateSelectionEvents)},triggerStartDateSelectionEvents:function(){this.triggerSelectionEvents("start")},triggerEndDateSelectionEvents:function(){this.triggerSelectionEvents("end")},triggerSelectionEvents:function(e){this.model.get("isBeingEdited")?this.model.get(e+"Date")&&sw.track.event("planner","select "+e+" date","edit"):this.model.get(e+"Date")&&sw.track.milestone("Planner: select "+e+" date")},render:function(){var e,t=this.model.toJSON();return t.startDateReadable=t.startDate?t.startDate.toDateString():void 0,t.endDateReadable=t.endDate?t.endDate.toDateString():void 0,this.$el.html(this.template(t)),this.setFormState(),this.$el.html(e)},setFormState:function(){var e=this.model.toJSON();e.isBeingEdited?this.editFormStates(e):this.createFormStates(e)},editFormStates:function(e){e.topic?e.startDate?e.endDate?this.closeTooltip():this.stateChooseEndDate():this.stateChooseStartDate():this.stateChooseTopic()},createFormStates:function(e){e.topic?e.startDate?e.endDate?_.defer(this.stateCreatePlan.bind(this)):this.stateChooseEndDate():this.stateChooseStartDate():this.stateChooseTopic()},stateChooseTopic:function(){_.defer(function(){this.createTooltip({reference:this.$(".js-plan-topic-input-group"),node:{content:"Choose a topic for your plan to&nbsp;cover.",classNames:"tooltip--dark tooltip--planner no-select"}})}.bind(this))},stateChooseStartDate:function(){sw.dispatcher.trigger("planner:enable-selection"),_.defer(function(){this.createTooltip({reference:this.$(".js-plan-start-date-input-group"),node:{content:"Click the calendar date you want your plan to begin&nbsp;on.",classNames:"tooltip--dark tooltip--planner no-select"}})}.bind(this))},stateChooseEndDate:function(){_.defer(function(){var e=$("#"+SW.Utility.getDateString(this.model.get("startDate")))||this.$(".js-plan-end-date-input-group");e=e.length>0?e:this.$(".js-plan-end-date-input-group"),e.length>0&&this.createTooltip({reference:e,node:{content:"Now click the date your plan should end&nbsp;on.",classNames:"tooltip--dark tooltip--planner tooltip--planner-day unclickable"}})}.bind(this))},stateCreatePlan:function(){var e="Your plan is ready to be&nbsp;created!";_.defer(function(){var t=$("#"+SW.Utility.getDateString(this.model.get("endDate"))),i="<p>"+e+"</p>";i+='<button id="tooltip-create-plan-btn" class="btn btn--primary btn--block js-create-plan-btn">Create</button>',this.createTooltip({reference:t,node:{parent:t,classNames:"tooltip--dark tooltip--planner tooltip--planner-day no-select",content:i}}),this.enableSaveButton(),$("#tooltip-create-plan-btn").one("click",function(){this.finalizePlan()}.bind(this))}.bind(this))},enableSaveButton:function(){this.$(".js-create-plan-btn").removeAttr("disabled")},finalizePlan:function(){var e=this.model.toJSON();isFormComplete=e.topic&&e.startDate&&e.endDate,isFormComplete?this.model.get("isBeingEdited")?this.model.edit():this.model.create():sw.toastManager.create({id:"plan-finalize-error",type:"error",content:"A topic and date range must be selected to create or save an edit for a plan.",timer:1e4})},openTopicModal:function(){var e="valid",t=this.model.toJSON(),i=this.createDialog({type:"confirmation",size:"medium",title:"Let's choose a topic for your plan.",buttons:[{text:"Cancel",callback:function(){this.stopListening(null,e)}.bind(this)},{text:"Continue",className:"btn-flat--primary"}],children:[{view:SW.TopicSelectView,model:SW.TopicSelect,modelData:{selectedGrade:t.topicGrade,selectedTopic:t.topic,selectedSkillIDs:t.topicSkillIDs}}]});this.listenToOnce(i.childViews.modules[0].model,e,this.completeTopicSelection)},completeTopicSelection:function(e){var t=e;t.topic&&t.topicSkillIDs.length?(t.name=t.topic.topicName,this.model.set(t),sw.track.milestone("Planner: select topic")):sw.toastManager.create({type:"error",content:"Oh no! There was a problem selecting that topic.",timer:15e3})},handleStartDateInputClick:function(e){var t=$(e.target);t.hasClass("js-edit-start-date")||(this.dateInputClick("startDate"),this.scrollToCalendar())},handleEndDateInputClick:function(e){var t=$(e.target);t.hasClass("js-edit-end-date")||this.dateInputClick("endDate")},dateInputClick:function(e){var t=this.model.toJSON();t.topic&&!t[e]&&sw.dispatcher.trigger("planner:flicker")}}),SW.AssignmentFormView=SW.CalendarItemFormView.extend({className:"assignment-form calendar__item-form",events:{"click .js-cancel-item-form":"cancel","click .js-date-range":"handleDateRangeInputClick","click .js-select-skills":"handleSelectSkills","click .js-select-options":"handleSelectOptions","click .js-create-assignment":"createAssignment","click .js-save-assignment-edits":"saveAssignmentEdits"},initialize:function(){var e=this.model.get("studentIDs");this._super("initialize",arguments),this.template=Handlebars.compile($("#assignment-form-template").html()),this._timesStateSet=0,this.model.get("isBeingEdited")&&_.isEmpty(e)&&sw.toastManager.create({type:"warning",content:"<b>We could not find any students for this assignment in your classroom.</b> New students will need to be assigned before any changes can be saved.",timer:15e3}),this.listenTo(this.model,"change:startDate change:endDate change:skills change:studentIDs",this.render)},render:function(){var e,t={},i=this.model.toJSON();return t.start=i.startDate?this.getReadableDate(i.startDate):"",t.end=i.endDate?this.getReadableDate(i.endDate):"",i.readableDateRange=t.start.length||t.end.length?t.start+" - "+t.end:void 0,e=this.template(i),this.setState(),this.$el.html(e)},getReadableDate:function(e){return SW.Utility.dateMonthName(e)+" "+e.getDate()},setState:function(){var e=this.model.toJSON();this.closeTooltip(),e.isBeingEdited?this.setEditState(e):this.setCreationState(e)},setEditState:function(e){},setCreationState:function(e){_.isEmpty(e.skills)?this.setSelectSkillsState():_.isEmpty(e.studentIDs)?this.setSelectOptionsState():e.startDate?e.endDate?this.model.canBeCreated()&&_.defer(this.setCompletionState.bind(this)):this.setChooseEndDateState():_.delay(this.setChooseStartDateState.bind(this),500),this._timesStateSet++},setSelectSkillsState:function(){_.defer(function(){var e=this.$(".js-select-skills").parents(".assignment-form__field");this.createTooltip({reference:e,node:{parent:e,content:"Choose a skill for your assignment to&nbsp;cover.",classNames:"tooltip--dark tooltip--planner no-select"}})}.bind(this))},setSelectOptionsState:function(){_.defer(function(){var e=this.$(".js-select-options").parents(".assignment-form__field");this.createTooltip({reference:e,node:{parent:e,content:"Choose students and a name for your&nbsp;assignment.",classNames:"tooltip--dark tooltip--planner no-select"}})}.bind(this))},setSelectStudentsState:function(){},setChooseStartDateState:function(){this.enableSelection()},enableSelection:function(){sw.dispatcher.trigger("planner:enable-selection",this.model.get("type"))},setChooseEndDateState:function(){_.defer(function(){var e=$("#"+SW.Utility.getDateString(this.model.get("startDate")))||this.$(".js-date-range");this.createTooltip({reference:e,node:{content:"Now click the date your assignment should end&nbsp;on.",classNames:"tooltip--dark tooltip--planner tooltip--planner-day unclickable"}})}.bind(this)),sw.track.milestone("Planner: assignment start-date chosen")},setCompletionState:function(){var e="Your assignment is<br> ready to be&nbsp;created!";_.defer(function(){var t=$("#"+SW.Utility.getDateString(this.model.get("endDate"))),i="<p>"+e+"</p>";i+='<button id="tooltip-create-assignment-btn" class="btn btn--primary btn--block js-create-assignment">Create</button>',this.createTooltip({reference:t,node:{parent:t,content:i,classNames:"tooltip--dark tooltip--planner tooltip--planner-day no-select"}}),$("#tooltip-create-assignment-btn").one("click",function(){this.createAssignment()}.bind(this))}.bind(this)),sw.track.milestone("Planner: assignment end-date chosen")},handleDateRangeInputClick:function(){this.model.get("endDate")?this.model.resetDate():(this.enableSelection(),this.scrollToCalendar(),sw.dispatcher.trigger("planner:flicker"))},handleSelectSkills:function(){this.createSkillSelectDialog()},handleSelectOptions:function(){this.createSelectOptionsDialog()},createSelectOptionsDialog:function(){var e=this.model.get("studentIDs"),t=this.model.get("name"),i=this.model.get("questions"),s=this.createDialog({className:"dialog dialog--basic",type:"custom",size:"medium",children:[{view:SW.SelectAssignmentOptionsCardView,model:SW.SelectAssignmentOptionsCard,modelData:{name:t,selectedStudentIDs:e,questions:i}}]});this.listenToOnce(s.childViews.modules[0].model,"confirmed:options",this.completeOptionsSelection)},completeOptionsSelection:function(e){var t=e.data;t.valid?(this.closeDialog(),this.model.saveOptions(t)):sw.toastManager.create({type:"error",content:"Oh no! There was a problem selecting the "+SW.Utility.pluralizer("skill","skills",skillIDs.length)+".",timer:15e3})},createSkillSelectDialog:function(){var e=this.model.get("skills"),t=this.createDialog({className:"dialog dialog--basic dialog--tall",type:"custom",size:"large",children:[{view:SW.SelectSkillsCardView,model:SW.SelectSkillsCard,modelData:{selectedSkillName:e?e.name:void 0,selectedSkillID:e?e.id:void 0}}]});this.listenToOnce(t.childViews.modules[0].model,"confirmed:skills",this.completeSkillSelection)},completeSkillSelection:function(e){var t=e.data;t.length?(this.closeDialog(),this.model.selectSkills(t)):sw.toastManager.create({type:"error",content:"Oh no! There was a problem selecting the "+SW.Utility.pluralizer("skill","skills",t.length)+".",timer:15e3})},createAssignment:function(){this.model.canBeCreated()?(this.model.create(),sw.track.milestone("Planner: assignment created")):sw.toastManager.create({id:"cannot-create-assignment",type:"warning",content:"Make sure your assignment has a <b>skill</b>, <b>student(s)</b> and <b>date range</b> before you create it!",timer:7e3})},saveAssignmentEdits:function(){this.model.canBeCreated()?this.model.edit():sw.toastManager.create({id:"cannot-save-assignment-edits",type:"warning",content:"Make sure your assignment has a <b>skill</b>, <b>student(s)</b> and <b>date range</b> before you save you changes!",timer:7e3})}}),SW.Assignment=SW.CalendarItem.extend({defaults:_.extend({},SW.CalendarItem.prototype.defaults,{type:"assignment",skills:void 0,studentIDs:void 0,questions:5}),initialize:function(){this._super("initialize",arguments),this._hasLoadedDetails=!1},selectSkills:function(e){var t=this.get("name"),i=_.isObject(this.get("skills"))?this.get("skills").name:null,s=t===i?null:t;this.set({name:s||SW.Education.skills[e[0]].name,skills:{name:SW.Education.skills[e[0]].name,id:e[0]}})},saveOptions:function(e){var t={};_.isString(e.name)&&(t.name=e.name),_.isArray(e.selectedStudentIDs)&&(t.studentIDs=e.selectedStudentIDs),_.isNumber(e.questions)&&(t.questions=e.questions),this.set(t)},create:function(){var e=this.getCreationData();e.end_date=SW.Utility.setTimeInDayToMidnight(e.end_date),this._super("create"),SW.Http.fetch({url:sw.config.api.assignments+"/v1/class/"+sw.user.classes.getCurrentClassID()+"/assignment",method:"POST",data:e,success:function(e){this.set("id",e.id,{silent:!0}),sw.track.user("increment",{"# Assignments Created":1}),sw.track.milestone("Planner: create assignment"),SW.Logger.track("assignment:create"),this.trigger("create:success")}.bind(this),error:function(e){this.trigger("create:error")}.bind(this)})},getCreationData:function(){var e=this.toJSON();return{skill_id:e.skills.id,num_questions:e.questions,student_ids:e.studentIDs.join(","),name:e.name,start_date:e.startDate,end_date:e.endDate,user_id:sw.user.get("userID")}},canBeCreated:function(){var e,t,i=!0;try{t=this.getCreationData()}catch(e){e=e,i=!1}if(i)for(e in t)if(_.isUndefined(t[e])||_.isNull(t[e])||"student_ids"===e&&_.isEmpty(t[e])){i=!1;break}return i},delete:function(){this._super("delete"),SW.Http.fetch({url:sw.config.api.assignments+"/v1/assignment/"+this.get("id"),method:"DELETE",success:function(e){this.trigger("delete:success",this),sw.dispatcher.trigger("planner:item:delete",this)}.bind(this),error:function(e){sw.toastManager.create({id:"assignment-delete-error",type:"error",content:"Assignment failed to deleted. Check your Internet connection.",timer:1e4}),this.trigger("delete:error")}.bind(this)})},startEditing:function(){this._hasLoadedDetails?this.startEditingExtended():this.loadDetails(this.startEditingExtended.bind(this))},startEditingExtended:function(){this.syncStudentIDs(),this._super("startEditing"),sw.dispatcher.trigger("planner:edit-item",this)},syncStudentIDs:function(){var e,t;studentIDs=this.get("studentIDs"),_.isArray(studentIDs)&&(t=sw.user.classes.getCurrentClass(),e=studentIDs.filter(function(e){return t.students.findIndex({id:e})!==-1}),this.set("studentIDs",e,{trigger:!1}))},edit:function(){var e=this.getEditedData();e.end_date&&(e.end_date=SW.Utility.setTimeInDayToMidnight(e.end_date)),this._super("edit"),_.isEmpty(e)?this.trigger("edit:success"):SW.Http.fetch({url:sw.config.api.assignments+"/v1/assignment/"+this.get("id"),method:"PUT",data:e,success:function(e){this.trigger("edit:success")}.bind(this),error:function(e){this.trigger("edit:error")}.bind(this)})},getEditedData:function(){var e={},t=this.get("cachedState"),i=this.toJSON();return _.isEqual(i.name,t.name)||(e.name=i.name),_.isEqual(i.skills,t.skills)||(e.skill_id=i.skills.id,e.num_questions=i.questions),_.isEqual(i.questions,t.questions)||(e.num_questions=i.questions),_.isEqual(_.clone(i.studentIDs).sort(),_.clone(t.studentIDs).sort())||(e.student_ids=i.studentIDs.join(",")),_.isEqual(i.startDate,t.startDate)||(e.start_date=i.startDate),_.isEqual(i.endDate,t.endDate)||(e.end_date=i.endDate),(_.has(e,"num_questions")||_.has(e,"skills"))&&(e.num_questions=e.num_questions||i.questions,e.skill_id=e.skill_id||i.skills.id),e},loadDetails:function(e,t){SW.Http.fetch({url:sw.config.api.assignments+"/v1/assignment/"+this.get("id"),method:"GET",success:function(t){this.selectSkills([t.skills.id]),this.set({studentIDs:t.student_ids,questions:t.questions.length}),this._hasLoadedDetails=!0,_.isFunction(e)&&e(t)}.bind(this),error:function(e){_.isFunction(e)&&e(data),sw.toastManager.create({id:"assignment-get-error",type:"error",content:"Assignment details failed to load. Check your Internet connection.",timer:1e4})}})}}),SW.TestPrep=SW.CalendarItem.extend({EDITING_STATES:{NOT_EDITING:"NOT_EDITING",TEST:"TEST",START_DATE:"START_DATE",END_DATE:"END_DATE",CONFIRMATION:"CONFIRMATION"},defaults:_.extend({},SW.CalendarItem.prototype.defaults,{type:"test-prep",selectedTest:null,editingState:""}),initialize:function(){this.on("change:selectedTest",this.updateName),this.on("change:selectedTest change:startDate change:endDate",this.updateEditingState),this.updateName(),this.updateEditingState()},create:function(){var e=this.getCreationData();e.end_date=SW.Utility.setTimeInDayToMidnight(e.end_date),this._super("create"),SW.Http.fetch({url:sw.config.api.assignments+"/v2/class/"+sw.user.classes.getCurrentClassID()+"/test-prep",method:"POST",data:e,success:function(e){SW.Logger.track("testprep:created"),this.set("id",e.id,{silent:!0}),this.trigger("create:success")}.bind(this),error:function(){this.trigger("create:error")}.bind(this)})},edit:function(){var e=this.getEditedData();e.end_date&&(e.end_date=SW.Utility.setTimeInDayToMidnight(e.end_date)),this._super("edit"),_.isEmpty(e)?this.trigger("edit:success"):SW.Http.fetch({url:sw.config.api.assignments+"/v2/test-prep/"+this.get("id"),method:"PUT",data:e,success:function(){this.trigger("edit:success")}.bind(this),error:function(){this.trigger("edit:error")}.bind(this)})},delete:function(){this._super("delete"),SW.Http.fetch({url:sw.config.api.assignments+"/v2/test-prep/"+this.get("id"),method:"DELETE",success:function(){this.trigger("delete:success",this),sw.dispatcher.trigger("planner:item:delete",this)}.bind(this),error:function(){sw.toastManager.create({id:"test-prep-delete-error",type:"error",content:"Test prep failed to delete. Check your Internet connection.",timer:1e4}),this.trigger("delete:error")}.bind(this)})},canCreate:function(){return this.get("editingState")===this.EDITING_STATES.CONFIRMATION},getCreationData:function(){var e=this.toJSON(),t=this.getStudentIds();return{user_id:sw.user.get("userID"),test_prep_id:e.selectedTest.id,name:e.name,student_ids:t,start_date:e.startDate,end_date:e.endDate}},getStudentIds:function(){var e=sw.user.classes.getCurrentClass();return e.students.getStudentIDs()},getEditedData:function(){var e={},t=this.get("cachedState"),i=this.toJSON();return _.isEqual(i.name,t.name)||(e.name=i.name),_.isEqual(i.selectedTest.id,t.selectedTest.id)||(e.test_prep_id=i.selectedTest.id),_.isEqual(i.startDate,t.startDate)||(e.start_date=i.startDate),_.isEqual(i.endDate,t.endDate)||(e.end_date=i.endDate),e},updateEditingState:function(){this.get("selectedTest")?this.get("startDate")?this.get("endDate")?this.get("id")?this.set({editingState:this.EDITING_STATES.NOT_EDITING}):this.set({editingState:this.EDITING_STATES.CONFIRMATION}):this.set({editingState:this.EDITING_STATES.END_DATE}):this.set({editingState:this.EDITING_STATES.START_DATE}):this.set({editingState:this.EDITING_STATES.TEST})},updateName:function(){this.get("selectedTest")&&this.set({name:this.getSelectedTestName()})},selectTest:function(e){this.set("selectedTest",{id:e.id||0,name:e.name||""})},startEditing:function(){this._super("startEditing"),this.updateEditingState(),sw.dispatcher.trigger("planner:edit-item",this)},adjustDates:function(){this.startEditing(),this.resetDate()},getEstimatedTotalMinutes:function(){return 100},getEstimatedDailyMinutes:function(){var e=this.get("startDate"),t=this.get("endDate"),i=this.get("selectedTest");if(e&&t&&i)return this.computeEstimatedDailyMinutes()},computeEstimatedDailyMinutes:function(){var e=moment(this.get("startDate")),t=moment(this.get("endDate")),i=t.diff(e,"days")+1,s=this.getEstimatedTotalMinutes()/i,n=SW.Utility.roundToNearest(s,5),a=Math.max(n,5);return a},getSelectedTestName:function(){var e=this.get("selectedTest");return e?e.name:""}}),SW.TestPrepFormView=SW.CalendarItemFormView.extend({className:"calendar__item-form",events:{"click .js-cancel-test-prep-btn":"cancel","click .js-test-prep-test-input-group":"openSelectTestModal","click .js-create-test-prep-btn":"finalizeTestPrep","click .js-edit-start-date":"clearStartDate","click .js-edit-end-date":"clearEndDate","click .js-test-prep-start-date-input-group":"onStartDateInputClick","click .js-test-prep-end-date-input-group":"onEndDateInputClick"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#test-prep-form-template").html()),this.listenTo(this.model,"change:selectedTest change:startDate change:endDate",this.render)},render:function(){var e=this.model.toJSON();return e.canCreate=this.model.canCreate(),this.$el.html(this.template(e)),this.renderEditingState(),this.$el},openSelectTestModal:function(){var e=sw.user.classes.getCurrentClass(),t=this.createDialog({className:"dialog dialog--basic",type:"custom",size:"medium-small",children:[{model:SW.TestPrepSelectCard,modelData:{hasStudents:e.getSize()>0,selectedGrade:e.getGrade()},view:SW.TestPrepSelectCardView}]});this.listenToOnce(t.childViews.modules[0].model,"test-selected",this.onTestSelection),SW.Logger.track("testprep:create:selecttestcard")},onTestSelection:function(e){this.model.selectTest(e),this.closeDialog(),SW.Logger.track("testprep:create:testselected")},renderEditingState:function(){_.defer(function(){var e=this.model.get("editingState");switch(e){case this.model.EDITING_STATES.TEST:this.renderStateTest();break;case this.model.EDITING_STATES.START_DATE:this.renderStateStartDate();break;case this.model.EDITING_STATES.END_DATE:this.renderStateEndDate();break;case this.model.EDITING_STATES.CONFIRMATION:this.renderStateConfirmation();break;case this.model.EDITING_STATES.NOT_EDITING:default:this.closeTooltip()}}.bind(this))},renderStateTest:function(){this.createTooltip({reference:this.$(".js-test-prep-test-input-group"),node:{content:"Choose the standardized test your students write.",classNames:"tooltip--dark tooltip--planner no-select"}})},renderStateStartDate:function(){var e=this.model.getSelectedTestName()||"standardized test";sw.dispatcher.trigger("planner:enable-selection"),this.createTooltip({reference:this.$(".js-test-prep-start-date-input-group"),node:{content:"Click the calendar date you want your "+e+" prep to begin on.",classNames:"tooltip--dark tooltip--planner no-select"}})},renderStateEndDate:function(){var e=$("#"+SW.Utility.getDateString(this.model.get("startDate"))),t=e.length?e:this.$(".js-test-prep-end-date-input-group"),i=this.model.getSelectedTestName()||"standardized test";t.length&&this.createTooltip({reference:t,node:{content:"Now click the date that the "+i+" prep should end on.",classNames:"tooltip--dark tooltip--planner tooltip--planner-day unclickable"}})},renderStateConfirmation:function(){var e=this.model.getSelectedTestName()||"standardized test",t="Your "+e+" prep is ready to be created!",i=$("#"+SW.Utility.getDateString(this.model.get("endDate"))),s="<p>"+t+"</p>";s+='<button id="tooltip-create-test-prep-btn" class="btn btn--primary btn--block js-create-plan-btn">Create</button>',this.createTooltip({reference:i,node:{parent:i,classNames:"tooltip--dark tooltip--planner tooltip--planner-day no-select",content:s}}),$("#tooltip-create-test-prep-btn").one("click",function(){this.finalizeTestPrep()}.bind(this))},finalizeTestPrep:function(){this.model.get("id")?this.model.edit():this.model.create()},onStartDateInputClick:function(e){var t=$(e.target);t.hasClass("js-edit-start-date")||(this.dateInputClick("startDate"),this.scrollToCalendar())},onEndDateInputClick:function(e){var t=$(e.target);t.hasClass("js-edit-end-date")||(this.dateInputClick("endDate"),this.scrollToCalendar())},dateInputClick:function(e){var t=this.model.toJSON();t.selectedTest&&!t[e]&&sw.dispatcher.trigger("planner:flicker")}}),SW.SkillSample=SW.Model.extend({defaults:{skillID:void 0}}),SW.SkillSampleView=SW.ParentView.extend({className:"skill-sample",initialize:function(e){this._super("initialize",arguments),e=e||{},this.anchorMouse=e.anchorMouse,this.setClassName(e),this.setID(),this._isDisplayed=!1},setClassName:function(e){e.hide&&(this.className+=" skill-sample--hidden",this.$el.addClass(this.className))},setID:function(){this.id="skill-sample-"+this.cid,this.$el.attr("id",this.id)},render:function(){return this._isDisplayed||this._displaySkill(),this.$el},setPosition:function(e){parseInt(this.$el.css("height"),10);this.anchorMouse&&e&&SW.Utility.moveElToMouse(this.$el,e,{stayInViewport:!0,offsetY:-22,alignY:"top"})},_displaySkill:function(){_.defer(function(){Controller.displayQuestion({containerID:this.$el.attr("id"),skillID:this.model.get("skillID"),isMinimal:!0})}.bind(this)),this._isDisplayed=!0},hide:function(){this.$el.addClass("skill-sample--hidden"),this.stopListening(sw.dispatcher,"body:mousemove")},show:function(e){e&&this.setPosition(e),this.listenTo(sw.dispatcher,"body:mousemove",this.setPosition),this.$el.removeClass("skill-sample--hidden")}}),SW.SkillSampleController=SW.Model.extend({defaults:{skillID:void 0}}),SW.SkillSampleControllerView=SW.ParentView.extend({className:"skill-sample-controller",events:{mouseenter:"showSample",mouseleave:"hideSample",click:"showSample"},initialize:function(e){this._super("initialize",arguments),sampleIsShown=void 0,this.closeOnScroll=e.closeOnScroll,this.template=Handlebars.compile($("#skill-sample-controller-template").html()),this.$modalContainer=$("#modals")},render:function(){return this.$el.html(this.template())},showSample:function(e){this.sampleIsShown||(this.sampleIsShown=!0,this.childViews.sample||this.createSample(),this.childViews.sample.show(e),this.closeOnScroll&&this.$el.parents().on("scroll",_.debounce(function(){
this.hideSample()}.bind(this),200)))},hideSample:function(){this.sampleIsShown&&(this.sampleIsShown=!1,this.childViews.sample.hide(),this.closeOnScroll&&this.$el.parents().off("scroll"))},toggleSample:function(){this.sampleIsShown?this.hideSample():this.showSample()},createSample:function(){this.initializeSample(),this.renderSample()},initializeSample:function(){this.childViews.sample=this.childViews.sample||new SW.SkillSampleView({anchorMouse:!0,hide:!0,model:this.model})},renderSample:function(){this.$modalContainer.append(this.childViews.sample.render())}}),SW.TopicSelect=SW.Model.extend({defaults:{selectedGrade:void 0,selectedTopic:void 0,selectedSkillIDs:[],topics:[],filteredTopics:[]},initialize:function(){this.getDefaultSelectedGrade(),this.loadTopics(),this.listenTo(this,"load:topics",this.loadTopics)},getDefaultSelectedGrade:function(){this.get("selectedGrade")||this.set("selectedGrade",sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum())},loadTopics:function(){this.loaded=!1,SW.Http.fetch({url:sw.config.api.planner+"/v1/curriculum-topics/"+this.get("selectedGrade"),success:this.handleLoadTopicsSuccess.bind(this),error:this.handleLoadTopicsFailed.bind(this)})},handleLoadTopicsSuccess:function(e){this.loaded=!0,e=_.sortBy(e,"topicName"),e.forEach(function(e,t){e.id="topic-"+t}),this.set({topics:e,filteredTopics:e},{silent:_.isObject(this.get("selectedTopic"))}),this.setSelectedTopicSkills(e),this.trigger("topics:load:success")},setSelectedTopicSkills:function(e){var t=this.get("selectedTopic");t&&!t.skillIDs&&this.set("selectedTopic",_.find(e,{topicName:t.topicName}))},handleLoadTopicsFailed:function(){this.trigger("topics:load:failed")},filterTopics:function(e){var t,i=e.toLowerCase().split(" ").filter(function(e){return e.length>0});i.length?(t=_.filter(this.get("topics"),function(e){var t,s=0;for(t=i.length-1;t>=0;t--)e.topicName.toLowerCase().indexOf(i[t])>-1&&s++;return e.queryMatches=s,s>0}),t=_.sortBy(t,function(e){return-e.queryMatches})):t=this.get("topics"),this.set("filteredTopics",t)},selectTopicById:function(e){var t=_.find(this.get("filteredTopics"),{id:e});this.set({selectedTopic:t,selectedSkillIDs:t.skillIDs.slice(0)})},toggleSelectedSkill:function(e){var t=this.get("selectedSkillIDs"),e=parseInt(e);this.set("selectedSkillIDs",SW.Array.toggle(t,e,!0))},loadTopicSkills:function(){var e=this.get("selectedTopic").skillIDs,t=this.get("selectedSkillIDs"),i=[];e.forEach(function(e,s){SW.Education.skills[e]&&i.push({data:SW.Education.skills[e],checked:t.indexOf(e)>-1})}),this.set("topicSkills",i)},changeSelectedGrade:function(e){this.set("selectedGrade",e),this.trigger("load:topics")},getTopicData:function(){var e=this.toJSON();return{topic:e.selectedTopic,topicSkillIDs:e.selectedSkillIDs,topicGrade:e.selectedGrade}}}),SW.TopicSelectView=SW.ParentView.extend({className:"topic-select",events:{"input .js-topic-search":function(e){this.throttledFilterTopics(e)},"click .js-topic":"selectTopic","click .js-reset-topic-selection":"resetSelectedTopic","click .js-topic-select-customize":"initializeCustomSkills","mouseenter .js-show-skill-sample":"handleRevealingSampleSkill","mouseleave .js-show-skill-sample":"handleHidingSampleSkill","change .js-topic-skill-input":"handleTopicSkillInputChange","change .js-select-grade":"changeSelectedGrade"},initialize:function(e){var t=e&&e.template?e.template:"topic-select-template";this._super("initialize",arguments),this.dialog=e.dialog,this.template={base:Handlebars.compile($("#"+t).html()),filterResults:Handlebars.compile($("#topic-select-filtered-topics-template").html()),customSkills:Handlebars.compile($("#topic-select-customize-skills-template").html())},this.throttledFilterTopics=_.throttle(this.filterTopics,450).bind(this),this.listenTo(this.model,"change:filteredTopics",this.updateFilteredTopics),this.listenTo(this.model,"change:selectedTopic",this.render),this.listenTo(this.model,"topics:load:failed",this.handleLoadingError),this.dialog&&this.listenTo(this.dialog,"click:button-1",this.validateTopicSelection)},render:function(){var e,t=this.model.toJSON();return t.curricula=sw.user.get("curricula"),e=this.template.base(t),this.$el.html(e),t.filteredTopics.length&&!t.selectedTopic?this.updateFilteredTopics(t):this.triggerDialogResize(),t.selectedTopic&&t.selectedSkillIDs.length<(t.selectedTopic.skillIDs?t.selectedTopic.skillIDs.length:-1)&&this.initializeCustomSkills(),this.matchSelectedGrade(),!this.dialog||t.selectedTopic||this.model.loaded||this.createLoadingOverlay(),this.$el},createLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:create")},removeLoadingOverlay:function(){sw.dispatcher.trigger("dialog:loader-overlay:remove")},updateFilteredTopics:function(){var e=this.model.toJSON(),t=this.$(".topic-select__filter-wrapper");this.removeLoadingOverlay(),t.html(this.template.filterResults(e)),this.triggerDialogResize()},focusSearchBar:function(){_.delay(function(){this.$el.find(".js-topic-search").focus()}.bind(this),100)},matchSelectedGrade:function(){this.$el.find(".js-select-grade").val(this.model.get("selectedGrade"))},filterTopics:function(e){var t=e.target.value;this.model.filterTopics(t)},selectTopic:function(e){var t=$(e.target);this.model.selectTopicById(t.attr("id"))},resetSelectedTopic:function(){this.model.set({selectedTopic:void 0,selectedSkillIDs:[]})},initializeCustomSkills:function(){this.model.loadTopicSkills(),this.renderCustomizeSkills()},renderCustomizeSkills:function(){var e=this.model.toJSON(),t=this.$el.find(".topic-select__skills-wrapper");t.html(this.template.customSkills(e)),this.triggerDialogResize()},triggerDialogResize:function(){this.dialog&&sw.dispatcher.trigger("dialog:resize")},handleRevealingSampleSkill:function(e){var t=$(e.target).parents(".js-topic-skill"),i=t.find(".js-skill-sample");i.removeClass("topic-select__skill-sample--hidden"),this.renderSampleSkillTo(i,t.attr("sw-skill-id"))},handleHidingSampleSkill:function(e){var t=$(e.target).parents(".js-topic-skill");t.find(".js-skill-sample").addClass("topic-select__skill-sample--hidden")},renderSampleSkillTo:function(e,t){parseInt(e.attr("sw-rendered"))!=t&&(e.attr("sw-rendered",t),Controller.displayQuestion({containerID:e.find(".js-skill-sample-inner").attr("id"),skillID:t,isMinimal:!0}))},handleTopicSkillInputChange:function(e){var t=$(e.target);this.model.toggleSelectedSkill(t.val())},handleLoadingError:function(){this.createDialog({type:"alert",size:"small",title:"Unable to load list of topics.",main:"Check your Internet connection and try to select a topic again in a few minutes.",buttons:[{text:"Close"}]})},changeSelectedGrade:function(e){var t=$(e.target);this.model.changeSelectedGrade(parseInt(t.val()))},validateTopicSelection:function(){this.isValid()?(this.model.trigger("valid",this.model.getTopicData()),this.closeDialog()):this.renderIncompleteForm()},isValid:function(){return this.model.get("selectedTopic")&&this.model.get("selectedSkillIDs").length},renderIncompleteForm:function(){var e=this.model.toJSON();e.selectedTopic?e.selectedSkillIDs.length||this.$el.find(".topic-select__inner").addClass("topic-select-skills--incomplete"):this.$el.find(".topic-select__inner").addClass("topic-select--incomplete")}}),SW.IntroPlanView=SW.ParentView.extend({className:"intro-plan",events:{"click .js-save-intro-plan-btn":"submitPlanTopic"},initialize:function(){this._super("initialize"),this.template=Handlebars.compile($("#intro-plan-template").html())},render:function(){return this.$el.html(this.template()),this.$saveBtn=this.$(".js-save-intro-plan-btn"),this.initializeTopicSelect(),this.buttonState(),this.$el},initializeTopicSelect:function(){this.childViews.topicSelect=this.childViews.topicSelect||new SW.TopicSelectView({model:new SW.TopicSelect}),this.listenToOnce(this.childViews.topicSelect.model,"topics:load:success",function(){this.renderTopicSelect()}.bind(this)),this.listenTo(this.childViews.topicSelect.model,"change:selectedTopic",function(e){this.buttonState()}.bind(this))},buttonState:function(){this.childViews.topicSelect.model.get("selectedTopic")?this.enableSaveButton():this.$saveBtn.addClass("btn--disabled")},enableSaveButton:function(){_.delay(function(){this.$saveBtn.removeClass("invisible btn--disabled")}.bind(this),100)},renderTopicSelect:function(){this.$(".js-topic-select-wrapper").html(this.childViews.topicSelect.render())},submitPlanTopic:function(){this.childViews.topicSelect.isValid()?this.model.savePlan({curriculumID:this.childViews.topicSelect.model.get("selectedGrade"),topicName:this.childViews.topicSelect.model.get("selectedTopic").topicName,skillIDs:this.childViews.topicSelect.model.get("selectedSkillIDs")}):this.childViews.topicSelect.renderIncompleteForm()}}),SW.IntroPlan=SW.Model.extend({initialize:function(){this._super("initialize"),this.loadPlans()},loadPlans:function(){SW.Http.fetch({url:sw.config.api.planner+"/v1/classes/"+sw.user.classes.getCurrentClassID()+"/plans",method:"GET",success:function(e){e.length&&e[0].id&&this.set("planID",e[0].id)}.bind(this),error:function(){}.bind(this)})},savePlan:function(e){var t,i="POST",s=sw.config.api.planner+"/v2/classes/"+sw.user.classes.getCurrentClassID()+"/plans",n=new Date,a=new Date;a.setDate(a.getDate()+13),t={startDate:SW.Utility.getDateString(n),endDate:SW.Utility.getDateString(a),timezone:moment.tz.guess(),curriculumID:e.curriculumID,curriculumTreeID:sw.user.get("curriculumTreeID"),topicName:e.topicName,skillIDs:e.skillIDs},this.get("planID")&&(i="PUT",s+="/"+this.get("planID")),SW.Http.fetch({url:s,method:i,data:t,success:function(e){this.set("planID",e.id,{silent:!0})}.bind(this),error:function(e){}.bind(this)}),this.trigger("plan:save")}}),SW.Tooltip=SW.Model.extend({defaults:function(){return{reference:null,node:{},options:{},onCreate:function(){},closeOnClick:!1}},initialize:function(){this._super("initialize",arguments),this.setNodeDefaults(),this.setOptionsDefaults(),this.setClassModifers(),this.setArrowClassModifers()},setNodeDefaults:function(){this.set("node",_.assign({contentType:"html"},this.get("node")))},setOptionsDefaults:function(){this.set("options",_.assign({placement:"top",removeOnDestroy:_.isFunction(document.getElementsByTagName("body")[0].remove)},this.get("options")))},setClassModifers:function(){var e=this.splitClasses("classNames");e.unshift("tooltip"),this.get("node").classNames=e},setArrowClassModifers:function(){var e=this.splitClasses("arrowClassNames");e.unshift("tooltip__arrow"),this.get("node").arrowClassNames=e},splitClasses:function(e){var t=this.get("node")[e];return _.isString(t)?_.compact(_.split(t," ")):t||[]}}),SW.TooltipView=SW.View.extend({initialize:function(){var e;this.settings=this.model.toJSON(),e=this.settings.onCreate,this.settings.closeOnClick&&(this.settings.onCreate=function(t){_.defer(function(){this.listenTo(sw.dispatcher,"body:click",function(e){var t=$(e.target);t.is(this.$el)||t.is(this.settings.trigger)||this.close.bind(this)()}),this.settings.trigger&&this.settings.trigger.bind("click.toolTip",this.onTriggerClick.bind(this))}.bind(this)),e&&e(t)}.bind(this))},render:function(){return this._tooltip=new Popper(this.settings.reference,this.settings.node,this.settings.options).onCreate(this.settings.onCreate),this.$el=$(this._tooltip._popper),this._tooltip.update(),this.$el},show:function(){this.$el.show()},hide:function(){this.$el.hide()},onTriggerClick:function(e){e.stopPropagation(),this.close()},close:function(){this.settings.closeOnClick&&(this.stopListening(sw.dispatcher,"body:click"),this.settings.trigger&&this.settings.trigger.unbind(".toolTip")),this._tooltip.destroy(),this._super("close")}}),SW.LocationSelect=SW.Model.extend({defaults:{locations:[],searchTerm:"",emptySearch:!1,chosenLocationID:!1,skippable:!0},initialize:function(){this._super("initialize"),this.requestNumber=0},clearLocations:function(){this.set("emptySearch",!1),this.set("locations",[])},getLocations:function(e){if(e=SW.Utility.replaceAll(e,".",""),e=SW.Utility.replaceAll(e,"%",""),!(e.length<3)){this.requestNumber++;var t=this,i=this.requestNumber;SW.Http.fetch({url:sw.config.api.web+"/v1/locations/search",dataType:"json",method:"GET",data:{name:e,province:SW.Utility.getDecodedCookie("fullState"),country:SW.Utility.getDecodedCookie("fullCountry")},success:function(e){if(i===t.requestNumber){var s=e;0==s.length?t.set("emptySearch",!0):t.set("emptySearch",!1),t.set("locations",s),t.trigger("load:complete")}}})}},chooseLocation:function(e,t,i){this.set("chosenLocationID",e),this.set("chosenSchool",t),this.set("chosenBoard",i)},clearChosenLocation:function(){this.set("chosenLocationID",!1)},getLocation:function(){return this.get("chosenLocationID")},saveManualLocation:function(e,t){sw.track.user("set",{locationType:"unlisted",school:e,board:t}),SW.Http.fetch({url:sw.config.api.web+"/v1/teacher/"+sw.user.get("userID")+"/location/manual",dataType:"json",data:{school:e,board:t,province:SW.Utility.getCookie("fullState")||"Unknown",country:SW.Utility.getCookie("fullCountry")||"Unknown"},method:"POST",success:function(e){}})},saveLocation:function(){sw.track.user("set",{locationType:"listed",school:this.get("chosenSchool"),board:this.get("chosenBoard")}),SW.Http.fetch({url:sw.config.api.web+"/v1/teacher/"+sw.user.get("userID")+"/location",dataType:"json",data:{locationID:this.get("chosenLocationID")},method:"POST",success:function(e){}})}}),SW.LocationSelectView=SW.ParentView.extend({className:"location-select",events:{"keyup .js-location-search":"handleInput","click .js-location-item":"chooseLocation","click .js-reset-location-selection":"clearLocation","click .js-skip-location-select":"skipLocationSelect","click .js-start-add-school":"showAddSchool","click .js-start-search":"showSearchBar","keyup input":"removeWarning"},initialize:function(){this._super("initialize"),this.template={base:this.findTemplate("location-select-base"),search:this.findTemplate("location-select-search"),results:this.findTemplate("location-select-results"),add:this.findTemplate("location-select-add-school")},this.listenTo(this.model,"load:complete",this.renderResults),this.listenTo(this.model,"change",this.removeWarning),this.currentValue=null},chooseLocation:function(e){this.setLocation($(e.currentTarget).data("id"),$(e.currentTarget).data("school"),$(e.currentTarget).data("board"))},setLocation:function(e,t,i){this.model.clearLocations(),this.renderResults(),this.setLocationBarSelected(t),this.model.chooseLocation(e,t,i)},setLocationBarSelected:function(e){this.$input.prop("disabled",!0),this.$input.addClass("search__input--selected"),this.$input.val(e),this.$clearIcon.show(),this.$searchIcon.hide(),this.hideHint()},clearLocation:function(){this.setLocationBarEmpty(),this.model.clearChosenLocation(),this.showSkipHint()},setLocationBarEmpty:function(){this.$input.prop("disabled",!1),this.$input.val(""),this.$input.removeClass("search__input--selected"),this.$input.focus(),this.$clearIcon.hide(),this.$searchIcon.show()},hideHint:function(){this.$addSchoolHint.hide(),this.$skipHint.hide()},showAddSchoolHint:function(){this.$addSchoolHint.show(),this.$skipHint.hide()},showSkipHint:function(){this.$addSchoolHint.hide(),this.$skipHint.show()},handleInput:function(){this.$input.val()!=this.currentValue&&(this.$input.val().length>2?(this.showSpinner(),this.processInput()):(this.hideSpinner(),this.model.clearLocations(),this.renderResults()),this.currentValue=this.$input.val())},showSpinner:function(){$(".js-search-spinner").show()},hideSpinner:function(){$(".js-search-spinner").hide()},processInput:_.debounce(function(){this.model.getLocations(this.$input.val())},500,{maxWait:1e3}),cacheSelections:function(){this.$input=this.$el.find(".js-location-search"),this.$clearIcon=this.$el.find("#location-clear-icon"),this.$searchIcon=this.$el.find("#location-search-icon"),this.$skipHint=this.$el.find("#location-skip-hint"),this.$addSchoolHint=this.$el.find("#location-add-hint"),this.$addSchoolContainer=this.$el.find("#location-select-add-school-container"),this.$searchContainer=this.$el.find("#location-select-search-container")},showAddSchool:function(){this.$searchContainer.hide(),this.$addSchoolContainer.show(),this.model.clearChosenLocation(),this.emptyManualInput()},skipLocationSelect:function(){this.model.clearLocations(),this.setLocationBarSelected("No School"),$("#school-name").val("No School"),$("#board-name").val("No Board")},showSearchBar:function(){this.$searchContainer.show(),this.$addSchoolContainer.hide(),this.emptyManualInput()},emptyManualInput:function(){this.$("#school-name").val(""),this.$("#board-name").val("")},renderBase:function(){var e=this.model.toJSON();this.$el.html(this.template.base(e))},renderSearch:function(){var e=this.model.toJSON(),t=this.template.search(e);this.$el.find("#location-select-input-container").html(t)},renderResults:function(){var e=this.model.toJSON(),t=this.template.results(e);this.hideSpinner(),this.model.get("locations").length>2?this.showAddSchoolHint():this.$addSchoolHint&&this.showSkipHint(),this.$el.find("#location-select-results-container").html(t)},renderAddSchool:function(){var e=this.model.toJSON(),t=this.template.add(e);this.$el.find("#location-select-add-school-container").html(t)},submitLocation:function(){this.isValid()?(sw.track.milestone("Location Selected"),this.model.getLocation()?this.model.saveLocation():this.model.saveManualLocation($("#school-name").val(),$("#board-name").val()),this.trigger("submit:complete")):this.renderWarning()},isValid:function(){return this.model.getLocation()||SW.Validate.name(this.$("#school-name").val())&&SW.Validate.name(this.$("#board-name").val())},render:function(){return this.renderBase(),this.renderSearch(),this.renderResults(),this.renderAddSchool(),this.cacheSelections(),this.$el},renderWarning:function(){this.$el.addClass("location-select--warning")},removeWarning:function(){this.$el.removeClass("location-select--warning")}}),SW.CurriculumSelectView=SW.ParentView.extend({initialize:function(e){var t="curriculum-select";this._super("initialize",arguments),_.isObject(e)&&e.template&&(t+="-"+e.template),this.template=this.findTemplate(t)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el}}),SW.CurriculumSelect=SW.Model.extend({defaults:{showLabel:!0}}),SW.AppPage=SW.Model.extend({defaults:{settings:{navigation:{},page:{},footer:{}},assets:{images:void 0},error:{title:"Oh no!",description:"Something seems to have gone wrong and the page was unable to load. Make sure you have an Internet connection and let's try again!",imgSrc:"/assets/images/ed/@2x/ed-fail@2x.png"}},initialize:function(){this._super("initialize"),this.isLoading=!1},load:function(){this.beforeLoad()},beforeLoad:function(){this.isLoading=!0,this.trigger("loading:started")},makeBreadcrumbs:function(e){var t=window.location.hash.replace(/\?.*/,"").split("/").map(function(e,t,i){return{href:i.slice(0,t+1).join("/"),text:e.split(/#|\//).join("").split("-").join(" ")}});return e.depth&&(t=_.take(t,e.depth)),t}}),SW.AppPageView=SW.ParentView.extend({className:"app-page",events:{"click .js-page-reload-btn":"reloadPage","click .js-video-btn":"handleOpenVideoLightbox","click .js-breadcrumb":"trackBreadcrumbClick"},initialize:function(){this._super("initialize"),this.template={base:this.findTemplate("app-page-base"),error:this.findTemplate("app-page-error"),breadcrumb:this.findTemplate("breadcrumb"),page:void 0},this.$page=void 0,this.isloading=!1,this.hasError=!1,this.isHintOpen=!1,this.isModalOpen=!1,this.preloadAssets(),this.listenTo(this.model,"loading:started",this.setLoadingState),this.listenTo(this.model,"loading:completed",this.setLoadedState),this.listenTo(this.model,"loading:failed",this.setErrorState),this.listenTo(sw.dispatcher,"error:conflict",this.sessionTimeout),this.listenTo(sw.user.classes,"remove-class:start",this.createLoadingDialog),this.listenTo(sw.user.classes,"remove-class:success",this.handleClassRemoval),this.listenTo(sw.user.classes,"remove-class:fail",this.handleClassRemovalFail)},preloadAssets:function(){var e=this.model.get("assets");_.isObject(e)&&e.images&&SW.Utility.preloadImages(e.images)},sessionTimeout:function(){this.renderModalWith({heading:"Oops, something went wrong!",main:"<p>Your login session has expired. Please log in again.</p>",buttons:[{name:"Okay",classList:"btn btn-primary btn-modal",callback:"forceLogout"}]})},forceLogout:function(){sw.user.logout()},renderInitialState:function(){this.model.isLoading?this.setLoadingState():this.setLoadedState()},cleanState:function(){this.removeLoader()},setLoadingState:function(){this.cleanState(),this.renderLoader()},setLoadedState:function(){this.cleanState(),this.renderPage()},setErrorState:function(){this.cleanState(),this.renderError()},setTutorialState:function(){},render:function(){return this.renderBase(),this.renderInitialState(),this.$el},renderBase:function(){var e=this.model.toJSON();return e.hasPageNav=e.settings.navigation.page,this.$el.html(this.template.base(e)),this.cacheSelections(),this.$el},renderPage:function(){},renderError:function(){var e=this.model.get("error");this.$page.html(this.template.error(e))},renderLoader:function(){this.childViews.loader=new SW.LoadingIconView,this.$page.html(this.childViews.loader.render())},setPageGutter:function(){this.$page.addClass("app-section")},cacheSelections:function(){this.$page=this.$el.find(".app-page__main")},reloadPage:function(){this.model.load()},handleClassRemoval:function(e){var t=e&&e.name?"<b>"+e.name+"</b> was removed successfully.":"Your class was removed.";this.closeDialog(),_.delay(function(){sw.toastManager.create({type:"success",content:t,timer:8e3})}),this.model.isClassPage&&sw.app.navigate("classes",{trigger:!0})},handleClassRemovalFail:function(e){var t=e&&e.name?"Removing <b>"+e.name+"</b> class failed. Please try again.":"Removing your class failed. Please try again.";this.closeDialog(),_.delay(function(){sw.toastManager.create({type:"error",content:t,timer:8e3})})},handleOpenVideoLightbox:function(e){var t,i=$(e.target);return i.hasClass("js-video-btn")||(i=i.parents(".js-video-btn")),t=i.attr("href"),this.createVideoLightbox(t),!1},createVideoLightbox:function(e){new SW.LightboxView({model:new SW.Model({src:e,controls:{close:!0}})})},trackBreadcrumbClick:function(e){sw.track.event("navigation","breadcrumb:click","report")},renderModalWith:function(e){this.createModal(),this.childViews.modal.model.set("content",e),this.isModalActive=!0},createModal:function(){var e=this;this.childViews.modal||(this.childViews.modal=new SW.ModalView({parentView:e,model:new SW.Model({content:void 0})}))},removeModal:function(){this.stopListening(this.childViews.modal),this.childViews.modal.close(),this.childViews.modal=null,this.isModalActive=!1},createLoadingDialog:function(){this.createDialog({type:"load"})},removeLoader:function(){this.childViews.loader&&(this.childViews.loader.close(),this.childViews.loader=null)},renderBreadcrumbs:function(e){var t=e||{},i=t.data||this.model.makeBreadcrumbs(t),s=i.pop(),n=this.template.breadcrumb({breadcrumbs:i,currentBreadcrumb:s});this.$(".js-app-page-breadcrumbs").html(n)}}),SW.Dashboard=SW.AppPage.extend({initialize:function(){this._super("initialize"),this.load(),this.set("isParent",sw.user.isParent())},load:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.classes,sw.user.students,sw.user.tutorials],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(e){this.set("classCode",sw.user.classes.getCurrentClass().get("classCode")),this.trigger("loading:completed")},handleLoadFailure:function(e){this.trigger("load:failed")}}),SW.DashboardView=SW.AppPageView.extend({events:function(){return _.extend({},SW.AppPageView.prototype.events,{"click .js-add-students-button":"openAddStudentsModal"})},initialize:function(){this._super("initialize"),this.template.tutorial=this.findTemplate("dashboard-tutorial"),this.template.emptyClass=this.findTemplate("empty-class-dashboard"),this.isUsingSampleData=!1,this.isModalActive=!1,this.childViews.widgets=[]},renderPage:function(){1===sw.user.classes.getCurrentClass().students.length?(this.renderDefaultDashboard(),this.$page.append($('<h2 class="app-section row-lg row-collapse-t text-center text-bold">Still have a question? We&#39;re here to help.</h2><div class="clearfix context"><div class="js-qa-container-1 dash-question-column"></div><div class="js-qa-container-2 dash-question-column"></div></div>')),this.renderTutorialQuestions()):sw.user.classes.getCurrentClass().students.length>1?this.renderDefaultDashboard():this.renderTutorial()},renderTutorial:function(){sw.splitTest.addStudents()?(SW.Logger.track("new-class:init"),this.$page.append(this.template.emptyClass)):(this.$page.append(this.template.tutorial(this.model.toJSON())),this.renderTutorialQuestions())},renderTutorialQuestions:function(){var e=this,t=[];t.push({startOpen:!1,imgSrc:"/assets/images/svg/wand.svg",question:"Can I see what the game looks like?",answer:"Of course! We've made a short video that outlines what your "+SW.Lexicon("students")+" will see when they play the game, and also explores some of the math features, including on-screen manipulatives!",linkText:"Watch our video!",linkCallback:function(){this.createVideoLightbox(" //play.vidyard.com/wRFu1RxmHSX12PFghW7gw4.html?v=3.1.1&autoplay=1")}.bind(this)}),sw.user.isParent()?t.push({startOpen:!1,imgSrc:"/assets/images/svg/girl.svg",question:"How do I add my child to my account?",answer:"Visit the <a href='/dashboard#students' target='_blank'>Child Accounts</a> page and click the 'add children' button. You will be asked to create a new child account or add an existing account. If your child already has an account you will need to input your child's account name and password, so make sure to get that information from them first!"}):t.push({startOpen:!1,imgSrc:"/assets/images/svg/girl.svg",question:"How do I add students to my class?",answer:"Students are added to your class list automatically by entering your class code ("+sw.user.classes.getCurrentClass().get("classCode")+") when they register. If a student changes classes, they can change their code immediately after logging in."}),t.push({startOpen:!1,imgSrc:"/assets/images/svg/imac.svg",question:"What devices can we play Prodigy on?",answer:SW.Lexicon("Students")+' can play Prodigy on any device with an Internet browser, including your computers or tablets, just by going to prodigygame.com/play. <a href="https://prodigygame.zendesk.com/hc/en-us/articles/200801559-Supported-Platforms" target="_blank">Older devices</a> may experience performance issues when playing.'}),t.push({startOpen:!1,imgSrc:"/assets/images/svg/clipboard.svg",question:"What does my class code do?",answer:"Your class code is used to get "+SW.Lexicon("students")+" onto your class list. Instead of adding each "+SW.Lexicon("student")+" manually, they can enter your class code when they first start Prodigy and be automatically put on your list!"}),t.push({startOpen:!1,imgSrc:"/assets/images/svg/data.svg",question:"What kind of data will I get?",answer:"As your "+SW.Lexicon("students")+" play Prodigy, your dashboard will automatically fill up with data such as which skills your "+SW.Lexicon("students")+" are struggling on, how much of the curriculum they've covered, and more!"}),sw.user.isParent()||t.push({startOpen:!1,imgSrc:"/assets/images/svg/help.svg",question:"Do I need to involve IT or my principal?",answer:"Not at all! Prodigy is free, and doesn't require any technical setup to get started. You can simply take your class to the lab, point them to prodigygame.com/play, and they'll be playing in minutes!"}),t.push({startOpen:!1,imgSrc:"/assets/images/svg/placement.svg",question:"How does the placement test work?",answer:"Our placement test starts immediately and runs in the background as the game is played. It begins at two grades below the grade that your "+SW.Lexicon("student")+" selected, and then works upwards to determine where your "+SW.Lexicon("student's")+" grade level really is. After the test ends, our curriculum continues to adapt, revisiting pre-requisites or jumping ahead depending on how your "+SW.Lexicon("student")+" performs."}),t.push({startOpen:!1,imgSrc:"/assets/images/svg/browser.svg",question:"What do I need to do next?",answer:"The next thing you should do is get your "+SW.Lexicon("students")+" on Prodigy! Simply follow the 3 steps at the top of this page, and you'll have your "+SW.Lexicon("students")+" mastering math in minutes!"}),t.forEach(function(t,i){var s=(i+1)%2?this.$(".js-qa-container-1"):this.$(".js-qa-container-2");e.childViews["question"+i]=new SW.DashQuestionView({model:new SW.Model({startOpen:t.startOpen,imgSrc:t.imgSrc,question:t.question,answer:t.answer,linkText:t.linkText,linkCallback:t.linkCallback})}),s.append(e.childViews["question"+i].render())}.bind(this))},renderDefaultDashboard:function(){this.createWidgets(),this.renderPageWidgets()},createWidgets:function(){var e={footerLink:{text:""}};this.childViews.widgets.length<1&&(sw.user.isEligibleForActivityGoals()?this.childViews.widgets=[new SW.ActivityGoalWidgetView({model:new SW.ActivityGoalWidget}),new SW.LeaderboardWidgetView({model:new SW.LeaderboardWidget(e)}),new SW.PlannerWidgetView({model:new SW.PlannerWidget(e)}),new SW.QuestionsWidgetView({model:new SW.QuestionsWidget}),new SW.InfluencerWidgetView({model:new SW.InfluencerWidget(e)}),new SW.AssignmentWidgetView({model:new SW.AssignmentWidget}),new SW.GradeComparisonWidgetView({model:new SW.GradeComparisonWidget(e)}),new SW.StrugglingWidgetView({model:new SW.StrugglingWidget})]:this.childViews.widgets=[new SW.QuestionsWidgetView({model:new SW.QuestionsWidget}),new SW.LeaderboardWidgetView({model:new SW.LeaderboardWidget(e)}),new SW.PlannerWidgetView({model:new SW.PlannerWidget(e)}),new SW.InfluencerWidgetView({model:new SW.InfluencerWidget(e)}),new SW.AssignmentWidgetView({model:new SW.AssignmentWidget}),new SW.GradeComparisonWidgetView({model:new SW.GradeComparisonWidget(e)}),new SW.StrugglingWidgetView({model:new SW.StrugglingWidget})])},renderPageWidgets:function(){var e=$('<div class="clearfix">');this.childViews.widgets.forEach(function(t){e.append(t.render())}),this.$page.append(e)},renderResetClassModal:function(){this.renderModalWith({heading:"Reset Class",main:"<p class='text-left'>It looks like you had a class of students on Prodigy last year. Would you like us to remove them from this year's class&nbsp;list?</p><p class='small text-left'><b>Note</b>: These students will still be able to use their accounts, you just won't get updated on their&nbsp;progress.</p>",buttons:[{name:"Reset class",classList:"btn btn-primary btn-modal",callback:"resetClassList"},{name:"No thanks",classList:"btn btn-ghost-secondary btn-modal",callback:"removeModal"}]})},renderResetClassLoadingModal:function(){this.renderModalWith({heading:"Reset Class",loadingSpinner:!0})},renderResetClassSuccessModal:function(){this.renderModalWith({heading:"Reset Class",main:"<p class='text-left'>Your class has been successfully reset!</p><p class='text-left'>Your new students can use your class code to add themselves to your new list.</p>",buttons:[{name:"Okay!",classList:"btn btn-primary btn-modal",callback:"refreshPage"}]})},refreshPage:function(){location.reload()},renderResetClassFailedModal:function(){this.renderModalWith({heading:"Reset Class",main:"<p class='text-left'>Oh no! Something went wrong and we weren't able to complete the request.</p>",buttons:[{name:"Try again?",classList:"btn btn-primary btn-modal",callback:"resetClassList"},{name:"Cancel",classList:"btn btn-ghost-secondary btn-modal",callback:"removeModal"}]})},resetClassList:function(){this.renderResetClassLoadingModal(),SW.Http.fetch({url:sw.config.api.web+"/v1/users/"+sw.user.get("userID")+"/licenses/old",method:"DELETE",data:{userID:sw.user.get("userID")},success:this.renderResetClassSuccessModal.bind(this),
error:this.renderResetClassFailedModal.bind(this)})},openAddStudentsModal:function(e){e.preventDefault(),SW.Logger.track("new-class:add-students-open"),dialog=this.createDialog({className:"dialog dialog--basic dialog--tall",type:"custom",size:"medium-small",children:[{view:SW.AddStudentsCardView,model:SW.AddStudentsCard}]})}}),SW.TutorialVersions={selected:"teacher:getting-started",getSelected:function(){return this._versions[this.selected]},setSelected:function(e){this._versions[e]&&(this.selected=e,sw.track.user("set",{"tutorial-test":e}))}},SW.TutorialVersions._versions={"parent:getting-started":{id:SW.Tutorials.INTRO,steps:[{url:"welcome",id:"TutorialWelcomeStep"}]},"teacher:getting-started":{id:SW.Tutorials.INTRO,steps:[{url:"welcome",id:"TutorialWelcomeStep"},{url:"create-class",id:"TutorialCreateClassStep"},{url:"create-plan",id:"TutorialCreatePlanStep"},{url:"location",id:"TutorialLocationStep"}]},"teacher:multiple-class-migration":{id:SW.Tutorials.MULTIPLE_CLASSES_MIGRATION,steps:[{url:"welcome",id:"MultipleClassesMigrationReviewStep",template:"tutorial-step-multiple-classes-migration-welcome"},{url:"review-class",id:"MultipleClassesMigrationReviewClassTutorialStep"},{url:"update-class",id:"MultipleClassesMigrationUpdateClassTutorialStep"}]},"teacher:multiple-class-migration-with-no-students":{id:SW.Tutorials.MULTIPLE_CLASSES_MIGRATION,steps:[{url:"welcome",id:"MultipleClassesMigrationReviewStep",template:"tutorial-step-multiple-classes-migration-welcome"},{url:"update-class",id:"MultipleClassesMigrationUpdateClassTutorialStep"}]}},SW.TutorialRouter=Backbone.Router.extend({routes:{tutorial:function(){sw.user.hasIncompleteCriticalTutorials()?this.openTutorialPage():this.leaveTutorial()},"tutorial/:stepName":function(){this.navigate("tutorial",{trigger:!0,replace:!0})}},initialize:function(){this.steps=[],this.listenTo(sw.dispatcher,"tutorial-router:start-tutorial-steps",this.initializeTutorialSteps),this.listenTo(sw.dispatcher,"tutorial-router:no-tutorial",function(){sw.dispatcher.trigger("navigate","classes")}),this.listenTo(sw.dispatcher,"tutorial-step:next",this.nextStep)},initializeTutorialSteps:function(e){this.steps=e,e.forEach(function(e,t){this.route("tutorial/"+e.url,function(){sw.user.hasIncompleteCriticalTutorials()?this.step(t):this.leaveTutorial()}.bind(this))}.bind(this)),this.navigate("tutorial/"+e[0].url,{trigger:!0,replace:!0})},step:function(e){this.openTutorialPage(),sw.dispatcher.trigger("tutorial-page:go-to-step",e)},openTutorialPage:function(){var e=!sw.appRootRegion.getAppPage()||"tutorial"!==sw.appRootRegion.getAppPage().model.get("settings").pageID;e&&(sw.app.setTutorialPage(),sw.support.chat.hideAll())},nextStep:function(e){var t=e+1;t<this.steps.length?this.navigateToStep(this.steps[t]):sw.dispatcher.trigger("tutorial-page:complete-tutorial")},navigateToStep:function(e){this.navigate("tutorial/"+e.url,{trigger:!0,replace:!0}),SW.Logger.pageView(e.url)},leaveTutorial:function(){sw.dispatcher.trigger("navigate","classes")}}),SW.TutorialPage=SW.AppPage.extend({defaults:function(){return _.extend({},SW.AppPage.prototype.defaults,{tutorialData:{isParent:sw.user.isParent()},tutorial:null})},initialize:function(){this._super("initialize"),this.load()},load:function(){this._super("load",arguments),this.setTutorialVersion()},setTutorialVersion:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.tutorials,sw.user.classes],success:this.setTutorialVersionSuccess.bind(this),fail:function(){this.isLoading=!1,this.trigger("loading:failed")}.bind(this)})},setTutorialVersionSuccess:function(){var e,t=!sw.user.tutorials.isCompleted(SW.Tutorials.INTRO),i=sw.user.isTeacher()&&sw.user.isReturningToMultipleClasses()&&!sw.user.tutorials.isCompleted(SW.Tutorials.MULTIPLE_CLASSES_MIGRATION);i?e=sw.user.classes.getCurrentClass().students.length>0?"teacher:multiple-class-migration":"teacher:multiple-class-migration-with-no-students":t&&(e=sw.user.get("usertype")+":getting-started"),e&&(SW.TutorialVersions.setSelected(e),this.set("tutorial",SW.TutorialVersions.getSelected())),this.isLoading=!1,this.trigger("loading:completed")}}),SW.TutorialPageView=SW.AppPageView.extend({initialize:function(){this.steps={},this._super("initialize"),this.listenTo(sw.dispatcher,"tutorial-page:go-to-step",this.renderStep),this.listenTo(sw.dispatcher,"tutorial-page:complete-tutorial",this.completeTutorial)},setLoadedState:function(){var e=this.model.get("tutorial");e?(this._super("setLoadedState",arguments),sw.dispatcher.trigger("tutorial-router:start-tutorial-steps",this.model.get("tutorial").steps)):sw.dispatcher.trigger("tutorial-router:no-tutorial")},renderStep:function(e){var t=this.model.get("tutorial").steps[e];this.currentStep&&this.currentStep.close(),this.currentStep=this.steps[t.id]=this.initializeStep(t,e),this.$page.html(this.currentStep.render(this.model.get("tutorialData"))),scrollTo(0,0)},initializeStep:function(e,t){var i=this.steps[e.id],s=SW[e.id]||SW.TutorialStep,n=SW[e.id+"View"]||SW.TutorialStepView,a=i&&i.model?i.model:null;return new n({template:e.template,model:a||new s(_.extend({},e,{index:t,progress:{currentStep:t+1,totalSteps:this.model.get("tutorial").steps.length}}))})},completeTutorial:function(){var e=this.model.get("tutorial").id;sw.user.tutorials.isCompleted(e)?sw.app.navigate("#",{trigger:!0}):(SW.Logger.track("tutorial:complete"),sw.user.tutorials.save(e),this.listenToOnce(sw.user.tutorials,"add",function(){sw.app.navigate("#",{trigger:!0})}))},close:function(){this.currentStep&&this.currentStep.close(),this._super("close")}}),SW.Influencer=SW.AppPage.extend({defaults:function(){return _.extend({},SW.AppPage.prototype.defaults,{assets:{images:["/assets/images/ed/@1x/ed-stars@1x.png"]}})},initialize:function(){this._super("initialize"),this.load()},load:function(){this._super("load"),this.listenToOnce(sw.dispatcher,"user:load-influencer:success",this.loadComplete),sw.user.loadInfluencerData()},loadComplete:function(){this.trigger("loading:completed")}}),SW.InfluencerView=SW.AppPageView.extend({initialize:function(){this._super("initialize"),this.template.page=Handlebars.compile($("#influencer-page-template").html())},renderPage:function(){this.instantiateCards()},instantiateCards:function(){this.cards={sharing:null,userInfluence:null,leaderboard:null},this.cards.sharing=new SW.SharingCardView({model:new SW.SharingCard}),sw.user.influencer&&sw.user.influencer.get("referrals").length>0&&(this.cards.userInfluence=new SW.UserInfluenceCardView({model:new SW.UserInfluenceCard})),this.renderAllCards()},renderAllCards:function(){var e=this;_.forEach(this.cards,function(t){t&&e.$page.append(t.render())})}}),SW.Classes=SW.AppPage.extend({initialize:function(){this._super("initialize"),this.set({lang:{student:SW.Lexicon("student"),students:SW.Lexicon("students")},parentApp:sw.user.parentApp()}),this.load()},load:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(){this.trigger("loading:completed")},handleLoadFailure:function(){this.trigger("load:failed")}}),SW.ClassesView=SW.AppPageView.extend({events:function(){return _.extend({},SW.AppPageView.prototype.events,{"click .js-create-class":"openCreateClassDialog"})},initialize:function(){this._super("initialize"),this.template.empty=Handlebars.compile($("#classes-empty-template").html()),this.template.noneEmpty=Handlebars.compile($("#classes-none-empty-template").html()),this.listenTo(sw.user.classes,"reset add remove",this.renderPage),SW.Loader.whenLoaded({context:this,entities:[sw.user.tutorials],success:function(){sw.user.parentApp()&&!sw.user.tutorials.isCompleted(SW.Tutorials.PARENT_FIRST_ADD_STUDENT)&&this.listenToOnce(sw.dispatcher,"parent:student-added",function(e){_.delay(this.createParentTutorialTooltip.bind(this,e[0]),1e3)})}.bind(this)})},createClassPreviews:function(){_.isEmpty(this.childViews.classPreviews)||this.childViews.classPreviews.forEach(function(e){e.close()}),this.childViews.classPreviews=sw.user.classes.map(function(e){return new SW.ClassPreviewView({model:e})})},createParentTutorialTooltip:function(e){var t=$(".js-class-preview-manage").last(),i=SW.Utility.firstName(e.name);this.createTooltip({reference:t,node:{classNames:"tooltip--tutorial tooltip--fade-in tooltip--margin-md",content:"Now that <b>"+i+"</b> is connected to your account you can stay informed about what they are learning in Prodigy anytime you like. Let's take a&nbsp;look!"},options:{placement:"right",flipBehavior:["right","bottom","top"]}}),t.click(function(){sw.user.tutorials.save(SW.Tutorials.PARENT_FIRST_ADD_STUDENT)})},renderPage:function(){this.determineClassesState(),sw.user.parentApp()&&this.renderBreadcrumbs()},determineClassesState:function(){sw.user.classes.length?this.renderNoneEmptyState():this.renderEmptyState()},renderNoneEmptyState:function(){var e,t=this.template.noneEmpty();this.$page.html(t),e=this.$page.find(".js-class-preview-container"),this.createClassPreviews(),this.childViews.classPreviews.forEach(function(t){e.append(t.render()),t.delegateEvents()})},renderEmptyState:function(){var e=this.template.empty(this.model.toJSON());this.setPageGutter(),this.$page.html(e)},openCreateClassDialog:function(){sw.user.parentApp()?sw.dialogManager.openAttachKid():sw.dialogManager.openCreateClass()}}),SW.StudentsPage=SW.AppPage.extend({defaults:function(){return _.extend({},SW.AppPage.prototype.defaults,{feature:{parentLetters:!0,connectParents:!0},selectedStudentsCount:0})},initialize:function(){this._super("initialize"),this.isClassPage=!0,this.toggleFeatures(),this.load()},toggleFeatures:function(){var e=sw.user.isParent();this.set("feature",{parentLetters:!e,connectParents:!e,parentCopy:e})},load:function(){this.classModel=null,SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(){this.classModel=this.getClassModel(),this.listenToOnce(sw.user.classes,"reset",this.handleLoadSuccess),this.trigger("loading:completed")},handleLoadFailure:function(){this.trigger("loading:failed")},getClassModel:function(){return sw.user.classes.getCurrentClass()}}),SW.StudentsPageView=SW.AppPageView.extend({events:function(){return _.extend({},SW.AppPageView.prototype.events,{"click .js-add-students":"openAddStudentDialog","click .js-connect-parents":"openConnectParentsDialog","click .js-share-class":"openShareClassDialog","click .js-edit-class":"openEditClassDialog","click .js-print-login-info":"trackPrintLogin","click .js-get-parent-letters":"trackGetParentLetters","click .js-move-students":"handleMoveStudents","click .js-remove-students":"handleRemoveStudents","click .js-selection-btn":"handleSelectionButton"})},initialize:function(){this._super("initialize"),this._studentsLength=0,this.template.page=Handlebars.compile($("#students-page-template").html()),this.listenTo(this.model,"change:selectedStudentsCount",this.updateSelectionBtnText),this.listenTo(sw.dispatcher,"student-preview:selection",this.updateSelectedStudentsCount)},setLoadedState:function(){this._studentList=this.model.classModel.students,this.childViews.studentPreviews=this._studentList.map(this.instantiateStudentPreview),this.listenTo(this._studentList,"reset",this.resetStudentPreviews),this.listenTo(this._studentList,"add",this.addStudentPreview),this.listenTo(this._studentList,"remove",this.removeStudentPreview),this.listenTo(this.model.classModel,"change",this.renderPage),this.listenTo(this.model.classModel,"remove-students:loading",this.createLoadingDialog),this.listenTo(this.model.classModel,"remove-students:complete",this.closeDialog),this._super("setLoadedState")},resetStudentPreviews:function(e){this.closeAllStudentPreviews(),this.childViews.studentPreviews=e.map(this.instantiateStudentPreview),this.renderPage()},closeAllStudentPreviews:function(){this.childViews.studentPreviews.forEach(function(e){e.close()})},addStudentPreview:function(e,t){var i=[],s=this.childViews.studentPreviews.length,n=this.instantiateStudentPreview(e),a=_.findIndex(t.toArray(),function(t){return t.cid===e.cid});this.childViews.studentPreviews.splice(a,0,n),0===s?this.renderPage():0===a?this.$(".js-student-container").prepend(n.render()):(i=this.$(".js-student-container .student-preview:nth-child("+a+")"),i.length>0?i.after(n.render()):this.$(".js-student-container").append(n.render()))},removeStudentPreview:function(e){var t=_.findIndex(this.childViews.studentPreviews,function(t){return t.model.cid===e.cid}),i=this.childViews.studentPreviews.splice(t,1)[0];i.close(),0===this.childViews.studentPreviews.length&&this.renderPage()},instantiateStudentPreview:function(e){return new SW.StudentPreviewView({model:e})},handleSelectionButton:function(){var e=this.getSelectedStudents();e.length?this.deselectStudents(e):this.selectAllStudents()},getSelectedStudents:function(){var e=this.childViews.studentPreviews.filter(function(e){return e.isSelected});return e},deselectStudents:function(e){e.forEach(function(e){e.deselect()})},selectAllStudents:function(){this.childViews.studentPreviews.forEach(function(e){e.select()})},updateSelectedStudentsCount:function(e){var t=e?1:-1,i=this.model.get("selectedStudentsCount")+t;this.model.set("selectedStudentsCount",i)},updateSelectionBtnText:function(){var e;e=this.model.get("selectedStudentsCount")>0?"Deselect All":"Select All",this.$(".js-selection-btn").html(e)},renderPage:function(){var e,t=this.model.getClassModel(),i=_.extend({},t.toJSON(),this.model.toJSON());i.isParent=sw.user.isParent(),i.students=this.childViews.studentPreviews.length,i.curriculum=sw.user.getCurriculumByID(i.curriculumID),e=this.template.page(i),this.setPageGutter(),this.$page.html(e),this.renderStudents()},renderStudents:function(){var e=this.$(".js-student-container");this.childViews.studentPreviews.forEach(function(t){e.append(t.render()),t.delegateEvents()})},disableSelectionBtns:function(){this.$(".js-remove-students, .js-move-students").addClass("disabled")},enableSelectionBtns:function(){this.$(".js-remove-students, .js-move-students").removeClass("disabled")},openAddStudentDialog:function(){var e=sw.user.isParent()?"children":"students";sw.splitTest.addStudents()?dialog=this.createDialog({className:"dialog dialog--basic dialog--tall",type:"custom",size:"medium-small",children:[{view:SW.AddStudentsCardView,model:SW.AddStudentsCard}]}):this.createDialog({className:"dialog dialog--add-students",type:"shell",title:"Add your "+e,headerClassName:"row-collapse-b",size:"medium-small",children:[{view:SW.AddStudentsView,model:SW.AddStudents,modelData:{classID:sw.user.classes.getCurrentClassID()}}]})},openConnectParentsDialog:function(){this.createDialog({type:"shell",title:"Keep parents informed!",headerClassName:"text-center row-collapse-b",size:"medium",children:[{view:SW.ConnectParentsView,model:SW.ConnectParents,modelData:{classID:sw.user.classes.getCurrentClassID()}}]})},openShareClassDialog:function(){alert("Share class dialog does not exist yet!")},openEditClassDialog:function(){sw.dialogManager.openEditClass(this.model.getClassModel())},handleMoveStudents:function(){this.manipulateSelectedStudents(this.moveSelectedStudents.bind(this),"move")},handleRemoveStudents:function(){this.manipulateSelectedStudents(this.confirmRemoveStudents.bind(this),"remove")},manipulateSelectedStudents:function(e){var t=sw.user.isParent()?"child":"student",i=this.getSelectedStudents();i.length?e(i):sw.toastManager.create({id:"no-students-selected",type:"warning",content:"Oops, you need to select a "+t+" first!",timer:5e3})},moveSelectedStudents:function(e){var t=this.getStudentCopy();this.createDialog({type:"confirmation",size:"medium-small",title:"Move "+t.plural,buttons:[{text:"Cancel"},{text:"Save changes",className:"btn-flat--blue"}],children:[{view:SW.MoveStudentsView,model:SW.MoveStudents,modelData:{students:e,curentClassID:sw.user.classes.getCurrentClassID()}}]})},confirmRemoveStudents:function(e){var t,i,s,n=e.length,a=this.getStudentCopy();n===this.childViews.studentPreviews.length?(t="Remove all "+a.plural,s="Are you sure you want to remove all "+a.plural+" from the class?"):n>1?(t="Remove "+a.plural,s="Are you sure you want to remove these "+n+" "+a.plural+" from the class?"):(t="Remove "+a.singular,s="Are you sure you want to remove this "+a.singular+" from the class?"),i=t,this.createDialog({type:"confirmation",title:t,main:s,buttons:[{text:"Cancel"},{text:i,className:"btn-flat--warning",callback:function(){this.removeSelectedStudents(e)}.bind(this)}]})},getStudentCopy:function(){var e=sw.user.isParent();return{singular:e?"child":"student",plural:e?"children":"students"}},removeSelectedStudents:function(e){var t=e.map(function(e){return e.model});sw.user.classes.getCurrentClass().removeStudents(t)},createLoadingDialog:function(){this.createDialog({type:"load"})},trackPrintLogin:function(){sw.track.event("students-page","print-logins")},trackGetParentLetters:function(){sw.track.event("students-page","get-parent-letters")}}),SW.StudentProfilePage=SW.AppPage.extend({initialize:function(){this._super("initialize"),this.load()},load:function(){this._super("load"),this.stopListening(this.studentModel),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(){this.classroomModel=sw.user.classes.getCurrentClass(),this.studentModel=this.classroomModel.students.at(0),this.isLoading=!1,this.listenTo(this.studentModel,"change",function(){this.trigger("student:change")}),this.trigger("loading:completed")},handleLoadFailure:function(){this.isLoading=!1,this.trigger("loading:failed")}}),SW.StudentProfilePageView=SW.AppPageView.extend({className:SW.AppPageView.prototype.className+" student-profie-page",events:{"click .js-edit-account-btn":"onClickEditAccount","click .js-view-reports-btn":"onClickViewReports"},initialize:function(){this._super("initialize",arguments),this._hasParentFirstPageviewBeenOpened=!1,this.template.page=this.findTemplate("student-profile"),this.template.pageHeader=this.findTemplate("student-profile-header"),this.template.parentDialog=this.findTemplate("reports-page-parent-dialog"),this.childViews.widgets=[],this.listenTo(this.model,"student:change",this.renderHeader)},setLoadedState:function(){this._super("setLoadedState",arguments),this.createWidgets(),this.renderWidgets(),SW.Loader.whenLoaded({context:this,entities:[sw.user.tutorials],success:this.loadParentAppTutorialsSuccess.bind(this)})},createWidgets:function(){var e=sw.user.classes.getCurrentClass(),t=e.students.at(0),i=t&&t.get("grade");_.isEmpty(this.childViews.widgets)&&(this.childViews.widgets=[new SW.TopicOverviewWidgetView({className:SW.TopicOverviewWidgetView.prototype.className+" dash-widget--md",model:new SW.TopicOverviewWidget({classroomID:e.get("id"),student:e.students.at(0)})}),new SW.QuestionsWidgetView({className:"questions-widget dash-widget--sm",model:new SW.QuestionsWidget}),new SW.GradeMasteryWidgetView({className:"grade-mastery-widget dash-widget--sm dash-widget--right",model:new SW.GradeMasteryWidget({classroomID:e.get("id"),currentGrade:i})})])},loadParentAppTutorialsSuccess:function(){this._hasParentFirstPageviewBeenOpened||sw.user.tutorials.isCompleted(SW.Tutorials.PARENT_FIRST_STUDENT_PROFILE_PAGEVIEW)||_.delay(this.createParentTutorialDialog.bind(this),1e3)},createParentTutorialDialog:function(){var e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),t=SW.Utility.firstName(e.name);this._hasParentFirstPageviewBeenOpened=!0,this.createDialog({type:"custom",main:this.template.parentDialog({studentName:t})}),this.listenTo(sw.dispatcher,"dialog:close",function(){sw.user.tutorials.save(SW.Tutorials.PARENT_FIRST_STUDENT_PROFILE_PAGEVIEW)})},renderPage:function(){var e=this.model.studentModel.toJSON();return this.$page.html(this.template.page()),this.renderHeader(),this.renderWidgets(),this.renderBreadcrumbs({data:[{href:"#my-kids",text:"My Kids"},{href:"#profile",text:SW.Utility.firstName(e.fullname)}]}),this.$el},renderHeader:function(){var e=this.model.studentModel.toJSON();e.firstName=SW.Utility.firstName(e.name),this.$(".js-student-page-header").html(this.template.pageHeader({student:e}))},renderWidgets:function(){var e=this.$(".js-student-page-content");this.childViews.widgets.forEach(function(t){e.append(t.render())})},onClickEditAccount:function(){sw.dialogManager.openEditClass(this.model.classroomModel)},onClickViewReports:function(){sw.user.classes.changeCurrentClass(this.model.classroomModel.get("id")),sw.dispatcher.trigger("navigate","reports")}}),SW.MembershipsPage=SW.AppPage.extend({initialize:function(){this._super("initialize"),sw.user.memberships.load(),this.load()},load:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.memberships],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(e){this.trigger("loading:completed")},handleLoadFailure:function(e){this.trigger("loading:failed")}}),SW.MembershipsPageView=SW.AppPageView.extend({initialize:function(){this._super("initialize"),this.template.page=this.findTemplate("memberships-page"),this.childViews.memberships=new SW.MembershipsView({collection:sw.user.memberships})},renderPage:function(){var e=this.template.page();this.$page.html(e),this.setPageGutter();var t=sw.user.memberships.where({licenseeID:0,expired:!1}).length;t&&sw.toastManager.create({id:"unassignedMembershipWarning",type:"warning",content:"You have <b>"+t+"</b> unassigned "+SW.Utility.pluralizer("membership","memberships",t)+".",timer:1e4}),this.renderMemberships()},renderMemberships:function(){var e=this.childViews.memberships.render();this.$(".js-memberships-container").append(e)}}),SW.MembershipClaim=SW.Model.extend({submit:function(e){var t=this;this.set("studentID",e),SW.Http.fetch({method:"POST",url:sw.config.api.web+"/v1/user/"+sw.user.get("userID")+"/redeempoints?rewardID=1",data:{licenseeID:e,userID:sw.user.get("userID")},success:function(e){t.trigger("claim:success")}.bind(this),error:function(){t.trigger("claim:fail")}})}}),SW.MembershipClaimView=SW.ParentView.extend({initialize:function(){this._super("initialize"),this.listenTo(this.model,"claim:success",this.claimSuccess),this.listenTo(this.model,"claim:fail",this.claimFail),this.open()},open:function(){var e,t="<select class='js-membership-claim__student-select membership-claim__student-select'><option value='0'>Choose a student</option>";sw.user.classes.getAllStudents("Array").forEach(function(e){t+="<option value='"+e.get("userID")+"'>"+e.get("name"),e.get("isMember")&&(t+=" (already a member)"),t+="</option>"}),t+="</select>",e=this.createDialog({type:"custom",className:"dialog-figure dialog-figure--left",template:"figure-dialog-template",size:"large",figure:{src:"/assets/images/ed/@1x/ed-stars@1x.png",alt:"Ed, arms raised in excitement with stars overhead."},title:"<span class='text-display--md'><span class='text--scales-more'>Congratulations!</span></span>",main:"<p class='text-left text--scales'>You have unlocked a 3-month membership for Prodigy! <span class='js-membership-claim-error'>Which student would you like to give it to?</span></p>"+t+"<small class='text-light'>Note: You can swap which student has the membership later</small>",buttons:[{text:"Choose later",className:"btn-flat--lg"},{text:"Give membership",className:"btn-flat--lg btn-flat--primary",callback:this.chooseStudentForMembership.bind(this)}]})},chooseStudentForMembership:function(){this.studentID=$(".js-membership-claim__student-select").val(),0==this.studentID?$(".js-membership-claim-error").addClass("text-danger text-bold"):(hasStudentId=!0,this.model.submit(parseInt(this.studentID)))},claimSuccess:function(){for(var e,t,i=sw.user.classes.getAllStudents("Array"),s=0;s<i.length;s++)i[s].id==this.studentID&&(t=i[s]);t.set("isMember",!0),e=this.createDialog({type:"alert",main:"<p>You've just made <strong>"+t.get("name")+"</strong> a Prodigy member! We're sure they're going to love&nbsp;it. <br /><br /><strong>Want another?</strong> Your next free membership is only one teacher away!</p>",buttons:[{text:"Okay",className:"btn-flat--primary",callback:sw.app.refresh}]})},claimFail:function(){this.createDialog({type:"alert",title:"Uh oh!",main:"<p>We couldn't claim your membership. Please check your Internet connection and try again in a few minutes.</p>",buttons:[{text:"Okay",className:"btn-flat--primary"}]})}}),SW.SharingCard=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{points:{min:0,max:20,current:0,percent:0},sharingLink:SW.Utility.getBaseUrl()+"/referral.php?referralCode="+sw.user.get("referralCode")+"&referralName="+sw.user.get("name")}})},initialize:function(){this._super("initialize"),this.handleSuccessfulLoad()},initializeSocialMediaContent:function(){var e=this.get("content").sharingLink;this.set("networks",{facebook:{u:e+"facebook"},twitter:{url:e+"twitter",text:"My class is loving this math game, I can't believe it's free!",via:"ProdigyGame",related:"ProdigyGame"},googlePlus:{url:e+"gplus"},pinterest:{url:e+"pinterest",media:window.location.origin+"/assets/images/mockups/game-preview.jpg",description:"My class is loving this math game, I can't believe it's free!"}})},handleSuccessfulLoad:function(){var e=sw.user.influencer.toJSON(),t=sw.user.influencer.get("unclaimedMemberships"),i=sw.user.influencer.get("claimedMemberships"),s=20,n=Math.floor(e.totalStudentsReferred/s)*s,a=n+s,r=e.totalStudentsReferred,o=(r-n)/s*100,l=sw.user.get("name").replace(/ /g,"%2B");this.set("content",{points:{min:n,max:a,current:SW.Utility.numberCommaFormat(r),totalStudents:r,unclaimedMemberships:t,claimedMemberships:i,totalMemberships:t+i,percent:o},sharingLink:SW.Utility.getBaseUrl()+"/referral.php?referralCode="+sw.user.get("referralCode")+"%26referralName="+l+"%26referralOrigin=",sharingCopyLink:SW.Utility.getBaseUrl()+"/referral.php?referralCode="+sw.user.get("referralCode")+"&referralName="+l+"&referralOrigin=link",showShareOptions:!SW.Device.isEdge()}),this.hasUnseenMemberships()&&t&&(this.get("content").points.min-=20,this.get("content").points.max-=20),this.initializeSocialMediaContent(),this.trigger("loading:completed")},hasUnseenMemberships:function(e){var t=SW.Storage.get("lastInfluencerRewardSeen"),i=t<this.get("content").points.totalMemberships;return!!i},updateLastMembershipSeen:function(){SW.Storage.set("lastInfluencerRewardSeen",this.get("content").points.totalMemberships)},handleFailedLoad:function(){this.trigger("loading:failed")}}),SW.SharingCardView=SW.WidgetView.extend({className:"card-influencer sharing-card",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-share-btn":"openShareWindow","click .js-membership-unlock-btn":"openMembershipUnlockModal","click .js-copy-text__btn":"trackLinkCopy"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#sharing-card-content-template").html())},renderContent:function(){var e=this.model.get("content");this.$contentContainer.html(this.template.content(e)),this.setProgress()},setProgress:function(){this.model.hasUnseenMemberships()&&this.model.get("content").points.unclaimedMemberships?_.delay(function(){this.model.updateLastMembershipSeen(),this.animateUnclaimedMembershipProgress()}.bind(this),800):_.delay(function(){this.animateProgress()}.bind(this),800)},animateProgress:function(){var e=this.$el.find(".js-progress-bar"),t=e.attr("data-width"),i=parseInt(t),s=i/40+(100-i)/100+"s";e.css("width","0%").animate({width:t},1e3*parseFloat(s))},animateUnclaimedMembershipProgress:function(){var e={unclaimed:[{min:this.model.get("content").points.min,max:this.model.get("content").points.max}]};this.animateUnclaimedMemberships(e,0)},animateUnclaimedMemberships:function(e,t){var i=this;$progBar=this.$el.find(".js-progress-bar"),width="98.5%",widthInt=parseInt(width),animDur=widthInt/40+(100-widthInt)/100+"s",$progBar.css("width","0%").animate({width:width},1e3*parseFloat(animDur),function(){t++,t<e.unclaimed.length?i.animateUnclaimedMemberships(e,t):i.openMembershipUnlockModal()})},openMembershipUnlockModal:function(){new SW.MembershipClaimView({model:new SW.MembershipClaim})},openShareWindow:function(e){var t=$(e.target),i="",s={},n=this.model.get("networks"),a=t.attr("data-share");switch(a){case"facebook":i="https://www.facebook.com/sharer/sharer.php",s=n.facebook;break;case"twitter":i="https://twitter.com/intent/tweet",s=n.twitter;break;case"google-plus":i="https://plus.google.com/share",s=n.googlePlus;break;case"pinterest":i="https://www.pinterest.com/pin/create/button",s=n.pinterest}i.length&&(sw.track.milestone("Share - Click Platform",{platform:a}),this.createSocialMediaWindow(i,s))},trackLinkCopy:function(){sw.track.milestone("Share - Click Platform",{platform:"link"})},createSocialMediaWindow:function(e,t){SW.SocialMedia.popup(e,t)}}),SW.UserInfluenceCard=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{areAllTeacherLoaded:!0,user:{teachers:void 0,students:void 0,points:void 0,memberships:void 0},teachers:[],additionalTeachers:[]}})},initialize:function(){this._super("initialize"),this.teachersShownOnLoad=4,this.load()},load:function(){this._super("load"),_.defer(function(){sw.user.influencer?this.handleSuccessfulLoad():(this.listenTo(sw.dispatcher,"user:load-influencer:success",this.handleSuccessfulLoad.bind(this)),this.listenTo(sw.dispatcher,"user:load-influencer:failed",this.handleFailedLoad.bind(this)))}.bind(this))},handleSuccessfulLoad:function(){var e=sw.user.influencer.toJSON(),t=this.get("content");that=this,t.user={teachers:SW.Utility.numberCommaFormat(e.referrals.length),students:SW.Utility.numberCommaFormat(e.totalStudentsReferred),points:SW.Utility.numberCommaFormat(e.totalPoints),memberships:e.totalMemberships},e.referrals.forEach(function(e){var i=that.formatRegisterDate(e.registerDate);t.teachers.push({name:e.name,id:e.userID,activeStudents:SW.Utility.numberCommaFormat(e.referralActiveStudents),points:SW.Utility.numberCommaFormat(e.referralPoints),memberships:Math.floor(e.referralPoints/50),registerDate:i})}),t.teachers.length>this.teachersShownOnLoad&&(t.additionalTeachers=t.teachers.splice(this.teachersShownOnLoad),t.areAllTeacherLoaded=!1),this.trigger("loading:completed")},formatRegisterDate:function(e){var t=new Date(e).toDateString().split(" ");return t.shift(),t=t.join(" ")},handleFailedLoad:function(){this.trigger("loading:failed")},loadAllTeachers:function(){var e=this.get("content"),t=e.additionalTeachers.splice(0,this.teachersShownOnLoad);setTimeout(function(){e.teachers=e.teachers.concat(t),e.additionalTeachers.length<1&&(e.areAllTeacherLoaded=!0),this.trigger("load-more-teachers:success")}.bind(this),750)},sendReminderTo:function(e){}}),SW.UserInfluenceCardView=SW.WidgetView.extend({className:"card-influencer user-influence-card",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-show-more":"loadMoreTeacherStats","click .js-send-reminder":"renderConfirmReminderModal"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#user-influence-card-content-template").html()),this.listenTo(this.model,"load-more-teachers:success",this.renderContent),this.listenTo(this.model,"load-more-teachers:fail",this.loadMoreTeacherStatsFailed),this.listenTo(this.model,"send-reminder:success",this.reminderSuccess),this.listenTo(this.model,"send-reminder:fail",this.reminderFail)},renderContent:function(){var e=this.model.get("content");parseInt(e.user.teachers)>0?this.$contentContainer.html(this.template.content(e)):this.close()},loadMoreTeacherStats:function(e){var t=$(e.target);
t.html("loading..."),this.model.loadAllTeachers()},loadMoreTeacherStatsFailed:function(){this.$el.find(".js-show-more").html('<span class="text-danger">Connection issue. Try again? <i class="fa fa-caret-down"></i></span>')},renderConfirmReminderModal:function(e){var t,i=$(e.target);this.teacherBeingReminded={name:i.attr("data-name"),id:i.attr("data-id")},t=this.createDialog({type:"confirmation",title:"Send Reminder",main:"<p class='text-left'>Would you like to send an email to <b>"+this.teacherBeingReminded.name+"</b> to remind them about setting up their students with&nbsp;Prodigy?</p>",buttons:[{text:"Cancel"},{text:"Send",className:"btn-flat--primary",callback:this.trySendingReminder.bind(this)}]})},trySendingReminder:function(){this.model.sendReminderTo(this.teacherBeingReminded),this.reminderSent()},reminderSent:function(){this.createDialog({type:"load",className:"text-center",title:"Sending Reminder"})},reminderSuccess:function(){this.createDialog({type:"alert",title:"Success!",main:"<p>Your reminder has been&nbsp;sent.</p>",buttons:[{text:"Okay"}]})},reminderFail:function(){this.createDialog({type:"confirmation",title:"Oh no, something went wrong!",main:"<p>We were not able to receive your request. Ensure you have an active Internet connection before trying&nbsp;again.</p>",buttons:[{text:"Cancel"},{text:"Try again",className:"btn-flat--primary",callback:this.trySendingReminder.bind(this)}]})}}),SW.InfluenceLeaderboardCard=SW.Widget.extend({defaults:function(){return _.extend({},SW.Widget.prototype.defaults,{content:{areAllTeacherLoaded:!0,teachers:[],additionalTeachers:[]}})},initialize:function(){this._super("initialize"),this.teachersShownOnLoad=4,this.trophiesHTML=['<span class="show-mobile-only">1</span><i class="hide-mobile trophy--gold fa fa-trophy"></i>','<span class="show-mobile-only">2</span><i class="hide-mobile trophy--silver fa fa-trophy"></i>','<span class="show-mobile-only">3</span><i class="hide-mobile trophy--bronze fa fa-trophy"></i>'],this.load()},load:function(){this._super("load"),SW.Http.fetch({url:sw.config.api.web+"/v1/user/topreferrers",dataType:"json",data:{userID:sw.user.get("userID")},success:function(e){this.handleSuccessfulLoad(e)}.bind(this),error:function(){this.handleFailedLoad()}.bind(this)})},handleSuccessfulLoad:function(e){_.isObject(e)&&_.isArray(e.topReferrers)?(this.configTeacherData(e.topReferrers),this.trigger("loading:completed")):this.handleFailedLoad()},configTeacherData:function(e){var t=this,i=_.forEach(e,function(e,i){i<t.trophiesHTML.length?e.rank=t.trophiesHTML[i]:e.rank=i+1,e.studentsReferred=SW.Utility.numberCommaFormat(e.sumRefs),e.points=SW.Utility.numberCommaFormat(10*e.sumRefs)}),s=i.splice(this.teachersShownOnLoad);s.length>0&&(this.get("content").areAllTeacherLoaded=!1),this.get("content").teachers=i,this.get("content").additionalTeachers=s},loadAllTeachers:function(){var e=this.get("content"),t=e.additionalTeachers.splice(0,this.teachersShownOnLoad);setTimeout(function(){e.teachers=e.teachers.concat(t),e.additionalTeachers.length<1&&(e.areAllTeacherLoaded=!0),this.trigger("load-more-teachers:success")}.bind(this),750)},handleFailedLoad:function(){this.trigger("loading:failed")}}),SW.InfluenceLeaderboardCardView=SW.WidgetView.extend({className:"card-influencer influence-leaderboard-card",events:function(){return _.extend({},SW.WidgetView.prototype.events,{"click .js-show-more":"loadMoreTeacherStats"})},initialize:function(){this._super("initialize"),this.template.content=Handlebars.compile($("#influence-leaderboard-card-content-template").html()),this.listenTo(this.model,"load-more-teachers:success",this.renderContent),this.listenTo(this.model,"load-more-teachers:fail",this.loadMoreTeacherStatsFailed)},renderContent:function(){var e=this.model.get("content");this.$contentContainer.html(this.template.content(e))},loadMoreTeacherStats:function(e){var t=$(e.target);t.html("loading..."),this.model.loadAllTeachers()},loadMoreTeacherStatsFailed:function(){this.$el.find(".js-show-more").html('<span class="text-danger">Connection issue. Try again? <i class="fa fa-caret-down"></i></span>')}}),SW.Notifications=SW.Model.extend({defaults:{isOpen:!1,numNewNotifications:0,notificationIconText:"",notifications:[],newNotificationIDs:[]},initialize:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.loadNotifications.bind(this),fail:function(){}})},toggle:function(){this.get("isOpen")?this.close():this.open()},open:function(){sw.track.user("increment",{"Notifications Open":1}),sw.track.event("notifications","open","",this.get("numNewNotifications")),this.set("isOpen",!0),this.setNumNewNotifications(0),this.saveReadStatus()},close:function(){this.set("isOpen",!1),this.setAllAsRead()},loadNotifications:function(){SW.Http.fetch({url:sw.config.api.notifications+"/v1/"+sw.user.get("userID"),dataType:"json",method:"GET",success:function(e){0!=this.get("notifications").length&&this.get("isOpen")||(this.set("notifications",this.processNotifications(e)),this.trigger("load:complete"))}.bind(this),error:function(){},complete:function(){setTimeout(this.loadNotifications.bind(this),6e4)}.bind(this)})},setNumNewNotifications:function(e){this.set("numNewNotifications",e);var t=e+"";e>=100&&(t="!"),this.set("counterClass","notifications__counter--single-digit"),t.length>1&&this.set("counterClass","notifications__counter--double-digit"),this.set("notificationIconText",t)},setAllAsRead:function(){this.get("notifications").forEach(function(e){e.isNew=!1,e.readStatusClass="notifications__item"})},saveReadStatus:function(){0!=this.get("newNotificationIDs").length&&SW.Http.fetch({url:sw.config.api.notifications+"/v1/notifications",method:"POST",_method:"PUT",data:{notificationIDs:this.get("newNotificationIDs").join(",")},success:function(e){}.bind(this),error:function(e,t,i){}})},processNotifications:function(e){var t={},i=[];return processedNotifications=[],this.setNumNewNotifications(0),e.forEach(function(e){var s;e.message.userID=parseInt(e.message.userID),e.date_created=parseInt(e.date_created),_.isNull(e.date_read)&&i.push(e.id),e.message.userID&&!sw.user.classes.findStudent(e.message.userID)||(e.localDate=new Date(e.date_created),s=SW.Utility.getDateString(e.localDate),t[s]||(t[s]={}),t[s][e.type]||(t[s][e.type]=[]),t[s][e.type].push(e))}),this.set("newNotificationIDs",i),Object.keys(t).forEach(function(e){Object.keys(t[e]).forEach(function(i){var s=this.combineNotifications(t[e][i]);s.description&&processedNotifications.push(s)},this)},this),processedNotifications},combineNotifications:function(e){var t={},i=e[0].type;return i.indexOf("assignment:complete")>=0?t=this.combineAssignmentCompleteNotifications(e):i.indexOf("placement-test:complete")>=0&&(t=this.combinePlacementTestCompleteNotifications(e)),t.numNewNotifications>0?(t.readStatusClass="notifications__item--new",this.setNumNewNotifications(this.get("numNewNotifications")+t.numNewNotifications)):t.readStatusClass="notifications__item",t},getCommonNotificationProperties:function(e){var t={numNewNotifications:0,latestNotificationDate:0,userIDs:[]};return e=_.sortBy(e,["localDate"],["desc"]),e.reverse(),e.forEach(function(e){e.localDate>t.latestNotificationDate&&(t.latestNotificationDate=e.localDate),_.isNull(e.date_read)&&t.numNewNotifications++,t.userIDs.push(e.message.userID)}),t.time=this.getTimeLabel(t.latestNotificationDate),t.subjects=this.getNotificationSubjects(t),t},getNotificationSubjects:function(e){var t=sw.user.classes.findStudent(e.userIDs[0]).get("name"),i=t;if(2==e.userIDs.length){var s=sw.user.classes.findStudent(e.userIDs[1]).get("name");i=t+" and "+s}else e.userIDs.length>2&&(i=t+" and "+(e.userIDs.length-1)+" others");return i},combineAssignmentCompleteNotifications:function(e){var t=this.getCommonNotificationProperties(e),i=e[0].message.skillID,s=e[0].message.assignmentID;return t.iconTypeClass="fa-check",t.iconColorClass="notifications__item-icon--success",t.description="completed an assignment",t.url="/assignments/report.php?id="+s+"&lock=1",t.eventClass="js-open-assignment",t.target="_blank",SW.Education.skills[i]&&(t.description+=" on",t.object=SW.Education.skills[i].name),t},combinePlacementTestCompleteNotifications:function(e){var t=this.getCommonNotificationProperties(e),i=e[0].message.grade;return t.iconTypeClass="fa-check",t.iconColorClass="notifications__item-icon--success",t.description="completed the placement test and ",t.eventClass="js-scroll-to-placement-test",1==t.userIDs.length?t.description+="was placed in ":t.description+="were placed in ",t.object="grade "+i,{}},getTimeLabel:function(e){var t=new Date,i=Math.floor((t-e)/36e5),s="";return s=i<1?"Less than 1 hour ago":i<24?i+" hours ago":i<48?"Yesterday":Math.floor(i/24)+" days ago"},trackNotificationClick:function(e){var t={};t["Notifications Click: "+e]=1,sw.track.user("increment",t),sw.track.user("increment",{"Notifications Click: Any":1}),sw.track.event("notifications","click",e)}}),SW.NotificationsView=SW.ParentView.extend({className:"notifications",events:{"click .js-toggle-notifications":"toggle","click .js-scroll-to-placement-test":"onPlacementTestNotificationClick","click .js-open-assignment":"trackOpenAssignment"},initialize:function(){this.template=Handlebars.compile($("#notifications-template").html()),this.listenTo(this.model,"load:complete",this.render),this.listenTo(sw.dispatcher,"body:click",this.checkBodyClick)},onPlacementTestNotificationClick:function(e){e.preventDefault(),this.model.trackNotificationClick("Placement Test"),this.close(),sw.appRootRegion.isAppPage("dashboard")?this.scrollToGradeComparionsWidget(e):(sw.dispatcher.trigger("navigate",""),_.defer(function(){this.scrollToGradeComparionsWidget(e)}.bind(this)))},scrollToGradeComparionsWidget:function(e){var t=parseInt($(e.target).parents(".js-notification-item").data("index"),10),i=this.model.get("notifications")[t].userIDs[0],s=$(".grade-comparison-widget").offset().top-50;sw.user.classes.getCurrentClass().students.findWhere({id:i})?$(document).scrollTop(s):(sw.user.classes.changeToClassWithStudents([i]),_.defer(function(){$(document).scrollTop(s)}))},trackOpenAssignment:function(){this.model.trackNotificationClick("Assignment")},checkBodyClick:function(e){var t=e.target.className.indexOf("js-toggle-notifications")==-1,i=0==$(e.target).parents(".js-notifications-container").length;t&&i&&this.closeIfOpen()},toggle:function(){this.model.toggle(),this.render()},close:function(){this.model.close(),this.render()},closeIfOpen:function(){this.model.get("isOpen")&&this.close()},render:function(){var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t)}}),SW.SkillsPage=SW.Page.extend({}),SW.SkillsPage.View=SW.PageView.extend({initialize:function(){this.curriculumID=SW.Static.regionCurriculumID||0,this.setup()},setup:function(){this.childViews={skillGroups:this.initSkillGroups()}},render:function(){return this.$el.html(this.childViews.skillGroups.render())},initSkillGroups:function(){var e=SW.Education.getCurriculumCodeFromTreeID(this.curriculumID),t=SW.Education.curricula[e][0].curriculumID;return new SW.SkillGroupCollectionView({collection:new SW.SkillGroupCollection,model:new SW.SkillGroupCollectionModel({curriculumTree:e,curriculumID:t,forcePublic:!0})})}}),SW.Planner=SW.AppPage.extend({defaults:function(){return _.extend({},SW.AppPage.prototype.defaults,{assets:{images:["/assets/images/svg/ed/ed-happy.svg","/assets/images/svg/ed/ed-calendar.svg"]}})},initialize:function(){this._super("initialize"),this.load()},load:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.classes,sw.user.tutorials],success:this.handleLoadSuccess.bind(this),loading:this.beforeLoad.bind(this),fail:this.handleLoadFailure.bind(this)})},handleLoadSuccess:function(e){this.trigger("loading:completed")},handleLoadFailure:function(e){this.trigger("loading:failed")}}),SW.PlannerView=SW.AppPageView.extend({events:function(){return _.extend({},SW.AppPageView.prototype.events,{"click #planner-create-plan-btn":"closeTooltip"})},initialize:function(){this._super("initialize"),this.template.tutorialDialog=Handlebars.compile($("#planner-dialog-template").html()),this.template.assignmentNoticeDialog=Handlebars.compile($("#assignment-notice-dialog-template").html())},setLoadedState:function(){this.initializePlannerCalendar(),this._super("setLoadedState")},initializePlannerCalendar:function(){this.childViews.calendar=new SW.PlannerCalendarView({enableSelection:!0,DayView:SW.PlannerCalendarDayView,DayModel:SW.PlannerCalendarDay,model:new SW.PlannerCalendar({layout:"weeks",dateRangeOffset:-7})})},initializeTutorials:function(){var e=sw.user.tutorials.isCompleted(SW.Tutorials.PLANNER_TOOL);e||_.defer(this.createTutorialDialog.bind(this))},createTutorialDialog:function(){var e=this.template.tutorialDialog({isParent:sw.user.isParent()});this.createDialog({type:"alert",size:"medium",main:e,buttons:[{text:"Get started",callback:this.completeTutorial.bind(this)}]})},completeTutorial:function(){sw.user.tutorials.save(SW.Tutorials.PLANNER_TOOL),_.delay(function(){var e=$("#planner-create-plan-btn");this.createTooltip({reference:e,node:{parent:e,classNames:"tooltip--dark tooltip--planner",content:"Let's get started!"}})}.bind(this),250)},createAssignmentNoticeDialog:function(){var e=this.template.assignmentNoticeDialog();this.createDialog({type:"alert",size:"medium",main:e,buttons:[{text:"Get started",callback:this.completeAssignmentNotice.bind(this)}]})},completeAssignmentNotice:function(){sw.track.milestone("Planner: assignment notice closed"),sw.user.tutorials.save(SW.Tutorials.ASSIGNMENTS_IN_PLANNER)},renderPage:function(){this.setPageGutter(),this.$page.append(this.childViews.calendar.render()),this.model.get("startCreation")&&(SW.Logger.track("planner:create:"+this.model.get("startCreation")),this.childViews.calendar.startItemCreation(this.model.get("startCreation")))}}),SW.TopicReportPage=SW.AppPage.extend({initialize:function(){this._super("initialize"),this._requiredDependencyCount=sw.user.parentApp()?2:1,this.load()},load:function(){this.isLoading||(this._super("load"),this._dependanciesLoaded=0,sw.user.parentApp()&&SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){this.set("curriculumID",sw.user.classes.getCurrentClass().get("curriculumID")),this.loadComplete()}.bind(this)}),this.listenToOnce(sw.dispatcher,"topic-report:load:complete",this.loadComplete))},loadComplete:function(){this._dependanciesLoaded+=1,this._dependanciesLoaded===this._requiredDependencyCount&&this.trigger("loading:completed")}}),SW.TopicReport=SW.Model.extend({defaults:{topics:[]},initialize:function(){SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.initialLoad.bind(this),fail:function(){}}),this.set({isParentApp:sw.user.parentApp()})},initialLoad:function(){this.get("defaultCurriculumID")||this.set("defaultCurriculumID",sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum()),this.setGradesForFiltering(),this.load()},load:function(){var e=this.get("selectedCurriculum");SW.Http.fetch({url:sw.config.api.planner+"/v1/classes/"+sw.user.classes.getCurrentClassID()+"/topic-report/"+e,dataType:"json",data:{userID:sw.user.get("userID")},success:function(e){e=this.formatReportData(e),this.set("topics",e),sw.dispatcher.trigger("topic-report:load:complete")}.bind(this),error:function(){sw.dispatcher.trigger("page:load:fail")}})},setGradesForFiltering:function(){var e=this.get("defaultCurriculumID"),t=_.cloneDeep(sw.user.get("curricula")),i=_.find(t,{curriculumID:e});i?i.selected=!0:e=t[0].curriculumID,this.set({curricula:t,selectedCurriculum:e})},isNewCurriculum:function(e){return this.get("selectedCurriculum")!=e},isFirstLoad:function(){return 0==Object.keys(this.get("topics")).length},getStudentResults:function(e,t){var i,s={correct:0,incorrect:0,grade:0};return this.get("topics").forEach(function(n){n.skills.forEach(function(n){n.skillID==t&&n.students.forEach(function(t){t.studentID==e&&(i=t.correct+t.incorrect,s.correct=t.correct,s.incorrect=t.incorrect,i>0?s.grade=(s.correct/i*100).toFixed(2):s.grade=0)})})}),s},getTopicNumberByName:function(e){var t,i;for(t=0;t<this.get("topics").length;t+=1)if(i=this.get("topics")[t],i.topicName==e)return i.topicNumber;return!1},formatReportData:function(e){var t=0;return e=_.sortBy(e,"topicName"),e.forEach(function(e){var i=0;e.topicNumber=t,e.numDangerSkills=0,e.topicMasteryPercent=0,e.skills.forEach(function(s){if(s.topicNumber=t,SW.Education.skills.hasOwnProperty(s.skillID)?s.skillName=SW.Education.skills[s.skillID].name:s.skillName="Unknown Skill",s.studentsMastered=[],s.studentsStruggling=[],s.studentsNotStarted=this.getStudents().toJSON(),s.studentsInProgress=[],s.percentMastered=0,s.percentStruggling=0,s.percentInProgress=0,s.percentNotStarted=100,s.students.forEach(function(e){var t=e.correct+e.incorrect>0;e.name=this.getStudents().get(e.studentID).get("name"),e.skillID=s.skillID,s.studentsNotStarted=_.filter(s.studentsNotStarted,function(i){return i.userID!=e.studentID||!t}),e.dateMastered?s.studentsMastered.push(e):e.correct/(e.correct+e.incorrect)<.7?s.studentsStruggling.push(e):t&&s.studentsInProgress.push(e)}.bind(this)),this.getStudents().length>0){i+=s.studentsMastered.length;var n=s.studentsMastered.length+s.studentsStruggling.length+s.studentsInProgress.length+s.studentsNotStarted.length;s.percentMastered=s.studentsMastered.length/n*100,s.percentStruggling=s.studentsStruggling.length/n*100,s.percentInProgress=s.studentsInProgress.length/n*100,s.percentNotStarted=s.studentsNotStarted.length/n*100,s.percentStruggling>=20&&(e.numDangerSkills+=1)}}.bind(this)),e.skills=_.sortBy(e.skills,["percentStruggling","percentMastered","percentInProgress"]).reverse(),this.getStudents().length>0&&(e.topicMasteryPercent=i/(this.getStudents().length*e.skills.length)*100,e.showCautionIcon=!1,e.showDangerIcon=!1,e.numDangerSkills>2?e.showDangerIcon=!0:e.numDangerSkills>0&&(e.showCautionIcon=!0)),t+=1}.bind(this)),e},getStudents:function(){return sw.user.classes.getCurrentClass().students}}),SW.TopicReportPageView=SW.AppPageView.extend({initialize:function(){this._super("initialize"),this.initializeReport(),this.model.get("topicName")&&this.listenToOnce(sw.dispatcher,"topic-report:load:complete",this.focusOnTopic),"email"===this.model.get("referrer")&&sw.user.isTeacher()&&this.listenToOnce(sw.dispatcher,"topic-report:load:complete",this.showPlanLoop)},initializeReport:function(){this.childViews.report=new SW.TopicReportView({model:new SW.TopicReport({defaultCurriculumID:this.model.get("curriculumID")})})},renderPage:function(){this.setPageGutter(),this.$page.append(this.childViews.report.render()),this.renderBreadcrumbs(this.breadcrumbs())},focusOnTopic:function(){this.childViews.report.focusOnTopic(this.model.get("topicName"))},showPlanLoop:function(){this.childViews.report.showPlanLoop()},breadcrumbs:function(){var e,t=[{href:"#reports",text:"Reports"},{href:"#reports/topic-report",text:"Topic Coverage"}];return sw.user.parentApp()&&(t.unshift({href:"#my-kids",text:"My Kids"}),e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),t.splice(1,0,{href:"#profile",text:SW.Utility.firstName(e.name)})),{data:t}}}),SW.TopicReportView=SW.ParentView.extend({events:{"click .js-skill-report-expand-topic":"expandTopic","click .js-skill-report-expand-skill":"expandSkill","mouseenter .js-progress-bar":"showProgressBarTooltip","mouseleave .js-progress-bar":"closeTooltip","mouseenter .js-topic-caution":"showCautionTooltip","mouseleave .js-topic-caution":"closeTooltip","mouseenter .js-topic-danger":"showDangerTooltip","mouseleave .js-topic-danger":"closeTooltip","mouseenter .js-student-name":"showStudentTooltip","mouseleave .js-student-name":"closeTooltip","change #topic-report-curriculum":"changeCurriculum","click .js-hide-plan-loop":"hidePlanLoop","click .js-navigate-to-planner":"navigateToPlanner","click .js-show-sample-question":"showSampleQuestionToolTip"},initialize:function(){this._super("initialize"),this.template={base:Handlebars.compile($("#topic-report-base-template").html()),report:Handlebars.compile($("#topic-report-template").html()),options:Handlebars.compile($("#topic-report-options-template").html())},this.listenTo(sw.dispatcher,"window:resize",this.resizeSampleQuestion),this.listenTo(sw.dispatcher,"topic-report:load:complete",this.renderReport)},resizeSampleQuestion:function(){$(".js-sample-question").trigger("resize")},focusOnTopic:function(e){var t=this.model.getTopicNumberByName(e),i="#skill-report-topic-"+t;this.expandTopic({currentTarget:i}),$(i).scrollTo(600,-75)},expandTopic:function(e){var t=$(e.currentTarget),i=t.data("topic-number"),s=$(".js-skills-container-"+i),n=$(".js-skills-legend-"+i),a=t.find(".skill-report__icon");this.toggleCaret(a),s.slideToggle(200),n.fadeToggle(200)},expandSkill:function(e){var t=$(e.currentTarget),i=t.data("topic-number"),s=t.data("skill-id"),n=$(".js-skill-details-"+i+"-"+s),a=t.find(".skill-report__icon");this.toggleCaret(a),n.slideToggle(200),Controller.displayQuestion({containerID:"sample-question-image-"+s,skillID:s,isMinimal:!0})},toggleCaret:function(e){e.hasClass("fa-caret-right")?(e.removeClass("fa-caret-right"),e.addClass("fa-caret-down")):(e.addClass("fa-caret-right"),e.removeClass("fa-caret-down"))},showProgressBarTooltip:function(e){var t,i=parseInt($(e.currentTarget).find(".skill-report__progress-bar-inner").css("width"),10);t=sw.user.parentApp()?"Your "+SW.Lexicon("student")+" has <strong>mastered "+i+"%</strong> of this topic":"Your "+SW.Lexicon("students")+" have <strong>mastered "+i+"%</strong> of this topic",this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark tooltip--top tooltip--md text-center no-select",content:t}})},showCautionTooltip:function(e){this.createTooltip({reference:$(e.target),node:{classNames:"tooltip--dark tooltip--top tooltip--md text-center no-select",content:"One or more skills are being struggled on"}})},showDangerTooltip:function(e){this.createTooltip({reference:$(e.target),node:{classNames:"tooltip--dark tooltip--top tooltip--md text-center no-select",content:"Many skills are being struggled on"}})},showStudentTooltip:function(e){var t=$(e.target).data("user-id"),i=$(e.target).data("skill-id"),s=this.model.getStudentResults(t,i),n='Skill Results<table class="skill-report__student-results"><tr><td># Correct</td><td class="text-right">'+s.correct+'</td></tr><tr><td># Incorrect</td><td class="text-right">'+s.incorrect+'</td></tr><tr><td class="text-bold">Grade</td><td class="text-right text-bold">'+s.grade+"%</td></tr></table>";this.createTooltip({reference:$(e.target),node:{classNames:"tooltip--dark tooltip--top tooltip--md text-left no-select",content:n}})},changeCurriculum:function(){var e,t=$("#topic-report-curriculum").val();this.model.isNewCurriculum(t)&&(e=this.$el.find(".js-loader-container"),this.loadingIconView=new SW.LoadingIconView({position:"top"}),e.removeClass("gone"),this.model.set("selectedCurriculum",t),this.model.load())},showSampleQuestionToolTip:function(e){var t=this.$(e.target),i=t.data("skill-id"),s="js-tooltip-sample-question-"+i;this.childViews.tooltip&&this.closeTooltip(),this.createTooltip({reference:this.$(".js-show-sample-question-"+i),node:{classNames:"js-tooltip-sample-question tooltip--sample-question no-select",content:'<div id="'+s+'" class="tooltip__content" />'},closeOnClick:!0,onCreate:function(){Controller.displayQuestion({containerID:s,skillID:i,isMinimal:!0})},trigger:t})},renderBase:function(){this.$el.html(this.template.base())},renderOptions:function(){var e=this.model.toJSON(),t=this.template.options(e);this.$el.find("#topic-report-options-container").html(t)},renderReport:function(){var e=this.model.toJSON(),t=this.template.report(e);this.$el.find("#topic-report-container").html(t)},render:function(){return this.renderBase(),this.renderOptions(),this.renderReport(),this.$el},showPlanLoop:function(){this.$(".js-sticky-footer").removeClass("sticky-footer--closed"),window.matchMedia("(min-width: 770px)").matches?sw.track.event("planner","loop:visible"):sw.track.event("planner","loop:invisible")},hidePlanLoop:function(){sw.track.event("planner","loop:dismissed"),this.$(".js-sticky-footer").addClass("sticky-footer--closed")},navigateToPlanner:function(){sw.track.event("planner","loop:followed"),sw.app.navigate("#planner?startCreation=plan",!0)}}),SW.ReportsPage=SW.AppPage.extend({initialize:function(){var e;e=sw.user.parentApp()?["weekly-activity","topic-coverage","student-usage"]:["student-usage","weekly-activity","student-progress","curriculum-coverage","topic-coverage"],this._super("initialize",arguments),this.set("isAdmin",sw.user.isAdmin()),this.load(),SW.Loader.whenLoaded({entities:[sw.user.classes],success:function(){this.set("reports",this._getReports(e)),this.isLoading=!1,this.trigger("loading:completed")}.bind(this),fail:function(){this.isLoading=!1,this.trigger("loading:failed")}})},_getReports:function(e){var t,i,s={};return sw.user.parentApp()&&(t=sw.user.classes.getCurrentClass().students.at(0).get("name"),t=SW.Utility.firstName(t),i=SW.Utility.firstName(t,{possessive:!0})),s["student-usage"]={name:sw.user.parentApp()?"Usage":SW.Lexicon("Student")+" Usage",description:"An overview of "+(i||"your "+SW.Lexicon("students'"))+" usage at home and in school.",url:"/dashboard/#reports/student-usage-report",imgSrc:"/assets/images/svg/reports/student-usage.svg"},s["weekly-activity"]={name:"Weekly Activity",description:"Skills "+(t?t+" is ":"your "+SW.Lexicon("students")+" are ")+"working on and how they did week by week.",url:"/dashboard/#reports/activity-report",imgSrc:"/assets/images/svg/reports/weekly-activity.svg"},s["student-progress"]={name:SW.Lexicon("Student")+" Progress",description:"An in-depth look at a particular "+SW.Lexicon("student's")+" progress in Prodigy.",url:"/reporting/studentprogress",target:"_blank",imgSrc:"/assets/images/svg/reports/student-progress.svg"},s["curriculum-coverage"]={name:"Curriculum Coverage",description:"Expectations your "+SW.Lexicon("students")+" have mastered or are struggling with.",url:"/dashboard/#reports/curriculum-report",imgSrc:"/assets/images/svg/reports/curriculum-coverage.svg"},s["topic-coverage"]={name:"Topic Coverage",description:"An overview of "+(i||"your "+SW.Lexicon("students'"))+" progress and trouble spots on a per topic basis.",url:"/dashboard/#reports/topic-report",imgSrc:"/assets/images/svg/reports/topic-coverage.svg"},e.map(function(e){return s[e]})}}),SW.ReportsPageView=SW.AppPageView.extend({initialize:function(){this._super("initialize",arguments),this._hasParentFirstPageviewBeenOpened=!1,this.template.page=this.findTemplate("reports-page"),this.template.parentDialog=this.findTemplate("reports-page-parent-dialog")},createParentTutorialDialog:function(){var e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),t=SW.Utility.firstName(e.name);this._hasParentFirstPageviewBeenOpened=!0,this.createDialog({type:"custom",main:this.template.parentDialog({studentName:t})}),this.listenTo(sw.dispatcher,"dialog:close",function(){sw.user.tutorials.save(SW.Tutorials.PARENT_FIRST_REPORT_PAGEVIEW)})},renderPage:function(){var e,t=this.template.page(this.model.toJSON());this.$page.html(t),sw.user.parentApp()&&(e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),this.renderBreadcrumbs({data:[{href:"#my-kids",text:"My Kids"},{href:"#profile",text:SW.Utility.firstName(e.name)},{href:"#reports",text:"Reports"}]}))}}),SW.DashQuestionView=SW.View.extend({className:"dash-question dash-block",events:{"click .js-toggle-open":"toggleOpen","click .js-action-link":"customAction"},initialize:function(e){this.toggleOpenClicks=0,this.wasOpened=!1,this.template=Handlebars.compile($("#dash-question-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON()))},toggleOpen:function(){this.toggleOpenClicks<2&&(this.toggleOpenClicks++,this.$el.find(".js-answer-container").slideToggle(function(){this.toggleOpenClicks--}.bind(this)),this.$el.find(".js-toggle-open-icon").toggleClass("fa-caret-down").toggleClass("fa-caret-up")),this.trackFirstToggle()},trackFirstToggle:function(){this.wasOpened||(this.wasOpened=!0,sw.track.event("tutorial","toggle-faq",this.model.get("question")),console.log(this.model.get("question")))},customAction:function(e){var t=this.model.get("linkCallback");e.preventDefault(),_.isFunction(t)&&t()}}),SW.ToyUnlockView=SW.ParentView.extend({initialize:function(){var e=this;$(".js-toy-close").click(function(){e.closePage()}),$("#toy-unlock__input").keyup(function(){e.removeError()}),$("#toy-unlock-form").submit(function(t){t.preventDefault(),e.submit()}),this.listenTo(this.model,"submit:error",this.handleError),this.listenTo(this.model,"submit:loading",this.setLoading),this.listenTo(this.model,"submit:success",this.handleSuccess),this.submittedCode=""},submit:function(){var e=window.parent.prodigyWeb.page.data.studentID,t=window.parent.prodigyWeb.page.data.token,i=$("#toy-unlock__input").val();this.submittedCode=i,this.model.submit(e,t,i)},setLoading:function(){$("#toy-unlock__submit").html("Verifying code..."),$("#toy-unlock__submit").prop("disabled",!0)},stopLoading:function(){$("#toy-unlock__submit").html("Unlock Big Hex"),$("#toy-unlock__submit").prop("disabled",!1)},removeError:function(){$("#toy-unlock__input").val()!==this.submittedCode&&($("#toy-unlock__label").removeClass("text-danger"),$("#toy-unlock__error").html(""))},handleError:function(e){$("#toy-unlock__label").addClass("text-danger"),$("#toy-unlock__error").html(" - "+e),this.stopLoading()},handleSuccess:function(){this.stopLoading(),this.closePage()},closePage:function(){_.isFunction(window.parent.prodigyWeb.page.close)&&window.parent.prodigyWeb.page.close(this.model.get("unlockResult")),this.close()}}),SW.ToyUnlock=SW.Model.extend({defaults:{unlockResult:{success:!1}},submit:function(e,t,i){return console.log("submitting",e,t,i),7!==i.length?this.trigger("submit:error","Your code needs to be 7 characters"):(this.trigger("submit:loading"),void SW.Http.fetch({url:sw.config.api.toy+"/v1/users/"+e+"/toy",method:"POST",data:{uniqueCode:i,token:t,"auth-key":t},success:function(e){sw.track.event("unlock-hex","submit-success"),this.set("unlockResult",e),this.trigger("submit:success")}.bind(this),error:function(e){409==e.status?(sw.track.event("unlock-hex","submit-error","409"),this.trigger("submit:error","Your session has expired. Please refresh the page and try again.")):(sw.track.event("unlock-hex","submit-error","404"),this.trigger("submit:error","Whoops, that code is invalid or has already been used!"))}.bind(this)}))}}),SW.CardView=SW.ParentView.extend({initialize:function(e){this._super("initialize",arguments),this.template=Handlebars.compile($("#card-template").html())},render:function(){var e=this.model.toJSON();return e.customClasses=e.customClasses||{},this.$el.html(e),this.$el}}),SW.Card=SW.Model.extend({}),SW.SelectSkillsCardView=SW.CardView.extend({className:"calendar-item-property-card select-skills-card",events:{"click .js-confirm-skills":"onConfirmSkillClick"},initialize:function(e){this._super("initialize",arguments),this.template={base:this.template,header:Handlebars.compile($("#select-skills-card-header-template").html()),footer:Handlebars.compile($("#select-skills-card-footer-template").html())},this.initializeMain(),this.listenTo(this.model,"change:selectedSkillName",this.updateFooter),sw.track.milestone("Planner: assignment skills opened")},initializeMain:function(){this.model.get("chooseSkillsState")?this.initializeSkillGroups():this.model.get("customizeSkillsState")},initializeSkillGroups:function(){this.childViews.main=new SW.SkillGroupCollectionView({enableSelection:!0,collection:new SW.SkillGroupCollection,dialog:this.dialog,model:new SW.SkillGroupCollectionModel}),this.listenTo(this.childViews.main.model,"change:selectedSkills",this.onSkillSelectionChange),this.listenTo(this.childViews.main,"rendered:skill-groups",this.checkSkillInputs);
},render:function(){var e,t={header:this.createHeaderHTML(),footer:this.createFooterHTML()};return e=this.template.base(t),this.$el.html(e),this.renderMain(),this.$el},createHeaderHTML:function(){var e=this.getTemplateData();return this.template.header(e)},createFooterHTML:function(){var e=this.getTemplateData();return this.template.footer(e)},getTemplateData:function(){return _.extend(this.model.toJSON(),{inDialog:_.isObject(this.dialog)})},renderMain:function(){var e=this.model.get("selectedSkillID");this.childViews.main&&(this.$(".card__main").html(this.childViews.main.render()),this.childViews.main.delegateEvents(),e&&_.defer(this.checkSkillInputs.bind(this,[e])))},checkSkillInputs:function(){var e=this.model.get("selectedSkillID");e&&this.$("input[value="+e+"]").prop("checked",!0)},updateFooter:function(){this.$(".card__footer").html(this.createFooterHTML())},onConfirmSkillClick:function(){sw.track.milestone("Planner: assignment skill chosen"),this.model.confirmSkills()},onSkillSelectionChange:function(e,t){var i=t.length>0?SW.Education.skills[t[0].value]:null;this.model.set({selectedSkillName:i?i.name:null,selectedSkillID:t[0].value})}}),SW.SelectSkillsCard=SW.Card.extend({defaults:{chooseSkillsState:!0,customizeSkillsState:!1,selectedSkillName:void 0,selectedSkillID:void 0},confirmSkills:function(){var e=this.get("selectedSkillID");e&&this.trigger("confirmed:skills",{data:[e]})}}),SW.TestPrepCreationCard=SW.Card.extend({defaults:{testName:"",estimatedTotalMinutes:0,estimatedDailyMinutes:0,onEditTest:function(){}}}),SW.TestPrepCreationCardView=SW.CardView.extend({className:"calendar-item-property-card test-prep-card",events:{"click .js-edit-test":"onEditTest","click .js-confirm-test":"onConfirmTest"},initialize:function(){this._super("initialize",arguments),this.template={base:this.template,main:this.findTemplate("test-prep-creation-card-main"),header:this.findTemplate("test-prep-creation-card-header"),footer:this.findTemplate("test-prep-creation-card-footer")}},render:function(){var e={main:this.template.main(this.model.toJSON()),header:this.template.header(this.model.toJSON()),footer:this.template.footer()},t=this.template.base(e);return this.$el.html(t),this.$el},onEditTest:function(){this.model.get("onEditTest").call(),this.closeDialog()},onConfirmTest:function(){this.closeDialog()}}),SW.TestPrepSelectCard=SW.Card.extend({defaults:{hasStudents:!1,hasFinishedInitialLoad:!1,isLoadingTests:!1,availbleTests:[],selectedTest:null,availableGrades:[],selectedGrade:0,availableTestNames:[],selectedTestName:""},initialize:function(){this.locationFilterList=new SW.LocationFilterList,this.listenTo(this.locationFilterList,"load:success",this.handleTestLoading),this.listenTo(this.locationFilterList,"load:error",this.triggerLoadingError),this.locationFilterList.loadLocationData(),this.listenTo(this,"change:availableTests",this._updateLocationFilterListError),this.listenTo(this,"change:availableTests",this._computeAvailableTestNames),this.listenTo(this,"change:availableTests change:selectedTestName",this._computeAvailableGrades),this.listenTo(this,"change:availableGrades change:selectedGrade change:selectedTestName",this._validateSelectedGrade),this.listenTo(this,"change:availableTestNames change:selectedTestName change:selectedGrade",this._validateSelectedTestName),this.listenTo(this,"change:selectedTestName change:selectedGrade",this._computeSelectedTest)},handleTestLoading:function(e){this.listenTo(this.locationFilterList,"location:select",this.loadAvailableTestsForLocation),this.listenTo(this.locationFilterList,"location:deselect",this.unsetAvailableTests),this._loadInitialTests(e)},_loadInitialTests:function(e){e?(this.listenTo(this,"change:isLoadingTests",function(){this.get("isLoadingTests")||(this.set({hasFinishedInitialLoad:!0}),this.stopListening(this,"change:isLoadingTests",this.finishInitialLoad))}.bind(this)),this.loadAvailableTestsForLocation(e)):(this.unsetAvailableTests(),this.set({hasFinishedInitialLoad:!0}))},loadAvailableTestsForLocation:function(e){this.set({isLoadingTests:!0}),this.unsetAvailableTests(),SW.Http.fetch({url:sw.config.api.assignments+"/v1/test-prep/locations/"+e.id+"/tests",method:"GET",success:function(e){var t=_(e).map(function(e){return{id:e.id,grade:parseInt(e.grade,10),acronym:e.acronym,name:e.name,testName:e.acronym?e.acronym+": "+e.name:e.name}}).orderBy("testName").value();this.set({availableTests:t,isLoadingTests:!1})}.bind(this),error:this.triggerLoadingError.bind(this)})},triggerLoadingError:function(){this.trigger("testprep:load:failed")},unsetAvailableTests:function(){this.set({availableTests:[]})},_updateLocationFilterListError:function(){this.locationFilterList.set({hasError:this._hasNoTestForLocation(),errorNotice:"We currently do not have a test for your location. In the meantime, you can try our Prodigy aligned test prep, based on Common Core."})},_hasNoTestForLocation:function(){var e=[177,178,179,180,181,182],t=this.get("availableTests");return!_.isEmpty(t)&&_.every(t,function(t){return _.includes(e,t.id)})},_computeAvailableTestNames:function(){var e=_(this.get("availableTests")).map("testName").uniq().sort().value();this.set({availableTestNames:e})},_computeAvailableGrades:function(){var e=_(this.get("availableTests")).filter({testName:this.get("selectedTestName")}).map("grade").uniq().sort().value();this.set({availableGrades:e})},_validateSelectedTestName:function(){var e=this.get("selectedTestName"),t=this.get("availableTestNames");_.includes(t,e)||this.set({selectedTestName:_.first(t)})},_validateSelectedGrade:function(){var e=this.get("selectedGrade"),t=this.get("availableGrades");_.includes(t,e)||_.isEmpty(t)||this.set({selectedGrade:_.first(t)})},_computeSelectedTest:function(){var e=this.get("availableTests"),t=_.find(e,{testName:this.get("selectedTestName"),grade:this.get("selectedGrade")});this.set({selectedTest:t})},selectTestName:function(e){this.set({selectedTestName:e})},selectGrade:function(e){this.set({selectedGrade:e})},canConfirmTest:function(){return this.get("hasStudents")&&_.includes(this.get("availableTests"),this.get("selectedTest"))},confirmSelection:function(){var e=this.get("selectedTest");this.canConfirmTest()&&this.trigger("test-selected",{id:e.id,name:e.acronym?e.acronym+" Grade "+e.grade:e.name+" Grade "+e.grade})}}),SW.TestPrepSelectCardView=SW.CardView.extend({className:"calendar-item-property-card test-prep-card test-prep-card",events:{"change .js-select-test":"selectTestName","change .js-select-grade":"selectGrade","click .js-confirm-test":"confirmTest"},initialize:function(){this._super("initialize",arguments),this.template={base:this.template,main:this.findTemplate("test-prep-select-card-main"),header:this.findTemplate("test-prep-select-card-header"),footer:this.findTemplate("test-prep-select-card-footer")},this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"testprep:load:failed",this.createErrorDialog),this.initializeLocationFilterList(),this.initializeLoader()},initializeLocationFilterList:function(){this.childViews.locationFilterList=new SW.LocationFilterListView({model:this.model.locationFilterList})},initializeLoader:function(){this.childViews.loader=new SW.LoadingIconView},render:function(){var e={main:this.template.main({hasStudents:this.model.get("hasStudents"),hasFinishedInitialLoad:this.model.get("hasFinishedInitialLoad"),isLoading:!this.model.get("hasFinishedInitialLoad")||this.model.get("isLoadingTests"),availableGrades:this.model.get("availableGrades"),availableTestNames:this.model.get("availableTestNames"),selectedGrade:this.model.get("selectedGrade"),selectedTestName:this.model.get("selectedTestName")}),header:this.template.header(),footer:this.template.footer({canProceed:this.model.canConfirmTest()})},t=this.template.base(e);return this.$el.html(t),this.renderLocationFilterList(),this.renderLoader(),this.$el},renderLocationFilterList:function(){this.$(".js-location-filter-list").html(this.childViews.locationFilterList.render()),this.childViews.locationFilterList.delegateEvents()},renderLoader:function(){this.$(".js-loader").html(this.childViews.loader.render())},onTestListChange:function(){var e=this.$(".js-test-list-select").val();this.model.set({selectedTestName:e})},selectTestName:function(e){var t=$(e.target).val().trim();this.model.selectTestName(t)},selectGrade:function(e){var t=parseInt($(e.target).val(),10);this.model.selectGrade(t)},confirmTest:function(){this.model.confirmSelection()},createErrorDialog:function(){this.createDialog({type:"alert",size:"small",title:"Unable to load test prep data",main:"Check your Internet connection and try to select a test prep again in a few minutes.",buttons:[{text:"Close"}]})}}),SW.SelectAssignmentOptionsCardView=SW.CardView.extend({className:"select-assignment-options-card calendar-item-property-card",events:{"click .js-confirm-options":"onConfirmOptionsClick"},initialize:function(e){this._super("initialize",arguments),this.template={base:this.template,header:Handlebars.compile($("#select-assignment-options-card-header-template").html()),footer:Handlebars.compile($("#select-assignment-options-card-footer-template").html())},this.initializeAssignmentOptions(),this.listenTo(this.model,"change:valid",this.updateFooter),sw.track.milestone("Planner: assignment options opened")},initializeAssignmentOptions:function(){var e=new SW.AssignmentOptions(this.model.toJSON());this.childViews.options=new SW.AssignmentOptionsView({model:e}),this.updateOptionsData(),this.listenTo(e,"change",this.updateOptionsData)},render:function(){var e,t={header:this.createHeaderHTML(),footer:this.createFooterHTML()};return e=this.template.base(t),this.$el.html(e),this.renderAssignmentOptions(),this.$el},createHeaderHTML:function(){var e=this.getTemplateData();return this.template.header(e)},createFooterHTML:function(){var e=this.getTemplateData();return this.template.footer(e)},getTemplateData:function(){return _.extend(this.model.toJSON(),{inDialog:_.isObject(this.dialog)})},renderAssignmentOptions:function(){this.childViews.options&&(this.$(".card__main").html(this.childViews.options.render()),this.childViews.options.delegateEvents())},updateOptionsData:function(){this.model.set(this.childViews.options.model.toJSON())},updateFooter:function(){this.$(".card__footer").html(this.createFooterHTML())},onConfirmOptionsClick:function(){sw.track.milestone("Planner: assignment options chosen"),this.model.confirmOptions()}}),SW.SelectAssignmentOptionsCard=SW.Card.extend({defaults:{name:void 0,questions:5,selectedStudentIDs:void 0,valid:!1},confirmOptions:function(){var e=this.toJSON();this.trigger("confirmed:options",{data:e})}}),SW.AssignmentOptionsView=SW.ParentView.extend({className:"assignment-options",events:{"click .js-toggle-student-selection":"toggleStudentSelection","change .js-student-checkbox":"onToggleSelectStudent","keyup .js-assignment-name-input":"onAssignmentNameKeyup","change .js-assignment-questions-select":"onQuestionsChange"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#assignment-options-template").html())},render:function(){var e=this.getTemplateData(),t=this.template(e);return this.$el.html(t),this.checkSelectedStudents(),this.syncNumberOfQuestions(),e.students.length>0&&!this.model.areAllStudentsSelected()&&this.updateToggleCheckbox("fa-minus","fa-check",!0),this.$el},getTemplateData:function(){var e=this.model.toJSON();return e.students=this.model.getStudents(),e.questionNumArr=_.range(1,26),e},checkSelectedStudents:function(){var e=this.model.get("selectedStudentIDs");_.isEmpty(e)||e.forEach(function(e){this.$(".js-student-checkbox[value='"+e+"']").prop("checked",!0)}.bind(this))},syncNumberOfQuestions:function(){this.$(".js-assignment-questions-select").val(this.model.get("questions"))},toggleStudentSelection:function(e){var t=this.model.get("selectedStudentIDs"),i=_.isEmpty(t);i?(this.model.selectAllStudents(),this.updateToggleCheckbox("fa-check","fa-minus",!0)):(this.model.resetSelectedStudents(),this.updateToggleCheckbox("fa-check","fa-minus",!1)),this.$(".js-student-checkbox").prop("checked",i)},onToggleSelectStudent:function(e){this.toggleStudent(e.target.value)},toggleStudent:function(e){this.model.toggleStudent(parseInt(e,10)),this.model.areAllStudentsSelected()?this.updateToggleCheckbox("fa-check","fa-minus",!0):_.isEmpty(this.model.get("selectedStudentIDs"))?this.updateToggleCheckbox("fa-check","fa-minus",!1):this.updateToggleCheckbox("fa-minus","fa-check",!0)},updateToggleCheckbox:function(e,t,i){this.$(".js-toggle-student-selection").prop("checked",i),this.$(".js-toggle-student-selection-label .fa").addClass(e).removeClass(t)},onAssignmentNameKeyup:function(e){var t=e.target.value.trim();this.model.set("name",t),t.length>this.model.get("maxNameLength")?this.showNameLengthWarning():this.hideNameLengthWarning()},showNameLengthWarning:function(){this.$nameLengthWarning||(this.$nameLengthWarning=$('<p class="warning-text">This assignment\'s name is too long!</p>'),this.$(".js-assignment-name-input").addClass("warning").before(this.$nameLengthWarning))},hideNameLengthWarning:function(){this.$nameLengthWarning&&(this.$(".js-assignment-name-input").removeClass("warning"),this.$nameLengthWarning.remove(),this.$nameLengthWarning=null)},onQuestionsChange:function(e){var t=$(e.target);this.model.set("questions",parseInt(t.val(),10))}}),SW.AssignmentOptions=SW.Model.extend({defaults:{name:"New Assignment",questions:5,selectedStudentIDs:void 0,valid:!1,maxNameLength:250},initialize:function(){_.isArray(this.get("selectedStudentIDs"))||this.selectAllStudents(),this.set("valid",this.validate()),this.listenTo(this,"change",this.onChange)},getStudents:function(){return sw.user.classes.getCurrentClass().students.toJSON()},selectAllStudents:function(){this.set("selectedStudentIDs",this.getStudents().map(function(e){return e.userID}))},resetSelectedStudents:function(){this.set("selectedStudentIDs",null)},toggleStudent:function(e){var t=_.isArray(this.get("selectedStudentIDs"))?this.get("selectedStudentIDs").slice(0):[];this.set("selectedStudentIDs",SW.Array.toggle(t,e))},onChange:function(){this.set("valid",this.validate())},validate:function(){var e=this.toJSON();return SW.Validate.text(e.name)&&e.name.length<this.get("maxNameLength")&&!_.isEmpty(e.selectedStudentIDs)},areAllStudentsSelected:function(){var e=_.isArray(this.get("selectedStudentIDs"))?this.get("selectedStudentIDs").length:0;return this.getStudents().length===e}}),SW.SubnavigationView=SW.ParentView.extend({tagName:"nav",className:"subnavigation",events:{"click .subnavigation__list-item":function(e){this.selectItem($(e.target).data("key"))},"change .subnavigation__dropdown":function(e){this.selectItem($(e.target).val())}},initialize:function(e){return this._super("initialize",arguments),this.template={base:Handlebars.compile($("#subnavigation-template").html()),listItem:Handlebars.compile($("#subnavigation-item-list-item-template").html()),dropdownItem:Handlebars.compile($("#subnavigation-item-dropdown-item-template").html())},this.listenTo(sw.dispatcher,"window:resize",this.handleWindowResize),this},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),this.elements={$list:this.$(".subnavigation__list"),$dropdown:this.$(".subnavigation__dropdown")},this.model.get("items")&&this.renderItems(this.model.get("items")),this.$el},renderItems:function(e){var t=this;return _.forEach(e,function(e,i){t.elements.$list.append(t.template.listItem({key:i,label:e})),t.elements.$dropdown.append(t.template.dropdownItem({key:i,label:e}))}),sw.dispatcher.trigger("window:resize"),this},selectItem:function(e){return this.trigger("subnavigation:select",e),this.activateItem(e),this},activateItem:function(e){this.activateListItem(e),this.activateDropdownItem(e)},activateListItem:function(e){return this.elements.$list.find(".subnavigation__list-item").removeClass("subnavigation__list-item--active"),this.elements.$list.find('[data-key="'+e+'"]').addClass("subnavigation__list-item--active"),this},activateDropdownItem:function(e){return this.elements.$dropdown.val(e),this},handleWindowResize:function(){this.elements.$list.removeClass("gone"),this.elements.$dropdown.removeClass("gone"),this.elements.$list.innerHeight()>this.elements.$list.find(".subnavigation__list-item").outerHeight()?this.elements.$list.addClass("gone"):this.elements.$dropdown.addClass("gone")}}),SW.Subnavigation=SW.Model.extend({}),SW.ReportView=SW.ParentView.extend({tagName:"div",className:"report card__wrapper",initialize:function(){this._super("initialize",arguments),this.template={base:this.findTemplate("report"),error:this.findTemplate("report-error")},this.listenTo(this.model,"load:complete",this.render)},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),!this.model.loaded||this.model.loading?this.renderLoading():this.renderContent(),this.$el},renderContent:function(){this.$(".js-loader-container").addClass("gone"),this.model.error?this.$el.html(this.template.error({error:this.model.error})):this.$(".js-report-content").html(this.childViews.content.render())},renderLoading:function(){this.$(".js-loader-container").removeClass("gone")}}),SW.Report=SW.Model.extend({defaults:{title:null},initialize:function(){this.lastTimeLoaded=null,this.loaded=!1,this.loading=!1,this.error=null,this.load()},beforeLoad:function(){this.loaded=!1,this.loading=!0,this.error=null},load:function(){var e;this.beforeLoad(),console.error("Report.load() should be overridden."),this.afterLoad(e)},afterLoad:function(e){this.lastTimeLoaded=new Date,this.loaded=!0,this.loading=!1,this.error=e,this.trigger("load:complete",{error:e})}}),SW.NestedListView=SW.ParentView.extend({className:"nested-list",initialize:function(e){this._super("initialize",arguments),this.template=Handlebars.compile($("#nested-list-template").html()),this.itemView=e.itemView},render:function(){return this.$el.html(this.template()),this.renderItems(),this.$el},renderItems:function(){this.collection.each(function(e){this.$el.append(new this.itemView({model:e}).render())}.bind(this))}}),SW.NestedList=SW.Collection.extend({}),SW.NestedListItemView=SW.ParentView.extend({className:"nested-list__item"}),SW.NestedListItem=SW.Model.extend({}),SW.DateRange=SW.Model.extend({defaults:{dateRangeText:"?",startTime:0,endTime:0,rangeType:"week",rangeOffset:0,nextRangeDisabled:!0,allowBeyondTodaysDate:!1,shiftIndex:0,reportDateMinimum:!1},configureDateRange:function(){this.initDateRange(),this.updateDateRangeText(),this.updateRangeForwardButtonStatus(),this.updateRangeBackwardButtonStatus()},initialize:function(){this.configureDateRange()},initDateRange:function(){var e=this.getBeginningOfTheWeek(),t=this.getEndOfTheWeek(),i=this.getBeginningOfTheMonth(),s=this.getEndOfTheMonth();this.isShiftingByWeek()?this.get("startTime")===this.defaults.startTime&&this.get("endTime")===this.defaults.endTime&&(this.set("startTime",e.getTime()),this.set("endTime",t.getTime())):this.isShiftingByMonth()&&this.get("startTime")===this.defaults.startTime&&this.get("endTime")===this.defaults.endTime&&(this.set("startTime",i.getTime()),this.set("endTime",s.getTime()))},resetDateRange:function(){this.set("startTime",0),this.set("endTime",0)},updateDateRangeType:function(e){this.set("rangeType",e),this.resetDateRange(),this.configureDateRange()},getBeginningOfTheWeek:function(){var e=new Date;return SW.Utility.setTimeInDayToZero(SW.Utility.firstDateInWeek(e,this.get("rangeOffset")))},getEndOfTheWeek:function(){var e=new Date;return SW.Utility.setTimeInDayToZero(SW.Utility.lastDateInWeek(e,this.get("rangeOffset")))},getBeginningOfTheMonth:function(){var e=new Date;return moment(e).startOf("month").toDate()},getEndOfTheMonth:function(){var e=new Date;return moment(e).endOf("month").toDate()},getDateRange:function(){return{startTime:this.get("startTime"),endTime:this.get("endTime")}},shiftRangeToToday:function(){var e,t;this.isShiftingByWeek()?(e=this.getBeginningOfTheWeek(),t=this.getEndOfTheWeek()):this.isShiftingByMonth()&&(e=this.getBeginningOfTheMonth(),t=this.getEndOfTheMonth()),this.set("startTime",e.getTime()),this.set("endTime",t.getTime()),this.set("shiftIndex",this.get("shiftIndex")+1),this.updateRangeForwardButtonStatus(),this.updateRangeBackwardButtonStatus(),this.updateDateRangeText(),this.trigger("range:shifted")},updateRangeForwardButtonStatus:function(){var e=new Date(this.get("endTime")),t=new Date;this.get("allowBeyondTodaysDate")||this.set("nextRangeDisabled",e.getTime()>t.getTime()||SW.Utility.isSameDate(e,t))},updateRangeBackwardButtonStatus:function(){var e=moment(this.get("startTime")).add(-1,this.get("rangeType"));this.set("previousRangeDisabled",this.get("reportDateMinimum")&&this.get("reportDateMinimum")>e.toDate())},shiftRangeForward:function(){var e=moment(this.get("startTime")).add(1,this.get("rangeType")),t=moment(this.get("endTime")).add(1,this.get("rangeType"));this.isShiftingByMonth()&&(e.startOf("month"),t.endOf("month")),this.set("startTime",e.toDate().getTime()),this.set("endTime",t.toDate().getTime()),this.set("shiftIndex",this.get("shiftIndex")+1),this.updateRangeForwardButtonStatus(),this.updateRangeBackwardButtonStatus(),this.updateDateRangeText(),this.trigger("range:shifted")},shiftRangeBackward:function(){var e=moment(this.get("startTime")).add(-1,this.get("rangeType")),t=moment(this.get("endTime")).add(-1,this.get("rangeType"));this.isShiftingByMonth()&&(e.startOf("month"),t.endOf("month")),this.set("startTime",e.toDate().getTime()),this.set("endTime",t.toDate().getTime()),this.set("nextRangeDisabled",!1),this.set("shiftIndex",this.get("shiftIndex")-1),sw.track.event(window.location.hash,"viewed-historical-range",this.get("shiftIndex")+""),this.updateRangeBackwardButtonStatus(),this.updateDateRangeText(),this.trigger("range:shifted")},isShiftingByWeek:function(){return"week"===this.get("rangeType")},isShiftingByMonth:function(){return"month"===this.get("rangeType")},updateDateRangeText:function(){var e=new Date(this.get("startTime")),t=new Date(this.get("endTime")),i="";this.isShiftingByWeek()?i=moment(e).format("MMM DD")+" - "+moment(t).format("MMM DD"):this.isShiftingByMonth()&&(i=moment(e).format("MMMM YYYY")),this.set("dateRangeText",i)}}),SW.DateRangeView=SW.ParentView.extend({className:"date-range",events:function(){return _.extend({"click .js-previous-range":this.model.shiftRangeBackward.bind(this.model),"click .js-next-range":this.model.shiftRangeForward.bind(this.model),"click .js-today-range":this.model.shiftRangeToToday.bind(this.model)},SW.ParentView.prototype.events)},initialize:function(){this._super("initialize"),this.template=this.findTemplate("date-range"),this.listenTo(this.model,"change:label",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el}}),SW.MembershipsView=SW.ParentView.extend({className:"memberships",events:{"click .js-assign-membership-event":"handleAssignMembership","click .js-cancel-membership-event":"handleCancelMembership"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("memberships")},templateContext:function(){var e=this.collection.map(function(e){var t=e.toJSON();return t.expiryDate=e.getFormatedDate("expiryDate"),t});return{memberships:e}},render:function(){return this.$el.html(this.template(this.templateContext()))},handleAssignMembership:function(e){var t=$(e.currentTarget),i=t.data("membershipId");e.preventDefault(),this.createAssignMembershipDialog(i)},createAssignMembershipDialog:function(e){this.createDialog({className:"dialog dialog--basic",type:"custom",size:"small",children:[{view:SW.AssignMembershipView,model:this.collection.get({id:e})}]})},handleCancelMembership:function(e){var t=$(e.currentTarget),i=t.data("membershipId");e.preventDefault(),"undefined"==typeof i&&(i=null),this.createCancelMembershipDialog(i)},createCancelMembershipDialog:function(e){this.createDialog({className:"dialog dialog--basic",type:"custom",size:"small",children:[{view:SW.CancelMembershipView,model:this.collection.get({id:e})}]})}}),SW.Memberships=SW.Model.extend({}),SW.AssignMembershipView=SW.CardView.extend({className:"assign-membership",events:{"change .js-assign-membership-choose":"handleChoose","click .js-assign-membership-save":"handleSave","click .js-assign-membership-cancel":"handleCancel"},initialize:function(e){this._super("initialize",arguments),this.template={base:this.template,main:this.findTemplate("assign-membership-main"),header:this.findTemplate("assign-membership-header"),footer:this.findTemplate("assign-membership-footer")}},templateContext:function(){var e=function(e,t){e=e.name+e.username,t=t.name+t.username;var i=[],s=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,s){i.push([t||1/0,s||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,i){s.push([t||1/0,i||""])});i.length&&s.length;){var n=i.shift(),a=s.shift(),r=n[0]-a[0]||n[1].localeCompare(a[1]);if(r)return r}return i.length-s.length},t=sw.user.classes.getAllStudents("JSON"),i=this.model.get("licenseeID"),s=sw.user.classes.findStudent(i),n=!(!s&&i),a=$.extend(this.model.toJSON(),{students:t.sort(e)}),r={assignedStudentIsInClass:n},o={header:this.template.header(),main:this.template.main(a),footer:this.template.footer(r)};return o},render:function(){var e=this.template.base(this.templateContext());return this.$el.html(e),this.$el},handleCancel:function(e){e.preventDefault(),sw.dispatcher.trigger("dialog:close")},handleChoose:function(e){e.preventDefault(),this.$(".js-assign-membership-save").attr("disabled",!1)},handleSave:function(e){var t=this,i=parseInt($(".js-assign-membership-choose").val());e.preventDefault(),this.model.assignMembership(i,function(e){e||(sw.dispatcher.trigger("dialog:close"),t.updateItemAssigned(i))})},updateItemAssigned:function(e){var t=$("#membership-"+this.model.get("id")),i=(t.find(".memberships__item-status"),t.find(".js-assign-membership-event")),s=t.find(".memberships__item-column--name");e?(t.removeClass("memberships__item--unassigned"),i.removeClass("btn--blue"),i.addClass("btn--white"),i.html("Switch Student"),s.html(this.model.get("licenseeName")+"<span class='memberships__item-username'>&nbsp;("+this.model.get("licenseeUsername")+")</span>")):(t.addClass("memberships__item--unassigned"),i.removeClass("btn--white"),i.addClass("btn--blue"),i.html("Choose Student"),s.html("<span class='memberships__item-nostudent'>Unassigned</span>&nbsp;<i class='fa fa-exclamation-triangle'><span>Please choose a student.</span></i>"))}}),SW.CancelMembershipView=SW.CardView.extend({className:"cancel-membership",events:{"click .js-cancel-membership-cancel":"handleCancel","click .js-cancel-membership-proceed":"handleProceed"},initialize:function(e){this._super("initialize",arguments),this.template={base:this.template,main:this.findTemplate("cancel-membership-main"),header:this.findTemplate("cancel-membership-header"),footer:this.findTemplate("cancel-membership-footer")}},templateContext:function(){var e={header:this.template.header(),main:this.template.main({expiryDate:this.model.getFormatedDate("expiryDate")}),footer:this.template.footer()};return e},render:function(){var e=this.template.base(this.templateContext());return this.$el.html(e),this.$el},handleCancel:function(e){e.preventDefault(),sw.dispatcher.trigger("dialog:close")},handleProceed:function(e){var t=this;e.preventDefault(),$(".js-cancel-membership-proceed").attr("disabled",!0),this.model.cancelMembership(function(e){return e?void sw.toastManager.create({id:"cancelMembershipError",type:"error",content:e.message,timer:1e4}):(sw.dispatcher.trigger("dialog:close"),void t.updateItemCanceled())})},updateItemCanceled:function(){var e=$("#membership-"+this.model.get("id")),t=e.find(".memberships__item-status"),i=e.find(".js-cancel-membership-event"),s=e.find(".js-canceled-membership-update-next-billing-heading");t.removeClass(function(e,t){return(t.match(/(^|\s)memberships__item-status--\S+/g)||[]).join(" ")}),t.addClass("memberships__item-status--canceled"),t.html("Canceled"),i.remove(),s.html("Membership Ending")}}),SW.CurriculumReportPageView=SW.AppPageView.extend({initialize:function(){this._super("initialize"),this.childViews.report=new SW.CurriculumReportView({model:new SW.CurriculumReport})},renderPage:function(){this.setPageGutter(),this.$page.append(this.childViews.report.render()),this.renderBreadcrumbs(this.breadcrumbs())},breadcrumbs:function(){return{data:[{href:"#reports",text:"Reports"},{href:"#reports/curriculum-report",text:"Curriculum Coverage"}]}}}),SW.CurriculumReportPage=SW.AppPage.extend({initialize:function(){this.listenToOnce(sw.dispatcher,"curriculum-report:load:complete",this.loadComplete),this._super("initialize"),this.load()},load:function(){this._super("load")},loadComplete:function(){this.trigger("loading:completed")}}),SW.CurriculumReportView=SW.ReportView.extend({className:SW.ReportView.prototype.className+" curriculum-report",events:{"change .js-curriculum-report-curricula-select":"selectCurricula"},initialize:function(){this._super("initialize",arguments),this.template.base=Handlebars.compile($("#curriculum-report-template").html())},renderContent:function(){var e=this.model.get("data");this.$el.find("option[value="+this.model.get("curriculumID")+"]").prop("selected","selected"),this.childViews.content=new SW.NestedListView({itemView:SW.CurriculumReportStrandView,collection:new SW.Collection(e)}),this._super("renderContent",arguments)},selectCurricula:function(e){this.model.set("curriculumID",$(e.currentTarget).val()),this.renderLoading(),this.model.loadStrands()}}),SW.CurriculumReport=SW.Report.extend({defaults:{title:"Curriculum Report"},initialize:function(e){this.set("curricula",sw.user.get("curricula")),this._super("initialize",arguments)},load:function(){this.beforeLoad(),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.loadDependenciesSuccess.bind(this),fail:this.loadDependenciesFailure.bind(this)})},loadDependenciesSuccess:function(e){this.loadStrands()},loadStrands:function(){this.setClass(),SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+this.get("class").get("id")+"/curriculum-report/"+this.get("curriculumID"),success:function(e){this.set("data",e),this.afterLoad()}.bind(this),error:function(e){this.afterLoad("There was an error loading the curriculum report.")}.bind(this)})},loadDependenciesFailure:function(e){this.afterLoad("There was an error loading the curriculum report.")},afterLoad:function(e){this._super("afterLoad",arguments),sw.dispatcher.trigger("curriculum-report:load:complete")},setClass:function(){var e;this.get("curriculumID")||(e=!1,this.set("class",sw.user.classes.getCurrentClass()),this.set("curriculumID",sw.user.classes.getCurrentClass().getCurriculumIDFromTeachersCurriculum()))}}),SW.CurriculumReportStrandView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--strand",events:{"click .js-toggle-expectations-list":"showHideExpectationsList","mouseenter .js-strand-progress":"showProgressBarTooltip","mouseleave .js-strand-progress":"closeTooltip","mouseenter .js-strand-medium-warning":"showMediumWarningTooltip","mouseleave .js-strand-medium-warning":"closeTooltip","mouseenter .js-strand-high-warning":"showHighWarningTooltip","mouseleave .js-strand-high-warning":"closeTooltip"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#curriculum-report-strand-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.renderWarning(),this.renderProgressBar(),this.renderExpectationsList(),this.$el},renderWarning:function(){this.model.get("num_danger_skills")>1?this.$(".js-strand-warning").addClass("js-strand-high-warning nested-list__item-column--high-warning"):1==this.model.get("num_danger_skills")&&this.$(".js-strand-warning").addClass("js-strand-medium-warning nested-list__item-column--medium-warning")},renderProgressBar:function(){
this.childViews.progressBar=new SW.ProgressBarView({elementClassModifiers:"progress-bar--mini",model:new SW.ProgressBar({total:this.model.get("total_student_skill_masteries"),segments:[{key:"num_student_skill_masteries",value:this.model.get("num_student_skill_masteries"),elementClassModifiers:"progress-bar__segment--green"}]})}),this.$(".js-strand-progress").html(this.childViews.progressBar.render())},renderExpectationsList:function(){var e=this.model.get("expectations");e&&(this.childViews.expectations=new SW.NestedListView({itemView:SW.CurriculumReportExpectationView,collection:new SW.Collection(e)}),this.$(".js-expectations-list").html(this.childViews.expectations.render()))},showHideExpectationsList:function(){this.$(".js-toggle-expectations-list").toggleClass("nested-list__item-row--expanded"),this.$(".js-expectations-list").slideToggle(300)},showProgressBarTooltip:function(e){var t=parseInt(this.model.get("num_student_skill_masteries")/this.model.get("total_student_skill_masteries")*100);this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"Your students have <strong>mastered "+t+"%</strong> of this strand."}})},showMediumWarningTooltip:function(e){this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"One or more skills are being struggled on."}})},showHighWarningTooltip:function(e){this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"Many skills are being struggled on."}})}}),SW.CurriculumReportExpectationView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--expectation",events:{"click .js-toggle-skills-list":"showHideSkillsList","mouseenter .js-expectation-progress":"showProgressBarTooltip","mouseleave .js-expectation-progress":"closeTooltip","mouseenter .js-expectation-medium-warning":"showMediumWarningTooltip","mouseleave .js-expectation-medium-warning":"closeTooltip","mouseenter .js-expectation-high-warning":"showHighWarningTooltip","mouseleave .js-expectation-high-warning":"closeTooltip"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#curriculum-report-expectation-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.renderWarning(),this.renderProgressBar(),this.renderSkillsList(),this.$el},renderWarning:function(){this.model.get("num_danger_skills")>1?this.$(".js-expectation-warning").addClass("js-expectation-high-warning nested-list__item-column--high-warning"):1==this.model.get("num_danger_skills")&&this.$(".js-expectation-warning").addClass("js-expectation-medium-warning nested-list__item-column--medium-warning")},renderProgressBar:function(){this.childViews.progressBar=new SW.ProgressBarView({elementClassModifiers:"progress-bar--mini",model:new SW.ProgressBar({total:this.model.get("total_student_skill_masteries"),segments:[{key:"num_student_skill_masteries",value:this.model.get("num_student_skill_masteries"),elementClassModifiers:"progress-bar__segment--green"}]})}),this.$(".js-expectation-progress").html(this.childViews.progressBar.render())},renderSkillsList:function(){var e=this.model.get("skills");e&&(this.childViews.skills=new SW.NestedListView({itemView:SW.CurriculumReportSkillView,collection:new SW.Collection(e,{model:SW.CurriculumReportSkill})}),this.$(".js-skills-list").html(this.childViews.skills.render()))},showHideSkillsList:function(){this.$(".js-toggle-skills-list").toggleClass("nested-list__item-row--expanded"),this.$(".js-expectation-legend").toggleClass("hidden"),this.$(".js-skills-list").slideToggle(200)},showProgressBarTooltip:function(e){var t=parseInt(this.model.get("num_student_skill_masteries")/this.model.get("total_student_skill_masteries")*100);this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"Your students have <strong>mastered "+t+"%</strong> of this expectation."}})},showMediumWarningTooltip:function(e){this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"One or more skills are being struggled on."}})},showHighWarningTooltip:function(e){this.createTooltip({reference:$(e.currentTarget),node:{classNames:"tooltip--dark text-center no-select",content:"Many skills are being struggled on."}})}}),SW.CurriculumReportSkillView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--skill",events:{"click .js-toggle-skill-detail":"showHideSkillDetail"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#curriculum-report-skill-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.renderWarning(),this.renderProgressBar(),this.renderSkillDetail(),this.$el},renderWarning:function(){this.model.get("num_danger_skills")>1?this.$(".js-skill-warning").addClass("js-skill-warning--high"):1==this.model.get("num_danger_skills")&&this.$(".js-skill-warning").addClass("js-skill-warning--medium")},renderProgressBar:function(){this.childViews.progressBar=new SW.ProgressBarView({style:"100-percent",model:new SW.ProgressBar({segments:[{key:"num_struggling",value:this.model.get("num_struggling"),elementClassModifiers:"progress-bar__segment--cinnabar"},{key:"num_not_started",value:this.model.get("num_not_started"),elementClassModifiers:"progress-bar__segment--alto"},{key:"num_in_progress",value:this.model.get("num_in_progress"),elementClassModifiers:"progress-bar__segment--dusty"},{key:"num_mastered",value:this.model.get("num_mastered"),elementClassModifiers:"progress-bar__segment--green"}]})}),this.$(".js-skill-progress-breakdown").html(this.childViews.progressBar.render())},renderSkillDetail:function(){this.childViews.SkillDetail=new SW.CurriculumReportSkillDetailView({model:this.model}),this.$(".js-skill-detail").html(this.childViews.SkillDetail.render())},showHideSkillDetail:function(){this.renderSkillQuestion(),this.$(".js-skill-detail").slideToggle(200),this.$(".js-toggle-skill-detail").toggleClass("nested-list__item-row--expanded")},renderSkillQuestion:function(){this.childViews.sampleQuestion||(this.childViews.sampleQuestion=Controller.displayQuestion({containerID:this.$(".js-skill-detail-sample-question").attr("id"),skillID:this.model.get("id"),isMinimal:!0}))}}),SW.CurriculumReportSkill=SW.Model.extend({initialize:function(e){this._super("initialize",arguments),this.set("name",SW.Education.skills[this.get("id")].name),this.initializeStudents()},initializeStudents:function(){var e=sw.user.classes.getCurrentClass().students.toJSON();this.set({strugglingStudents:[],notStartedStudents:[],inProgressStudents:[],masteredStudents:[]}),_.forEach(e,function(e){var t=_.find(this.get("students"),{id:e.userID}),i={fullname:e.fullname};t?(_.merge(i,{correct:t.correct,incorrect:t.incorrect}),i.correct+i.incorrect>0&&(i.grade=Math.floor(i.correct/(i.correct+i.incorrect)*100)),t.date_mastered?this.get("masteredStudents").push(i):t.is_struggling?this.get("strugglingStudents").push(i):t.correct||t.incorrect?this.get("inProgressStudents").push(i):this.get("notStartedStudents").push(i)):(_.merge(i,{correct:0,incorrect:0,grade:0}),this.get("notStartedStudents").push(i))}.bind(this))}}),SW.CurriculumReportSkillDetailView=SW.ParentView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--skill-detail",events:{"click .js-toggle-skill-detail":"showHideSkillDetail","click .js-toggle-student-breakdown-list":"showHideStudentBreakdown","mouseenter .js-skill-detail-student":"renderTooltip","mouseleave .js-skill-detail-student":"closeTooltip"},initialize:function(){this._super("initialize",arguments),this.template={base:Handlebars.compile($("#curriculum-report-skill-detail-template").html()),gradeTooltip:Handlebars.compile($("#curriculum-report-skill-detail-grade-tooltip-template").html())}},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),this.$el},renderTooltip:function(e){var t=$(e.currentTarget),i=this.template.gradeTooltip({correct:t.data("correct"),incorrect:t.data("incorrect"),grade:t.data("grade")});this.createTooltip({reference:t,node:{content:i,classNames:"tooltip--dark text-center no-select"}})},showHideStudentBreakdown:function(e){$(e.currentTarget).parent().find(".student-breakdown__list").toggleClass("student-breakdown__list--expanded")}}),SW.ActivityReportPageView=SW.AppPageView.extend({initialize:function(){this._super("initialize"),this.childViews.report=new SW.ActivityReportView({model:new SW.ActivityReport({startTime:this.model.get("startTime"),endTime:this.model.get("endTime")})})},renderPage:function(){this.setPageGutter(),this.$page.html(this.childViews.report.render()),this.renderBreadcrumbs(this.breadcrumbs())},breadcrumbs:function(){var e,t=[{href:"#reports",text:"Reports"},{href:"#reports/activity-report",text:"Weekly Activity"}];return sw.user.parentApp()&&(t.unshift({href:"#my-kids",text:"My Kids"}),e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),t.splice(1,0,{href:"#profile",text:SW.Utility.firstName(e.name)})),{data:t}}}),SW.ActivityReportPage=SW.AppPage.extend({initialize:function(e){this.listenToOnce(sw.dispatcher,"activity-report:load:complete",this.loadComplete),this._super("initialize",e),this.set({startTime:e.startTime||0,endTime:e.endTime||0}),this.load()},load:function(){this._super("load")},loadComplete:function(){this.trigger("loading:completed")}}),SW.ActivityReportView=SW.ReportView.extend({className:SW.ReportView.prototype.className+" curriculum-report",initialize:function(){this._super("initialize",arguments),this.template.base=this.findTemplate("activity-report"),this.createContent(),this.createDateRange()},createContent:function(){this.childViews.content||(this.childViews.content=new SW.NestedListView({itemView:SW.ActivityReportSkillView,collection:new SW.Collection(null,{model:SW.ActivityReportSkill})}))},createDateRange:function(){this.childViews.dateRange||(this.childViews.dateRange=new SW.DateRangeView({model:this.model.dateRangeObject}),this.listenTo(this.model.dateRangeObject,"range:shifted",this.dateRangeShift))},renderContent:function(){this.resetContent(),this.renderDateRange(),this._super("renderContent",arguments)},resetContent:function(){this.childViews.content.collection.reset(this.model.get("data"))},renderDateRange:function(){this.$(".js-date-range__container").html(this.childViews.dateRange.render()),this.childViews.dateRange.delegateEvents()},dateRangeShift:function(){var e=this.model.dateRangeObject.getDateRange();this.renderLoading(),this.model.set("dateRange",e),this.model.loadReport()}}),SW.ActivityReport=SW.Report.extend({defaults:{title:"Weekly Activity Report",dateRange:{}},initialize:function(){this.dateRangeObject=new SW.DateRange({rangeType:"week",rangeOffset:1,startTime:this.get("startTime"),endTime:this.get("endTime")}),this.set("dateRange",this.dateRangeObject.getDateRange()),this._super("initialize",arguments)},load:function(){this.beforeLoad(),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:this.loadDependenciesSuccess.bind(this),fail:this.loadDependenciesFailure.bind(this)})},loadDependenciesSuccess:function(){this.loadReport()},loadReport:function(){var e=moment(this.get("dateRange").startTime),t=moment(this.get("dateRange").endTime);1e3*e.unix()<sw.config.statsStartTime?SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+sw.user.classes.getCurrentClassID()+"/activity-report",data:{user_id:sw.user.get("userID"),start_time:this.get("dateRange").startTime,end_time:this.get("dateRange").endTime},success:function(e){this.set("data",this.sortSkills(e.skills)),this.afterLoad()}.bind(this),error:function(){this.afterLoad("There was an error loading the activity report.")}.bind(this)}):SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+sw.user.classes.getCurrentClassID()+"/stats",data:{userID:sw.user.get("userID"),startDate:e.format("YYYY-MM-DD"),endDate:t.format("YYYY-MM-DD")},success:function(e){var t={},i=[];_.forIn(e,function(e){_.forIn(e,function(e){_.forEach(e.skills,function(e){t[e.skill_id]||(t[e.skill_id]={},t[e.skill_id].questions_answered=0,t[e.skill_id].questions_at_school=0,t[e.skill_id].questions_correct=0,t[e.skill_id].seconds_spent=0),t[e.skill_id].questions_answered+=e.questions_answered,t[e.skill_id].questions_at_school+=e.questions_at_school,t[e.skill_id].questions_correct+=e.questions_correct,t[e.skill_id].seconds_spent+=e.seconds_spent,t[e.skill_id].grade=t[e.skill_id].questions_correct/t[e.skill_id].questions_answered*100,t[e.skill_id].students||(t[e.skill_id].students={}),t[e.skill_id].students[e.user_id]||(t[e.skill_id].students[e.user_id]={},t[e.skill_id].students[e.user_id].questions_answered=0,t[e.skill_id].students[e.user_id].questions_at_school=0,t[e.skill_id].students[e.user_id].questions_correct=0,t[e.skill_id].students[e.user_id].seconds_spent=0),t[e.skill_id].students[e.user_id].questions_answered+=e.questions_answered,t[e.skill_id].students[e.user_id].questions_at_school+=e.questions_at_school,t[e.skill_id].students[e.user_id].questions_correct+=e.questions_correct,t[e.skill_id].students[e.user_id].seconds_spent+=e.seconds_spent})})}),_.forIn(t,function(e,t){var s=[],n=[],a=[];_.forIn(e.students,function(e,t){var i=e.questions_correct/e.questions_answered,e={id:t,correct:e.questions_correct,incorrect:e.questions_answered-e.questions_correct,grade:i};i<.6?a.push(e):i<.8?n.push(e):s.push(e)}),i.push({id:t,good_students:s,average_students:n,struggling_students:a})}),this.set("data",this.sortSkills(i)),this.afterLoad()}.bind(this),error:function(){this.afterLoad("There was an error loading the activity report.")}.bind(this)})},sortSkills:function(e){return e.sort(function(e,t){var i=e.struggling_students.length+e.average_students.length+e.good_students.length,s=t.struggling_students.length+t.average_students.length+t.good_students.length;return i>s?-1:i<s?1:e.struggling_students.length>t.struggling_students.length?-1:e.struggling_students.length<t.struggling_students.length?1:0}),e},loadDependenciesFailure:function(){this.afterLoad("There was an error loading the activity report.")},afterLoad:function(){this._super("afterLoad",arguments),sw.dispatcher.trigger("activity-report:load:complete")}}),SW.ActivityReportSkillView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--strand",events:{"click .js-toggle-skill-detail":"showHideSkillDetail","click .js-show-sample-question":"showSampleQuestionToolTip"},initialize:function(){this._super("initialize",arguments),this.template=Handlebars.compile($("#activity-report-skill-template").html())},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.renderSkillDetail(),this.$el},renderSkillDetail:function(){this.childViews.SkillDetail=new SW.ActivityReportSkillDetailView({model:this.model}),this.$(".js-skill-detail").html(this.childViews.SkillDetail.render())},showHideSkillDetail:function(){this.renderSkillQuestion(),this.$(".js-skill-detail").slideToggle(200),this.$(".js-toggle-skill-detail").toggleClass("nested-list__item-row--expanded")},renderSkillQuestion:function(){this.childViews.sampleQuestion||(this.childViews.sampleQuestion=Controller.displayQuestion({containerID:this.$(".js-skill-detail-sample-question").attr("id"),skillID:this.model.get("id"),isMinimal:!0}))},showSampleQuestionToolTip:function(){var e=this.$(event.target),t="js-tooltip-sample-question-"+this.model.get("id"),i=this.model.get("id");this.childViews.tooltip&&this.closeTooltip(),this.createTooltip({reference:this.$(".js-show-sample-question"),node:{classNames:"js-tooltip-sample-question tooltip--sample-question no-select",content:'<div id="'+t+'" class="tooltip__content" />'},closeOnClick:!0,onCreate:function(){Controller.displayQuestion({containerID:t,skillID:i,isMinimal:!0})},trigger:e})}}),SW.ActivityReportSkill=SW.Model.extend({initialize:function(){var e=sw.user.parentApp(),t=function(e){return Math.round(e.correct/(e.correct+e.incorrect)*100)};this._super("initialize",arguments),this.set({isParentApp:e,name:SW.Education.skills[this.get("id")].name}),e?this.get("struggling_students").length?this.set({activityReportSummaryPercentCorrect:t(this.get("struggling_students")[0]),activityReportSummaryClass:"activity-report__num-struggling"}):this.get("average_students").length?this.set({activityReportSummaryPercentCorrect:t(this.get("average_students")[0]),activityReportSummaryClass:"activity-report__num-average"}):this.get("good_students").length&&this.set({activityReportSummaryPercentCorrect:t(this.get("good_students")[0]),activityReportSummaryClass:"activity-report__num-good"}):this.set({numStruggling:this.get("struggling_students").length,numAverage:this.get("average_students").length,numGood:this.get("good_students").length,strugglingStudentsOpacityClass:"",averageStudentsOpacityClass:"",goodStudentsOpacityClass:""}),this.initializeStudents()},initializeStudents:function(){var e="activity-report__counter--disabled";this.formatStudentData(this.get("struggling_students")),this.formatStudentData(this.get("average_students")),this.formatStudentData(this.get("good_students")),0===this.get("struggling_students").length&&this.set("strugglingStudentsOpacityClass",e),0===this.get("average_students").length&&this.set("averageStudentsOpacityClass",e),0===this.get("good_students").length&&this.set("goodStudentsOpacityClass",e)},formatStudentData:function(e){e.forEach(function(e){var t=sw.user.classes.getCurrentClass().students.get(e.id);e.name="Unknown Student",e&&(e.name=t.get("name")),e.grade<=1&&(e.grade*=100)})}}),SW.ActivityReportSkillDetailView=SW.ParentView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--skill-detail",events:{"click .js-toggle-skill-detail":"showHideSkillDetail","click .js-toggle-student-breakdown-list":"showHideStudentBreakdown","mouseenter .js-skill-detail-student":"renderTooltip","mouseleave .js-skill-detail-student":"closeTooltip"},initialize:function(){this._super("initialize",arguments),this.template={base:this.findTemplate("activity-report-skill-detail"),gradeTooltip:this.findTemplate("curriculum-report-skill-detail-grade-tooltip")}},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),this.$el},renderTooltip:function(e){var t=$(e.currentTarget),i=this.template.gradeTooltip({correct:t.data("correct"),incorrect:t.data("incorrect"),grade:t.data("grade")});this.createTooltip({reference:t,node:{content:i,classNames:"tooltip--dark text-center no-select"}})},showHideStudentBreakdown:function(e){$(e.currentTarget).parent().find(".student-breakdown__list").toggleClass("student-breakdown__list--expanded")}}),SW.AccountSettingsView=SW.AppPageView.extend({initialize:function(){return this._super("initialize",arguments),this.template.page=Handlebars.compile($("#account-settings-template").html()),this.initializeSections(),this.initializeSubnavigation(),this},initializeSections:function(){return this.childViews.sections={general:new SW.GeneralAccountSettingsSectionView({model:new SW.GeneralAccountSettingsSection}),password:new SW.PasswordAccountSettingsSectionView({model:new SW.PasswordAccountSettingsSection}),email:new SW.EmailAccountSettingsSectionView({model:new SW.EmailAccountSettingsSection}),"account-type":new SW.AccountTypeSettingsSectionView({model:new SW.AccountTypeSettingsSection})},this},initializeSubnavigation:function(){var e={};return _.each(this.childViews.sections,function(t){e[t.model.get("slug")]=t.model.get("title")}),this.childViews.subnavigation=new SW.SubnavigationView({model:new SW.Subnavigation({items:e})}),this.listenTo(this.childViews.subnavigation,"subnavigation:select",function(e){this.renderSection(this.childViews.sections[e])}),this},renderPage:function(){return this.$page.html(this.template.page),this.setPageGutter(),this.renderSubnavigation(),this.renderSection(this.childViews.sections.general),this.childViews.subnavigation.activateItem("general"),this},renderSubnavigation:function(){return this.$("#account-settings__subnavigation").html(this.childViews.subnavigation.render()),this},renderSection:function(e){return e.setElement(this.$("#account-settings__section")).render(),this}}),SW.AccountSettings=SW.AppPage.extend({defaults:function(){return _.extend({},SW.AppPage.prototype.defaults,{page:{id:"account",title:"Account Settings",appNavLinkID:"",rootTitle:"Dashboard",rootRouterName:""}})},initialize:function(){this._super("initialize",arguments)}}),SW.AccountSettingsSectionView=SW.ParentView.extend({events:{"change #disable-communication-input":"disableAllCommunication"},initialize:function(e){this._super("initialize",arguments),this.template={base:Handlebars.compile($("#"+this.model.get("slug")+"-account-settings-section-template").html()),error:Handlebars.compile($("#account-settings-section-error-template").html())}},disableAllCommunication:function(e){var t=$(e.target),i=t.is(":checked");i&&$("#email-account-settings-form-report-frequency").val(0),$("#email-account-settings-form-report-frequency").prop("disabled",i)},handleSubmitSuccess:function(e,t){sw.toastManager.create({id:"account-settings-submit-success",type:"success",content:"Your account settings have been saved.",timer:3e3})},handleSubmitError:function(e,t){sw.toastManager.create({id:"account-settings-submit-error",type:"error",content:"Your account settings could not be saved.",timer:3e3})},handleLoadError:function(e){this.$el.html(this.template.error(this.model.toJSON()))}}),SW.AccountSettingsSection=SW.Model.extend({}),SW.GeneralAccountSettingsSectionView=SW.AccountSettingsSectionView.extend({initialize:function(e){this._super("initialize",arguments)},render:function(){return this.model.load({done:function(){this.$el.html(this.template.base(this.model.toJSON())),this.initializeForm()}.bind(this)}),this.$el},initializeForm:function(){this.form=new SW.FormView({el:this.$("#general-account-settings-form"),fetch:{method:"POST",dataType:"text",url:sw.config.api.accounts+"/v2/user/"+this.model.get("userID"),success:this.handleSubmitSuccess.bind(this),error:this.handleSubmitError.bind(this)},formatData:function(e){return{change_fields:JSON.stringify(_.pick(e,["email","name"]))}}})},handleSubmitSuccess:function(e,t){var i=JSON.parse(t.change_fields);sw.user.set("name",i.name),sw.user.set("email",i.email),sw.user.updateSession({name:i.name,email:i.email}),this._super("handleSubmitSuccess",e,t)}}),SW.GeneralAccountSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"general",title:"General Settings"},load:function(e){this.set({userID:sw.user.get("userID"),username:sw.user.get("username"),email:sw.user.get("email"),name:sw.user.get("name")}),e.done()}}),SW.PasswordAccountSettingsSectionView=SW.AccountSettingsSectionView.extend({initialize:function(e){this._super("initialize",arguments)},render:function(){return this.model.load({done:function(){this.$el.html(this.template.base(this.model.toJSON())),this.initializeForm()}.bind(this)}),this.$el},initializeForm:function(){this.form=new SW.FormView({el:this.$("#password-account-settings-form"),fetch:{method:"POST",dataType:"json",url:"/includes/server/routers/user.php",success:this.handleSubmitSuccess.bind(this),error:this.handleSubmitError.bind(this)},formatData:function(e){return _.merge(_.pick(e,["password"]),{method:"set-password"})}})}}),SW.PasswordAccountSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"password",title:"Change Password"},load:function(e){this.set({userID:sw.user.get("userID")}),e.done()}}),SW.EmailAccountSettingsSectionView=SW.AccountSettingsSectionView.extend({initialize:function(e){this._super("initialize",arguments)},render:function(){return this.createDialog({type:"load"}),this.model.load({success:function(e){this.closeDialog(),this.$el.html(this.template.base(this.model.toJSON())),this.initializeForm()}.bind(this),error:function(e){this.closeDialog(),this._super("handleLoadError",e)}.bind(this)}),this.$el},initializeForm:function(){var e=this.$("#email-account-settings-form");this.form=new SW.FormView({el:e,fetch:{method:"POST",dataType:"text",url:sw.config.api.accounts+"/v2/user/"+sw.user.get("userID")+"/email-preferences",success:this.handleSubmitSuccess.bind(this),error:this.handleSubmitError.bind(this)},formatData:function(e){return{updateData:JSON.stringify({isOptedOut:null!=e["email-opt-out"]})}}})},handleLoadError:function(e){}}),SW.EmailAccountSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"email",title:"Email Preferences"},load:function(e){SW.Http.fetch({url:sw.config.api.accounts+"/v2/user/"+sw.user.get("userID")+"/email-preferences",success:function(t){this.handleLoadSuccess(t,e)}.bind(this),error:e.error})},handleLoadSuccess:function(e,t){this.set({isOptedOut:null!=e.emailOptOutsID}),t.success(e)}}),SW.MembershipsAccountSettingsSectionView=SW.AccountSettingsSectionView.extend({render:function(){window.location.href="/licenses/"}}),SW.MembershipsAccountSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"memberships",title:"Manage Memberships"}}),SW.LocationAccountSettingsSectionView=SW.AccountSettingsSectionView.extend({initialize:function(e){this._super("initialize",arguments)},render:function(){return this.model.load({done:function(e){this.$el.html(this.template.base(this.model.toJSON())),this.initializeLocationSelect(),this.initializeCurriculumSelect(),this.initializeForm()}.bind(this)}),this.$el},initializeForm:function(){var e=this.$("#location-account-settings-form");this.form=new SW.FormView({el:e,fetch:{method:"POST",url:sw.config.api.web+"/v1/teacher/"+sw.user.get("userID")+"/location",success:this.handleSubmitSuccess.bind(this),error:this.handleSubmitError.bind(this)},formatData:function(){return{locationID:this.childViews.locationSelect.model.get("chosenLocationID")}}.bind(this)})},initializeLocationSelect:function(){this.childViews.locationSelect&&this.childViews.locationSelect.close(),this.childViews.locationSelect=new SW.LocationSelectView({model:new SW.LocationSelect({skippable:!1})}),this.childViews.locationSelect.template.base=Handlebars.compile($("#account-settings-section-location-select-template").html()),this.$("#location-account-settings").append(this.childViews.locationSelect.render()),this.childViews.locationSelect.setLocation(1,"School name","Board name")},initializeCurriculumSelect:function(){this.childViews.curriculumSelect&&this.childViews.curriculumSelect.close(),this.childViews.curriculumSelect=new SW.CurriculumSelectView({model:new SW.CurriculumSelect}),this.$el.find("#location-account-settings").append(this.childViews.curriculumSelect.render())},handleLoadError:function(e){}});SW.LocationAccountSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"location",title:"Location Settings"},load:function(e){e.done()}}),SW.AccountTypeSettingsSectionView=SW.AccountSettingsSectionView.extend({events:{"click .js-migrate":"runMigration","click .js-learn-more":"onClickLearnMore"},initialize:function(){this._super("initialize",arguments),this.listenTo(sw.user,"change:usertype",this.render)},render:function(){return this.$el.html(this.template.base(_.assign(this.model.toJSON(),{userType:sw.user.get("usertype")}))),this.$el},runMigration:function(){var e=sw.user.get("usertype"),t="parent"===e?"teacher":"parent";this.createDialog({type:"confirmation",title:"Update Account",main:"You are about to update your account to the <b>"+t+" experience</b>!",buttons:[{text:"Back"},{text:"Update",className:"btn-flat--primary",callback:function(){sw.dispatcher.trigger("dialog:loader-overlay:create"),SW.Http.fetch({url:sw.config.api.accounts+"/v2/migration/"+t,method:"POST",success:this.handleSubmitSuccess.bind(this,t),error:this.handleSubmitError.bind(this)})}.bind(this)}]})},handleSubmitSuccess:function(e){this.createDialog({className:"dialog dialog--basic",type:"custom",size:"medium",children:[{view:SW.MigrationSuccessDialogView,model:SW.MigrationSuccessDialog,modelData:{userType:e}}]})},handleSubmitError:function(){sw.toastManager.create({id:"migrate-account-submit-error",type:"error",content:"Your account settings could not be saved.",timer:3e3})},onClickLearnMore:function(){SW.Logger.track("migrate-user:learn-more-clicked")}}),SW.AccountTypeSettingsSection=SW.AccountSettingsSection.extend({defaults:{slug:"account-type",title:"Account Type"}}),SW.MigrationDialogView=SW.ParentView.extend({className:"migration-dialog-view",events:{"click .js-select-parent":"selectParent","click .js-select-teacher":"selectTeacher","click .js-confirm":"runMigration","click .js-learn-more":"onClickLearnMore"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("migration-dialog"),this.listenTo(this.model,"change:selectedUserType",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),SW.Logger.track("migrate-user:dialog-shown"),this.$el},selectParent:function(){this.model.set("selectedUserType","parent")},selectTeacher:function(){this.model.set("selectedUserType","teacher")},runMigration:function(){this.askForConfirmation(this.model.get("selectedUserType"))},askForConfirmation:function(e){this.createDialog({type:"confirmation",title:"Update Account",main:"You are about to update your account to the <b>"+e+" experience</b>!",buttons:[{text:"Back",callback:function(){_.delay(function(){this.createDialog({className:"dialog dialog--basic dialog--tall",type:"custom",size:"medium",children:[{view:SW.MigrationDialogView,model:SW.MigrationDialog}]})}.bind(this),200)}.bind(this)},{text:"Update",className:"btn-flat--primary",callback:function(){sw.dispatcher.trigger("dialog:loader-overlay:create"),SW.Http.fetch({url:sw.config.api.accounts+"/v2/migration/"+e,method:"POST",success:this.handleSubmitSuccess.bind(this,e),error:this.handleSubmitError.bind(this)})}.bind(this)}]})},handleSubmitSuccess:function(e){this.createDialog({className:"dialog dialog--basic",type:"custom",size:"medium",children:[{view:SW.MigrationSuccessDialogView,model:SW.MigrationSuccessDialog,modelData:{userType:e}}]})},handleSubmitError:function(){sw.toastManager.create({id:"migrate-account-submit-error",type:"error",content:"Your account settings could not be saved.",timer:3e3})},onClickLearnMore:function(){SW.Logger.track("migrate-user:learn-more-clicked")}}),SW.MigrationDialog=SW.Model.extend({defaults:{selectedUserType:null}}),SW.MigrationSuccessDialogView=SW.ParentView.extend({className:"migration-dialog-success-view",events:{"click .js-okay":"closeDialog"},initialize:function(){this._super("initialize",arguments),SW.Logger.track("migrate-user:migrate-to-"+this.model.get("userType")+"-complete"),this.template=this.findTemplate("migration-success-dialog")},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el},closeDialog:function(){var e=this.model.get("userType");sw.user.set("usertype",e),sw.user.updateSession({usertype:e},function(){this._super("closeDialog",arguments),sw.app.hardReload("#classes")}.bind(this)),sw.user.tutorials.save(SW.Tutorials.PARENT_APP_MIGRATION)},onClickLearnMore:function(){SW.Logger.track("migrate-user:learn-more-clicked")}}),SW.MigrationSuccessDialog=SW.Model.extend({defaults:{userType:null}}),SW.StudentUsageReportPage=SW.AppPage.extend({initialize:function(){this._super("initialize"),this.load()},load:function(){this._super("load"),SW.Loader.whenLoaded({context:this,entities:[sw.user.classes],success:function(){this.isLoading=!1,this.trigger("loading:completed")}.bind(this),fail:function(){this.isLoading=!1,this.trigger("loading:failed")}.bind(this)})}}),SW.StudentUsageReportPageView=SW.AppPageView.extend({setLoadedState:function(){this.childViews.report=new SW.StudentUsageReportView({model:new SW.StudentUsageReport({startTime:this.model.get("startTime"),
endTime:this.model.get("endTime")})}),this._super("setLoadedState",arguments)},renderPage:function(){this.setPageGutter(),this.$page.append(this.childViews.report.render()),this.renderBreadcrumbs(this.breadcrumbs())},breadcrumbs:function(){var e,t=sw.user.parentApp()?"Usage":SW.Lexicon("Student")+" Usage",i=[{href:"#reports",text:"Reports"},{href:"#reports/student-usage-report",text:t}];return sw.user.parentApp()&&(i.unshift({href:"#my-kids",text:"My Kids"}),e=sw.user.classes.getCurrentClass().students.at(0).toJSON(),i.splice(1,0,{href:"#profile",text:SW.Utility.firstName(e.name)})),{data:i}}}),SW.StudentUsageReport=SW.Report.extend({defaults:function(){var e,t=0;return sw.user.parentApp()&&(e=sw.user.classes.getCurrentClass().students.toJSON(),t=e[0].id),{dateRange:new SW.DateRange({rangeType:"week",rangeOffset:1}),filteredStudentID:t}},initialize:function(){this.set("dateRange",new SW.DateRange({rangeType:"week",rangeOffset:1,startTime:this.get("startTime"),endTime:this.get("endTime")})),this._super("initialize",arguments),this.on("change:filteredStudentID",this.updateCollectionFilter)},load:function(){var e=this.get("dateRange").getDateRange();this.beforeLoad(),e.startTime<sw.config.statsStartTime?SW.Http.fetch({url:sw.config.api.web+"/v1/class/"+sw.user.classes.getCurrentClassID()+"/student-usage-report",data:{user_id:sw.user.get("userID"),start_time:e.startTime,end_time:e.endTime,time_zone:moment.tz.guess()},success:function(e){this.parseData(e),this.afterLoad()}.bind(this),error:function(e){this.afterLoad("There was an error loading the student usage report.")}.bind(this)}):SW.Http.fetch({url:sw.config.api.reports+"/v1/classroom/"+sw.user.classes.getCurrentClassID()+"/student-usage",data:{userID:sw.user.get("userID"),startDate:moment(e.startTime).format("YYYY-MM-DD"),endDate:moment(e.endTime).format("YYYY-MM-DD")},success:function(e){this.parseData(e),this.afterLoad()}.bind(this),error:function(e){this.afterLoad("There was an error loading the student usage report.")}.bind(this)})},isFiltered:function(){return 0!==this.get("filteredStudentID")},parseData:function(e){var t,i=_.map(e.data,function(e){return e.studentData}),s=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"],n=new SW.StudentUsageDailyTotalRowCollection;this.studentUsageDailyTotalRowCollection=n,_.map(i,function(e,i){var a={day:s[i],order:i},r=0,o=0,l=_.map(e,function(e){var t=sw.user.classes.getCurrentClass().students.get(e.studentID);return r+=e.questionsAtHome,o+=e.questionsInSchool,{id:t?t.id:0,name:t?t.simpleName():"Unknown Student",atHome:e.questionsAtHome,atSchool:e.questionsInSchool,total:e.questionsAtHome+e.questionsInSchool}});t=n.add(a),t.studentUsageRowCollection.add(l)}),this.updateCollectionFilter()},afterLoad:function(e){this._super("afterLoad",arguments),this.trigger("student-usage-report:load:complete"),sw.dispatcher.trigger("student-usage-report:load:complete")},updateCollectionFilter:function(){this.studentUsageDailyTotalRowCollection.filteredStudentID=this.get("filteredStudentID")},getGraphData:function(){return this.studentUsageDailyTotalRowCollection.buildGraphData()}}),SW.StudentUsageRow=SW.Model.extend({defaults:{id:0,name:"",atHome:0,atSchool:0,total:0}}),SW.StudentUsageDailyTotalRow=SW.Model.extend({defaults:{day:"",order:0},initialize:function(){this.studentUsageRowCollection=new SW.StudentUsageRowCollection},isFiltered:function(){return this.collection&&0!==this.collection.filteredStudentID},atHome:function(){return this.isFiltered()?this.studentUsageRowCollection.get(this.collection.filteredStudentID).get("atHome"):this.studentUsageRowCollection.reduce(function(e,t){return e+t.get("atHome")},0)},atSchool:function(){return this.isFiltered()?this.studentUsageRowCollection.get(this.collection.filteredStudentID).get("atSchool"):this.studentUsageRowCollection.reduce(function(e,t){return e+t.get("atSchool")},0)},total:function(){return this.isFiltered()?this.studentUsageRowCollection.get(this.collection.filteredStudentID).get("total"):this.studentUsageRowCollection.reduce(function(e,t){return e+t.get("total")},0)},toJSON:function(){var e={atHome:this.atHome(),atSchool:this.atSchool(),total:this.total(),isFiltered:this.isFiltered()};return _.defaults(e,this.attributes)}}),SW.StudentUsageRowCollection=SW.Collection.extend({model:SW.StudentUsageRow,comparator:function(e){return-e.get("total")}}),SW.StudentUsageDailyTotalRowCollection=SW.Collection.extend({model:SW.StudentUsageDailyTotalRow,comparator:"order",initialize:function(){this.filteredStudentID=0},buildGraphData:function(){var e={atHome:[],atSchool:[]};return this.forEach(function(t){e.atHome.push(t.atHome()),e.atSchool.push(t.atSchool())}),e}}),SW.StudentUsageReportView=SW.ParentView.extend({className:"student-usage-report",events:{"click .js-reload-student-report":"refreshReport"},initialize:function(){this._super("initialize",arguments),this.template={base:this.findTemplate("student-usage-report"),error:this.findTemplate("student-usage-report-error")},this.childViews.studentUsageReportControlsView=new SW.StudentUsageReportControlsView({model:this.model}),this.childViews.studentUsageReportGraphView=new SW.StudentUsageReportGraphView({model:this.model}),this.childViews.studentUsageReportTableView=new SW.StudentUsageReportTableView({model:this.model}),this.listenTo(this.model,"student-usage-report:load:complete",this.render),this.listenTo(this.model.get("dateRange"),"range:shifted",this.refreshReport)},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),!this.model.loaded||this.model.loading?this.renderLoading():this.renderContent(),this.$el},refreshReport:function(){this.renderLoading(),this.model.load()},renderContent:function(){this.$(".js-loader-container").addClass("gone"),this.$(".js-report-content").html(""),this.model.error?this.$(".js-report-content").append(this.template.error({error:this.model.error})):(this.$(".js-report-content").append(this.childViews.studentUsageReportControlsView.render()),this.$(".js-report-content").append(this.childViews.studentUsageReportGraphView.render()),this.$(".js-report-content").append(this.childViews.studentUsageReportTableView.render()),this.childViews.studentUsageReportControlsView.delegateEvents(),this.childViews.studentUsageReportGraphView.delegateEvents(),this.childViews.studentUsageReportTableView.delegateEvents())},renderLoading:function(){this.$(".js-loader-container").removeClass("gone")}}),SW.StudentUsageReportControlsView=SW.ParentView.extend({className:"student-usage-report-controls",events:{"change .js-student-select":"studentSelected"},template:function(e){return this.findTemplate("student-usage-report-controls")(e)},initialize:function(e){this._super("initialize",arguments),this.childViews={},this.buildDateRange()},buildDateRange:function(){this.childViews.dateRange||(this.childViews.dateRange=new SW.DateRangeView({model:this.model.get("dateRange")}))},studentSelected:function(e){var t=0;_.isEmpty(e.currentTarget.value)||(t=parseInt(e.currentTarget.value)),this.model.set("filteredStudentID",t)},render:function(){return this.$el.html(this.template({isFiltered:this.model.isFiltered(),filteredStudentID:this.model.get("filteredStudentID"),students:sw.user.classes.getCurrentClass().students.toJSON()})),this.$(".js-date-range__container").html(this.childViews.dateRange.render()),this.childViews.dateRange.delegateEvents(),this.$el}}),SW.StudentUsageReportGraphView=SW.CardView.extend({className:"student-usage-report-graph",initialize:function(e){this._super("initialize",arguments),this.listenTo(this.model,"change:filteredStudentID",this.updateGraph),this.listenTo(this.model,"change:filteredStudentID",this.updateHeader)},render:function(){return this.$el.html(this.template({header:this.generateHeaderText(),main:this.findTemplate("student-usage-report-graph")()})),_.delay(_.bind(this.renderGraph,this),1),this.$el},renderGraph:function(){var e=this.model.getGraphData();this.chart=new Highcharts.Chart({chart:{type:"area",backgroundColor:"transparent",height:250,renderTo:"student-usage-report-graph-container"},credits:{enabled:!1},title:{text:""},xAxis:{categories:["MON","TUES","WED","THURS","FRI","SAT","SUN"],tickLength:0,title:{enabled:!1}},yAxis:{allowDecimals:!1,title:{text:""},labels:{formatter:function(){return this.value}}},tooltip:{shared:!0,valueSuffix:" questions"},plotOptions:{area:{stacking:"normal",lineWidth:5,marker:{enabled:!1}}},legend:{layout:"horizontal",align:"left",verticalAlign:"top",y:25,symbolWidth:35,symbolHeight:6,symbolPadding:8,symbolRadius:4,itemMarginBottom:11,itemStyle:{fontSize:"12px"}},series:[{name:"At home",color:"rgb(141, 68, 173)",fillColor:"rgba(141, 68, 173, 0.1)",lineColor:"rgb(141, 68, 173)",marker:{fillColor:"rgba(141, 68, 173, 1)",symbol:"circle"},data:e.atHome},{name:"At school",color:"rgb(41, 128, 185)",fillColor:"rgba(41, 128, 185, 0.2)",lineColor:"rgb(41, 128, 185)",marker:{fillColor:"rgba(41, 128, 185, 1)",symbol:"circle"},data:e.atSchool}]})},updateHeader:function(){this.$el.find(".card__header").html(this.generateHeaderText())},generateHeaderText:function(){var e=sw.user.classes.getCurrentClass().students.get(this.model.get("filteredStudentID")),t="",i="Questions Answered Overview";return e&&(t=e.get("fullname").split(" ")[0],i=t+"'s Questions Answered Overview"),i},updateGraph:function(){var e=this.model.getGraphData();this.chart.series[0].setData(e.atHome),this.chart.series[1].setData(e.atSchool)}}),SW.StudentUsageReportTableView=SW.CardView.extend({className:"student-usage-report-table",initialize:function(e){this._super("initialize",arguments),this.listenTo(this.model,"change:filteredStudentID",this.renderChildren),this.listenTo(this.model,"change:filteredStudentID",this.updateHeader)},render:function(){return this.$el.html(this.template({header:this.generateHeaderText(),main:this.findTemplate("student-usage-report-table")(),customClasses:{mainClass:"report__container"}})),this.renderChildren(),this.$el},renderChildren:function(){this.closeChildViews(),this.childViews.dateSummaryRows=new SW.NestedListView({itemView:SW.StudentUsageReportTableDateRowView,collection:this.model.studentUsageDailyTotalRowCollection}),this.$el.find(".student-usage-report-table__container").append(this.childViews.dateSummaryRows.render())},updateHeader:function(){this.$el.find(".card__header").html(this.generateHeaderText())},generateHeaderText:function(){var e=sw.user.classes.getCurrentClass().students.get(this.model.get("filteredStudentID")),t="",i="Questions Answered By Day";return e&&(t=e.get("fullname").split(" ")[0],i=t+"'s Questions Answered By Day"),i}}),SW.StudentUsageReportTableDateRowView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--usage-report-date",events:{"click .js-toggle-student-activity-list":"toggleStudentActivityList"},template:function(e){return this.findTemplate("student-usage-report-table-date-row")(e)},initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.childViews.studentSummaryRows=new SW.NestedListView({itemView:SW.StudentUsageReportTableStudentRowView,collection:this.model.studentUsageRowCollection}),this.$el.find(".js-students-list").html(this.childViews.studentSummaryRows.render()),this.$el},toggleStudentActivityList:function(){this.model.isFiltered()||(this.$(".js-toggle-student-activity-list").toggleClass("nested-list__item-row--expanded"),this.$(".js-students-list").slideToggle(300))}}),SW.StudentUsageReportTableStudentRowView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--usage-report-student",template:function(e){return this.findTemplate("student-usage-report-table-student-row")(e)},initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el}}),SW.AdminReportPage=SW.AppPage.extend({initialize:function(){this._super("initialize")}}),SW.AdminReportPageView=SW.AppPageView.extend({setLoadedState:function(){this.childViews.report=new SW.AdminReportView({model:new SW.AdminReport({startTime:this.model.get("startTime"),endTime:this.model.get("endTime")})}),this._super("setLoadedState",arguments)},renderPage:function(){this.setPageGutter(),this.$page.append(this.childViews.report.render()),this.renderBreadcrumbs(this.breadcrumbs())},breadcrumbs:function(){var e=[{href:"#reports",text:"Reports"},{href:"#reports/admin-report",text:"Admin Report"}];return{data:e}}}),SW.AdminReport=SW.Report.extend({defaults:{isWeekly:!1,isMonthly:!0,orderByActivity:!0,orderAlphabetically:!1,reportDateMinimum:new Date("2017-02-15")},initialize:function(){this.set("dateRange",new SW.DateRange({rangeType:"month",reportDateMinimum:this.get("reportDateMinimum")})),this._super("initialize",arguments)},load:function(){var e=this.get("dateRange").getDateRange(),t=moment(e.startTime).format("YYYY-MM-DD"),i=moment(e.endTime).format("YYYY-MM-DD");this.beforeLoad(),this.trigger("admin-report:load:start"),SW.Http.fetch({url:sw.config.api.reports+"/v1/admin/"+sw.user.get("userID")+"/schools-usage",data:{startDate:t,endDate:i},success:function(e){this.parseData(e),this.afterLoad()}.bind(this),error:function(){this.afterLoad("There was an error loading the admin report.")}.bind(this)})},setDateRangeType:function(e){var t=this.get("dateRange");t.updateDateRangeType(e),this.set({dateRange:t,isMonthly:"month"===e,isWeekly:"month"!==e})},setOrderBy:function(e){this.set({orderAlphabetically:"alphabetic"===e,orderByActivity:"alphabetic"!==e})},getCurrentMonth:function(){return this.get("dateRange").get("dateRangeText")},parseData:function(e){var t,i,s=this,n=[];_.forEach(e,function(e){t={locationID:e.locationID,school:e.school,board:e.board,questionsAtSchool:0,questionsAtHome:0,questionsAnswered:0},i=[],_.forOwn(e.data,function(e,s){i.push({userID:s,name:e.name,questionsAnswered:e.questionsAnswered,questionsAtSchool:e.questionsAtSchool,questionsAtHome:e.questionsAnswered-e.questionsAtSchool,minutesSpent:Math.ceil(e.secondsSpent/60)}),t.questionsAtSchool+=e.questionsAtSchool,t.questionsAtHome+=e.questionsAnswered-e.questionsAtSchool,t.questionsAnswered+=e.questionsAnswered}),s.get("orderByActivity")?t.teachers=i.sort(s.sortByActivity):t.teachers=i.sort(s.sortTeachersAlphabetically),0===t.teachers.length&&t.teachers.push({name:"No Teachers Found"}),n.push(t)}),n=s.get("orderByActivity")?n.sort(s.sortByActivity):n.sort(s.sortSchoolsAlphabetically),s.set("data",n)},sortTeachersAlphabetically:function(e,t){return e.name<t.name?-1:e.name>t.name?1:0},sortSchoolsAlphabetically:function(e,t){return e.school<t.school?-1:e.school>t.school?1:0},sortByActivity:function(e,t){return e.questionsAnswered<t.questionsAnswered?1:e.questionsAnswered>t.questionsAnswered?-1:0},afterLoad:function(){this._super("afterLoad",arguments),this.trigger("admin-report:load:complete")}}),SW.AdminReportView=SW.ParentView.extend({className:"admin-report",events:{"click .js-reload-admin-report":"refreshReport"},initialize:function(){this._super("initialize",arguments),this.template={base:this.findTemplate("admin-report"),error:this.findTemplate("admin-report-error")},this.childViews.adminReportControlsView=new SW.AdminReportControlsView({model:this.model}),this.childViews.adminReportGraphView=new SW.AdminReportGraphView({model:this.model}),this.childViews.adminReportTableView=new SW.AdminReportTableView({model:this.model}),this.listenTo(this.model,"admin-report:load:complete",this.render),this.listenTo(this.model,"admin-report:load:complete",this.hideSpinner),this.listenTo(this.model.get("dateRange"),"range:shifted",this.refreshReport),this.listenTo(this.model,"admin-report:load:start",this.renderLoading)},hideSpinner:function(){this.$(".js-loading-icon").addClass("gone")},render:function(){return this.$el.html(this.template.base(this.model.toJSON())),!this.model.loaded||this.model.loading?this.renderLoading():this.renderContent(),this.$el},refreshReport:function(){this.model.load()},renderContent:function(){this.$(".js-loader-container").addClass("gone"),this.$(".js-report-content").html(""),this.model.error?this.$(".js-report-content").append(this.template.error({error:this.model.error})):(this.$(".js-report-content").append(this.childViews.adminReportControlsView.render()),this.$(".js-report-content").append(this.childViews.adminReportGraphView.render()),this.$(".js-report-content").append(this.childViews.adminReportTableView.render()),this.childViews.adminReportControlsView.delegateEvents(),this.childViews.adminReportGraphView.delegateEvents(),this.childViews.adminReportTableView.delegateEvents())},renderLoading:function(){this.$(".js-loader-container").removeClass("gone")}}),SW.AdminReportControlsView=SW.ParentView.extend({className:"admin-report-controls",events:{"change .js-date-range-type":"updateDateRangeType","change .js-order-by":"updateOrderBy"},template:function(e){return this.findTemplate("admin-report-controls")(e)},initialize:function(){this._super("initialize",arguments),this.childViews={},this.buildDateRange()},updateDateRangeType:function(e){this.model.setDateRangeType(e.target.value),this.model.load()},updateOrderBy:function(e){this.model.setOrderBy(e.target.value),this.model.load()},buildDateRange:function(){this.childViews.dateRange||(this.childViews.dateRange=new SW.DateRangeView({model:this.model.get("dateRange")}))},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$(".js-date-range__container").html(this.childViews.dateRange.render()),this.childViews.dateRange.delegateEvents(),this.$el}}),SW.AdminReportGraphView=SW.CardView.extend({className:"admin-report-graph",initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template({header:this.generateHeaderText(),main:this.findTemplate("admin-report-graph")()})),_.delay(_.bind(this.renderGraph,this),1),this.$el},getGraphDataByTeacher:function(){var e=[],t=this.model.get("data")[0];return _.forEach(t.teachers,function(t){e.push([t.name,t.questionsAnswered])}),e},getGraphDataBySchool:function(){var e,t=[],i=this.model.get("data");return _.forEach(i,function(i){e=0,_.forEach(i.teachers,function(t){e+=t.questionsAnswered}),t.push([i.school,e])}),t},getGraphData:function(){var e,t=this.model.get("data");return e=1===t.length?this.getGraphDataByTeacher():this.getGraphDataBySchool()},renderGraph:function(){var e=this.getGraphData();this.chart=new Highcharts.Chart({chart:{type:"bar",backgroundColor:"transparent",renderTo:"admin-report-graph-container",height:80*e.length},colors:[],plotOptions:{series:{},bar:{color:"#8D44AD"}},title:{text:"Questions Answered ("+this.model.getCurrentMonth()+")"},xAxis:{type:"category",labels:{style:{fontSize:"13px",fontFamily:"Verdana, sans-serif"}}},yAxis:{min:0,allowDecimals:!1,title:{text:"Questions Answered"}},legend:{enabled:!1},tooltip:{pointFormat:"Questions answered: <b>{point.y}</b>"},series:[{name:"School Data",data:e}]})},updateHeader:function(){this.$el.find(".card__header").html(this.generateHeaderText())},generateHeaderText:function(){var e="School Usage Overview";return e},updateGraph:function(){var e=this.model.getGraphData();this.chart.series[0].setData(e.atHome),this.chart.series[1].setData(e.atSchool)}}),SW.AdminReportTableView=SW.CardView.extend({className:"student-usage-report-table",initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template({header:this.generateHeaderText(),main:this.findTemplate("admin-report-table")(),customClasses:{mainClass:"report__container"}})),this.renderChildren(),this.$el},renderChildren:function(){this.closeChildViews(),this.childViews.schoolSummaryRows=new SW.NestedListView({itemView:SW.AdminReportTableSchoolRowView,collection:new SW.Collection(this.model.get("data"),{model:SW.Model})}),this.$el.find(".admin-report-table__container").append(this.childViews.schoolSummaryRows.render())},updateHeader:function(){this.$el.find(".card__header").html(this.generateHeaderText())},generateHeaderText:function(){var e="Questions Answered Breakdown";return e}}),SW.AdminReportTableSchoolRowView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--usage-report-date",events:{"click .js-toggle-teacher-activity-list":"toggleTeacherActivityList"},template:function(e){return this.findTemplate("admin-report-table-school-row")(e)},initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.childViews.teacherSummaryRows=new SW.NestedListView({itemView:SW.AdminReportTableTeacherRowView,collection:new SW.Collection(this.model.get("teachers"),{model:SW.Model})}),this.$el.find(".js-teacher-list").html(this.childViews.teacherSummaryRows.render()),this.$el},toggleTeacherActivityList:function(){this.$(".js-toggle-teacher-activity-list").toggleClass("nested-list__item-row--expanded"),this.$(".js-teacher-list").slideToggle(300)}}),SW.AdminReportTableTeacherRowView=SW.NestedListItemView.extend({className:SW.NestedListItemView.prototype.className+" nested-list__item--usage-report-student",template:function(e){return this.findTemplate("admin-report-table-teacher-row")(e)},initialize:function(){this._super("initialize",arguments)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el}}),SW.MaintenanceMessage=SW.Model.extend({initialize:function(){this.fetch()},fetch:function(){SW.Http.fetch({url:sw.config.api.web+"/v1/maintenance-message",success:this.fetchSuccessCallback.bind(this),complete:this.fetchCompleteCallback.bind(this)})},fetchSuccessCallback:function(e){var t=SW.Cookie.get("hideMaintenanceMessage"),i=!!t&&e.message===decodeURIComponent(t),s=!!e.message&&!i;s&&SW.Cookie.expire("hideMaintenanceMessage"),this.set({isVisible:s,message:e.message})},fetchCompleteCallback:function(){setTimeout(this.fetch.bind(this),6e4)}}),SW.MaintenanceMessageView=SW.View.extend({className:"maintenance-message",events:{"click .js-dismiss":"dismiss"},initialize:function(){this.template=this.findTemplate("maintenance-message"),this.listenTo(this.model,"change",this.render)},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.padPageByMaintenanceMessageHeight(),this.listenTo(sw.dispatcher,"window:resize",this.padPageByMaintenanceMessageHeight.bind(this)),this.listenTo(sw.dispatcher,"page:change",this.padPageByMaintenanceMessageHeight.bind(this)),this.$el},dismiss:function(){SW.Cookie.set("hideMaintenanceMessage",this.model.get("message"),1),this.model.set("isVisible",!1)},padPageByMaintenanceMessageHeight:function(){this.model.get("isVisible")?sw.appRootRegion.childViews.page.$el.css("margin-top",this.$el.outerHeight()):sw.appRootRegion.childViews.page.$el.css("margin-top","auto")}}),SW.AddStudentsCard=SW.Card.extend({defaults:function(){return{nextStep:null,currentStep:null,previousSteps:[],students:new SW.StudentList,downloadedPDF:!1}},saveStudents:function(e){var t=this.get("students").map(function(e){return{firstName:e.get("firstName"),lastName:e.get("lastName"),grade:e.get("grade"),chosenGrade:e.get("chosenGrade"),curriculumTreeID:e.get("curriculumTreeID"),classID:e.get("classID")}});SW.Http.fetch({url:sw.config.api.accounts+"/v2/students-batch",method:"post",data:{students:t},stringify:!0,success:e.success,error:e.error})}}),SW.AddStudentsCardView=SW.ParentView.extend({className:"add-students-card",initialize:function(e){this._super("initialize",arguments),this.steps=this.getSteps(),this.nextStep(this.steps.accountStatus),this.instantiateChildView(this.steps.accountStatus.View)},render:function(){var e=this.childViews.currentInstance,t=e.render()[0];return this.$el.html(t),this.$el},instantiateChildView:function(e){this.childViews.currentInstance&&(this.stopListening(this.childViews.currentInstance),this.childViews.currentInstance.close()),this.childViews.currentInstance=new e({model:this.model}),this.listenTo(this.childViews.currentInstance,"dialog:next-step",this.nextStepAndRender),this.listenTo(this.childViews.currentInstance,"dialog:back",this.previousStepAndRender),this.listenTo(this.childViews.currentInstance,"dialog:close",this.previousStepAndRender)},triggerClose:function(){sw.dispatcher.trigger("dialog:close")},nextStepAndRender:function(e){this.nextStep(e),this.instantiateChildView(e.View),this.render()},previousStepAndRender:function(){this.previousStep(),this.instantiateChildView(this.model.get("currentStep").View),this.render()},setCurrentStep:function(e){this.model.set({currentStep:e}),this.model.set({nextStep:null})},nextStep:function(e){var t=this.model.get("currentStep");t&&this.model.get("previousSteps").push(t),this.setCurrentStep(e)},previousStep:function(){var e=this.model.get("previousSteps").pop();if(!e)throw new Error("Cannot show the previous step because no previous step exists");this.setCurrentStep(e)},getSteps:function(){var e={accountStatus:{View:SW.AddStudentsCardAccountStatusView,nextSteps:{classCode:function(){return e.classCodeExistingAccounts},inviteOptions:function(){return e.inviteOptions}}},classCodeExistingAccounts:{View:SW.AddStudentsCardClassCodeExistingAccountsView,nextSteps:{printInstructions:function(){return e.printInstructionsExistingAccounts}}},inviteOptions:{View:SW.AddStudentsCardInviteOptionsView,nextSteps:{classCode:function(){return e.classCodeNewAccounts},createAccounts:function(){return e.createAccounts}}},printInstructionsExistingAccounts:{View:SW.AddStudentsCardPrintInstructionsExistingAccountsView,nextSteps:{}},classCodeNewAccounts:{View:SW.AddStudentsCardClassCodeNewAccountsView,nextSteps:{printInstructions:function(){return e.printInstructionsNewAccounts}}},printInstructionsNewAccounts:{View:SW.AddStudentsCardPrintInstructionsNewAccountsView,nextSteps:{}},createAccounts:{View:SW.AddStudentsCardCreateAccountsView,nextSteps:{discard:function(){return e.discardAndBack},accountInfo:function(){return e.accountInfo},close:function(){return e.discardAndClose}}},discardAndBack:{View:SW.AddStudentsCardDiscardAndBackView,nextSteps:{cancel:function(){return e.createAccounts},confirm:function(){return e.inviteOptions}}},discardAndClose:{View:SW.AddStudentsCardDiscardAndCloseView,nextSteps:{cancel:function(){return e.createAccounts}}},accountInfo:{View:SW.AddStudentsCardAccountInfoView,nextSteps:{close:function(){return e.closeConfirm}}},closeConfirm:{View:SW.AddStudentsCardCloseConfirmView,nextSteps:{cancel:function(){return e.accountInfo}}}};return e}}),SW.AddStudentsCardAccountStatusView=SW.ParentView.extend({events:{"click .js-option-0":"clickedHaveAccounts","click .js-option-1":"clickedDoNotHaveAccounts","click .js-dialog-close":"triggerClose","click .js-dialog-continue":"clickedContinue"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-account-status-body"),footer:this.findTemplate("add-students-card-cancel-continue-footer")}},render:function(){var e=this.template.header(),t=this.template.main(),i=this.template.footer(),s=e+t+i;return this.$el.html(s),this.$el},triggerClose:function(){sw.dispatcher.trigger("dialog:close")},clickedContinue:function(){var e=this.model.get("nextStep");e&&(e===this.model.get("currentStep").nextSteps.classCode()?SW.Logger.track("new-class:existing-students"):SW.Logger.track("new-class:new-students"),this.trigger("dialog:next-step",e))},enableContinue:function(){$(".js-dialog-continue").removeClass("add-students-card__footer-primary-btn--disabled")},clickedHaveAccounts:function(){var e=this.model.get("currentStep").nextSteps.classCode();this.model.set({nextStep:e}),this.enableContinue(),this.highlightOption($(".js-option-0")),this.unhighlightOption($(".js-option-1"))},clickedDoNotHaveAccounts:function(){var e=this.model.get("currentStep").nextSteps.inviteOptions();this.model.set({nextStep:e}),this.enableContinue(),this.highlightOption($(".js-option-1")),this.unhighlightOption($(".js-option-0"))},highlightOption:function(e){e.addClass("add-students-card__option--active")},unhighlightOption:function(e){e.removeClass("add-students-card__option--active")}}),SW.AddStudentsCardClassCodeExistingAccountsView=SW.ParentView.extend({events:{"click .js-dialog-back":"clickedBack","click .js-dialog-continue":"clickedContinue"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-class-code-existing-accounts"),footer:this.findTemplate("add-students-card-back-continue-footer")},this.model.set({nextStep:this.model.get("currentStep").nextSteps.printInstructions()})},render:function(){var e=this.template.header(),t=this.template.main({classCode:sw.user.classes.getCurrentClass().get("classCode")}),i=this.template.footer(),s=e+t+i;return this.$el.html(s),this.$el},clickedBack:function(){this.trigger("dialog:back")},clickedContinue:function(){var e=this.model.get("nextStep");e&&(SW.Logger.track("new-class:existing-class-code"),this.trigger("dialog:next-step",e))}}),SW.AddStudentsCardPrintInstructionsExistingAccountsView=SW.ParentView.extend({events:{"click .js-dialog-back":"clickedBack","click .js-dialog-finish":"clickedFinish","click .js-dialog-get-instructions":"clickedGetInstructions"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-print-instructions"),footer:this.findTemplate("add-students-card-back-finished-footer")}},render:function(){var e="Students can log into their existing accounts and follow these instructions to join your classroom.",t=this.template.header(),i=this.template.main({msg:e}),s=this.template.footer(),n=t+i+s;return this.$el.html(n),this.$el},clickedBack:function(){this.trigger("dialog:back")},clickedFinish:function(){SW.Logger.track("new-class:existing-finished"),sw.dispatcher.trigger("dialog:close")},clickedGetInstructions:function(){SW.Logger.track("new-class:instructions-downloaded");var e="/actions/getClassCodeExistingPDF.php?classCode="+sw.user.classes.getCurrentClass().get("classCode");window.open(e)}}),SW.AddStudentsCardInviteOptionsView=SW.ParentView.extend({events:{"click .js-option-0":"clickedUseClassCode","click .js-option-1":"clickedCreateAccounts","click .js-dialog-back":"clickedBack","click .js-dialog-continue":"clickedContinue"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-invite-options"),footer:this.findTemplate("add-students-card-back-continue-footer")}},render:function(){var e=this.template.header(),t=this.template.main(),i=this.template.footer({disableContinue:!0}),s=e+t+i;return this.$el.html(s),this.$el},clickedContinue:function(){var e=this.model.get("nextStep");e&&(e===this.model.get("currentStep").nextSteps.classCode()?SW.Logger.track("new-class:new-students-use-class-code"):SW.Logger.track("new-class:new-students-manual"),this.trigger("dialog:next-step",e))},clickedBack:function(){this.trigger("dialog:back")},enableContinue:function(){$(".js-dialog-continue").removeClass("add-students-card__footer-primary-btn--disabled")},clickedUseClassCode:function(){var e=this.model.get("currentStep").nextSteps.classCode();this.model.set({nextStep:e}),this.enableContinue(),this.highlightOption($(".js-option-0")),this.unhighlightOption($(".js-option-1"))},clickedCreateAccounts:function(){var e=this.model.get("currentStep").nextSteps.createAccounts();this.model.set({nextStep:e}),this.enableContinue(),this.highlightOption($(".js-option-1")),this.unhighlightOption($(".js-option-0"))},highlightOption:function(e){e.addClass("add-students-card__option--active")},unhighlightOption:function(e){e.removeClass("add-students-card__option--active");
}}),SW.AddStudentsCardClassCodeNewAccountsView=SW.ParentView.extend({events:{"click .js-dialog-back":"clickedBack","click .js-dialog-continue":"clickedContinue"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-class-code-new-accounts"),footer:this.findTemplate("add-students-card-back-continue-footer")},this.model.set({nextStep:this.model.get("currentStep").nextSteps.printInstructions()})},render:function(){var e=this.template.header(),t=this.template.main({classCode:sw.user.classes.getCurrentClass().get("classCode")}),i=this.template.footer(),s=e+t+i;return this.$el.html(s),this.$el},clickedBack:function(){this.trigger("dialog:back")},clickedContinue:function(){var e=this.model.get("nextStep");e&&(SW.Logger.track("new-class:new-students-class-code-instructions"),this.trigger("dialog:next-step",e))}}),SW.AddStudentsCardPrintInstructionsNewAccountsView=SW.ParentView.extend({events:{"click .js-dialog-back":"clickedBack","click .js-dialog-finish":"clickedFinish","click .js-dialog-get-instructions":"clickedGetInstructions"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-print-instructions"),footer:this.findTemplate("add-students-card-back-finished-footer")}},render:function(){var e="Print these simple instructions for your students to help them get started.",t=this.template.header(),i=this.template.main({msg:e}),s=this.template.footer(),n=t+i+s;return this.$el.html(n),this.$el},clickedBack:function(){this.trigger("dialog:back")},clickedFinish:function(){SW.Logger.track("new-class:new-code-finished"),sw.dispatcher.trigger("dialog:close")},clickedGetInstructions:function(){SW.Logger.track("new-class:instructions-downloaded");var e="/actions/getClassCodeNewPDF.php?classCode="+sw.user.classes.getCurrentClass().get("classCode");window.open(e)}}),SW.AddStudentsCardCreateAccountsView=SW.ParentView.extend({events:{"click .js-dialog-back":"clickedBack","click .js-dialog-close":"clickedClose","click .js-dialog-create":"clickedCreate","click .js-add-student-btn":"clickedAdd","keydown .js-add-student-input":"handleInputKeydown"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-create-accounts"),footer:this.findTemplate("add-students-card-back-create-footer"),errors:this.findTemplate("add-students-card-errors")},this.childViews.students=[],this.listenTo(this.model.get("students"),"update",this.toggleContinue),this.createButtonDisabled=!1},render:function(){var e=this.template.header(),t=this.template.main(),i=this.template.footer({disableContinue:!0}),s=e+t+i;return this.$el.html(s),this.createAllStudentViews(),this.toggleContinue(),this.focusOnInput(),this.$el},clickedBack:function(){var e=this.model.get("currentStep").nextSteps.discard();this.model.get("students").length>0?(this.model.set({nextStep:e}),this.trigger("dialog:next-step",e)):this.trigger("dialog:back")},clickedClose:function(){var e=this.model.get("currentStep").nextSteps.close();this.model.get("students").length>0?this.trigger("dialog:next-step",e):sw.dispatcher.trigger("dialog:close")},focusOnInput:function(){_.delay(function(){this.$(".js-add-student-input").focus()}.bind(this),100)},clearInput:function(){this.$(".js-add-student-input").val("")},clickedAdd:function(){var e=this.$(".js-add-student-input").val(),t=SW.Utility.parseName(e),i=sw.user.classes.getCurrentClass().getGrade(),s=new SW.Student({firstName:t.firstName,lastName:t.lastName,fullname:t.firstName+" "+t.lastName,name:t.firstName+" "+t.lastName,grade:i,chosenGrade:i,curriculumTreeID:sw.user.get("curriculumTreeID"),classID:sw.user.classes.getCurrentClassID()}),n=s.validate(s.attributes);this.clearErrors(),n?(this.displayErrors(n),this.focusOnInput()):(this.model.get("students").add(s),this.createStudentView(s),this.clearInput(),this.focusOnInput(),this.scroll())},createAllStudentViews:function(){this.model.get("students").each(this.createStudentView.bind(this))},createStudentView:function(e){var t=new SW.AddStudentsCardStudentView({model:e});this.childViews.students.push(t),this.$(".js-students-list").append(t.render()[0]),this.listenToOnce(t,"remove-student",this.removeStudent)},displayErrors:function(e){var t=e.reduce(function(e,t){return e.concat(t.errors)},[]),i=this.template.errors({errors:t});this.$(".js-student-errors").removeClass("add-students-card__errors--empty").html(i)},clearErrors:function(){this.$(".js-student-errors").addClass("add-students-card__errors--empty").empty()},handleInputKeydown:function(e){var t=e.keyCode?e.keyCode:e.which;13===t&&this.clickedAdd()},clickedCreate:function(){var e=this.model.get("currentStep").nextSteps.accountInfo();this.createButtonDisabled||(this.createButtonDisabled=!0,this.model.get("students").length>0&&this.model.saveStudents({success:function(t){SW.Logger.track({name:"add-student",details:{isNewStudent:!0,numOfStudents:this.model.get("students").length}});var i=t.map(function(e){return new SW.Student(e,{parse:!0})});this.model.get("students").reset(null),sw.user.classes.getCurrentClass().students.add(i),this.trigger("dialog:next-step",e),this.createButtonDisabled=!1}.bind(this),error:function(){sw.toastManager.create({id:"create-student-error",type:"error",content:"Error creating student accounts. Please try again later.",timer:6e3}),this.createButtonDisabled=!1}}))},removeStudent:function(e){var t=_.findIndex(this.childViews.students,function(t){return t===e}),i=this.childViews.students.splice(t,1);i[0].close(),this.model.get("students").remove(e.model)},toggleContinue:function(){this.model.get("students").length>0?this.enableContinue():this.disableContinue()},enableContinue:function(){this.$(".js-dialog-create").removeClass("add-students-card__footer-primary-btn--disabled")},disableContinue:function(){this.$(".js-dialog-create").addClass("add-students-card__footer-primary-btn--disabled")},scroll:function(){var e=this.$(".add-students-card__students");e.stop().animate({scrollTop:e[0].scrollHeight})}}),SW.AddStudentsCardStudentView=SW.ChildView.extend({tagName:"li",className:"add-students-card__student",events:{"click .js-remove-student":"removeStudent"},initialize:function(){this._super("initialize"),this.template=this.findTemplate("add-students-card-student")},render:function(){var e=this.model.toJSON(),t=this.template(e);return this.$el.html(t),this.$el},removeStudent:function(){this.trigger("remove-student",this),this.remove()}}),SW.AddStudentsCardDiscardAndBackView=SW.ParentView.extend({events:{"click .js-dialog-cancel":"clickedCancel","click .js-dialog-confirm":"clickedConfirm"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("add-students-card-confirm")},render:function(){var e="These accounts have not been created yet. Do you want to delete all progress? Once discarded, you will have to re-enter them.",t=this.template({msg:e});return this.$el.html(t),this.$el},clickedCancel:function(){var e=this.model.get("currentStep").nextSteps.cancel();this.model.set({nextStep:e}),this.trigger("dialog:next-step",e)},clickedConfirm:function(){var e=this.model.get("currentStep").nextSteps.confirm();this.model.get("students").reset(null),this.model.set({nextStep:e}),this.trigger("dialog:next-step",e)}}),SW.AddStudentsCardAccountInfoView=SW.ParentView.extend({events:{"click .js-dialog-close":"clickedClose","click .js-dialog-download":"clickedDownload","click .js-dialog-finished":"clickedFinished"},initialize:function(){this._super("initialize",arguments),this.template={header:this.findTemplate("add-students-card-header"),main:this.findTemplate("add-students-card-account-info"),footer:this.findTemplate("add-students-card-finished-footer")}},render:function(){var e=this.template.header(),t=this.template.main(),i=this.template.footer({disableFinished:!this.model.get("downloadedPDF")}),s=e+t+i;return this.$el.html(s),this.enableFinished(),this.$el},clickedClose:function(){var e=this.model.get("currentStep").nextSteps.close();this.model.get("downloadedPDF")?(sw.app.navigate("#students",{trigger:!0}),sw.dispatcher.trigger("dialog:close")):this.trigger("dialog:next-step",e)},clickedDownload:function(){var e="/actions/printLoginInfo.php?class-id="+sw.user.classes.getCurrentClass().get("id");this.model.set({downloadedPDF:!0}),this.enableFinished(),window.open(e)},enableFinished:function(){this.model.get("downloadedPDF")&&(this.$(".js-dialog-finished").removeClass("add-students-card__footer-primary-btn--disabled"),this.$(".js-dialog-download").removeClass("add-students-card__download-pdf-btn--active"))},clickedFinished:function(){this.model.get("downloadedPDF")&&(SW.Logger.track("new-class:new-students-finished"),sw.dispatcher.trigger("dialog:close"),sw.app.navigate("#students",{trigger:!0}))}}),SW.AddStudentsCardCloseConfirmView=SW.ParentView.extend({events:{"click .js-dialog-cancel":"clickedCancel","click .js-dialog-confirm":"clickedConfirm"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("add-students-card-close-confirm")},render:function(){var e=this.template();return this.$el.html(e),this.$el},clickedCancel:function(){var e=this.model.get("currentStep").nextSteps.cancel();this.model.set({nextStep:e}),this.trigger("dialog:next-step",e)},clickedConfirm:function(){sw.app.navigate("#students",{trigger:!0}),sw.dispatcher.trigger("dialog:close")}}),SW.AddStudentsCardDiscardAndCloseView=SW.ParentView.extend({events:{"click .js-dialog-cancel":"clickedCancel","click .js-dialog-confirm":"clickedConfirm"},initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("add-students-card-confirm")},render:function(){var e="These accounts have not been created yet. Do you want to delete all progress? Once discarded, you will have to re-enter them.",t=this.template({msg:e});return this.$el.html(t),this.$el},clickedCancel:function(){var e=this.model.get("currentStep").nextSteps.cancel();this.model.set({nextStep:e}),this.trigger("dialog:next-step",e)},clickedConfirm:function(){this.model.get("students").reset(null),sw.dispatcher.trigger("dialog:close")}}),SW.ActivateChildView=SW.ParentView.extend({className:"activate-child",initialize:function(){this._super("initialize",arguments),this.template=this.findTemplate("activate-child")},render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el}}),$(function(){function e(e){var t=e.html(),i="Copied!",s=250,n={"transition-duration":s/1e3+"s",color:"transparent"};e.attr("data-copied")||(e.attr("data-copied",!0).css(n),setTimeout(function(){e.html(i).css("color",""),setTimeout(function(){e.css(n),setTimeout(function(){e.attr("data-copied","").html(t).css("color","")},s)},4e3)},s))}$("body").on("click",".js-copy-text__btn",function(){var t=$(this).siblings(".js-copy-text__value").select().val();try{var i=document.execCommand("copy");if(!i)throw"not-copied";e($(this))}catch(e){window.prompt("Copy the text to the clipboard:",t)}})}),$(function(){function e(){$("select[sw-select]:not([sw-select^='id-'])").each(t)}function t(){var e=$(this);d++,e.attr("sw-select","id-"+d),s(e),i(e)}function i(e){e.addClass("hidden-accessible")}function s(e){var t=$("<div class='sw-select' sw-select-id tabindex='-1'>"),i=$("<button class='sw-select__btn' sw-select-btn tabindex='-1' type='button'><span class='sw-select__btn-text'></span> <i class='sw-select__icon fa fa-chevron-down'></button>"),s=n(e);i.find(".sw-select__btn-text").text(s.find("[sw-select-option='selected']").text()),t.append(i).append(s).addClass(e.attr("class")).attr("sw-select-id",e.attr("sw-select")),e.after(t)}function n(e){var t=$("<ul class='sw-select__options'>"),i=0;return e.find("option").each(function(e){this.selected&&(i=e)}),e.find("option").each(function(e){var s=$(this),n=$('<li class="sw-select__option" sw-select-option-value="'+s.val()+'" sw-select-option><span class="sw-select__option-text">'+s.text()+"</span></li>");e===i&&n.attr("sw-select-option","selected"),s.attr("hidden")&&n.addClass("gone"),s.attr("sw-select-option-url")&&n.prepend('<img class="sw-select__option-icon" src="'+s.attr("sw-select-option-url")+'">'),t.append(n)}),t}function a(e){var t=$(e.target);t.parents(".sw-select").length?r(t):o()}function r(e){var t,i;e.hasClass("sw-select__btn")||e.parents(".sw-select__btn").length>0?(i=e.parents(".sw-select"),t=!i.hasClass("sw-select--open"),o(),t&&i.addClass("sw-select--open")):e.hasClass("sw-select__option")?l(e):e.hasClass("sw-select__option-text")&&l(e.parent(".sw-select__option"))}function o(){$(".sw-select.sw-select--open").removeClass("sw-select--open")}function l(e){var t=e.parents(".sw-select"),i=$("[sw-select='"+t.attr("sw-select-id")+"']"),s=e.attr("sw-select-option-value");t.find(".sw-select__btn-text").html(e.html()),t.removeClass("sw-select--open"),i.val(s).trigger("change")}var d=0;e(),sw.dispatcher.on("DOM:change",e),sw.dispatcher.on("body:click",a)}),function(e,t){var i=(e.sw||{},function(e,t){function i(){o?(r.removeClass("opened"),a.removeClass(n).addClass(s)):(r.addClass("opened"),a.removeClass(s).addClass(n)),o=!o}var s="fa-bars",n="fa-times",a=e,r=t,o=!1;a.addClass("fa "+s).click(function(){i()})});e.sw.menuToggle=i}(window,jQuery),$(function(){$("body").on("click",".js-notice-bar-close",function(){$(this).parents(".js-notice-bar").slideUp(200,function(){$(this).remove()})})}),function(e){$("body").on("click","[data-reveal]",function(){var e,t=$(this),i=t.attr("data-reveal-hide"),s=t.attr("data-reveal");i&&(e="siblings"===i?$(s).siblings():$(i),e.css("display","none")),$(s).css("display","")})}(window),function(e){function t(){var t=e.location.pathname||e.location.pathName;sw.track.event("text to speech","click",t)}$("body").on("click","[data-audio]",function(){var e=window.location.origin+"/"+$(this).attr("data-audio"),i=new Audio(e);i.play(),t()})}(window);